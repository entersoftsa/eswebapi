{"version":3,"sources":["kendo.spreadsheet.js"],"names":["f","define","kendo","UndoRedoStack","Observable","extend","init","options","fn","call","this","clear","events","push","command","stack","slice","currentCommandIndex","undo","canUndo","trigger","redo","canRedo","length","deepExtend","util","amd","a1","a2","a3","defined","value","UNDEFINED","round","precision","power","pow","math","p","limitValue","min","max","rad","degrees","DEG_TO_RAD","deg","radians","isNumber","val","isNaN","valueOrDefault","defaultValue","sqr","objectKey","object","key","parts","sort","join","hashKey","str","i","hash","charCodeAt","hashObject","arrayLimits","arr","MAX_NUM","MIN_NUM","arrayMin","arrayMax","sparseArrayMin","sparseArrayLimits","sparseArrayMax","n","isFinite","undefined","last","array","append","first","second","apply","renderTemplate","text","template","useWithBlock","paramName","renderAttr","name","renderAllAttr","attrs","output","renderStyle","renderSize","size","renderPos","pos","result","toHyphens","split","isTransparent","color","arabicToRoman","literals",1,10,100,2,20,200,3,30,300,4,40,400,5,50,500,6,60,600,7,70,700,8,80,800,9,90,900,1000,"values","roman","shift","romanToArabic","r","digits","prev","v","toLowerCase","x","l","c","d","m","charAt","memoize","cache","Object","create","id","arguments","ucs2decode","string","extra","counter","ucs2encode","map","String","fromCharCode","Math","window","PI","Number","MAX_VALUE","now","Date","getTime","drawing","dataviz","$","measureText","style","measureBox","TextMetrics","current","measure","doc","document","Class","LRUCache","_size","_length","_map","put","lru","entry","_head","_tail","newer","older","get","defaultMeasureBox","_cache","_initOptions","baselineMarkerSize","box","baselineMarker","styleKey","cacheKey","cachedResult","width","height","baseline","_baselineMarker","cloneNode","appendChild","body","offsetWidth","offsetHeight","offsetTop","parentNode","removeChild","jQuery","CODE","out","UCS2","code","parse","data","callbacks","readChar","index","croak","msg","Error","readWhile","pred","a","readAsciiWhile","STRING","skipWhitespace","isWhitespace","eat","save","skip","isDigit","isHexDigit","isNameStart","isName","xmlComment","END_COMMENT","xmlTag","QUESTION_MARK","xmlDecl","START_COMMENT","xmlName","xmlAttrs","END_SHORT_TAG","GREATER_THAN","xmlContent","pop","END_TAG","START_CDATA","END_CDATA","LESS_THAN","AMPERSAND","xmlEntity","xmlString","quote","QUOTE","APOSTROPHE","SHARP","LOWERCASE_X","UPPERCASE_X","parseInt","ENTITIES","SEMICOLON","END_DECLARATION","$tag","EQUAL","what","thing","arg1","arg2","is","selector","j","exit","EXIT","amp","lt","gt","quot","nbsp","parseXML","ex","encodeBase64","input","chr1","chr2","chr3","enc1","enc2","enc3","enc4","encodeUTF8","KEY_STR","inArray","ObserversMixin","observers","_observers","addObserver","element","removeObserver","splice","methodName","event","observer","idx","_suspended","optionsChange","e","geometryChange","suspend","resume","_observerField","field","mixins","Command","PropertyChangeCommand","ApplyFilterCommand","DeleteCommand","AddCommand","support","browser","msie","version","spreadsheet","_workbook","workbook","_property","property","_state","range","_range","exec","setState","getState","_forEachCell","callback","ref","_ref","forEach","sheet","toRangeRef","bind","_value","ClearContentCommand","clearContent","EditCommand","rejectState","validationState","title","message","reason","type","_getValidationState","ex1","calc","ParseError","ex2","TextWrapCommand","rowHeight","forEachRow","topLeft","row","_rowHeight","AdjustDecimalsCommand","_decimals","decimals","formatting","batch","forEachCell","col","cell","format","adjustDecimals","BorderChangeCommand","_type","border","_style","noBorders","borderLeft","borderTop","borderRight","borderBottom","allBorders","leftBorder","leftColumn","rightBorder","rightColumn","topBorder","topRow","bottomBorder","bottomRow","outsideBorders","insideBorders","insideHorizontalBorders","insideVerticalBorders","MergeCellCommand","activate","activeCell","unmerge","cells","merge","horizontally","vertically","forEachColumn","FreezePanesCommand","_topLeft","panes","frozenColumns","frozenRows","rows","columns","unfreeze","PasteCommand","_clipboard","clipboard","activeSheet","pasteRef","status","canPaste","menuInvoked","paste","_adjustRowHeight","pasteOnMerged","AdjustRowHeightCommand","rowIndex","ToolbarPasteCommand","_view","focus","select","execCommand","CopyCommand","noop","canCopy","copy","multiSelection","ToolbarCopyCommand","textarea","createElement","addClass","html","appendTo","remove","CutCommand","cut","AutoFillCommand","origin","_origin","fillFrom","ToolbarCutCommand","FilterCommand","filter","hasFilter","intersectingMerged","SortCommand","column","ascending","expandRange","Range","_sheetRef","clearFilter","filterRule","exists","valueFilter","ValueFilter","customFilter","CustomFilter","eq","ClearFilterCommand","HideLineCommand","axis","setAxisState","getAxisState","axisManager","hideSelectedRows","hideSelectedColumns","UnHideLineCommand","unhideSelectedRows","unhideSelectedColumns","DeleteRowCommand","deleteSelectedRows","DeleteColumnCommand","deleteSelectedColumns","AddColumnCommand","addColumnLeft","addColumnRight","AddRowCommand","canAddRow","addRowAbove","addRowBelow","EditValidationCommand","validation","OpenCommand","file","match","fromFile","SaveAsCommand","fileName","extension","saveAsExcel","saveAsPDF","pdf","classNames","FormulaBar","wrapper","ui","Widget","formulaInput","FormulaInput","destroy","isOpenParen","ch","isCloseParen","isMatchingParen","close","open","touches","target","begin","end","knownFunction","runtime","FUNCS","isEqualToken","tok1","tok2","ns","keys","styles","KEY_NAMES","PRIVATE_FORMULA_CHECK","listWrapper",27,37,39,35,36,32,"attr","autoScale","on","scale","_highlightedRefs","_staticTokens","_formulaSource","_formulaList","_popup","_tooltip","_keydown","_keyup","_blur","_input","_focus","filterOperator","scalePadding","minLength","enable","toggleClass","getPos","lookup","lookupNode","loop","node","nodeType","firstChild","nextSibling","nodeValue","div","tmp","sel","getSelection","focusNode","focusOffset","b","anchorNode","anchorOffset","collapsed","setPos","len","el","eiv","createRange","setStart","setEnd","removeAllRanges","addRange","home","test","toUpperCase","formulaSource","DataSource","list","StaticList","insertAfter","autoBind","selectable","change","_formulaListChange","dataSource","dataValueField","preventDefault","activeToken","completion","ctx","tokenCtx","_tokenContext","_mute","token","replace","nextToken","_replaceAt","popup","Popup","anchor","clearTimeout","_focusId","_isFormula","keyCode","_navigated","_move","_keyDownTimeout","setTimeout","_syntaxHighlight","view","visible","focusFirst","_focusTimeout","pressed","DOWN","focusNext","UP","focusPrev","focusLast","ENTER","TAB","PAGEUP","PAGEDOWN","tokens","tok","point","tokenize","_sync","_editorToSync","isActive","_textContainer","computedStyles","getComputedStyles","position","visibility","whiteSpace","top","left","_span","css","_cellTooltip","tooltip","toggleTooltip","show","toggle","_activeElement","operator","hide","rectangle","resize","canInsertRef","isKeyboardAction","_canInsertRef","afterPoint","canReplace","canInsertBetween","right","strictMode","refAtPoint","simplify","newValue","rest","substr","syncWith","eventName","off","highlightedRefs","refClasses","Pane","series","refIndex","parens","active","cls","colorClass","unshift","reverse","htmlEncode","substring","_setStaticTokens","Mac","isAlphaNum","keyName","EventListener",13,38,33,34,46,113,"navigator","platform","indexOf","handlers","_handlers","_observer","keyDownProxy","keyDown","mouseProxy","mouse","threshold","_pressLocation","documentElement","handleEvent","rightClick","dx","dy","distance","which","button","pageX","y","pageY","sqrt","catchAllHandler","handler","eventKey","mod","metaKey","ctrlKey","shiftKey","passThrough","skew","level","temp","insert","NilNode","RangeTreeNode","start","diff","heir","intersecting","ranges","intersects","tree","root","RangeTree","RangeList","Iterator","SparseRangeList","findrange","clone","firstRange","lastRange","rangeValue","rangeStart","rangeEnd","expandedValues","rangeIndex","sortedIndices","valueComparer","indices","comparer","sourceStart","sourceEnd","targetStart","iterator","state","unique","at","lastRangeStart","ValueRange","toExcelFormat","Property","JsonProperty","ValueProperty","set","dst","JSON","stringify","formats","validations","prototype","dateToNumber","culture","calendar","patterns","PropertyBag","specs","sortable","serializable","depends","cellCount","properties","lists","spec","fromJSON","si","iterators","forEachProperty","ALL_PROPERTIES","columnName","colIndex","letter","floor","displaySheet","displayRef","rel","aa","Ref","NULL","NameRef","CellRef","RangeRef","UnionRef","hasSheet","_hasSheet","setSheet","absolute","relative","adjust","toString","print","obj","intersect","isCell","toRow","toColumn","rangeAt","nextRangeIndex","previousRangeIndex","reference","refs1","refs2","r1","r2","bottomRight","single","refs","concat","replaceAt","forEachColumnIndex","forEachAxisIndex","forEachRowIndex","sorted","method","valid","display","ret","trow","tcol","abs","arow","acol","forRow","delta","tl","br","endSheet","normalize","_containsRange","_containsCell","contains","Array","that","some","_intersectRange","a_left","a_top","a_right","a_bottom","b_left","b_top","b_right","b_bottom","c1","c2","rr1","rc1","rr2","rc2","changes","relTL","relBR","collapse","startRow","endRow","startCol","endCol","union","topLeftRow","topLeftCol","bottomRightRow","bottomRightCol","modified","num","limit","bottom","move","cols","tr","u","reduce","empty","theRef","newRefs","NULLREF","SHEETREF","Infinity","FIRSTREF","AutoFillCalculator","grid","_grid","rectIsVertical","startRect","endRect","autoFillDest","selection","cursor","quadrant","pivot","opposite","cornerResult","expanding","bottomLeft","topRight","lower","further","EdgeNavigator","SheetNavigator","rangeGetter","prevLeft","prevVisible","nextRight","nextVisible","nextLeft","prevRight","boundary","_sheet","_columns","autoFillCalculator","colEdge","columnRange","rowEdge","_rows","rowRange","_viewPortHeight","unionWithMerged","leftCol","rightCol","selectionIncludesMergedCells","_mergedCells","setSelectionValue","selectAll","mode","addToExisting","refForMode","rowRef","colRef","startSelection","startAutoFill","completeSelection","selectForContextMenu","modifySelection","action","scrollInto","newSelection","direction","determineDirection","viewPortHeight","originalSelection","currentOriginalSelectionRange","prevPage","nextPage","firstVisible","lastVisible","updateCurrentSelectionRange","moveActiveCell","originalActiveCell","navigateInSelection","currentNavigationRange","selTopLeft","selBottomRight","done","nextNavigationRange","previousNavigationRange","shouldSkip","singleCellSelection","extendSelection","resizeAutoFill","isMerged","forEachMergedCell","merged","hint","preview","props","_autoFillOrigin","dest","punch","_previewFillFrom","updateAutoFill","currentSelectionRange","leftMode","rightMode","topMode","bottomMode","originalSelect","selectionRangeIndex","subset","bottomCol","AxisManager","forEachSelectedColumn","layout","recalc","forEachSelectedRow","includesHiddenColumns","includesHidden","includesHiddenRows","selectionIncludesHiddenColumns","selectionIncludesHiddenRows","deleteColumn","deleteRow","hideColumn","hideRow","unhideColumn","unhideRow","insertColumn","rowCount","canInsertRow","insertRow","Clipboard","iframe","className","_external","_uid","guid","external","hasOwnProperty","intersectsMerged","stateRangeRef","contents","destination","originActiveCell","rowDelta","colDelta","address","_isInternal","triggerChange","plain","table","mergedCells","contentWindow","write","find","_parseHTML","_parseTSV","_cellState","tbody","each","td","ci","ri","rowspan","colspan","blankCell","after","cellState","internalHTML","internalPlain","getComputedStyle","borders","_borderObject","fontSize","background","underline","italic","bold","_strippedStyle","textAlign","verticalAlign","wrap","prefixes","prefix","borderObject","looksLikeANumber","getTextHeight","font-size","word-break","white-space","complement","_normalize","_set","noTrigger","_get","_resizedRef","_border","_collapsedBorder","collapsedBorderTop","collapsedBorderRight","collapsedBorderBottom","collapsedBorderLeft","formula","compile","editorChange","isInEditMode","numberToDate","_","toJSON","_validation","_merge","mergedRef","vi","_properties","setProp","line","propName","propValue","clearAll","contentsOnly","formatOnly","clearFormat","isSortable","_sortBy","isFilterable","clearFilters","_filterBy","_filter","propertyName","maxHeight","cellRange","totalWidth","columnWidth","hasValue","flag","draw","CalcError","argmax","compileArgumentChecks","functionName","args","comp","allowError","isArray","arrayArgs","resolve","cond","force","canBeArrayArg","hasArrayArgs","typeCheck","forced","haveForced","err","main","Function","withErrorHandling","makeSyncFunction","check","doit","xargs","Matrix","arrays","makeAsyncFunction","count","makeCallback","defineFunction","func","log","console","kendoSpreadsheetArgs","argsAsync","dateToJulianDays","julianDaysToDate","jd","year","month","date","day","ord","ORDINAL_ADD_DAYS","isLeapYear","yr","daysInYear","daysInMonth","mo","DAYS_IN_MONTH","unpackDate","serial","BASE_DATE","packDate","unpackTime","ms","hours","minutes","seconds","frac","MS_IN_DAY","MS_IN_HOUR","MS_IN_MIN","milliseconds","serialToDate","t","packTime","dateToSerial","time","getHours","getMinutes","getSeconds","getMilliseconds","getFullYear","getMonth","getDate","parseDate","binaryCompare","exports","Context","Formula","ARGS_NUMERIC","ARGS_ANYVALUE","ss","parent","self","resolveCells","getRefData","_resolve","onFormula","fetch","context","pending","add","formulas","getRefCells","cellValues","fname","bool","asMatrix","h","isRange","hiddenInfo","getData","includeEmpty","eachRow","eachCol","mapRow","mapCol","transpose","unit","multiply","s","va","vb","adds","sign","determinant","C","L","k","inverse","imax","augment","printer","absrefs","onReady","lcsheet","parentContext","reset","renameSheet","oldSheetName","newSheetName","affectedSheet","operation","formulaRow","formulaCol","formulaSheet","formulaMoves","newFormulaRow","newFormulaCol","co","th","comatrix","thmatrix","elmatrix","defineAlias","alias","orig","kendoSpreadsheetAliases","compileValidation","validationHandler","parsedFromDate","parsedToDate","from","dataType","TRANSPOSE_FORMAT","DATE_FORMAT","fromIsDateValue","parseFormula","to","toIsDateValue","validationComparers","custom","comparerType","valueToCompare","toValue","allowNulls","_getListData","Validation","tooltipMessageTemplate","tooltipTitleTemplate","messageTemplate","titleTemplate","_formatMessages","fromFormula","toFormula","_setMessages","tooltipTitle","tooltipMessage","cube","_getOptions","compareValue","compareFormat","calculateFromCallBack","greaterThan","lessThan","between","equalTo","notEqualTo","greaterThanOrEqualTo","lessThanOrEqualTo","notBetween","Color","Selection","Sheet","_activeCell","currentOriginalNavigationRange","expanded","changeActiveCell","columnCount","headerHeight","headerWidth","Axis","_frozenRows","_frozenColumns","_suspendChanges","Grid","_sorter","Sorter","_viewSelection","_editSelection","_formulaSelections","showGridLines","_selectionState","_inEdit","_navigator","_axisManager","_name","_sheetName","accessor","_field","suspendChanges","setDataSource","dataSourceBinder","SheetDataSourceBinder","columnIndex","unhide","isHiddenColumn","hidden","_copyRange","sourceRangeRef","targetRef","nextRefTopLeft","nextRefBottomRight","nextIndex","nextBottomIndex","targetIndex","_adjustReferences","_sheets","_forFormulas","_forValidations","adjustNames","nextRef","isEnabledRow","isEnabledColumn","isHiddenRow","numRows","numColumns","parseReference","forEachFilterHeader","columnRef","startCellIndex","endCellIndex","startResizing","initialPosition","_initialPosition","_resizeInProgress","_autoFillInProgress","_autoFillDest","_autoFillPunch","_autoFillHint","_autoFillDirection","autoFillRef","autoFillPunch","autoFillInProgress","resizingInProgress","completeResizing","hintPosition","handlePosition","resizeHintPosition","resizeHandlePosition","_resizeHandlePosition","location","_resizeHintPosition","removeResizeHandle","positionResizeHandle","_selectionInProgress","execute","operatingRange","selectionInProgress","expandedRef","selectionState","isAxis","trim","trims","activeCellSelection","selectedHeaders","allCols","allRows","rowSelection","colSelection","rowState","colState","all","isInEdit","_setFormulaSelections","_viewActiveCell","json","positions","viewSelection","toHex","_sort","activeCellRef","_compileFormula","_compileValidation","Filter","_refreshFilter","logToConsole","cellRefIndex","resetFormulas","resetValidations","next","revalidate","cellRef","_copyValuesInRange","suspended","sortBy","prepare","matches","filterColumn","filterRef","_clearFilter","ALL_REASONS","currentRef","DOT","EMPTYCHAR","sheetsBarClassNames","SheetsBar","sheetsBarWrapper","sheetsBarSheetsWrapper","sheetsBarActive","sheetsBarInactive","sheetsBarAdd","sheetsBarRemove","sheetsBarItems","sheetsBarEditor","sheetsBarScrollable","sheetsBarNext","sheetsBarPrev","sheetsBarKItem","sheetsBarKActive","sheetsBarKTextbox","sheetsBarKLink","sheetsBarKIcon","sheetsBarKFontIcon","sheetsBarKButton","sheetsBarKButtonBare","sheetsBarKArrowW","sheetsBarKArrowE","sheetsBarKReset","sheetsBarKIconX","sheetsBarKSprite","sheetsBarKIconPlus","sheetsBarHintWrapper","sheetsBarKResetItems","_tree","dom","Tree","render","_addButton","_createSheetsWrapper","_createSortable","_sortable","_onSheetReorderStart","_onSheetReorderEnd","_onSheetRemove","_onSheetSelect","_createEditor","_onAddSelect","scrollable","_editor","_renderSheets","_selectedIndex","_onEditorKeydown","_onEditorBlur","_destroyEditor","renderSheets","sheets","selectedIndex","wrapperOffsetWidth","sheetsGroupScrollWidth","scrollPrevButton","scrollNextButton","scrollPrevButtonWidth","sheetsWrapper","_sheetsWrapper","sheetsGroup","_sheetsGroup","addButtonWidth","outerWidth","_isRtl","isRtl","_scrollableAllowed","scrollWidth","_scrollableModeActive","_toggleScrollButtons","_renderHtml","_nowScrollingSheets","children","marginLeft","marginRight","_toggleScrollEvents","_scrollSheetsByDelta","renderScrollButtons","isSelectedSheet","elementContent","deleteIcon","sheetElements","maxlength","baseButtonClass","childrenElements","Sortable","container","animation","ignore","closest","_onSheetRename","oldIndex","newIndex","removedSheetName","editorValue","selectedSheetText","_scrollSheetsToItem","isAddButton","sheetIndex","item","currentScrollOffset","itemWidth","itemOffset","sheetsGroupWidth","sheetsGroupPadding","itemPosition","scrollLeft","ceil","parseFloat","finish","animate","scrLeft","ul","getcol","getrow","noThrow","stream","OUT","TokenStream","eof","addReference","peek","parseExpression","commas","maybeBinary","maybeIntersect","parseAtom","parseSymbol","upper","TRUE","FALSE","parseFuncall","fixReference","exp","parseArray","op","maybePercent","my_prec","his_prec","OPERATORS","ast","makePrinter","prec","withParens","parenthesize","arg","needParens","makeClosure","toCPS","cps","cpsAtom","cpsUnary","cpsBinary","cpsFunc","cpsLambda","cpsMatrix","cpsIf","makeContinuation","thenK","gensym","elseK","vars","cpsAnd","cpsOr","cont","elements","isMatrix","GENSYM","makeFormula","js","jsArray","FORMULA_CACHE","identity","readNext","ahead","refRange3D","refCell3D","refSheetRange","refSheetCell","refRange","refCell","funcall","toCell","isFirst","forEditor","fixCell","g","space","addPos","RawTokenStream","InputStream","startToken","endToken","isIdStart","isId","isOpChar","isPunc","readNumber","has_dot","number","symbol","getRC","negative","readSymbol","lookingAt","readString","readEscaped","readSheetName","readOperator","readPunc","EOF","forward","RegExp","escaped","predicate","rx","ops","readExcel","deferred","reader","FileReader","onload","zip","JSZip","readWorkbook","readAsArrayBuffer","strings","readStrings","relationships","readRelationships","theme","readTheme","byType","readStyles","items","enter","tag","relId","dim","SEL_SHEET","byId","sheetDimensions","SEL_VIEW","activeTab","integer","SEL_DEFINED_NAME","vbProcedure","defineName","loadSheets","then","recalcSheets","ready","Deferred","promise","insertSheet","queueSheet","progress","notify","readSheet","defaultColWidth","toColWidth","defaultRowHeight","toRowHeight","SEL_ROW","maximumDigitWidth","fraction","pts","formulaRange","nCols","_count","styleIndex","stop","acRef","SEL_CELL","applyStyle","SEL_MERGE","SEL_COL","ht","SEL_SELECTION","SEL_PANE","xSplit","ySplit","SEL_SHEET_VIEW","leave","_refresh","SEL_VALUE","SEL_STRING","SEL_FORMULA","setFormat","formatCode","setFill","setFont","fontFamily","setBorder","side","prop","BORDER_WIDTHS","shouldSet","applyName","xf","base","inlineStyles","xfId","namedStyles","fonts","fills","numFmts","DEFAULT_FORMATS","part","files","asUint8Array","SEL_SHARED_STRING","SEL_TEXT","entries","Id","Target","Type","getXf","addBool","borderId","fillId","fontId","numFmtId","pivotButton","quotePrefix","getColor","themeColor","tint","rgb","toCSSColor","indexed","INDEXED_COLORS","colorScheme","parseColor","toHSL","toCssRgba","font","fill","closed","SEL_NUM_FMT","SEL_FONT","SEL_FILL","patternType","SEL_BORDER","SEL_NAMED_STYLE","SEL_INLINE_STYLE","horizontal","vertical","wrapText","swap","scheme","SEL_SCHEME_SYSCLR","SEL_SCHEME_RGBCLR","def","none","thin","medium","dashed","dotted","thick","double","hair","mediumDashed","dashDot","mediumDashDot","dashDotDot","mediumDashDotDot","slantDashDot",0,11,12,14,15,16,17,18,19,21,22,45,47,48,49,"_readSheet","_readStrings","_readStyles","_readTheme","_readWorkbook","Workbook","_sheetsSearchCache","undoRedoStack","_onUndoRedo","_context","FormulaContext","_validationContext","ValidationFormulaContext","_names","unbind","_sheetChange","_inputForRef","commandOptions","editActiveCell","refresh","sheetByName","moveSheetToIndex","toIndex","fromIndex","sheetSelection","insertIndex","sheetName","getUniqueSheetName","sheetNameSuffix","sheetByIndex","removeSheet","newSheet","reject","excel","ooxml","saveAs","dataURI","toDataURL","proxyURL","forceProxy","group","undefineName","nameValue","PDFMixin","_drawPDF","exportPDF","proxyTarget","fail","area","states","currentFormula","toActionSelector","selectors","alphaNumRegExp","ACTIONS","ENTRY_ACTIONS","CONTAINER_EVENTS","CLIPBOARD_EVENTS","EDITOR_EVENTS","FORMULABAR_EVENTS","FORMULAINPUT_EVENTS","SELECTION_MODES","COMPOSITE_UNAVAILABLE_ACTION_SELECTORS","UNHIDE_ACTION_SELECTORS","ACTION_KEYS","SHIFT_ACTION_KEYS","ENTRY_ACTION_KEYS","Controller","up","down","ctrl+left","ctrl+right","ctrl+up","ctrl+down","ctrl+home","ctrl+end","pageup","pagedown","tab","shift+tab","shift+enter","delete","backspace","shift+:alphanum",":alphanum","ctrl+:alphanum",":edit","wheel","*+mousedown","contextmenu","*+mousedrag","*+mouseup","*+dblclick","mousemove","*+pageup","*+pagedown","mouseup","*+cut","*+paste","*+copy","esc","rowheader","columnheader","topcorner","autofill","clipboardElement","cellContextMenu","rowHeaderContextMenu","colHeaderContextMenu","scroller","tabstrip","sheetsbar","editor","onEditorChange","onEditorActivate","onEditorDeactivate","onEditorUpdate","onScroll","listener","keyListener","barKeyListener","barElement","inputKeyListener","cellElement","onSheetBarSelect","onSheetBarReorder","onSheetBarRename","onSheetBarRemove","onContextMenuSelect","onCommandRequest","onDialogRequest","_execute","editorClose","showError","openDialog","_activeTooltip","clientHeight","onWheel","deltaX","originalEvent","deltaY","deltaMode","scrollWith","onAction","onPageUp","scrollDown","onPageDown","onEntryAction","shouldPrevent","disabled","rect","activeCellRectangle","onShiftAction","appendSelection","onMouseMove","objectAt","onMouseDown","pane","originFrame","_selectionMode","deactivate","openFilterMenu","onContextMenu","menu","isComposite","showUnhide","showUnmerge","prevent","constrainResize","resizeHandle","onMouseDrag","frame","startAutoScroll","selectToLocation","scrollTop","onMouseUp","stopAutoScroll","activeEditor","onDblClick","onCut","detach","clipBoardValue","onPaste","hasHTML","hasPlainText","clipboardData","DOMStringList","types","onCopy","scrollRight","offset","coordinates","cellLocation","lastKnownCellLocation","autoScroll","_autoScrollTarget","boundaries","scrollStep","finalLocation","viewObject","_scrollInterval","setInterval","clearInterval","filterMenu","createFilterMenu","openFor","onEditorBarFocus","onEditorCellFocus","onEditorEsc","onEditorBlur","isFiltered","onEditorAction","onEditorShiftAction","exportOptions","pdfExport","excelExport","selectElementContents","selectNodeContents","cellBefore","trs","cellAbove","prevRow","cellBorder","drawCell","collection","hBorders","vBorders","showGrid","defaultBorder","shouldDrawCell","toHSV","backgroundColor","textDecoration","fontStyle","fontWeight","wordBreak","__dataType","paneClassNames","addCell","sibling","borderRightColor","borderBottomColor","borderLeftColor","borderTopColor","within","RESIZE_HANDLE_WIDTH","viewClassNames","VIEW_MESAGES","HtmlTable","CELL_CONTEXT_MENU","ROW_HEADER_CONTEXT_MENU","COL_HEADER_CONTEXT_MENU","VIEW_CONTENTS","View","fixedContainer","viewSize","cellEditor","barEditor","topCorner","filterHeadersWrapper","filterRange","filterButton","filterButtonActive","icon","iconFilterDefault","sheetsBar","messages","errors","openUnsupported","shiftingNonblankCells","filterRangeContainingMerges","sortRangeContainingMerges","validationError","tabs","_height","_width","addColumn","addRow","Node","toDomTree","ContextMenu","contextMenuConfig","scrollbar","_chrome","_dialogs","_formulaInput","clipboardContents","SheetEditor","_sheetsbar","showOn","clientWidth","_resize","tabstripHeight","outerHeight","formulaBarHeight","formulaBar","sheetsBarHeight","quickAccessAdjust","prependTo","toolbar","_tabstrip","content","TabStrip","dataTextField","dataContentField","toolbarOptions","_executeCommand","cellRectangle","_rectangle","boundingRectangle","isColumnResizer","handleWidth","_headerWidth","isRowResizer","_headerHeight","isFilterIcon","filterIconRect","isAutoFill","frozen","paneAt","containingPane","theGrid","refreshTools","totalHeight","_pane","_destroyFilterMenu","_filterMenu","FilterMenu","selectClipBoardContents","scrollIntoView","willScroll","scrollBoundaries","scrollBottom","_destroyDialog","dialog","dialogs","errorMessages","focusLastActive","_filterMenuColumn","renderResizeHint","renderClipboardContents","resizeHint","resizeHintVertical","resizeHintHandle","resizeHintMarker","selectionView","primaryMergedCells","secondaryMergedCells","rangeDimensions","mergedCell","vaxis","haxis","rowHeader","columnHeader","mergedCellsWrapper","selectionWrapper","autoFillWrapper","selectionHighlight","isVisible","paneClasses","_currentView","_currentRect","_selectedHeaders","renderData","renderSelection","renderAutoFill","renderEditorSelection","renderFilterHeaders","hasRowHeader","rowOffset","headerClassName","hasColumnHeader","columnOffset","renderResizeHandler","itemSelection","allHeaders","doLayout","forScreen","xCoords","yCoords","hb","BUTTON_SIZE","BUTTON_OFFSET","Rectangle","filtered","classes","_addDiv","selections","activeCellClasses","selectionClasses","activeFormulaColor","_activeFormulaColor","_directionClasses","_addTable","cssClass","autoFillRectangle","toDiv","activeFormulaSelection","colorClasses","cellClasses","mergedCellLeft","mergedCellTop","PaneGrid","sum","total","PaneAxis","rangeRef","headerSize","hasHeader","paneSegment","_viewSize","widthCompensation","heightCompensation","_hidden","scrollBarSize","overflow","pageSize","firstHidden","lastHidden","startOffset","startIndex","endOffset","endIndex","startSegment","endSegment","lastPage","_pixelValues","_axis","_start","quarter","sameYear","today","setFullYear","sameMonth","firstDayOfMonth","setMonth","sameWeek","firstWeek","secondWeek","dayOfWeek","constructor","_values","_dates","_blanks","blanks","dates","_logic","logic","criteria","_criteria","expression","Query","filterExpr","filters","_matches","criterionValue","criterionType","valueType","TopFilter","DynamicFilter","_predicate","_average","aboveAverage","belowAverage","tomorrow","addDays","isToday","yesterday","nextWeek","thisWeek","lastWeek","nextMonth","thisMonth","lastMonth","nextQuarter","thisQuarter","lastQuarter","nextYear","thisYear","lastYear","yearToDate","cultures","months","names","_lists","ascendingComparer","descendingComparer","li","typeA","typeB","localeCompare","addPlainText","sections","maybeColor","RX_COLORS","maybeCondition","RX_CONDITION","readFormat","sep","decimal","decimalPart","haveTimePart","am","pm","readSection","haveConditional","sec","printSection","printToken","padLeft","adjusted","restart","compileFormatPart","checkComma","scaleCount","hasDate","hasTime","hasAmpm","percentCount","separeThousands","declen","intFormat","decFormat","condition","preamble","CACHE","calendars","standard","days","namesAbbr","ampm","eltime","formatInt","numberFormat","iv","chf","toFixed","formatDec","span","textAndColor","_cosh","_sinh","_tanh","_gcd","_lcm","forIFS","chunks","matrix","parseCriteria","COL","_avg","numbers","_var_sp","divisor","avg","_stdev_sp","_percentrank","exc","nlt","ngt","found","_covariance","ax","ay","_percentile","rank","_percentile_inc","_percentile_exc","fetchValuesForAggregate","opt_ignore_hidden_rows","opt_ignore_errors","opt_use_aggregates","fetchValues","_binom_dist","cumulative","_combinations","weeksInYear","_days_360","d1","d2","numericPredicate","descending","ARGS_COUNTIFS","ARGS_SUMIFS","ARGS_SUMIF","ARGS_PERCENTRANK","_fact","AGGREGATE_FUNCS","RX_NON_PRINTABLE","cos","sin","atan","tan","mult","prod","coef","seen","m1","sumRange","nth","error","res","discard","bins","asc","variance","stddev","significance","fact","f1","f2","p1","p2","funcId","ignoreHidden","alpha","s2","approx","resultCol","cmp","resultRow","fw","sy","dow","wk","hh","mm","holidays","inc","random","rom","radix","minLen","dec","noCommas","newText","oldText","valueIfError","makeComparator","lc","compLT","compLTE","compGT","compGTE","compNE","compEQ","RXCACHE","ERF","S","an","f_abs","ERFC","GAMMALN","cof","ser","GAMMA","pi","BETALN","BETA","gamma_inc","g_series","g_contfrac","ap","gln","MAX_IT","EPS","FP_MIN","aj","bj","GAMMA_DIST","GAMMA_INV","M","ab","q","NORM_S_DIST","NORM_S_INV","plow","phigh","NORM_DIST","NORM_INV","betastd_pdf","betastd_cdf","beta_lentz","m2","del","qab","qap","qam","betastd_inv","BETADIST","BETA_DIST","cdf","BETA_INV","chisq_left","cds","chisq_right","chisq_left_inv","chisq_right_inv","chisq_test","obsv","expect","eij","expon","poisson","lnf","Fdist","Fdist_right","Finv_right","Finv","_mean","me","_var_sq","Ftest","arr1","arr2","n1","n2","va1","va2","fisher","fisherinv","e2","Tdist","Tdist_right","Tdist_2tail","Tdist_inv","Tdist_2tail_inv","Tdist_test","gr1","gr2","tail","t_st","df","md","v1","v2","u1","u2","q1","q2","confidence_t","confidence_norm","gauss","z","phi","lognorm_dist","lognorm_inv","prob","x_","p_","lw","slope","y_","mx","my","b1","b2","intercept","pearson","t1","t2","s1","s3","rsq","steyx","forecast","_mat_mean","Mat","_mat_devsq","mean","sq","linest","Y","X","konst","stats","Xt","B","line_1","Y1","y_y1","mp","SSreg","SSresid","line_5","R2","degfre","err_est","line_3","F_sta","line_4","SCP","line_2","logest","trend","W","growth","new_X","root_newton","guess","max_it","eps","f_d","FV","rate","nper","pmt","pv","h1","h2","PV","fv","PMT","NPER","RATE","xfd","IPMT","per","ipmt","PPMT","CUMPRINC","tn","ts","te","monthlyPayment","remainingBalanceAtStart","remainingBalanceAtEnd","CUMIPMT","cip","NPV","flows","npv","IRR","npv1","EFFECT","nominal_rate","npery","NOMINAL","effect_rate","XNPV","XIRR","ISPMT","DB","cost","salvage","life","period","db","DDB","factor","prior","dep","SLN","SYD","VDB","no_switch","_getGDA","gda","oldValue","interest","_interVDB","life1","term","remValue","intEnd","lia","vdb","nowLia","intStart","_edate","_daysBetween","basis","_borderCoupons","settlement","maturity","freq","sett","periods","_borderCoupons_fw","COUPDAYBS","frequency","COUPDAYS","settl","matur","COUPDAYSNC","COUPPCD","COUPNCD","COUPNUM","mat","ACCRINTM","issue","par","year_days","ACCRINT","_numCoupons","annual","brace","prev1","next1","nrc","accr","DISC","pr","redemption","INTRATE","investment","RECEIVED","discount","PRICE","yld","N","beg_settl","settl_end","beg_end","den","yf","PRICEDISC","dsm","COUPS_ARGS","ll","ac","BORDER_TYPES","BORDER_PALETTE_MESSAGES","ColorChooser","BorderPalette","borderPalette","customColor","cancel","_resetButton","_colorPalette","_customColorPalette","_customColorButton","resetButton","resetColor","customColorButton","colorPalette","flatColorPicker","_change","class","kendoColorPalette","palette","viewModel","kendoWindow","resizable","maximizable","modal","center","one","_hueSlider","kendoFlatColorPicker","observable","_borderTypePalette","_borderColorPalette","_click","colorChooser","buttons","_colorChange","currentTarget","ToolBar","MESSAGES","defaultTools","toolDefaults","SpreadsheetToolBar","DropDownTool","PopupTool","OverflowDialogButton","ColorPicker","ColorPickerButton","FONT_SIZES","DEFAULT_FONT_SIZE","FontSize","FontSizeButton","FONT_FAMILIES","DEFAULT_FONT_FAMILY","FontFamily","FontFamilyButton","defaultFormats","Format","FormatButton","BorderChangeTool","BorderChangeButton","AlignmentTool","AlignmentButton","MergeTool","MergeButton","FreezeTool","FreezeButton","Sort","SortButton","FilterButton","Open","alignment","alignmentButtons","justtifyLeft","justifyCenter","justifyRight","justifyFull","alignTop","alignMiddle","alignBottom","colorPicker","formatTypes","automatic","percent","financial","currency","dateTime","duration","moreFormats","formatDecreaseDecimal","formatIncreaseDecimal","freeze","freezeButtons","freezePanes","freezeRows","freezeColumns","mergeButtons","mergeCells","mergeHorizontally","mergeVertically","quickAccess","exportAs","sortAsc","sortDesc","sortButtons","sortSheetAsc","sortSheetDesc","sortRangeAsc","sortRangeDesc","textColor","textWrap","iconClass","dialogName","togglable","separator","formatCells","_expandTools","tools","toolbarName","handleClick","_addSeparators","click","groups","before","expandTool","toolName","isPlainObject","spriteCssClass","typeDefaults","splitButton","showText","toolIcon","tool","attributes","menuButtons","commandType","checked","setToggle","update","_tools","isFunction","toArray","_getItem","instance","Item","dropDownList","kendoDropDownList","addUidAttr","addOverflowAttr","_open","data-command","data-property","listWidth","ddl","_listWidth","sender","dataItem","popupName","kendoPopup","registerComponent","ToolBarButton","_dialogName","OverflowButton","iconName","comboBox","kendoComboBox","_valueChange","fontSizes","sizes","defaultSize","fontFamilies","defaultFont","_revertTitle","setOptions","dataValuePrimitive","valueTemplate","sample","_borderPalette","_action","_commandPalette","removeClass","_quickAccessButtons","quickAccessToolBar","toolbars","contentElements","_toolbar","buttonTemplate","insertBefore","tabGroup","formattedValue","uniqueBy","ObservableObject","registry","SpreadsheetDialog","FormatCellsViewModel","FormatCellsDialog","MessageDialog","FontFamilyDialog","FontSizeDialog","BordersDialog","ColorPickerDialog","CustomColorDialog","AlignmentDialog","MergeDialog","FreezeDialog","ValidationViewModel","ValidationDialog","ExportAsDialog","ModifyMergedDialog","UseKeyboardDialog","UnsupportedSelectionDialog","okText","formatCellsDialog","categories","fontFamilyDialog","fontSizeDialog","bordersDialog","alignmentDialog","mergeDialog","freezeDialog","validationDialog","hintMessage","hintTitle","any","comparers","comparerMessages","labels","onInvalidData","rejectInput","showWarning","showHint","ignoreBlank","placeholders","typeTitle","typeMessage","exportAsDialog","fit","saveAsType","exportArea","paperSize","margins","orientation","guidelines","modifyMergedDialog","errorMessage","useKeyboardDialog","forCopy","forCut","forPaste","unsupportedSelectionDialog","register","dialogClass","_dialog","_onDialogClose","_onDialogActivate","_onDialogDeactivate","useCategory","category","formatCurrency","currencies","allFormats","useFirstFormat","info","_currency","iso","convert","categoryFilter","repeat","pattern","abbr","_generateFormats","calendarPatterns","currenciesFrom","numberFormats","dateFormats","currencyFilter","roleSelector","description","_list","_colorPicker","ValidationCellsViewModel","criterion","setHintMessageTemplate","shouldBuild","buildMessages","hintTitleTemplate","hintMessageTemplate","setComparers","defaultHintTitle","text_comparers","defaultComparers","defaultHintMessage","isAny","showToForNumber","showTo","showToForDate","isDate","isText","isList","isCustom","showRemove","fromValidationObject","useCustomMessages","toValidationObject","errorTemplate","validatable","Validator","validateOnBlur","validate","fileFormats","author","subject","keywords","creator","fitWidth","areas","paperSizes","margin","landscape","hCenter","vCenter","_normalizeColumns","_dataSource","_header","_sheetChangeHandler","_sheetDeleteRowHandler","_sheetDeleteRow","_sheetInsertRowHandler","_sheetInsertRow","model","_skipRebind","record","valueIndex","colValueIndex","_changeHandler","getters","getter","getterIdx","distinctValues","query","itemVisible","anyVisibleChildren","hasVisibleChildren","HierarchicalDataSource","uncheckAll","hasChildren","flattenOperators","operators","FILTERMENU_MESSAGES","Details","templates","FilterMenuViewModel","FilterMenuController","details","detailsSummary","detailsContent","iconCollapse","iconExpand","iconSearch","textbox","filterByCondition","filterByValue","valuesTreeViewWrapper","actionButtons","_summary","_toggle","_icon","_container","fx","expand","sortAscending","sortDescending","search","addToCurrent","operatorNone","and","or","doesnotcontain","startswith","endswith","neq","gte","lte","binders","spreadsheetFilterValue","Binder","bindings","proxy","widget","binding","menuItem","valuesChange","valuesDataSource","lastIndexOf","appendToSearch","valueSelect","hasActiveSearch","filterValues","operatorChange","isNone","isString","valuesTree","filterType","topValue","filterForColumn","allFilters","columnFilters","_filterInit","_filterByCondition","_filterByValue","_actionButtons","valuesTreeView","_active","activeFilter","copyAnchorStyles","dir","kendoMenu","_appendTemplate","compiledTemplate","_detailToggle","not","isExpanded","activeContainer","hasClass","notEqual","oldRect","newRect","barInput","cellInput","_triggerUpdate","lastActive","activeElement","_rect","inputType","linearRegression","findSeries","findStep","forEachSeries","formatType","getType","lst","findStringList","stringLists","strl","MSG_INCOMPATIBLE","MSG_NO_DIRECTION","srcRange","src","srcIdx","destRange","distributeCoords","heights","pageHeight","curr","getMergedCells","primary","secondary","pageWidth","scaleFactor","boxWidth","boxHeight","rowHeights","colWidths","maxRow","maxCol","nonEmpty","relrow","relcol","emptyCells","orlast","normalOrder","drawLayout","addPage","page","endbottom","endright","Group","clip","Path","fromRect","geo","Rect","multiplyCopy","translate","transform","moveTo","lineTo","stroke","GUIDELINE_WIDTH","ncols","nrows","r2d2","drawText","vtrans","rect_left","rect_top","rect_width","rect_height","makeFontDef","lines","text_height","lineBreak","Text","htrans","eol","sub","paper","getPaperOptions","multiPage","geometry","NS","Spreadsheet","_controller","_autoRefresh","_bindWorkbookEvents","_resizeHandler","_workbookChange","autoRefresh","blob","_workbookExcelExport","_workbookExcelImport","_initProgress","loading","pb","kendoProgressBar","chunkCount","always","_workbookPdfExport","plugin"],"mappings":"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","file":"kendo.spreadsheet.min.js","sourcesContent":["/*!\n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n\n*/\n(function (f, define) {\n    define('util/undoredostack', ['kendo.core'], f);\n}(function () {\n    (function (kendo) {\n        var UndoRedoStack = kendo.Observable.extend({\n            init: function (options) {\n                kendo.Observable.fn.init.call(this, options);\n                this.clear();\n            },\n            events: [\n                'undo',\n                'redo'\n            ],\n            push: function (command) {\n                this.stack = this.stack.slice(0, this.currentCommandIndex + 1);\n                this.currentCommandIndex = this.stack.push(command) - 1;\n            },\n            undo: function () {\n                if (this.canUndo()) {\n                    var command = this.stack[this.currentCommandIndex--];\n                    command.undo();\n                    this.trigger('undo', { command: command });\n                }\n            },\n            redo: function () {\n                if (this.canRedo()) {\n                    var command = this.stack[++this.currentCommandIndex];\n                    command.redo();\n                    this.trigger('redo', { command: command });\n                }\n            },\n            clear: function () {\n                this.stack = [];\n                this.currentCommandIndex = -1;\n            },\n            canUndo: function () {\n                return this.currentCommandIndex >= 0;\n            },\n            canRedo: function () {\n                return this.currentCommandIndex != this.stack.length - 1;\n            }\n        });\n        kendo.deepExtend(kendo, { util: { UndoRedoStack: UndoRedoStack } });\n    }(kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('util/main', ['kendo.core'], f);\n}(function () {\n    (function () {\n        var math = Math, kendo = window.kendo, deepExtend = kendo.deepExtend;\n        var DEG_TO_RAD = math.PI / 180, MAX_NUM = Number.MAX_VALUE, MIN_NUM = -Number.MAX_VALUE, UNDEFINED = 'undefined';\n        function defined(value) {\n            return typeof value !== UNDEFINED;\n        }\n        function round(value, precision) {\n            var power = pow(precision);\n            return math.round(value * power) / power;\n        }\n        function pow(p) {\n            if (p) {\n                return math.pow(10, p);\n            } else {\n                return 1;\n            }\n        }\n        function limitValue(value, min, max) {\n            return math.max(math.min(value, max), min);\n        }\n        function rad(degrees) {\n            return degrees * DEG_TO_RAD;\n        }\n        function deg(radians) {\n            return radians / DEG_TO_RAD;\n        }\n        function isNumber(val) {\n            return typeof val === 'number' && !isNaN(val);\n        }\n        function valueOrDefault(value, defaultValue) {\n            return defined(value) ? value : defaultValue;\n        }\n        function sqr(value) {\n            return value * value;\n        }\n        function objectKey(object) {\n            var parts = [];\n            for (var key in object) {\n                parts.push(key + object[key]);\n            }\n            return parts.sort().join('');\n        }\n        function hashKey(str) {\n            var hash = 2166136261;\n            for (var i = 0; i < str.length; ++i) {\n                hash += (hash << 1) + (hash << 4) + (hash << 7) + (hash << 8) + (hash << 24);\n                hash ^= str.charCodeAt(i);\n            }\n            return hash >>> 0;\n        }\n        function hashObject(object) {\n            return hashKey(objectKey(object));\n        }\n        var now = Date.now;\n        if (!now) {\n            now = function () {\n                return new Date().getTime();\n            };\n        }\n        function arrayLimits(arr) {\n            var length = arr.length, i, min = MAX_NUM, max = MIN_NUM;\n            for (i = 0; i < length; i++) {\n                max = math.max(max, arr[i]);\n                min = math.min(min, arr[i]);\n            }\n            return {\n                min: min,\n                max: max\n            };\n        }\n        function arrayMin(arr) {\n            return arrayLimits(arr).min;\n        }\n        function arrayMax(arr) {\n            return arrayLimits(arr).max;\n        }\n        function sparseArrayMin(arr) {\n            return sparseArrayLimits(arr).min;\n        }\n        function sparseArrayMax(arr) {\n            return sparseArrayLimits(arr).max;\n        }\n        function sparseArrayLimits(arr) {\n            var min = MAX_NUM, max = MIN_NUM;\n            for (var i = 0, length = arr.length; i < length; i++) {\n                var n = arr[i];\n                if (n !== null && isFinite(n)) {\n                    min = math.min(min, n);\n                    max = math.max(max, n);\n                }\n            }\n            return {\n                min: min === MAX_NUM ? undefined : min,\n                max: max === MIN_NUM ? undefined : max\n            };\n        }\n        function last(array) {\n            if (array) {\n                return array[array.length - 1];\n            }\n        }\n        function append(first, second) {\n            first.push.apply(first, second);\n            return first;\n        }\n        function renderTemplate(text) {\n            return kendo.template(text, {\n                useWithBlock: false,\n                paramName: 'd'\n            });\n        }\n        function renderAttr(name, value) {\n            return defined(value) && value !== null ? ' ' + name + '=\\'' + value + '\\' ' : '';\n        }\n        function renderAllAttr(attrs) {\n            var output = '';\n            for (var i = 0; i < attrs.length; i++) {\n                output += renderAttr(attrs[i][0], attrs[i][1]);\n            }\n            return output;\n        }\n        function renderStyle(attrs) {\n            var output = '';\n            for (var i = 0; i < attrs.length; i++) {\n                var value = attrs[i][1];\n                if (defined(value)) {\n                    output += attrs[i][0] + ':' + value + ';';\n                }\n            }\n            if (output !== '') {\n                return output;\n            }\n        }\n        function renderSize(size) {\n            if (typeof size !== 'string') {\n                size += 'px';\n            }\n            return size;\n        }\n        function renderPos(pos) {\n            var result = [];\n            if (pos) {\n                var parts = kendo.toHyphens(pos).split('-');\n                for (var i = 0; i < parts.length; i++) {\n                    result.push('k-pos-' + parts[i]);\n                }\n            }\n            return result.join(' ');\n        }\n        function isTransparent(color) {\n            return color === '' || color === null || color === 'none' || color === 'transparent' || !defined(color);\n        }\n        function arabicToRoman(n) {\n            var literals = {\n                1: 'i',\n                10: 'x',\n                100: 'c',\n                2: 'ii',\n                20: 'xx',\n                200: 'cc',\n                3: 'iii',\n                30: 'xxx',\n                300: 'ccc',\n                4: 'iv',\n                40: 'xl',\n                400: 'cd',\n                5: 'v',\n                50: 'l',\n                500: 'd',\n                6: 'vi',\n                60: 'lx',\n                600: 'dc',\n                7: 'vii',\n                70: 'lxx',\n                700: 'dcc',\n                8: 'viii',\n                80: 'lxxx',\n                800: 'dccc',\n                9: 'ix',\n                90: 'xc',\n                900: 'cm',\n                1000: 'm'\n            };\n            var values = [\n                1000,\n                900,\n                800,\n                700,\n                600,\n                500,\n                400,\n                300,\n                200,\n                100,\n                90,\n                80,\n                70,\n                60,\n                50,\n                40,\n                30,\n                20,\n                10,\n                9,\n                8,\n                7,\n                6,\n                5,\n                4,\n                3,\n                2,\n                1\n            ];\n            var roman = '';\n            while (n > 0) {\n                if (n < values[0]) {\n                    values.shift();\n                } else {\n                    roman += literals[values[0]];\n                    n -= values[0];\n                }\n            }\n            return roman;\n        }\n        function romanToArabic(r) {\n            r = r.toLowerCase();\n            var digits = {\n                i: 1,\n                v: 5,\n                x: 10,\n                l: 50,\n                c: 100,\n                d: 500,\n                m: 1000\n            };\n            var value = 0, prev = 0;\n            for (var i = 0; i < r.length; ++i) {\n                var v = digits[r.charAt(i)];\n                if (!v) {\n                    return null;\n                }\n                value += v;\n                if (v > prev) {\n                    value -= 2 * prev;\n                }\n                prev = v;\n            }\n            return value;\n        }\n        function memoize(f) {\n            var cache = Object.create(null);\n            return function () {\n                var id = '';\n                for (var i = arguments.length; --i >= 0;) {\n                    id += ':' + arguments[i];\n                }\n                if (id in cache) {\n                    return cache[id];\n                }\n                return f.apply(this, arguments);\n            };\n        }\n        function ucs2decode(string) {\n            var output = [], counter = 0, length = string.length, value, extra;\n            while (counter < length) {\n                value = string.charCodeAt(counter++);\n                if (value >= 55296 && value <= 56319 && counter < length) {\n                    extra = string.charCodeAt(counter++);\n                    if ((extra & 64512) == 56320) {\n                        output.push(((value & 1023) << 10) + (extra & 1023) + 65536);\n                    } else {\n                        output.push(value);\n                        counter--;\n                    }\n                } else {\n                    output.push(value);\n                }\n            }\n            return output;\n        }\n        function ucs2encode(array) {\n            return array.map(function (value) {\n                var output = '';\n                if (value > 65535) {\n                    value -= 65536;\n                    output += String.fromCharCode(value >>> 10 & 1023 | 55296);\n                    value = 56320 | value & 1023;\n                }\n                output += String.fromCharCode(value);\n                return output;\n            }).join('');\n        }\n        deepExtend(kendo, {\n            util: {\n                MAX_NUM: MAX_NUM,\n                MIN_NUM: MIN_NUM,\n                append: append,\n                arrayLimits: arrayLimits,\n                arrayMin: arrayMin,\n                arrayMax: arrayMax,\n                defined: defined,\n                deg: deg,\n                hashKey: hashKey,\n                hashObject: hashObject,\n                isNumber: isNumber,\n                isTransparent: isTransparent,\n                last: last,\n                limitValue: limitValue,\n                now: now,\n                objectKey: objectKey,\n                round: round,\n                rad: rad,\n                renderAttr: renderAttr,\n                renderAllAttr: renderAllAttr,\n                renderPos: renderPos,\n                renderSize: renderSize,\n                renderStyle: renderStyle,\n                renderTemplate: renderTemplate,\n                sparseArrayLimits: sparseArrayLimits,\n                sparseArrayMin: sparseArrayMin,\n                sparseArrayMax: sparseArrayMax,\n                sqr: sqr,\n                valueOrDefault: valueOrDefault,\n                romanToArabic: romanToArabic,\n                arabicToRoman: arabicToRoman,\n                memoize: memoize,\n                ucs2encode: ucs2encode,\n                ucs2decode: ucs2decode\n            }\n        });\n        kendo.drawing.util = kendo.util;\n        kendo.dataviz.util = kendo.util;\n    }());\n    return window.kendo;\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('util/text-metrics', [\n        'kendo.core',\n        'util/main'\n    ], f);\n}(function () {\n    (function ($) {\n        var doc = document, kendo = window.kendo, Class = kendo.Class, util = kendo.util, defined = util.defined;\n        var LRUCache = Class.extend({\n            init: function (size) {\n                this._size = size;\n                this._length = 0;\n                this._map = {};\n            },\n            put: function (key, value) {\n                var lru = this, map = lru._map, entry = {\n                        key: key,\n                        value: value\n                    };\n                map[key] = entry;\n                if (!lru._head) {\n                    lru._head = lru._tail = entry;\n                } else {\n                    lru._tail.newer = entry;\n                    entry.older = lru._tail;\n                    lru._tail = entry;\n                }\n                if (lru._length >= lru._size) {\n                    map[lru._head.key] = null;\n                    lru._head = lru._head.newer;\n                    lru._head.older = null;\n                } else {\n                    lru._length++;\n                }\n            },\n            get: function (key) {\n                var lru = this, entry = lru._map[key];\n                if (entry) {\n                    if (entry === lru._head && entry !== lru._tail) {\n                        lru._head = entry.newer;\n                        lru._head.older = null;\n                    }\n                    if (entry !== lru._tail) {\n                        if (entry.older) {\n                            entry.older.newer = entry.newer;\n                            entry.newer.older = entry.older;\n                        }\n                        entry.older = lru._tail;\n                        entry.newer = null;\n                        lru._tail.newer = entry;\n                        lru._tail = entry;\n                    }\n                    return entry.value;\n                }\n            }\n        });\n        var defaultMeasureBox = $('<div style=\\'position: absolute !important; top: -4000px !important; width: auto !important; height: auto !important;' + 'padding: 0 !important; margin: 0 !important; border: 0 !important;' + 'line-height: normal !important; visibility: hidden !important; white-space: nowrap!important;\\' />')[0];\n        var TextMetrics = Class.extend({\n            init: function (options) {\n                this._cache = new LRUCache(1000);\n                this._initOptions(options);\n            },\n            options: { baselineMarkerSize: 1 },\n            measure: function (text, style, box) {\n                var styleKey = util.objectKey(style), cacheKey = util.hashKey(text + styleKey), cachedResult = this._cache.get(cacheKey);\n                if (cachedResult) {\n                    return cachedResult;\n                }\n                var size = {\n                    width: 0,\n                    height: 0,\n                    baseline: 0\n                };\n                var measureBox = box ? box : defaultMeasureBox;\n                var baselineMarker = this._baselineMarker().cloneNode(false);\n                for (var key in style) {\n                    var value = style[key];\n                    if (defined(value)) {\n                        measureBox.style[key] = value;\n                    }\n                }\n                $(measureBox).text(text);\n                measureBox.appendChild(baselineMarker);\n                doc.body.appendChild(measureBox);\n                if ((text + '').length) {\n                    size.width = measureBox.offsetWidth - this.options.baselineMarkerSize;\n                    size.height = measureBox.offsetHeight;\n                    size.baseline = baselineMarker.offsetTop + this.options.baselineMarkerSize;\n                }\n                if (size.width > 0 && size.height > 0) {\n                    this._cache.put(cacheKey, size);\n                }\n                measureBox.parentNode.removeChild(measureBox);\n                return size;\n            },\n            _baselineMarker: function () {\n                return $('<div class=\\'k-baseline-marker\\' ' + 'style=\\'display: inline-block; vertical-align: baseline;' + 'width: ' + this.options.baselineMarkerSize + 'px; height: ' + this.options.baselineMarkerSize + 'px;' + 'overflow: hidden;\\' />')[0];\n            }\n        });\n        TextMetrics.current = new TextMetrics();\n        function measureText(text, style, measureBox) {\n            return TextMetrics.current.measure(text, style, measureBox);\n        }\n        kendo.util.TextMetrics = TextMetrics;\n        kendo.util.LRUCache = LRUCache;\n        kendo.util.measureText = measureText;\n    }(window.kendo.jQuery));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('util/parse-xml', [\n        'kendo.core',\n        'util/main'\n    ], f);\n}(function () {\n    'use strict';\n    var STRING = String.fromCharCode;\n    var ENTITIES = {\n        'amp': 38,\n        'lt': 60,\n        'gt': 62,\n        'quot': 34,\n        'nbsp': 160\n    };\n    function CODE(str) {\n        var out = [];\n        for (var i = 0; i < str.length; ++i) {\n            out.push(str.charCodeAt(i));\n        }\n        return out;\n    }\n    function UCS2(out, code) {\n        if (code > 65535) {\n            code -= 65536;\n            out.push(code >>> 10 & 1023 | 55296, 56320 | code & 1023);\n        } else {\n            out.push(code);\n        }\n    }\n    var START_CDATA = CODE('<![CDATA[');\n    var END_CDATA = CODE(']]>');\n    var END_COMMENT = CODE('-->');\n    var START_COMMENT = CODE('!--');\n    var END_SHORT_TAG = CODE('/>');\n    var END_TAG = CODE('</');\n    var END_DECLARATION = CODE('?>');\n    var QUESTION_MARK = CODE('?');\n    var LESS_THAN = CODE('<');\n    var GREATER_THAN = CODE('>');\n    var SEMICOLON = CODE(';');\n    var EQUAL = CODE('=');\n    var AMPERSAND = CODE('&');\n    var QUOTE = CODE('\"');\n    var APOSTROPHE = CODE('\\'');\n    var SHARP = CODE('#');\n    var LOWERCASE_X = CODE('x');\n    var UPPERCASE_X = CODE('X');\n    var EXIT = {};\n    function parse(data, callbacks) {\n        var index = 0;\n        var stack = [];\n        var object = {\n            is: function (selector) {\n                var i = stack.length, j = selector.length;\n                while (--i >= 0 && --j >= 0) {\n                    if (stack[i].$tag != selector[j] && selector[j] != '*') {\n                        return false;\n                    }\n                }\n                return j < 0 ? stack[stack.length - 1] : null;\n            },\n            exit: function () {\n                throw EXIT;\n            },\n            stack: stack\n        };\n        function readChar(body) {\n            var code = data[index++];\n            if (!(code & 240 ^ 240)) {\n                UCS2(body, (code & 3) << 18 | (data[index++] & 63) << 12 | (data[index++] & 63) << 6 | data[index++] & 63);\n            } else if (!(code & 224 ^ 224)) {\n                UCS2(body, (code & 15) << 12 | (data[index++] & 63) << 6 | data[index++] & 63);\n            } else if (!(code & 192 ^ 192)) {\n                UCS2(body, (code & 31) << 6 | data[index++] & 63);\n            } else {\n                body.push(code);\n            }\n        }\n        function croak(msg) {\n            throw new Error(msg + ', at ' + index);\n        }\n        function readWhile(pred) {\n            var a = [];\n            while (index < data.length && pred(data[index])) {\n                a.push(data[index++]);\n            }\n            return a;\n        }\n        function readAsciiWhile(pred) {\n            return STRING.apply(0, readWhile(pred));\n        }\n        function skipWhitespace() {\n            readWhile(isWhitespace);\n        }\n        function eat(a) {\n            var save = index;\n            for (var i = 0; i < a.length; ++i) {\n                if (data[index++] != a[i]) {\n                    index = save;\n                    return false;\n                }\n            }\n            return a;\n        }\n        function skip(code) {\n            if (!eat(code)) {\n                croak('Expecting ' + code.join(', '));\n            }\n        }\n        function isWhitespace(code) {\n            return code == 9 || code == 10 || code == 13 || code == 32;\n        }\n        function isDigit(code) {\n            return code >= 48 && code <= 57;\n        }\n        function isHexDigit(code) {\n            return code >= 48 && code <= 57 || (code |= 32) >= 97 && code <= 102;\n        }\n        function isNameStart(code) {\n            return code == 58 || code == 95 || (code |= 32) >= 97 && code <= 122;\n        }\n        function isName(code) {\n            return code == 45 || isDigit(code) || isNameStart(code);\n        }\n        function xmlComment() {\n            var body = [];\n            while (index < data.length) {\n                if (eat(END_COMMENT)) {\n                    return call('comment', STRING.apply(0, body));\n                }\n                readChar(body);\n            }\n        }\n        function xmlTag() {\n            var name, attrs;\n            if (eat(QUESTION_MARK)) {\n                xmlDecl();\n            } else if (eat(START_COMMENT)) {\n                xmlComment();\n            } else {\n                name = xmlName();\n                attrs = xmlAttrs(name);\n                stack.push(attrs);\n                if (eat(END_SHORT_TAG)) {\n                    call('enter', name, attrs, true);\n                } else {\n                    skip(GREATER_THAN);\n                    call('enter', name, attrs);\n                    xmlContent(name);\n                    if (name != xmlName()) {\n                        croak('Bad closing tag');\n                    }\n                    call('leave', name, attrs);\n                    skipWhitespace();\n                    skip(GREATER_THAN);\n                }\n                stack.pop();\n            }\n        }\n        function xmlContent(name) {\n            var body = [];\n            while (index < data.length) {\n                if (eat(END_TAG)) {\n                    return body.length && call('text', STRING.apply(0, body));\n                } else if (eat(START_CDATA)) {\n                    while (index < data.length && !eat(END_CDATA)) {\n                        readChar(body);\n                    }\n                } else if (eat(LESS_THAN)) {\n                    if (body.length) {\n                        call('text', STRING.apply(0, body));\n                    }\n                    xmlTag();\n                    body = [];\n                } else if (eat(AMPERSAND)) {\n                    xmlEntity(body);\n                } else {\n                    readChar(body);\n                }\n            }\n            croak('Unclosed tag ' + name);\n        }\n        function xmlName() {\n            if (!isNameStart(data[index])) {\n                croak('Expecting XML name');\n            }\n            return readAsciiWhile(isName);\n        }\n        function xmlString() {\n            var quote = eat(QUOTE) || eat(APOSTROPHE);\n            if (!quote) {\n                croak('Expecting string');\n            }\n            var body = [];\n            while (index < data.length) {\n                if (eat(quote)) {\n                    return STRING.apply(0, body);\n                } else if (eat(AMPERSAND)) {\n                    xmlEntity(body);\n                } else {\n                    readChar(body);\n                }\n            }\n            croak('Unfinished string');\n        }\n        function xmlEntity(body) {\n            var code;\n            if (eat(SHARP)) {\n                if (eat(LOWERCASE_X) || eat(UPPERCASE_X)) {\n                    code = parseInt(readAsciiWhile(isHexDigit), 16);\n                } else {\n                    code = parseInt(readAsciiWhile(isDigit), 10);\n                }\n                if (isNaN(code)) {\n                    croak('Bad numeric entity');\n                }\n            } else {\n                var name = xmlName();\n                code = ENTITIES[name];\n                if (code === undefined) {\n                    croak('Unknown entity ' + name);\n                }\n            }\n            UCS2(body, code);\n            skip(SEMICOLON);\n        }\n        function xmlDecl() {\n            call('decl', xmlName(), xmlAttrs());\n            skip(END_DECLARATION);\n        }\n        function xmlAttrs(name) {\n            var map = { $tag: name };\n            while (index < data.length) {\n                skipWhitespace();\n                var code = data[index];\n                if (code == 63 || code == 62 || code == 47) {\n                    break;\n                }\n                map[xmlName()] = (skip(EQUAL), xmlString());\n            }\n            return map;\n        }\n        function call(what, thing, arg1, arg2) {\n            var f = callbacks && callbacks[what];\n            if (f) {\n                f.call(object, thing, arg1, arg2);\n            }\n        }\n        while (index < data.length) {\n            skipWhitespace();\n            skip(LESS_THAN);\n            xmlTag();\n            skipWhitespace();\n        }\n    }\n    kendo.util.parseXML = function parseXML() {\n        try {\n            return parse.apply(this, arguments);\n        } catch (ex) {\n            if (ex !== EXIT) {\n                throw ex;\n            }\n        }\n    };\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('util/base64', ['util/main'], f);\n}(function () {\n    (function () {\n        var kendo = window.kendo, deepExtend = kendo.deepExtend, fromCharCode = String.fromCharCode;\n        var KEY_STR = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=';\n        function encodeBase64(input) {\n            var output = '';\n            var chr1, chr2, chr3, enc1, enc2, enc3, enc4;\n            var i = 0;\n            input = encodeUTF8(input);\n            while (i < input.length) {\n                chr1 = input.charCodeAt(i++);\n                chr2 = input.charCodeAt(i++);\n                chr3 = input.charCodeAt(i++);\n                enc1 = chr1 >> 2;\n                enc2 = (chr1 & 3) << 4 | chr2 >> 4;\n                enc3 = (chr2 & 15) << 2 | chr3 >> 6;\n                enc4 = chr3 & 63;\n                if (isNaN(chr2)) {\n                    enc3 = enc4 = 64;\n                } else if (isNaN(chr3)) {\n                    enc4 = 64;\n                }\n                output = output + KEY_STR.charAt(enc1) + KEY_STR.charAt(enc2) + KEY_STR.charAt(enc3) + KEY_STR.charAt(enc4);\n            }\n            return output;\n        }\n        function encodeUTF8(input) {\n            var output = '';\n            for (var i = 0; i < input.length; i++) {\n                var c = input.charCodeAt(i);\n                if (c < 128) {\n                    output += fromCharCode(c);\n                } else if (c < 2048) {\n                    output += fromCharCode(192 | c >>> 6);\n                    output += fromCharCode(128 | c & 63);\n                } else if (c < 65536) {\n                    output += fromCharCode(224 | c >>> 12);\n                    output += fromCharCode(128 | c >>> 6 & 63);\n                    output += fromCharCode(128 | c & 63);\n                }\n            }\n            return output;\n        }\n        deepExtend(kendo.util, {\n            encodeBase64: encodeBase64,\n            encodeUTF8: encodeUTF8\n        });\n    }());\n    return window.kendo;\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('mixins/observers', ['kendo.core'], f);\n}(function () {\n    (function ($) {\n        var math = Math, kendo = window.kendo, deepExtend = kendo.deepExtend, inArray = $.inArray;\n        var ObserversMixin = {\n            observers: function () {\n                this._observers = this._observers || [];\n                return this._observers;\n            },\n            addObserver: function (element) {\n                if (!this._observers) {\n                    this._observers = [element];\n                } else {\n                    this._observers.push(element);\n                }\n                return this;\n            },\n            removeObserver: function (element) {\n                var observers = this.observers();\n                var index = inArray(element, observers);\n                if (index != -1) {\n                    observers.splice(index, 1);\n                }\n                return this;\n            },\n            trigger: function (methodName, event) {\n                var observers = this._observers;\n                var observer;\n                var idx;\n                if (observers && !this._suspended) {\n                    for (idx = 0; idx < observers.length; idx++) {\n                        observer = observers[idx];\n                        if (observer[methodName]) {\n                            observer[methodName](event);\n                        }\n                    }\n                }\n                return this;\n            },\n            optionsChange: function (e) {\n                this.trigger('optionsChange', e);\n            },\n            geometryChange: function (e) {\n                this.trigger('geometryChange', e);\n            },\n            suspend: function () {\n                this._suspended = (this._suspended || 0) + 1;\n                return this;\n            },\n            resume: function () {\n                this._suspended = math.max((this._suspended || 0) - 1, 0);\n                return this;\n            },\n            _observerField: function (field, value) {\n                if (this[field]) {\n                    this[field].removeObserver(this);\n                }\n                this[field] = value;\n                value.addObserver(this);\n            }\n        };\n        deepExtend(kendo, { mixins: { ObserversMixin: ObserversMixin } });\n    }(window.kendo.jQuery));\n    return window.kendo;\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/commands', [\n        'kendo.core',\n        'kendo.binder',\n        'kendo.window',\n        'kendo.list',\n        'kendo.tabstrip'\n    ], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var $ = kendo.jQuery;\n        var Command = kendo.spreadsheet.Command = kendo.Class.extend({\n            init: function (options) {\n                this.options = options;\n                this._workbook = options.workbook;\n                this._property = options && options.property;\n                this._state = {};\n            },\n            range: function (range) {\n                if (range !== undefined) {\n                    this._range = range;\n                }\n                return this._range;\n            },\n            redo: function () {\n                this.exec();\n            },\n            undo: function () {\n                this.range().setState(this._state);\n            },\n            getState: function () {\n                this._state = this.range().getState(this._property);\n            },\n            _forEachCell: function (callback) {\n                var range = this.range();\n                var ref = range._ref;\n                ref.forEach(function (ref) {\n                    range.sheet().forEach(ref.toRangeRef(), callback.bind(this));\n                }.bind(this));\n            }\n        });\n        var PropertyChangeCommand = kendo.spreadsheet.PropertyChangeCommand = Command.extend({\n            init: function (options) {\n                Command.fn.init.call(this, options);\n                this._value = options.value;\n            },\n            exec: function () {\n                var range = this.range();\n                this.getState();\n                range[this._property](this._value);\n            }\n        });\n        kendo.spreadsheet.ClearContentCommand = Command.extend({\n            exec: function () {\n                this.getState();\n                this.range().clearContent();\n            }\n        });\n        kendo.spreadsheet.EditCommand = PropertyChangeCommand.extend({\n            init: function (options) {\n                options.property = 'input';\n                PropertyChangeCommand.fn.init.call(this, options);\n            },\n            rejectState: function (validationState) {\n                this.undo();\n                return {\n                    title: validationState.title,\n                    body: validationState.message,\n                    reason: 'error',\n                    type: 'validationError'\n                };\n            },\n            exec: function () {\n                var range = this.range();\n                var value = this._value;\n                this.getState();\n                try {\n                    range.input(value);\n                    var validationState = range._getValidationState();\n                    if (validationState) {\n                        return this.rejectState(validationState);\n                    }\n                } catch (ex1) {\n                    if (ex1 instanceof kendo.spreadsheet.calc.ParseError) {\n                        try {\n                            range.input(value + ')');\n                            var validationState = range._getValidationState();\n                            if (validationState) {\n                                return this.rejectState(validationState);\n                            }\n                        } catch (ex2) {\n                            if (ex2 instanceof kendo.spreadsheet.calc.ParseError) {\n                                range.input('\\'' + value);\n                                return {\n                                    title: 'Error in formula',\n                                    body: ex1 + '',\n                                    reason: 'error'\n                                };\n                            }\n                        }\n                    } else {\n                        throw ex1;\n                    }\n                }\n            }\n        });\n        kendo.spreadsheet.TextWrapCommand = PropertyChangeCommand.extend({\n            init: function (options) {\n                options.property = 'wrap';\n                PropertyChangeCommand.fn.init.call(this, options);\n                this._value = options.value;\n            },\n            getState: function () {\n                var rowHeight = {};\n                this.range().forEachRow(function (range) {\n                    var index = range.topLeft().row;\n                    rowHeight[index] = range.sheet().rowHeight(index);\n                });\n                this._state = this.range().getState(this._property);\n                this._rowHeight = rowHeight;\n            },\n            undo: function () {\n                var sheet = this.range().sheet();\n                var rowHeight = this._rowHeight;\n                this.range().setState(this._state);\n                for (var row in rowHeight) {\n                    sheet.rowHeight(row, rowHeight[row]);\n                }\n            }\n        });\n        kendo.spreadsheet.AdjustDecimalsCommand = Command.extend({\n            init: function (options) {\n                this._decimals = options.value;\n                options.property = 'format';\n                Command.fn.init.call(this, options);\n            },\n            exec: function () {\n                var sheet = this.range().sheet();\n                var decimals = this._decimals;\n                var formatting = kendo.spreadsheet.formatting;\n                this.getState();\n                sheet.batch(function () {\n                    this.range().forEachCell(function (row, col, cell) {\n                        var format = cell.format;\n                        if (format || decimals > 0) {\n                            format = formatting.adjustDecimals(format || '#', decimals);\n                            sheet.range(row, col).format(format);\n                        }\n                    });\n                }.bind(this));\n            }\n        });\n        kendo.spreadsheet.BorderChangeCommand = Command.extend({\n            init: function (options) {\n                options.property = 'border';\n                Command.fn.init.call(this, options);\n                this._type = options.border;\n                this._style = options.style;\n            },\n            exec: function () {\n                this.getState();\n                this[this._type](this._style);\n            },\n            noBorders: function () {\n                var range = this.range();\n                range.sheet().batch(function () {\n                    range.borderLeft(null).borderTop(null).borderRight(null).borderBottom(null);\n                }.bind(this), {});\n            },\n            allBorders: function (style) {\n                var range = this.range();\n                range.sheet().batch(function () {\n                    range.borderLeft(style).borderTop(style).borderRight(style).borderBottom(style);\n                }.bind(this), {});\n            },\n            leftBorder: function (style) {\n                this.range().leftColumn().borderLeft(style);\n            },\n            rightBorder: function (style) {\n                this.range().rightColumn().borderRight(style);\n            },\n            topBorder: function (style) {\n                this.range().topRow().borderTop(style);\n            },\n            bottomBorder: function (style) {\n                this.range().bottomRow().borderBottom(style);\n            },\n            outsideBorders: function (style) {\n                var range = this.range();\n                range.sheet().batch(function () {\n                    range.leftColumn().borderLeft(style);\n                    range.topRow().borderTop(style);\n                    range.rightColumn().borderRight(style);\n                    range.bottomRow().borderBottom(style);\n                }.bind(this), {});\n            },\n            insideBorders: function (style) {\n                this.range().sheet().batch(function () {\n                    this.allBorders(style);\n                    this.outsideBorders(null);\n                }.bind(this), {});\n            },\n            insideHorizontalBorders: function (style) {\n                var range = this.range();\n                range.sheet().batch(function () {\n                    range.borderBottom(style);\n                    range.bottomRow().borderBottom(null);\n                }.bind(this), {});\n            },\n            insideVerticalBorders: function (style) {\n                var range = this.range();\n                range.sheet().batch(function () {\n                    range.borderRight(style);\n                    range.rightColumn().borderRight(null);\n                }.bind(this), {});\n            }\n        });\n        kendo.spreadsheet.MergeCellCommand = Command.extend({\n            init: function (options) {\n                Command.fn.init.call(this, options);\n                this._type = options.value;\n            },\n            exec: function () {\n                this.getState();\n                this[this._type]();\n            },\n            activate: function (ref) {\n                this.range().sheet().activeCell(ref);\n            },\n            getState: function () {\n                this._state = this.range().getState();\n            },\n            undo: function () {\n                if (this._type !== 'unmerge') {\n                    this.range().unmerge();\n                    this.activate(this.range().topLeft());\n                }\n                this.range().setState(this._state);\n            },\n            cells: function () {\n                var range = this.range();\n                var ref = range._ref;\n                range.merge();\n                this.activate(ref);\n            },\n            horizontally: function () {\n                var ref = this.range().topRow()._ref;\n                this.range().forEachRow(function (range) {\n                    range.merge();\n                });\n                this.activate(ref);\n            },\n            vertically: function () {\n                var ref = this.range().leftColumn()._ref;\n                this.range().forEachColumn(function (range) {\n                    range.merge();\n                });\n                this.activate(ref);\n            },\n            unmerge: function () {\n                var range = this.range();\n                var ref = range._ref.topLeft;\n                range.unmerge();\n                this.activate(ref);\n            }\n        });\n        kendo.spreadsheet.FreezePanesCommand = Command.extend({\n            init: function (options) {\n                Command.fn.init.call(this, options);\n                this._type = options.value;\n            },\n            exec: function () {\n                this.getState();\n                this._topLeft = this.range().topLeft();\n                this[this._type]();\n            },\n            getState: function () {\n                this._state = this.range().sheet().getState();\n            },\n            undo: function () {\n                this.range().sheet().setState(this._state);\n            },\n            panes: function () {\n                var topLeft = this._topLeft;\n                var sheet = this.range().sheet();\n                sheet.frozenColumns(topLeft.col).frozenRows(topLeft.row);\n            },\n            rows: function () {\n                var topLeft = this._topLeft;\n                var sheet = this.range().sheet();\n                sheet.frozenRows(topLeft.row);\n            },\n            columns: function () {\n                var topLeft = this._topLeft;\n                var sheet = this.range().sheet();\n                sheet.frozenColumns(topLeft.col);\n            },\n            unfreeze: function () {\n                var sheet = this.range().sheet();\n                sheet.frozenRows(0).frozenColumns(0);\n            }\n        });\n        kendo.spreadsheet.PasteCommand = Command.extend({\n            init: function (options) {\n                Command.fn.init.call(this, options);\n                this._clipboard = this._workbook.clipboard();\n            },\n            getState: function () {\n                this._range = this._workbook.activeSheet().range(this._clipboard.pasteRef());\n                this._state = this._range.getState();\n            },\n            exec: function () {\n                var status = this._clipboard.canPaste();\n                this._clipboard.menuInvoked = true;\n                if (!status.canPaste) {\n                    if (status.menuInvoked) {\n                        return { reason: 'useKeyboard' };\n                    }\n                    if (status.pasteOnMerged) {\n                        return { reason: 'modifyMerged' };\n                    }\n                    return;\n                }\n                this.getState();\n                this._clipboard.paste();\n                var range = this._workbook.activeSheet().range(this._clipboard.pasteRef());\n                range._adjustRowHeight();\n            }\n        });\n        kendo.spreadsheet.AdjustRowHeightCommand = Command.extend({\n            exec: function () {\n                var options = this.options;\n                var sheet = this._workbook.activeSheet();\n                var range = options.range || sheet.range(options.rowIndex);\n                range._adjustRowHeight();\n            }\n        });\n        kendo.spreadsheet.ToolbarPasteCommand = Command.extend({\n            exec: function () {\n                if (kendo.support.clipboard.paste) {\n                    this._workbook._view.clipboard.focus().select();\n                    document.execCommand('paste');\n                } else {\n                    return { reason: 'useKeyboard' };\n                }\n            }\n        });\n        kendo.spreadsheet.CopyCommand = Command.extend({\n            init: function (options) {\n                Command.fn.init.call(this, options);\n                this._clipboard = options.workbook.clipboard();\n            },\n            undo: $.noop,\n            exec: function () {\n                var status = this._clipboard.canCopy();\n                this._clipboard.menuInvoked = true;\n                if (!status.canCopy) {\n                    if (status.menuInvoked) {\n                        return { reason: 'useKeyboard' };\n                    } else if (status.multiSelection) {\n                        return { reason: 'unsupportedSelection' };\n                    }\n                    return;\n                }\n                this._clipboard.copy();\n            }\n        });\n        kendo.spreadsheet.ToolbarCopyCommand = Command.extend({\n            init: function (options) {\n                Command.fn.init.call(this, options);\n                this._clipboard = options.workbook.clipboard();\n            },\n            undo: $.noop,\n            exec: function () {\n                if (kendo.support.clipboard.copy) {\n                    var clipboard = this._workbook._view.clipboard;\n                    var textarea = document.createElement('textarea');\n                    $(textarea).addClass('k-spreadsheet-clipboard').val(clipboard.html()).appendTo(document.body).focus().select();\n                    document.execCommand('copy');\n                    clipboard.trigger('copy');\n                    $(textarea).remove();\n                } else {\n                    return { reason: 'useKeyboard' };\n                }\n            }\n        });\n        kendo.spreadsheet.CutCommand = Command.extend({\n            init: function (options) {\n                Command.fn.init.call(this, options);\n                this._clipboard = options.workbook.clipboard();\n            },\n            exec: function () {\n                if (this._clipboard.canCopy()) {\n                    this.getState();\n                    this._clipboard.cut();\n                }\n            }\n        });\n        kendo.spreadsheet.AutoFillCommand = Command.extend({\n            init: function (options) {\n                Command.fn.init.call(this, options);\n            },\n            origin: function (origin) {\n                this._origin = origin;\n            },\n            exec: function () {\n                this.getState();\n                this.range().fillFrom(this._origin);\n            }\n        });\n        kendo.spreadsheet.ToolbarCutCommand = Command.extend({\n            init: function (options) {\n                Command.fn.init.call(this, options);\n                this._clipboard = options.workbook.clipboard();\n            },\n            exec: function () {\n                if (kendo.support.clipboard.copy) {\n                    var clipboard = this._workbook._view.clipboard;\n                    var textarea = document.createElement('textarea');\n                    $(textarea).val(clipboard.html()).appendTo(document.body).focus().select();\n                    document.execCommand('copy');\n                    clipboard.trigger('cut');\n                    $(textarea).remove();\n                } else {\n                    return { reason: 'useKeyboard' };\n                }\n            }\n        });\n        kendo.spreadsheet.FilterCommand = Command.extend({\n            undo: function () {\n                this.range().filter(this._state);\n            },\n            exec: function () {\n                var range = this.range();\n                this._state = range.hasFilter();\n                if (range.hasFilter()) {\n                    range.filter(false);\n                } else if (!range.intersectingMerged().length) {\n                    range.filter(true);\n                } else {\n                    return {\n                        reason: 'error',\n                        type: 'filterRangeContainingMerges'\n                    };\n                }\n            }\n        });\n        kendo.spreadsheet.SortCommand = Command.extend({\n            undo: function () {\n                var sheet = this.range().sheet();\n                sheet.setState(this._state);\n            },\n            exec: function () {\n                var range = this.range();\n                var sheet = range.sheet();\n                var activeCell = sheet.activeCell();\n                var col = this.options.sheet ? activeCell.topLeft.col : this.options.column || 0;\n                var ascending = this.options.value === 'asc' ? true : false;\n                this._state = sheet.getState();\n                if (this.options.sheet) {\n                    range = this.expandRange();\n                }\n                if (!range.intersectingMerged().length) {\n                    range.sort({\n                        column: col,\n                        ascending: ascending\n                    });\n                } else {\n                    return {\n                        reason: 'error',\n                        type: 'sortRangeContainingMerges'\n                    };\n                }\n            },\n            expandRange: function () {\n                var sheet = this.range().sheet();\n                return new kendo.spreadsheet.Range(sheet._sheetRef, sheet);\n            }\n        });\n        var ApplyFilterCommand = kendo.spreadsheet.ApplyFilterCommand = Command.extend({\n            column: function () {\n                return this.options.column || 0;\n            },\n            undo: function () {\n                var sheet = this.range().sheet();\n                sheet.clearFilter(this.column());\n                if (this._state.length) {\n                    this.range().filter(this._state);\n                }\n            },\n            getState: function () {\n                var sheet = this.range().sheet();\n                var current = sheet.filter();\n                if (current) {\n                    this._state = current.columns.filter(function (c) {\n                        return c.index == this.column();\n                    }.bind(this));\n                }\n            },\n            exec: function () {\n                var range = this.range();\n                var column = this.column();\n                var current = range.sheet().filter();\n                var options;\n                var filterRule;\n                var exists = false;\n                if (this.options.valueFilter) {\n                    filterRule = {\n                        column: column,\n                        filter: new kendo.spreadsheet.ValueFilter(this.options.valueFilter)\n                    };\n                } else if (this.options.customFilter) {\n                    filterRule = {\n                        column: column,\n                        filter: new kendo.spreadsheet.CustomFilter(this.options.customFilter)\n                    };\n                }\n                this.getState();\n                if (current && current.ref.eq(range._ref) && current.columns.length) {\n                    current.columns.forEach(function (element) {\n                        if (element.index === column) {\n                            exists = true;\n                        }\n                    });\n                    options = current.columns.map(function (element) {\n                        return element.index === column ? filterRule : {\n                            column: element.index,\n                            filter: element.filter\n                        };\n                    });\n                    if (!exists) {\n                        options.push(filterRule);\n                    }\n                } else {\n                    options = filterRule;\n                }\n                range.filter(options);\n            }\n        });\n        kendo.spreadsheet.ClearFilterCommand = ApplyFilterCommand.extend({\n            exec: function () {\n                var range = this.range();\n                var column = this.column();\n                this.getState();\n                range.clearFilter(column);\n            }\n        });\n        kendo.spreadsheet.HideLineCommand = Command.extend({\n            init: function (options) {\n                Command.fn.init.call(this, options);\n                this.axis = options.axis;\n            },\n            undo: function () {\n                var sheet = this.range().sheet();\n                sheet.setAxisState(this._state);\n            },\n            exec: function () {\n                var sheet = this.range().sheet();\n                this._state = sheet.getAxisState();\n                if (this.axis == 'row') {\n                    sheet.axisManager().hideSelectedRows();\n                } else {\n                    sheet.axisManager().hideSelectedColumns();\n                }\n            }\n        });\n        kendo.spreadsheet.UnHideLineCommand = kendo.spreadsheet.HideLineCommand.extend({\n            exec: function () {\n                var sheet = this.range().sheet();\n                this._state = sheet.getAxisState();\n                if (this.axis == 'row') {\n                    sheet.axisManager().unhideSelectedRows();\n                } else {\n                    sheet.axisManager().unhideSelectedColumns();\n                }\n            }\n        });\n        var DeleteCommand = kendo.spreadsheet.DeleteCommand = Command.extend({\n            undo: function () {\n                var sheet = this.range().sheet();\n                sheet.setState(this._state);\n            }\n        });\n        kendo.spreadsheet.DeleteRowCommand = DeleteCommand.extend({\n            exec: function () {\n                var sheet = this.range().sheet();\n                this._state = sheet.getState();\n                sheet.axisManager().deleteSelectedRows();\n            }\n        });\n        kendo.spreadsheet.DeleteColumnCommand = DeleteCommand.extend({\n            exec: function () {\n                var sheet = this.range().sheet();\n                this._state = sheet.getState();\n                sheet.axisManager().deleteSelectedColumns();\n            }\n        });\n        var AddCommand = Command.extend({\n            init: function (options) {\n                Command.fn.init.call(this, options);\n                this._value = options.value;\n            },\n            undo: function () {\n                var sheet = this.range().sheet();\n                sheet.setState(this._state);\n            }\n        });\n        kendo.spreadsheet.AddColumnCommand = AddCommand.extend({\n            exec: function () {\n                var sheet = this.range().sheet();\n                this._state = sheet.getState();\n                if (this._value === 'left') {\n                    sheet.axisManager().addColumnLeft();\n                } else {\n                    sheet.axisManager().addColumnRight();\n                }\n            }\n        });\n        kendo.spreadsheet.AddRowCommand = AddCommand.extend({\n            exec: function () {\n                var sheet = this.range().sheet();\n                if (!sheet.axisManager().canAddRow()) {\n                    return {\n                        reason: 'error',\n                        type: 'shiftingNonblankCells'\n                    };\n                }\n                this._state = sheet.getState();\n                if (this._value === 'above') {\n                    sheet.axisManager().addRowAbove();\n                } else {\n                    sheet.axisManager().addRowBelow();\n                }\n            }\n        });\n        kendo.spreadsheet.EditValidationCommand = Command.extend({\n            init: function (options) {\n                Command.fn.init.call(this, options);\n                this._value = options.value;\n            },\n            exec: function () {\n                this.range().validation(this._value);\n            }\n        });\n        kendo.spreadsheet.OpenCommand = Command.extend({\n            exec: function () {\n                var file = this.options.file;\n                if (file.name.match(/.xlsx$/i) === null) {\n                    return {\n                        reason: 'error',\n                        type: 'openUnsupported'\n                    };\n                }\n                this.options.workbook.fromFile(this.options.file);\n            }\n        });\n        kendo.spreadsheet.SaveAsCommand = Command.extend({\n            exec: function () {\n                var fileName = this.options.name + this.options.extension;\n                if (this.options.extension === '.xlsx') {\n                    this.options.workbook.saveAsExcel({ fileName: fileName });\n                } else if (this.options.extension === '.pdf') {\n                    this.options.workbook.saveAsPDF($.extend(this.options.pdf, {\n                        workbook: this.options.workbook,\n                        fileName: fileName\n                    }));\n                }\n            }\n        });\n    }(kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/formulabar', ['kendo.core'], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var $ = kendo.jQuery;\n        var classNames = { wrapper: 'k-spreadsheet-formula-bar' };\n        var FormulaBar = kendo.ui.Widget.extend({\n            init: function (element, options) {\n                kendo.ui.Widget.call(this, element, options);\n                element = this.element.addClass(FormulaBar.classNames.wrapper);\n                this.formulaInput = new kendo.spreadsheet.FormulaInput($('<div/>').appendTo(element));\n            },\n            destroy: function () {\n                if (this.formulaInput) {\n                    this.formulaInput.destroy();\n                }\n                this.formulaInput = null;\n            }\n        });\n        kendo.spreadsheet.FormulaBar = FormulaBar;\n        $.extend(true, FormulaBar, { classNames: classNames });\n    }(window.kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/formulainput', ['kendo.core'], f);\n}(function () {\n    (function (kendo, window) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var $ = kendo.jQuery;\n        var Widget = kendo.ui.Widget;\n        var ns = '.kendoFormulaInput';\n        var keys = kendo.keys;\n        var classNames = {\n            wrapper: 'k-spreadsheet-formula-input',\n            listWrapper: 'k-spreadsheet-formula-list'\n        };\n        var styles = [\n            'font-family',\n            'font-size',\n            'font-stretch',\n            'font-style',\n            'font-weight',\n            'letter-spacing',\n            'text-transform',\n            'line-height'\n        ];\n        var KEY_NAMES = {\n            27: 'esc',\n            37: 'left',\n            39: 'right',\n            35: 'end',\n            36: 'home',\n            32: 'spacebar'\n        };\n        var PRIVATE_FORMULA_CHECK = /(^_|[^a-z0-9]$)/i;\n        var FormulaInput = Widget.extend({\n            init: function (element, options) {\n                Widget.call(this, element, options);\n                element = this.element;\n                element.addClass(FormulaInput.classNames.wrapper).attr('contenteditable', true).attr('spellcheck', false);\n                if (this.options.autoScale) {\n                    element.on('input', this.scale.bind(this));\n                }\n                this._highlightedRefs = [];\n                this._staticTokens = [];\n                this._formulaSource();\n                this._formulaList();\n                this._popup();\n                this._tooltip();\n                element.on('keydown', this._keydown.bind(this)).on('keyup', this._keyup.bind(this)).on('blur', this._blur.bind(this)).on('input click', this._input.bind(this)).on('focus', this._focus.bind(this));\n            },\n            options: {\n                name: 'FormulaInput',\n                autoScale: false,\n                filterOperator: 'startswith',\n                scalePadding: 30,\n                minLength: 1\n            },\n            events: [\n                'keyup',\n                'focus'\n            ],\n            enable: function (enable) {\n                if (enable === undefined) {\n                    return this.element.attr('contenteditable') === 'false' ? false : true;\n                }\n                this.element.attr('contenteditable', enable).toggleClass('k-state-disabled', !enable);\n            },\n            getPos: function () {\n                var div = this.element[0];\n                var sel = window.getSelection();\n                var a = lookup(sel.focusNode, sel.focusOffset);\n                var b = lookup(sel.anchorNode, sel.anchorOffset);\n                if (a != null && b != null) {\n                    if (a > b) {\n                        var tmp = a;\n                        a = b;\n                        b = tmp;\n                    }\n                    return {\n                        begin: a,\n                        end: b,\n                        collapsed: a == b\n                    };\n                }\n                function lookup(lookupNode, pos) {\n                    try {\n                        (function loop(node) {\n                            if (node === lookupNode) {\n                                throw pos;\n                            } else if (node.nodeType == 1) {\n                                for (var i = node.firstChild; i; i = i.nextSibling) {\n                                    loop(i);\n                                }\n                            } else if (node.nodeType == 3) {\n                                pos += node.nodeValue.length;\n                            }\n                        }(div));\n                    } catch (index) {\n                        return index;\n                    }\n                }\n            },\n            setPos: function (begin, end) {\n                var eiv = this.element[0];\n                begin = lookup(eiv, begin);\n                if (end != null) {\n                    end = lookup(eiv, end);\n                } else {\n                    end = begin;\n                }\n                if (begin && end) {\n                    var r = document.createRange();\n                    r.setStart(begin.node, begin.pos);\n                    r.setEnd(end.node, end.pos);\n                    var sel = window.getSelection();\n                    sel.removeAllRanges();\n                    sel.addRange(r);\n                }\n                function lookup(node, pos) {\n                    try {\n                        (function loop(node) {\n                            if (node.nodeType == 3) {\n                                var len = node.nodeValue.length;\n                                if (len >= pos) {\n                                    throw node;\n                                }\n                                pos -= len;\n                            } else if (node.nodeType == 1) {\n                                for (var i = node.firstChild; i; i = i.nextSibling) {\n                                    loop(i);\n                                }\n                            }\n                        }(node));\n                    } catch (el) {\n                        return {\n                            node: el,\n                            pos: pos\n                        };\n                    }\n                }\n            },\n            end: function () {\n                this.setPos(this.length());\n            },\n            home: function () {\n                this.setPos(0);\n            },\n            length: function () {\n                return this.value().length;\n            },\n            _formulaSource: function () {\n                var result = [];\n                var value;\n                for (var key in kendo.spreadsheet.calc.runtime.FUNCS) {\n                    if (!PRIVATE_FORMULA_CHECK.test(key)) {\n                        value = key.toUpperCase();\n                        result.push({\n                            value: value,\n                            text: value\n                        });\n                    }\n                }\n                this.formulaSource = new kendo.data.DataSource({ data: result });\n            },\n            _formulaList: function () {\n                this.list = new kendo.ui.StaticList($('<ul />').addClass(FormulaInput.classNames.listWrapper).insertAfter(this.element), {\n                    autoBind: false,\n                    selectable: true,\n                    change: this._formulaListChange.bind(this),\n                    dataSource: this.formulaSource,\n                    dataValueField: 'value',\n                    template: '#:data.value#'\n                });\n                this.list.element.on('mousedown', function (e) {\n                    e.preventDefault();\n                });\n            },\n            _formulaListChange: function () {\n                var tokenCtx = this._tokenContext();\n                if (!tokenCtx || this._mute) {\n                    return;\n                }\n                var activeToken = tokenCtx.token;\n                var completion = this.list.value()[0];\n                var ctx = {\n                    replace: true,\n                    token: activeToken,\n                    end: activeToken.end\n                };\n                if (!tokenCtx.nextToken || tokenCtx.nextToken.value != '(') {\n                    completion += '(';\n                }\n                this._replaceAt(ctx, completion);\n                this.popup.close();\n            },\n            _popup: function () {\n                this.popup = new kendo.ui.Popup(this.list.element, { anchor: this.element });\n            },\n            _blur: function () {\n                this.popup.close();\n                clearTimeout(this._focusId);\n            },\n            _isFormula: function () {\n                return /^=/.test(this.value());\n            },\n            _keydown: function (e) {\n                var key = e.keyCode;\n                if (KEY_NAMES[key]) {\n                    this.popup.close();\n                    this._navigated = true;\n                } else if (this._move(key)) {\n                    this._navigated = true;\n                    e.preventDefault();\n                }\n                this._keyDownTimeout = setTimeout(this._syntaxHighlight.bind(this));\n            },\n            _keyup: function () {\n                var popup = this.popup;\n                var value;\n                if (this._isFormula() && !this._navigated) {\n                    value = ((this._tokenContext() || {}).token || {}).value;\n                    this.filter(value);\n                    if (!value || !this.formulaSource.view().length) {\n                        popup.close();\n                    } else {\n                        popup[popup.visible() ? 'position' : 'open']();\n                        this.list.focusFirst();\n                    }\n                }\n                this._navigated = false;\n                this._syntaxHighlight();\n                this.trigger('keyup');\n            },\n            _input: function () {\n                this._syntaxHighlight();\n            },\n            _focus: function () {\n                this._focusTimeout = setTimeout(this._syntaxHighlight.bind(this));\n                this.trigger('focus');\n            },\n            _move: function (key) {\n                var list = this.list;\n                var pressed = false;\n                var popup = this.popup;\n                if (key === keys.DOWN) {\n                    list.focusNext();\n                    if (!list.focus()) {\n                        list.focusFirst();\n                    }\n                    pressed = true;\n                } else if (key === keys.UP) {\n                    list.focusPrev();\n                    if (!list.focus()) {\n                        list.focusLast();\n                    }\n                    pressed = true;\n                } else if (key === keys.ENTER) {\n                    if (popup.visible()) {\n                        list.select(list.focus());\n                    }\n                    popup.close();\n                    pressed = true;\n                } else if (key === keys.TAB) {\n                    list.select(list.focus());\n                    popup.close();\n                    pressed = true;\n                } else if (key === keys.PAGEUP) {\n                    list.focusFirst();\n                    pressed = true;\n                } else if (key === keys.PAGEDOWN) {\n                    list.focusLast();\n                    pressed = true;\n                }\n                return pressed;\n            },\n            _tokenContext: function () {\n                var point = this.getPos();\n                var value = this.value();\n                if (!value || !point || !point.collapsed) {\n                    return null;\n                }\n                var tokens = kendo.spreadsheet.calc.tokenize(value, this.row(), this.col());\n                var tok;\n                for (var i = 0; i < tokens.length; ++i) {\n                    tok = tokens[i];\n                    if (touches(tok, point) && /^(?:str|sym|func)$/.test(tok.type)) {\n                        return {\n                            token: tok,\n                            nextToken: tokens[i + 1]\n                        };\n                    }\n                }\n                return null;\n            },\n            _sync: function () {\n                if (this._editorToSync && this.isActive()) {\n                    this._editorToSync.value(this.value());\n                }\n            },\n            _textContainer: function () {\n                var computedStyles = kendo.getComputedStyles(this.element[0], styles);\n                computedStyles.position = 'absolute';\n                computedStyles.visibility = 'hidden';\n                computedStyles.whiteSpace = 'pre';\n                computedStyles.top = -3333;\n                computedStyles.left = -3333;\n                this._span = $('<span/>').css(computedStyles).insertAfter(this.element);\n            },\n            _tooltip: function () {\n                this._cellTooltip = $('<div class=\"k-widget k-tooltip\" style=\"position:absolute; display:none\">A1</div>').insertAfter(this.element);\n            },\n            tooltip: function (value) {\n                this._cellTooltip.text(value);\n            },\n            toggleTooltip: function (show) {\n                this._cellTooltip.toggle(show);\n            },\n            isActive: function () {\n                return this.element[0] === kendo._activeElement();\n            },\n            filter: function (value) {\n                if (!value || value.length < this.options.minLength) {\n                    return;\n                }\n                this._mute = true;\n                this.list.select(-1);\n                this._mute = false;\n                this.formulaSource.filter({\n                    field: this.list.options.dataValueField,\n                    operator: this.options.filterOperator,\n                    value: value\n                });\n            },\n            hide: function () {\n                this.element.hide();\n                this._cellTooltip.hide();\n            },\n            show: function () {\n                this.element.show();\n            },\n            row: function () {\n                if (this.activeCell) {\n                    return this.activeCell.row;\n                }\n            },\n            col: function () {\n                if (this.activeCell) {\n                    return this.activeCell.col;\n                }\n            },\n            position: function (rectangle) {\n                if (!rectangle) {\n                    return;\n                }\n                this.element.show().css({\n                    'top': rectangle.top + 1 + 'px',\n                    'left': rectangle.left + 1 + 'px'\n                });\n                this._cellTooltip.css({\n                    'top': rectangle.top - this._cellTooltip.height() - 10 + 'px',\n                    'left': rectangle.left\n                });\n            },\n            resize: function (rectangle) {\n                if (!rectangle) {\n                    return;\n                }\n                this.element.css({\n                    width: rectangle.width - 1,\n                    height: rectangle.height - 1\n                });\n            },\n            canInsertRef: function (isKeyboardAction) {\n                var result = this._canInsertRef(isKeyboardAction);\n                var token = result && result.token;\n                var idx;\n                if (token) {\n                    for (idx = 0; idx < this._staticTokens.length; idx++) {\n                        if (isEqualToken(token, this._staticTokens[idx])) {\n                            return null;\n                        }\n                    }\n                }\n                return result;\n            },\n            _canInsertRef: function (isKeyboardAction) {\n                if (this.popup.visible()) {\n                    return null;\n                }\n                var strictMode = isKeyboardAction;\n                var point = this.getPos();\n                var tokens, tok;\n                if (point && this._isFormula()) {\n                    if (point.begin === 0) {\n                        return null;\n                    }\n                    tokens = kendo.spreadsheet.calc.tokenize(this.value(), this.row(), this.col());\n                    for (var i = 0; i < tokens.length; ++i) {\n                        tok = tokens[i];\n                        if (touches(tok, point)) {\n                            return canReplace(tok);\n                        }\n                        if (afterPoint(tok)) {\n                            return canInsertBetween(tokens[i - 1], tok);\n                        }\n                    }\n                    return canInsertBetween(tok, null);\n                }\n                return null;\n                function afterPoint(tok) {\n                    return tok.begin > point.begin;\n                }\n                function canReplace(tok) {\n                    if (tok) {\n                        if (/^(?:num|str|bool|sym|ref)$/.test(tok.type)) {\n                            return {\n                                replace: true,\n                                token: tok,\n                                end: tok.end\n                            };\n                        }\n                        if (/^(?:op|punc|startexp)$/.test(tok.type)) {\n                            if (tok.end == point.end) {\n                                return canInsertBetween(tok, tokens[i + 1]);\n                            }\n                            return canInsertBetween(tokens[i - 1], tok);\n                        }\n                    }\n                }\n                function canInsertBetween(left, right) {\n                    if (left == null) {\n                        return null;\n                    }\n                    if (right == null) {\n                        if (/^(?:op|startexp)$/.test(left.type) || isOpenParen(left.value)) {\n                            return {\n                                token: left,\n                                end: point.end\n                            };\n                        }\n                        return null;\n                    }\n                    if (strictMode) {\n                        if (left.type == 'op' && /^(?:punc|op)$/.test(right.type)) {\n                            return {\n                                token: left,\n                                end: point.end\n                            };\n                        }\n                    } else {\n                        if (left.type == 'startexp') {\n                            return {\n                                token: left,\n                                end: point.end\n                            };\n                        }\n                        if (/^(?:ref|op|punc)$/.test(left.type)) {\n                            return {\n                                token: left,\n                                end: point.end\n                            };\n                        }\n                        if (/^(?:punc|op)$/.test(left.type)) {\n                            return /^[,;({]$/.test(left.value) ? {\n                                token: left,\n                                end: point.end\n                            } : null;\n                        }\n                    }\n                    return false;\n                }\n            },\n            refAtPoint: function (ref) {\n                var x = this._canInsertRef();\n                if (x) {\n                    this._replaceAt(x, ref.simplify().toString());\n                }\n            },\n            _replaceAt: function (ctx, newValue) {\n                var value = this.value();\n                var tok = ctx.token;\n                var rest = value.substr(ctx.end);\n                value = value.substr(0, ctx.replace ? tok.begin : ctx.end) + newValue;\n                var point = value.length;\n                value += rest;\n                this._value(value);\n                this.setPos(point);\n                this.scale();\n                this._syntaxHighlight();\n                this._sync();\n            },\n            syncWith: function (formulaInput) {\n                var eventName = 'input' + ns;\n                this._editorToSync = formulaInput;\n                this.element.off(eventName).on(eventName, this._sync.bind(this));\n            },\n            scale: function () {\n                var element = this.element;\n                var width;\n                if (!this._span) {\n                    this._textContainer();\n                }\n                this._span.html(element.html());\n                width = this._span.width() + this.options.scalePadding;\n                if (width > element.width()) {\n                    element.width(width);\n                }\n            },\n            _value: function (value) {\n                this.element.text(value);\n            },\n            value: function (value) {\n                if (value === undefined) {\n                    return this.element.text();\n                }\n                this._value(value);\n                this._syntaxHighlight();\n            },\n            highlightedRefs: function () {\n                return this._highlightedRefs.slice();\n            },\n            _syntaxHighlight: function () {\n                var pos = this.getPos();\n                var value = this.value();\n                var refClasses = kendo.spreadsheet.Pane.classNames.series;\n                var highlightedRefs = [];\n                var refIndex = 0;\n                var parens = [];\n                var tokens = [];\n                var activeToken;\n                if (pos && !pos.collapsed) {\n                    return;\n                }\n                if (!/^=/.test(value)) {\n                    this.element.text(value);\n                    if (this.popup) {\n                        this.popup.close();\n                    }\n                } else {\n                    tokens = kendo.spreadsheet.calc.tokenize(value, this.row(), this.col());\n                    tokens.forEach(function (tok) {\n                        tok.active = false;\n                        tok.cls = ['k-syntax-' + tok.type];\n                        if (tok.type == 'ref') {\n                            tok.colorClass = refClasses[refIndex++ % refClasses.length];\n                            tok.cls.push(tok.colorClass);\n                            highlightedRefs.push(tok);\n                        }\n                        if (pos && tok.type == 'punc') {\n                            if (isOpenParen(tok.value)) {\n                                parens.unshift(tok);\n                            } else if (isCloseParen(tok.value)) {\n                                var open = parens.shift();\n                                if (open) {\n                                    if (isMatchingParen(tok.value, open.value)) {\n                                        if (touches(tok, pos) || touches(open, pos)) {\n                                            tok.cls.push('k-syntax-paren-match');\n                                            open.cls.push('k-syntax-paren-match');\n                                        }\n                                    } else {\n                                        tok.cls.push('k-syntax-error');\n                                        open.cls.push('k-syntax-error');\n                                    }\n                                } else {\n                                    tok.cls.push('k-syntax-error');\n                                }\n                            }\n                        }\n                        if (pos && touches(tok, pos)) {\n                            tok.cls.push('k-syntax-at-point');\n                            tok.active = true;\n                            activeToken = tok;\n                        }\n                        if (tok.type == 'func' && !knownFunction(tok.value) && (!pos || !touches(tok, pos))) {\n                            tok.cls.push('k-syntax-error');\n                        }\n                    });\n                    tokens.reverse().forEach(function (tok) {\n                        var begin = tok.begin, end = tok.end;\n                        var text = kendo.htmlEncode(value.substring(begin, end));\n                        value = value.substr(0, begin) + '<span class=\\'' + tok.cls.join(' ') + '\\'>' + text + '</span>' + value.substr(end);\n                    });\n                    this.element.html(value);\n                }\n                if (pos) {\n                    this.setPos(pos.begin, pos.end);\n                }\n                if (activeToken && /^(?:startexp|op|punc)$/.test(activeToken.type)) {\n                    this._setStaticTokens(tokens);\n                }\n                this._highlightedRefs = highlightedRefs;\n            },\n            _setStaticTokens: function (tokens) {\n                var idx, tok;\n                this._staticTokens = [];\n                for (idx = 0; idx < tokens.length; idx++) {\n                    tok = tokens[idx];\n                    if (/^(?:num|str|bool|sym|ref)$/.test(tok.type)) {\n                        this._staticTokens.push(tok);\n                    }\n                }\n            },\n            destroy: function () {\n                this._editorToSync = null;\n                this.element.off(ns);\n                clearTimeout(this._focusTimeout);\n                clearTimeout(this._keyDownTimeout);\n                this._cellTooltip = null;\n                this._span = null;\n                this.popup.destroy();\n                this.popup = null;\n                Widget.fn.destroy.call(this);\n            }\n        });\n        function isOpenParen(ch) {\n            return ch == '(' || ch == '[' || ch == '{';\n        }\n        function isCloseParen(ch) {\n            return ch == ')' || ch == ']' || ch == '}';\n        }\n        function isMatchingParen(close, open) {\n            return open == '(' ? close == ')' : open == '[' ? close == ']' : open == '{' ? close == '}' : false;\n        }\n        function touches(pos, target) {\n            return pos.begin <= target.begin && pos.end >= target.end;\n        }\n        function knownFunction(name) {\n            return kendo.spreadsheet.calc.runtime.FUNCS[name.toLowerCase()];\n        }\n        function isEqualToken(tok1, tok2) {\n            if (!tok1 || !tok2) {\n                return false;\n            }\n            if (tok1.type == 'ref' && tok2.type == 'ref') {\n                return tok1.ref.eq(tok2.ref);\n            } else {\n                return tok1.value === tok2.value;\n            }\n        }\n        kendo.spreadsheet.FormulaInput = FormulaInput;\n        $.extend(true, FormulaInput, { classNames: classNames });\n    }(kendo, window));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/eventlistener', ['kendo.core'], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var $ = kendo.jQuery;\n        var KEY_NAMES = {\n            8: 'backspace',\n            9: 'tab',\n            13: 'enter',\n            27: 'esc',\n            37: 'left',\n            38: 'up',\n            39: 'right',\n            40: 'down',\n            35: 'end',\n            36: 'home',\n            32: 'spacebar',\n            33: 'pageup',\n            34: 'pagedown',\n            46: 'delete',\n            113: ':edit'\n        };\n        var Mac = navigator.platform.toUpperCase().indexOf('MAC') >= 0;\n        var isAlphaNum = function (keyCode) {\n            if (keyCode > 47 && keyCode < 58 || keyCode > 64 && keyCode < 91 || keyCode > 95 && keyCode < 112 || keyCode > 185 && keyCode < 193 || keyCode > 218 && keyCode < 223) {\n                return true;\n            }\n            return false;\n        };\n        var keyName = function (keyCode) {\n            var name = KEY_NAMES[keyCode];\n            if (!name && isAlphaNum(keyCode)) {\n                name = ':alphanum';\n            }\n            return name;\n        };\n        var EventListener = kendo.Class.extend({\n            init: function (target, observer, handlers) {\n                this._handlers = {};\n                this.target = target;\n                this._observer = observer || window;\n                this.keyDownProxy = this.keyDown.bind(this);\n                this.mouseProxy = this.mouse.bind(this);\n                this.threshold = 5;\n                this._pressLocation = null;\n                target.on('keydown', this.keyDownProxy);\n                target.on('contextmenu mousedown cut copy paste scroll wheel click dblclick focus', this.mouseProxy);\n                $(document.documentElement).on('mousemove mouseup', this.mouseProxy);\n                if (handlers) {\n                    for (var key in handlers) {\n                        this.on(key, handlers[key]);\n                    }\n                }\n            },\n            keyDown: function (e) {\n                this.handleEvent(e, keyName(e.keyCode));\n            },\n            mouse: function (e) {\n                var rightClick;\n                if (e.which) {\n                    rightClick = e.which == 3;\n                } else if (e.button) {\n                    rightClick = e.button == 2;\n                }\n                var type = e.type;\n                if (type === 'mousedown') {\n                    if (rightClick) {\n                        type = 'rightmousedown';\n                    } else {\n                        this._pressLocation = {\n                            x: e.pageX,\n                            y: e.pageY\n                        };\n                    }\n                }\n                if (type === 'mouseup') {\n                    if (!rightClick) {\n                        this._pressLocation = null;\n                    }\n                }\n                if (type === 'mousemove' && this._pressLocation) {\n                    var dx = this._pressLocation.x - e.pageX;\n                    var dy = this._pressLocation.y - e.pageY;\n                    var distance = Math.sqrt(dx * dx + dy * dy);\n                    if (distance > this.threshold) {\n                        type = 'mousedrag';\n                    }\n                }\n                this.handleEvent(e, type);\n            },\n            handleEvent: function (e, name) {\n                var eventKey = '';\n                e.mod = Mac ? e.metaKey : e.ctrlKey;\n                if (e.shiftKey) {\n                    eventKey += 'shift+';\n                }\n                if (e.ctrlKey) {\n                    eventKey += 'ctrl+';\n                }\n                eventKey += name;\n                var catchAllHandler = this._handlers['*+' + name];\n                if (catchAllHandler) {\n                    catchAllHandler.call(this._observer, e, eventKey);\n                }\n                var handler = this._handlers[eventKey];\n                if (handler) {\n                    handler.call(this._observer, e, eventKey);\n                }\n            },\n            on: function (event, callback) {\n                var handlers = this._handlers;\n                if (typeof callback === 'string') {\n                    callback = this._observer[callback];\n                }\n                if (typeof event === 'string') {\n                    event = event.split(',');\n                }\n                event.forEach(function (e) {\n                    handlers[e] = callback;\n                });\n            },\n            destroy: function () {\n                this.target.off('keydown', this.keyDownProxy);\n                this.target.off('keydown', this.mouseProxy);\n                $(document.documentElement).off('mousemove mouseup', this.mouseProxy);\n            }\n        });\n        kendo.spreadsheet.EventListener = EventListener;\n    }(window.kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/rangelist', ['kendo.core'], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var RangeTreeNode = kendo.Class.extend({\n            init: function Node(level, value, left, right) {\n                this.level = level;\n                this.value = value;\n                this.left = left;\n                this.right = right;\n            }\n        });\n        var NilNode = new function NIL() {\n            this.left = this;\n            this.right = this;\n            this.level = 0;\n        }();\n        function passThrough(value) {\n            return value;\n        }\n        function skew(node) {\n            if (node.left.level === node.level) {\n                var temp = node;\n                node = node.left;\n                temp.left = node.right;\n                node.right = temp;\n            }\n            return node;\n        }\n        function split(node) {\n            if (node.right.right.level === node.level) {\n                var temp = node;\n                node = node.right;\n                temp.right = node.left;\n                node.left = temp;\n                node.level += 1;\n            }\n            return node;\n        }\n        function insert(node, value) {\n            if (node === NilNode) {\n                return new RangeTreeNode(1, value, NilNode, NilNode);\n            } else if (node.value.start - value.start > 0) {\n                node.left = insert(node.left, value);\n            } else {\n                node.right = insert(node.right, value);\n            }\n            return split(skew(node));\n        }\n        function remove(node, value) {\n            if (node === NilNode) {\n                return node;\n            }\n            var diff = node.value.start - value.start;\n            if (diff === 0) {\n                if (node.left !== NilNode && node.right !== NilNode) {\n                    var heir = node.left;\n                    while (heir.right !== NilNode) {\n                        heir = heir.right;\n                    }\n                    node.value = heir.value;\n                    node.left = remove(node.left, node.value);\n                } else if (node.left === NilNode) {\n                    node = node.right;\n                } else {\n                    node = node.left;\n                }\n            } else if (diff > 0) {\n                node.left = remove(node.left, value);\n            } else {\n                node.right = remove(node.right, value);\n            }\n            if (node.left.level < node.level - 1 || node.right.level < node.level - 1) {\n                node.level -= 1;\n                if (node.right.level > node.level) {\n                    node.right.level = node.level;\n                }\n                node = skew(node);\n                node.right = skew(node.right);\n                node.right.right = skew(node.right.right);\n                node = split(node);\n                node.right = split(node.right);\n            }\n            return node;\n        }\n        var Range = kendo.Class.extend({\n            init: function Value(start, end, value) {\n                this.start = start;\n                this.end = end;\n                this.value = value;\n            },\n            intersects: function (range) {\n                return range.start <= this.end && range.end >= this.start;\n            }\n        });\n        var RangeTree = kendo.Class.extend({\n            init: function () {\n                this.root = NilNode;\n            },\n            insert: function (value) {\n                this.root = insert(this.root, value);\n            },\n            remove: function (value) {\n                this.root = remove(this.root, value);\n            },\n            findrange: function (value) {\n                var node = this.root;\n                while (node != NilNode) {\n                    if (value < node.value.start) {\n                        node = node.left;\n                    } else if (value > node.value.end) {\n                        node = node.right;\n                    } else {\n                        return node.value;\n                    }\n                }\n                return null;\n            },\n            values: function () {\n                var result = [];\n                values(this.root, result);\n                return result;\n            },\n            intersecting: function (start, end) {\n                var ranges = [];\n                intersecting(this.root, new Range(start, end), ranges);\n                return ranges;\n            },\n            map: function (callback) {\n                var tree = new RangeTree();\n                map(tree, this.root, callback);\n                return tree;\n            },\n            clone: function () {\n                return this.map(passThrough);\n            },\n            first: function () {\n                var first = this.root;\n                while (first.left != NilNode) {\n                    first = first.left;\n                }\n                return first;\n            },\n            last: function () {\n                var last = this.root;\n                while (last.right != NilNode) {\n                    last = last.right;\n                }\n                return last;\n            }\n        });\n        function values(node, result) {\n            if (node === NilNode) {\n                return;\n            }\n            values(node.left, result);\n            result.push(node.value);\n            values(node.right, result);\n        }\n        function intersecting(node, range, ranges) {\n            if (node === NilNode) {\n                return;\n            }\n            var value = node.value;\n            if (range.start < value.start) {\n                intersecting(node.left, range, ranges);\n            }\n            if (value.intersects(range)) {\n                ranges.push(value);\n            }\n            if (range.end > value.end) {\n                intersecting(node.right, range, ranges);\n            }\n        }\n        function map(tree, root, callback) {\n            if (root === NilNode) {\n                return;\n            }\n            map(tree, root.left, callback);\n            tree.insert(callback(root.value));\n            map(tree, root.right, callback);\n        }\n        var RangeList = kendo.Class.extend({\n            init: function (start, end, value) {\n                if (end === undefined) {\n                    this.tree = start;\n                } else {\n                    this.tree = new RangeTree();\n                    this.tree.insert(new Range(start, end, value));\n                }\n            },\n            values: function () {\n                return this.tree.values();\n            },\n            map: function (callback) {\n                return new RangeList(this.tree.map(callback));\n            },\n            intersecting: function (start, end) {\n                return this.tree.intersecting(start, end);\n            },\n            first: function () {\n                return this.tree.first().value;\n            },\n            last: function () {\n                return this.tree.last().value;\n            },\n            insert: function (start, end, value) {\n                return this.tree.insert(new Range(start, end, value));\n            },\n            value: function (start, end, value) {\n                if (value === undefined) {\n                    if (end === undefined) {\n                        end = start;\n                    }\n                    return this.intersecting(start, end)[0].value;\n                }\n                var ranges = this.tree.intersecting(start - 1, end + 1);\n                if (ranges.length) {\n                    var firstRange = ranges[0], lastRange = ranges[ranges.length - 1];\n                    if (firstRange.end < start) {\n                        if (firstRange.value === value) {\n                            start = firstRange.start;\n                        } else {\n                            ranges.shift();\n                        }\n                    }\n                    if (lastRange.start > end) {\n                        if (lastRange.value === value) {\n                            end = lastRange.end;\n                        } else {\n                            ranges.pop();\n                        }\n                    }\n                    for (var i = 0, length = ranges.length; i < length; i++) {\n                        var range = ranges[i];\n                        var rangeValue = range.value;\n                        var rangeStart = range.start;\n                        var rangeEnd = range.end;\n                        this.tree.remove(range);\n                        if (rangeStart < start) {\n                            if (rangeValue !== value) {\n                                this.insert(rangeStart, start - 1, rangeValue);\n                            } else {\n                                start = rangeStart;\n                            }\n                        }\n                        if (rangeEnd > end) {\n                            if (rangeValue !== value) {\n                                this.insert(end + 1, rangeEnd, rangeValue);\n                            } else {\n                                end = rangeEnd;\n                            }\n                        }\n                    }\n                }\n                this.insert(start, end, value);\n            },\n            expandedValues: function (start, end) {\n                var ranges = this.intersecting(start, end);\n                var result = [];\n                var rangeIndex = 0;\n                for (var i = start; i <= end; i++) {\n                    if (ranges[rangeIndex].end < i) {\n                        rangeIndex++;\n                    }\n                    result.push({\n                        index: i - start,\n                        value: ranges[rangeIndex].value\n                    });\n                }\n                return result;\n            },\n            sortedIndices: function (start, end, valueComparer, indices) {\n                var result = this.expandedValues(start, end);\n                var comparer = function (a, b) {\n                    if (a.value === b.value) {\n                        return a.index - b.index;\n                    }\n                    return valueComparer(a.value, b.value);\n                };\n                if (indices) {\n                    comparer = function (a, b) {\n                        var x = indices[a.index];\n                        var y = indices[b.index];\n                        if (x.value === y.value) {\n                            return valueComparer(a.value, b.value);\n                        }\n                        return a.index - b.index;\n                    };\n                }\n                result.sort(comparer);\n                return result;\n            },\n            sort: function (start, end, indices) {\n                if (this.intersecting(start, end).length === 1) {\n                    return;\n                }\n                var values = this.expandedValues(start, end);\n                for (var i = 0, len = indices.length; i < len; i++) {\n                    this.value(i + start, i + start, values[indices[i].index].value);\n                }\n            },\n            copy: function (sourceStart, sourceEnd, targetStart) {\n                var values = this.intersecting(sourceStart, sourceEnd);\n                var start = targetStart;\n                var end;\n                for (var i = 0, len = values.length; i < len; i++) {\n                    var rangeStart = values[i].start;\n                    if (rangeStart < sourceStart) {\n                        rangeStart = sourceStart;\n                    }\n                    var rangeEnd = values[i].end;\n                    if (rangeEnd > sourceEnd) {\n                        rangeEnd = sourceEnd;\n                    }\n                    end = start + (rangeEnd - rangeStart);\n                    this.value(start, end, values[i].value);\n                    start = ++end;\n                }\n            },\n            iterator: function (start, end) {\n                return new Iterator(start, end, this.intersecting(start, end));\n            },\n            getState: function () {\n                return this.tree.clone();\n            },\n            setState: function (state) {\n                this.tree = state;\n            }\n        });\n        var Iterator = kendo.Class.extend({\n            init: function (start, end, ranges) {\n                this.start = start;\n                this.end = end;\n                this.index = 0;\n                this.ranges = ranges;\n            },\n            unique: function () {\n                return this.ranges.map(function (range) {\n                    return range.value;\n                });\n            },\n            at: function (index) {\n                while (this.ranges[this.index].end < index) {\n                    this.index++;\n                }\n                return this.ranges[this.index].value;\n            },\n            forEach: function (callback) {\n                for (var i = this.start; i <= this.end; i++) {\n                    callback(this.at(i), i);\n                }\n                this.index = 0;\n            }\n        });\n        var SparseRangeList = RangeList.extend({\n            init: function (start, end, value) {\n                this.tree = new RangeTree();\n                this.range = new Range(start, end, value);\n            },\n            intersecting: function (start, end) {\n                var ranges = this.tree.intersecting(start, end);\n                var result = [];\n                var range;\n                if (!ranges.length) {\n                    return [this.range];\n                }\n                for (var i = 0, len = ranges.length; i < len; i++) {\n                    range = ranges[i];\n                    if (range.start > start) {\n                        result.push(new Range(start, range.start - 1, this.range.value));\n                    }\n                    result.push(range);\n                    start = range.end + 1;\n                }\n                if (range.end < end) {\n                    result.push(new Range(range.end + 1, end, this.range.value));\n                }\n                return result;\n            },\n            insert: function (start, end, value) {\n                if (value !== this.range.value) {\n                    this.tree.insert(new Range(start, end, value));\n                }\n            },\n            lastRangeStart: function () {\n                var node = this.tree.root;\n                if (node === NilNode) {\n                    return this.range.start;\n                }\n                while (node.right !== NilNode) {\n                    node = node.right;\n                }\n                return node.value.end + 1;\n            }\n        });\n        kendo.spreadsheet.RangeTree = RangeTree;\n        kendo.spreadsheet.RangeList = RangeList;\n        kendo.spreadsheet.SparseRangeList = SparseRangeList;\n        kendo.spreadsheet.ValueRange = Range;\n    }(kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/propertybag', ['kendo.core'], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var $ = kendo.jQuery;\n        var Property = kendo.Class.extend({\n            init: function (list) {\n                this.list = list;\n            },\n            get: function (index) {\n                return this.parse(this.list.value(index, index));\n            },\n            set: function (start, end, value) {\n                if (value === undefined) {\n                    value = end;\n                    end = start;\n                }\n                this.list.value(start, end, value);\n            },\n            parse: function (value) {\n                return value;\n            },\n            copy: function (start, end, dst) {\n                this.list.copy(start, end, dst);\n            },\n            iterator: function (start, end) {\n                return this.list.iterator(start, end);\n            }\n        });\n        var JsonProperty = Property.extend({\n            set: function (start, end, value) {\n                this.list.value(start, end, JSON.stringify(value));\n            },\n            parse: function (value) {\n                return JSON.parse(value);\n            }\n        });\n        var ValueProperty = Property.extend({\n            init: function (values, formats, validations) {\n                Property.prototype.init.call(this, values);\n                this.validations = validations;\n                this.formats = formats;\n            },\n            set: function (start, end, value) {\n                if (value instanceof Date) {\n                    value = kendo.spreadsheet.dateToNumber(value);\n                    this.formats.value(start, end, toExcelFormat(kendo.culture().calendar.patterns.d));\n                }\n                this.list.value(start, end, value);\n            }\n        });\n        function toExcelFormat(format) {\n            return format.replace(/M/g, 'm').replace(/'/g, '\"').replace(/tt/, 'am/pm');\n        }\n        kendo.spreadsheet.PropertyBag = kendo.Class.extend({\n            specs: [\n                {\n                    property: ValueProperty,\n                    name: 'value',\n                    value: null,\n                    sortable: true,\n                    serializable: true,\n                    depends: 'format'\n                },\n                {\n                    property: Property,\n                    name: 'format',\n                    value: null,\n                    sortable: true,\n                    serializable: true\n                },\n                {\n                    property: Property,\n                    name: 'formula',\n                    value: null,\n                    sortable: true,\n                    serializable: true\n                },\n                {\n                    property: Property,\n                    name: 'background',\n                    value: null,\n                    sortable: true,\n                    serializable: true\n                },\n                {\n                    property: JsonProperty,\n                    name: 'borderBottom',\n                    value: null,\n                    sortable: false,\n                    serializable: true\n                },\n                {\n                    property: JsonProperty,\n                    name: 'borderRight',\n                    value: null,\n                    sortable: false,\n                    serializable: true\n                },\n                {\n                    property: JsonProperty,\n                    name: 'borderLeft',\n                    value: null,\n                    sortable: false,\n                    serializable: true\n                },\n                {\n                    property: JsonProperty,\n                    name: 'borderTop',\n                    value: null,\n                    sortable: false,\n                    serializable: true\n                },\n                {\n                    property: Property,\n                    name: 'color',\n                    value: null,\n                    sortable: true,\n                    serializable: true\n                },\n                {\n                    property: Property,\n                    name: 'fontFamily',\n                    value: null,\n                    sortable: true,\n                    serializable: true\n                },\n                {\n                    property: Property,\n                    name: 'underline',\n                    value: null,\n                    sortable: true,\n                    serializable: true\n                },\n                {\n                    property: Property,\n                    name: 'fontSize',\n                    value: null,\n                    sortable: true,\n                    serializable: true\n                },\n                {\n                    property: Property,\n                    name: 'italic',\n                    value: null,\n                    sortable: true,\n                    serializable: true\n                },\n                {\n                    property: Property,\n                    name: 'bold',\n                    value: null,\n                    sortable: true,\n                    serializable: true\n                },\n                {\n                    property: Property,\n                    name: 'textAlign',\n                    value: null,\n                    sortable: true,\n                    serializable: true\n                },\n                {\n                    property: Property,\n                    name: 'verticalAlign',\n                    value: null,\n                    sortable: true,\n                    serializable: true\n                },\n                {\n                    property: Property,\n                    name: 'wrap',\n                    value: null,\n                    sortable: true,\n                    serializable: true\n                },\n                {\n                    property: Property,\n                    name: 'validation',\n                    value: null,\n                    sortable: false,\n                    serializable: true\n                },\n                {\n                    property: Property,\n                    name: 'enable',\n                    value: null,\n                    sortable: false,\n                    serializable: true\n                }\n            ],\n            init: function (cellCount) {\n                this.properties = {};\n                this.lists = {};\n                this.specs.forEach(function (spec) {\n                    this.lists[spec.name] = new kendo.spreadsheet.SparseRangeList(0, cellCount, spec.value);\n                }, this);\n                this.specs.forEach(function (spec) {\n                    this.properties[spec.name] = new spec.property(this.lists[spec.name], this.lists[spec.depends]);\n                }, this);\n            },\n            getState: function () {\n                var state = {};\n                this.specs.forEach(function (spec) {\n                    state[spec.name] = this.lists[spec.name].getState();\n                }, this);\n                return state;\n            },\n            setState: function (state) {\n                this.specs.forEach(function (spec) {\n                    this.lists[spec.name].setState(state[spec.name]);\n                }, this);\n            },\n            get: function (name, index) {\n                if (index === undefined) {\n                    return this.lists[name];\n                }\n                return this.properties[name].get(index);\n            },\n            set: function (name, start, end, value) {\n                this.properties[name].set(start, end, value);\n            },\n            fromJSON: function (index, value) {\n                for (var si = 0; si < this.specs.length; si++) {\n                    var spec = this.specs[si];\n                    if (spec.serializable) {\n                        if (value[spec.name] !== undefined) {\n                            this.set(spec.name, index, index, value[spec.name], false);\n                        }\n                    }\n                }\n            },\n            copy: function (sourceStart, sourceEnd, targetStart) {\n                this.specs.forEach(function (spec) {\n                    this.properties[spec.name].copy(sourceStart, sourceEnd, targetStart);\n                }, this);\n            },\n            iterator: function (name, start, end) {\n                return this.properties[name].iterator(start, end);\n            },\n            sortable: function () {\n                return this.specs.filter(function (spec) {\n                    return spec.sortable;\n                }).map(function (spec) {\n                    return this.lists[spec.name];\n                }, this);\n            },\n            iterators: function (start, end) {\n                var specs = this.specs.filter(function (spec) {\n                    return spec.serializable;\n                });\n                return specs.map(function (spec) {\n                    var iterator = this.iterator(spec.name, start, end);\n                    return {\n                        name: spec.name,\n                        value: spec.value,\n                        at: function (index) {\n                            return spec.property.fn.parse(iterator.at(index));\n                        }\n                    };\n                }, this);\n            },\n            forEach: function (start, end, callback) {\n                var iterators = this.iterators(start, end);\n                for (var index = start; index <= end; index++) {\n                    var values = {};\n                    for (var i = 0; i < iterators.length; i++) {\n                        var iterator = iterators[i];\n                        var value = iterator.at(index);\n                        if (value !== iterator.value) {\n                            values[iterator.name] = value;\n                        }\n                    }\n                    callback(values);\n                }\n            },\n            forEachProperty: function (callback) {\n                for (var name in this.properties) {\n                    callback(this.properties[name]);\n                }\n            }\n        });\n        kendo.spreadsheet.ALL_PROPERTIES = $.map(kendo.spreadsheet.PropertyBag.prototype.specs, function (spec) {\n            return spec.name;\n        });\n    }(window.kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/references', ['kendo.core'], f);\n}(function () {\n    'use strict';\n    if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n        return;\n    }\n    var spreadsheet = kendo.spreadsheet;\n    var Class = kendo.Class;\n    function columnName(colIndex) {\n        var letter = Math.floor(colIndex / 26) - 1;\n        return (letter >= 0 ? columnName(letter) : '') + String.fromCharCode(65 + colIndex % 26);\n    }\n    function displaySheet(sheet) {\n        if (/^[a-z0-9_]*$/i.test(sheet)) {\n            return sheet;\n        }\n        return '\\'' + sheet.replace(/\\x27/g, '\\\\\\'') + '\\'';\n    }\n    function displayRef(sheet, row, col, rel) {\n        var aa = '';\n        ++row;\n        if (!isFinite(row)) {\n            row = '';\n        } else if (rel != null && !(rel & 2)) {\n            row = '$' + row;\n        }\n        if (!isFinite(col)) {\n            col = '';\n        } else {\n            aa = columnName(col);\n            if (rel != null && !(rel & 1)) {\n                aa = '$' + aa;\n            }\n        }\n        if (sheet) {\n            return displaySheet(sheet) + '!' + aa + row;\n        } else {\n            return aa + row;\n        }\n    }\n    var Ref = Class.extend({\n        type: 'ref',\n        hasSheet: function () {\n            return this._hasSheet;\n        },\n        simplify: function () {\n            return this;\n        },\n        setSheet: function (sheet, hasSheet) {\n            this.sheet = sheet;\n            if (hasSheet != null) {\n                this._hasSheet = hasSheet;\n            }\n            return this;\n        },\n        absolute: function () {\n            return this;\n        },\n        relative: function () {\n            return this;\n        },\n        adjust: function () {\n            return this;\n        },\n        toString: function () {\n            return this.relative(0, 0, 3, 3).print(0, 0);\n        },\n        forEach: function (callback, obj) {\n            callback.call(obj, this);\n        },\n        map: function (callback, obj) {\n            return callback.call(obj, this);\n        },\n        intersects: function (ref) {\n            return this.intersect(ref) !== NULL;\n        },\n        isCell: function () {\n            return false;\n        },\n        toRow: function () {\n            return this;\n        },\n        toColumn: function () {\n            return this;\n        },\n        first: function () {\n            return this;\n        },\n        lastRange: function () {\n            return this;\n        },\n        size: function () {\n            return 1;\n        },\n        rangeAt: function () {\n            return this;\n        },\n        nextRangeIndex: function () {\n            return 0;\n        },\n        previousRangeIndex: function () {\n            return 0;\n        },\n        eq: function (reference) {\n            var r1 = this;\n            var r2 = reference;\n            if (r1 === NULL || r2 === NULL) {\n                return r1 === r2;\n            }\n            if (r2 instanceof CellRef || r2 instanceof RangeRef && !(r1 instanceof CellRef)) {\n                r1 = reference;\n                r2 = this;\n            }\n            if (r1 instanceof CellRef) {\n                r2 = r2.simplify();\n                return r2 instanceof CellRef && r1.row == r2.row && r1.col == r2.col && r1.sheet == r2.sheet;\n            } else if (r1 instanceof RangeRef) {\n                if (r2 instanceof RangeRef) {\n                    return r2.topLeft.eq(r1.topLeft) && r2.bottomRight.eq(r1.bottomRight);\n                }\n                if (r2 instanceof UnionRef) {\n                    return r2.single() && r1.eq(r2.refs[0]);\n                }\n            } else if (r1 instanceof UnionRef && r2 instanceof UnionRef) {\n                var refs1 = r1.refs;\n                var refs2 = r2.refs;\n                if (refs1.length != refs2.length) {\n                    return false;\n                }\n                for (var i = 0, len = refs1.length; i < len; i++) {\n                    if (!refs1[i].eq(refs2[i])) {\n                        return false;\n                    }\n                }\n                return true;\n            }\n            return r1 === r2;\n        },\n        concat: function (ref) {\n            return new UnionRef([\n                this,\n                ref\n            ]);\n        },\n        replaceAt: function (index, ref) {\n            return ref;\n        },\n        forEachColumnIndex: function (callback) {\n            this.forEachAxisIndex('col', callback);\n        },\n        forEachRowIndex: function (callback) {\n            this.forEachAxisIndex('row', callback);\n        },\n        forEachAxisIndex: function (axis, callback) {\n            var sorted = [];\n            var method = axis === 'row' ? 'forEachRow' : 'forEachColumn';\n            this[method](function (ref) {\n                var index = ref.first()[axis];\n                if (sorted.indexOf(index) === -1) {\n                    sorted.push(index);\n                }\n            });\n            sorted.sort(function (a, b) {\n                return a > b ? 1 : a < b ? -1 : 0;\n            }).forEach(callback);\n        },\n        valid: function () {\n            return false;\n        }\n    });\n    Ref.display = displayRef;\n    var NULL = new (Ref.extend({\n        init: function NullRef() {\n        },\n        print: function () {\n            return '#NULL!';\n        },\n        clone: function () {\n            return this;\n        },\n        eq: function (ref) {\n            return ref === this;\n        },\n        forEach: function () {\n        }\n    }))();\n    var NameRef = Ref.extend({\n        ref: 'name',\n        init: function NameRef(name) {\n            this.name = name;\n        },\n        print: function () {\n            var ret = displaySheet(this.name);\n            if (this.hasSheet()) {\n                ret = displaySheet(this.sheet) + '!' + ret;\n            }\n            return ret;\n        }\n    });\n    var CellRef = Ref.extend({\n        ref: 'cell',\n        init: function CellRef(row, col, rel) {\n            this.row = row;\n            this.col = col;\n            this.rel = rel || 0;\n        },\n        clone: function () {\n            return new CellRef(this.row, this.col, this.rel).setSheet(this.sheet, this.hasSheet());\n        },\n        intersect: function (ref) {\n            if (ref instanceof CellRef) {\n                if (this.eq(ref)) {\n                    return this;\n                } else {\n                    return NULL;\n                }\n            }\n            return ref.intersect(this);\n        },\n        print: function (trow, tcol) {\n            var col = this.col, row = this.row, rel = this.rel, abs;\n            if (trow == null) {\n                if (isFinite(col)) {\n                    col = rel & 1 ? 'C[' + col + ']' : 'C' + (col + 1);\n                } else {\n                    col = '';\n                }\n                if (isFinite(row)) {\n                    row = rel & 2 ? 'R[' + row + ']' : 'R' + (row + 1);\n                } else {\n                    row = '';\n                }\n                return row + col;\n            } else {\n                abs = this.absolute(trow, tcol);\n                return abs.valid() ? displayRef(this._hasSheet && this.sheet, abs.row, abs.col, rel) : '#REF!';\n            }\n        },\n        absolute: function (arow, acol) {\n            var ret = this.clone();\n            if (ret.rel & 3 === 0) {\n                return ret;\n            }\n            if (ret.rel & 1) {\n                ret.col += acol;\n            }\n            if (ret.rel & 2) {\n                ret.row += arow;\n            }\n            ret.rel = 0;\n            return ret;\n        },\n        toRangeRef: function () {\n            return new RangeRef(this, this);\n        },\n        relative: function (arow, acol, rel) {\n            if (rel == null) {\n                rel = this.rel;\n            }\n            var row = rel & 2 ? this.row - arow : this.row;\n            var col = rel & 1 ? this.col - acol : this.col;\n            return new CellRef(row, col, rel).setSheet(this.sheet, this.hasSheet());\n        },\n        height: function () {\n            return 1;\n        },\n        width: function () {\n            return 1;\n        },\n        toString: function () {\n            return displayRef(null, this.row, this.col, 3);\n        },\n        isCell: function () {\n            return true;\n        },\n        leftColumn: function () {\n            return this;\n        },\n        rightColumn: function () {\n            return this;\n        },\n        topRow: function () {\n            return this;\n        },\n        bottomRow: function () {\n            return this;\n        },\n        forEachRow: function (callback) {\n            callback(this.toRangeRef());\n        },\n        forEachColumn: function (callback) {\n            callback(this.toRangeRef());\n        },\n        adjust: function (row, col, trow, tcol, forRow, start, delta) {\n            var ref = this.absolute(row, col);\n            if (forRow) {\n                if (ref.row >= start) {\n                    if (delta < 0 && ref.row < start - delta) {\n                        return NULL;\n                    }\n                    ref.row += delta;\n                }\n            } else {\n                if (ref.col >= start) {\n                    if (delta < 0 && ref.col < start - delta) {\n                        return NULL;\n                    }\n                    ref.col += delta;\n                }\n            }\n            if (trow != null && tcol != null) {\n                ref = ref.relative(trow, tcol, this.rel);\n            }\n            return ref;\n        },\n        valid: function () {\n            if (this.rel) {\n                throw new Error('valid() called on relative reference');\n            }\n            var col = this.col, row = this.row;\n            return !(isFinite(col) && col < 0 || isFinite(row) && row < 0);\n        }\n    });\n    var RangeRef = Ref.extend({\n        ref: 'range',\n        init: function RangeRef(tl, br) {\n            if (tl._hasSheet && br._hasSheet && tl.sheet.toLowerCase() != br.sheet.toLowerCase()) {\n                this.endSheet = br.sheet;\n            }\n            this.topLeft = new CellRef(tl.row, tl.col, tl.rel);\n            this.bottomRight = new CellRef(br.row, br.col, br.rel);\n            this.normalize();\n        },\n        clone: function () {\n            return new RangeRef(this.topLeft.clone(), this.bottomRight.clone()).setSheet(this.sheet, this.hasSheet());\n        },\n        _containsRange: function (range) {\n            return this._containsCell(range.topLeft) && this._containsCell(range.bottomRight);\n        },\n        _containsCell: function (cell) {\n            return cell.sheet == this.sheet && cell.row >= this.topLeft.row && cell.col >= this.topLeft.col && cell.row <= this.bottomRight.row && cell.col <= this.bottomRight.col;\n        },\n        contains: function (ref) {\n            if (ref instanceof Array) {\n                var that = this;\n                return ref.some(function (_ref) {\n                    return that.contains(_ref);\n                });\n            }\n            if (ref instanceof CellRef) {\n                return this._containsCell(ref);\n            }\n            if (ref instanceof RangeRef) {\n                return this._containsRange(ref);\n            }\n            return false;\n        },\n        _intersectRange: function (ref) {\n            if (this.sheet != ref.sheet) {\n                return NULL;\n            }\n            var a_left = this.topLeft.col;\n            var a_top = this.topLeft.row;\n            var a_right = this.bottomRight.col;\n            var a_bottom = this.bottomRight.row;\n            var b_left = ref.topLeft.col;\n            var b_top = ref.topLeft.row;\n            var b_right = ref.bottomRight.col;\n            var b_bottom = ref.bottomRight.row;\n            if (a_left <= b_right && b_left <= a_right && a_top <= b_bottom && b_top <= a_bottom) {\n                return new RangeRef(new CellRef(Math.max(a_top, b_top), Math.max(a_left, b_left)), new CellRef(Math.min(a_bottom, b_bottom), Math.min(a_right, b_right))).setSheet(this.sheet, this.hasSheet());\n            } else {\n                return NULL;\n            }\n        },\n        intersect: function (ref) {\n            if (ref === NULL) {\n                return ref;\n            }\n            if (ref instanceof CellRef) {\n                return this._containsCell(ref) ? ref : NULL;\n            }\n            if (ref instanceof RangeRef) {\n                return this._intersectRange(ref).simplify();\n            }\n            if (ref instanceof UnionRef) {\n                return ref.intersect(this);\n            }\n            throw new Error('Unknown reference');\n        },\n        simplify: function () {\n            if (this.isCell()) {\n                return new CellRef(this.topLeft.row, this.topLeft.col, this.topLeft.rel).setSheet(this.sheet, this.hasSheet());\n            }\n            return this;\n        },\n        normalize: function () {\n            var a = this.topLeft, b = this.bottomRight;\n            var r1 = a.row, c1 = a.col, r2 = b.row, c2 = b.col;\n            var rr1 = a.rel & 2, rc1 = a.rel & 1;\n            var rr2 = b.rel & 2, rc2 = b.rel & 1;\n            var tmp, changes = false;\n            if (r1 > r2) {\n                changes = true;\n                tmp = r1;\n                r1 = r2;\n                r2 = tmp;\n                tmp = rr1;\n                rr1 = rr2;\n                rr2 = tmp;\n            }\n            if (c1 > c2) {\n                changes = true;\n                tmp = c1;\n                c1 = c2;\n                c2 = tmp;\n                tmp = rc1;\n                rc1 = rc2;\n                rc2 = tmp;\n            }\n            if (changes) {\n                this.topLeft = new CellRef(r1, c1, rc1 | rr1);\n                this.bottomRight = new CellRef(r2, c2, rc2 | rr2);\n            }\n            return this;\n        },\n        print: function (trow, tcol) {\n            var abs = this.absolute(trow, tcol);\n            if (abs.valid()) {\n                var ret = this.topLeft.print(trow, tcol) + ':' + this.bottomRight.print(trow, tcol);\n                if (this.hasSheet()) {\n                    ret = displaySheet(this.sheet) + (this.endSheet ? ':' + displaySheet(this.endSheet) : '') + '!' + ret;\n                }\n                return ret;\n            }\n            return '#REF!';\n        },\n        absolute: function (arow, acol) {\n            return new RangeRef(this.topLeft.absolute(arow, acol), this.bottomRight.absolute(arow, acol)).setSheet(this.sheet, this.hasSheet());\n        },\n        relative: function (arow, acol, relTL, relBR) {\n            if (relBR == null) {\n                relBR = relTL;\n            }\n            return new RangeRef(this.topLeft.relative(arow, acol, relTL), this.bottomRight.relative(arow, acol, relBR)).setSheet(this.sheet, this.hasSheet());\n        },\n        height: function () {\n            if (this.topLeft.rel != this.bottomRight.rel) {\n                throw new Error('Mixed relative/absolute references');\n            }\n            return this.bottomRight.row - this.topLeft.row + 1;\n        },\n        width: function () {\n            if (this.topLeft.rel != this.bottomRight.rel) {\n                throw new Error('Mixed relative/absolute references');\n            }\n            return this.bottomRight.col - this.topLeft.col + 1;\n        },\n        collapse: function () {\n            return this.topLeft.toRangeRef();\n        },\n        leftColumn: function () {\n            return new RangeRef(this.topLeft, new CellRef(this.bottomRight.row, this.topLeft.col));\n        },\n        rightColumn: function () {\n            return new RangeRef(new CellRef(this.topLeft.row, this.bottomRight.col), this.bottomRight);\n        },\n        topRow: function () {\n            return new RangeRef(this.topLeft, new CellRef(this.topLeft.row, this.bottomRight.col));\n        },\n        bottomRow: function () {\n            return new RangeRef(new CellRef(this.bottomRight.row, this.topLeft.col), this.bottomRight);\n        },\n        toRangeRef: function () {\n            return this;\n        },\n        toRow: function (row) {\n            return new RangeRef(new CellRef(this.topLeft.row + row, this.topLeft.col), new CellRef(this.topLeft.row + row, this.bottomRight.col));\n        },\n        toColumn: function (col) {\n            return new RangeRef(new CellRef(this.topLeft.row, this.topLeft.col + col), new CellRef(this.bottomRight.row, this.topLeft.col + col));\n        },\n        forEachRow: function (callback) {\n            var startRow = this.topLeft.row;\n            var endRow = this.bottomRight.row;\n            var startCol = this.topLeft.col;\n            var endCol = this.bottomRight.col;\n            for (var i = startRow; i <= endRow; i++) {\n                callback(new RangeRef(new CellRef(i, startCol), new CellRef(i, endCol)));\n            }\n        },\n        forEachColumn: function (callback) {\n            var startRow = this.topLeft.row;\n            var endRow = this.bottomRight.row;\n            var startCol = this.topLeft.col;\n            var endCol = this.bottomRight.col;\n            for (var i = startCol; i <= endCol; i++) {\n                callback(new RangeRef(new CellRef(startRow, i), new CellRef(endRow, i)));\n            }\n        },\n        intersecting: function (refs) {\n            return refs.filter(function (ref) {\n                return ref.toRangeRef().intersects(this);\n            }, this);\n        },\n        union: function (refs, callback) {\n            var intersecting = this.intersecting(refs);\n            var topLeftRow = this.topLeft.row;\n            var topLeftCol = this.topLeft.col;\n            var bottomRightRow = this.bottomRight.row;\n            var bottomRightCol = this.bottomRight.col;\n            var modified = false;\n            intersecting.forEach(function (ref) {\n                ref = ref.toRangeRef();\n                if (ref.topLeft.row < topLeftRow) {\n                    modified = true;\n                    topLeftRow = ref.topLeft.row;\n                }\n                if (ref.topLeft.col < topLeftCol) {\n                    modified = true;\n                    topLeftCol = ref.topLeft.col;\n                }\n                if (ref.bottomRight.row > bottomRightRow) {\n                    modified = true;\n                    bottomRightRow = ref.bottomRight.row;\n                }\n                if (ref.bottomRight.col > bottomRightCol) {\n                    modified = true;\n                    bottomRightCol = ref.bottomRight.col;\n                }\n                if (callback) {\n                    callback(ref);\n                }\n            });\n            var result = new RangeRef(new CellRef(topLeftRow, topLeftCol), new CellRef(bottomRightRow, bottomRightCol));\n            if (modified) {\n                return result.union(refs, callback);\n            } else {\n                return result;\n            }\n        },\n        resize: function (options) {\n            var limit = Math.max.bind(Math, 0);\n            function num(value) {\n                return value || 0;\n            }\n            var top = this.topLeft.row + num(options.top);\n            var left = this.topLeft.col + num(options.left);\n            var bottom = this.bottomRight.row + num(options.bottom);\n            var right = this.bottomRight.col + num(options.right);\n            if (left < 0 && right < 0 || top < 0 && bottom < 0) {\n                return NULL;\n            } else if (top <= bottom && left <= right) {\n                return new RangeRef(new CellRef(limit(top), limit(left)), new CellRef(limit(bottom), limit(right)));\n            } else {\n                return NULL;\n            }\n        },\n        move: function (rows, cols) {\n            return new RangeRef(new CellRef(this.topLeft.row + rows, this.topLeft.col + cols), new CellRef(this.bottomRight.row + rows, this.bottomRight.col + cols));\n        },\n        first: function () {\n            return this.topLeft;\n        },\n        isCell: function () {\n            return !this.endSheet && this.topLeft.eq(this.bottomRight);\n        },\n        toString: function () {\n            return this.topLeft + ':' + this.bottomRight;\n        },\n        adjust: function (row, col, trow, tcol, forRow, start, delta) {\n            var tl = this.topLeft.adjust(row, col, trow, tcol, forRow, start, delta);\n            var tr = this.bottomRight.adjust(row, col, trow, tcol, forRow, start, delta);\n            if (tl === NULL && tr === NULL) {\n                return NULL;\n            }\n            if (tl === NULL) {\n                tl = this.topLeft.absolute(row, col);\n                if (forRow) {\n                    tl.row = start;\n                } else {\n                    tl.col = start;\n                }\n                if (trow != null && tcol != null) {\n                    tl = tl.relative(trow, tcol, this.topLeft.rel);\n                }\n            } else if (tr === NULL) {\n                tr = this.bottomRight.absolute(row, col);\n                if (forRow) {\n                    tr.row = start - 1;\n                } else {\n                    tr.col = start - 1;\n                }\n                if (trow != null && tcol != null) {\n                    tr = tr.relative(trow, tcol, this.bottomRight.rel);\n                }\n            }\n            return new RangeRef(tl, tr).setSheet(this.sheet, this.hasSheet()).simplify();\n        },\n        valid: function () {\n            return this.topLeft.valid() && this.bottomRight.valid();\n        }\n    });\n    var UnionRef = Ref.extend({\n        init: function UnionRef(refs) {\n            this.refs = refs;\n            this.length = this.refs.length;\n        },\n        intersect: function (ref) {\n            var a = [];\n            for (var i = 0; i < this.length; ++i) {\n                var x = ref.intersect(this.refs[i]);\n                if (x !== NULL) {\n                    a.push(x);\n                }\n            }\n            if (a.length > 0) {\n                return new UnionRef(a).simplify();\n            }\n            return NULL;\n        },\n        simplify: function () {\n            var u = new UnionRef(this.refs.reduce(function (a, ref) {\n                ref = ref.simplify();\n                if (ref !== NULL) {\n                    a.push(ref);\n                }\n                return a;\n            }, []));\n            if (u.empty()) {\n                return NULL;\n            }\n            if (u.single()) {\n                return u.refs[0];\n            }\n            return u;\n        },\n        absolute: function (arow, acol) {\n            return new UnionRef(this.refs.map(function (ref) {\n                return ref.absolute(arow, acol);\n            }));\n        },\n        forEach: function (callback, obj) {\n            this.refs.forEach(callback, obj);\n        },\n        toRangeRef: function () {\n            return this.refs[0].toRangeRef();\n        },\n        contains: function (theRef) {\n            return this.refs.some(function (ref) {\n                return ref.contains(theRef);\n            });\n        },\n        map: function (callback, obj) {\n            return new UnionRef(this.refs.map(callback, obj));\n        },\n        first: function () {\n            return this.refs[0].first();\n        },\n        lastRange: function () {\n            return this.refs[this.length - 1];\n        },\n        size: function () {\n            return this.length;\n        },\n        single: function () {\n            return this.length == 1;\n        },\n        empty: function () {\n            return this.length === 0;\n        },\n        isCell: function () {\n            return this.single() && this.refs[0].isCell();\n        },\n        rangeAt: function (index) {\n            return this.refs[index];\n        },\n        nextRangeIndex: function (index) {\n            if (index === this.length - 1) {\n                return 0;\n            } else {\n                return index + 1;\n            }\n        },\n        previousRangeIndex: function (index) {\n            if (index === 0) {\n                return this.length - 1;\n            } else {\n                return index - 1;\n            }\n        },\n        concat: function (ref) {\n            return new UnionRef(this.refs.concat([ref]));\n        },\n        print: function (row, col) {\n            return this.refs.map(function (ref) {\n                return ref.print(row, col);\n            }).join(',');\n        },\n        replaceAt: function (index, ref) {\n            var newRefs = this.refs.slice();\n            newRefs.splice(index, 1, ref);\n            return new UnionRef(newRefs);\n        },\n        leftColumn: function () {\n            return this.map(function (ref) {\n                return ref.leftColumn();\n            });\n        },\n        rightColumn: function () {\n            return this.map(function (ref) {\n                return ref.rightColumn();\n            });\n        },\n        topRow: function () {\n            return this.map(function (ref) {\n                return ref.topRow();\n            });\n        },\n        bottomRow: function () {\n            return this.map(function (ref) {\n                return ref.bottomRow();\n            });\n        },\n        forEachRow: function (callback) {\n            this.forEach(function (ref) {\n                ref.forEachRow(callback);\n            });\n        },\n        forEachColumn: function (callback) {\n            this.forEach(function (ref) {\n                ref.forEachColumn(callback);\n            });\n        },\n        adjust: function (row, col, trow, tcol, forRow, start, delta) {\n            return this.map(function (ref) {\n                return ref.adjust(row, col, trow, tcol, forRow, start, delta);\n            }).simplify();\n        },\n        toString: function () {\n            return this.refs.map(function (ref) {\n                return ref.toString();\n            }).join(', ');\n        },\n        valid: function () {\n            for (var i = this.refs.length; --i >= 0;) {\n                if (this.refs[i].valid()) {\n                    return false;\n                }\n            }\n            return true;\n        }\n    });\n    spreadsheet.NULLREF = NULL;\n    spreadsheet.SHEETREF = new RangeRef(new CellRef(0, 0), new CellRef(Infinity, Infinity));\n    spreadsheet.FIRSTREF = new CellRef(0, 0);\n    spreadsheet.Ref = Ref;\n    spreadsheet.NameRef = NameRef;\n    spreadsheet.CellRef = CellRef;\n    spreadsheet.RangeRef = RangeRef;\n    spreadsheet.UnionRef = UnionRef;\n    spreadsheet.SHEETREF.print = function () {\n        return '#SHEET';\n    };\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/autofillcalculator', ['kendo.core'], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var RangeRef = kendo.spreadsheet.RangeRef;\n        var CellRef = kendo.spreadsheet.CellRef;\n        var AutoFillCalculator = kendo.Class.extend({\n            init: function (grid) {\n                this._grid = grid;\n            },\n            rectIsVertical: function (start, end, x, y) {\n                var startRect = this._grid.rectangle(start.toRangeRef());\n                var endRect = this._grid.rectangle(end.toRangeRef());\n                return Math.abs(endRect[y] - startRect[y]) > Math.abs(startRect[x] - endRect[x]);\n            },\n            autoFillDest: function (selection, cursor) {\n                var topLeft = selection.topLeft;\n                var bottomRight = selection.bottomRight;\n                var quadrant;\n                var lower = cursor.row >= topLeft.row;\n                var further = cursor.col >= topLeft.col;\n                if (lower) {\n                    quadrant = further ? 4 : 3;\n                } else {\n                    quadrant = further ? 2 : 1;\n                }\n                var pivot, opposite, cornerResult, expanding;\n                if (quadrant === 4) {\n                    pivot = topLeft;\n                    opposite = bottomRight;\n                    expanding = cursor.row > opposite.row || cursor.col > opposite.col;\n                    if (expanding) {\n                        cursor = new CellRef(Math.max(cursor.row, opposite.row), Math.max(cursor.col, opposite.col));\n                    }\n                    if (this.rectIsVertical(opposite, cursor, 'right', 'bottom')) {\n                        cornerResult = new CellRef(cursor.row, opposite.col);\n                    } else {\n                        cornerResult = new CellRef(opposite.row, cursor.col);\n                    }\n                } else if (quadrant === 3) {\n                    var bottomLeft = new CellRef(topLeft.col, bottomRight.row);\n                    if (cursor.row > bottomRight.row && this.rectIsVertical(bottomLeft, cursor, 'left', 'bottom')) {\n                        pivot = topLeft;\n                        cornerResult = new CellRef(cursor.row, bottomRight.col);\n                    } else {\n                        pivot = bottomRight;\n                        cornerResult = new CellRef(topLeft.row, cursor.col);\n                    }\n                } else if (quadrant === 2) {\n                    var topRight = new CellRef(topLeft.row, bottomRight.col);\n                    if (cursor.col > bottomRight.col && !this.rectIsVertical(topRight, cursor, 'right', 'top')) {\n                        pivot = topLeft;\n                        cornerResult = new CellRef(bottomRight.row, cursor.col);\n                    } else {\n                        pivot = bottomRight;\n                        cornerResult = new CellRef(cursor.row, topLeft.col);\n                    }\n                } else {\n                    pivot = bottomRight;\n                    if (this.rectIsVertical(topLeft, cursor, 'left', 'top')) {\n                        cornerResult = new CellRef(cursor.row, topLeft.col);\n                    } else {\n                        cornerResult = new CellRef(topLeft.row, cursor.col);\n                    }\n                }\n                return this._grid.normalize(new RangeRef(pivot, cornerResult));\n            }\n        });\n        kendo.spreadsheet.AutoFillCalculator = AutoFillCalculator;\n    }(kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/navigator', [\n        'kendo.core',\n        'spreadsheet/autofillcalculator'\n    ], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var RangeRef = kendo.spreadsheet.RangeRef;\n        var CellRef = kendo.spreadsheet.CellRef;\n        var EdgeNavigator = kendo.Class.extend({\n            init: function (field, axis, rangeGetter, union) {\n                this.rangeGetter = rangeGetter;\n                this.prevLeft = function (index) {\n                    var current = union(this.range(index));\n                    var range = this.range(axis.prevVisible(current.topLeft[field]));\n                    return union(range).topLeft[field];\n                };\n                this.nextRight = function (index) {\n                    var current = union(this.range(index));\n                    var range = this.range(axis.nextVisible(current.bottomRight[field]));\n                    return union(range).bottomRight[field];\n                };\n                this.nextLeft = function (index) {\n                    var range = union(this.range(index));\n                    return axis.nextVisible(range.bottomRight[field]);\n                };\n                this.prevRight = function (index) {\n                    var range = union(this.range(index));\n                    return axis.prevVisible(range.topLeft[field]);\n                };\n            },\n            boundary: function (top, bottom) {\n                this.top = top;\n                this.bottom = bottom;\n            },\n            range: function (index) {\n                return this.rangeGetter(index, this.top, this.bottom);\n            }\n        });\n        var SheetNavigator = kendo.Class.extend({\n            init: function (sheet) {\n                this._sheet = sheet;\n                this.columns = this._sheet._grid._columns;\n                this.autoFillCalculator = new kendo.spreadsheet.AutoFillCalculator(sheet._grid);\n                this.colEdge = new EdgeNavigator('col', this._sheet._grid._columns, this.columnRange.bind(this), this.union.bind(this));\n                this.rowEdge = new EdgeNavigator('row', this._sheet._grid._rows, this.rowRange.bind(this), this.union.bind(this));\n            },\n            height: function (height) {\n                this._viewPortHeight = height;\n            },\n            union: function (ref) {\n                return this._sheet.unionWithMerged(ref);\n            },\n            columnRange: function (col, topRow, bottomRow) {\n                return this._sheet._ref(topRow, col, bottomRow - topRow, 1);\n            },\n            rowRange: function (row, leftCol, rightCol) {\n                return this._sheet._ref(row, leftCol, 1, rightCol - leftCol);\n            },\n            selectionIncludesMergedCells: function () {\n                return this._sheet.select().contains(this._sheet._mergedCells);\n            },\n            setSelectionValue: function (value) {\n                var selection = this._sheet.selection();\n                setTimeout(function () {\n                    selection.value(value());\n                });\n            },\n            selectAll: function () {\n                this._sheet.select(this._sheet._sheetRef);\n            },\n            select: function (ref, mode, addToExisting) {\n                ref = this.refForMode(ref, mode);\n                if (addToExisting) {\n                    ref = this._sheet.select().concat(ref);\n                }\n                this._sheet.select(ref);\n            },\n            refForMode: function (ref, mode) {\n                var grid = this._sheet._grid;\n                switch (mode) {\n                case 'range':\n                    ref = grid.normalize(ref);\n                    break;\n                case 'row':\n                    ref = grid.rowRef(ref.row);\n                    break;\n                case 'column':\n                    ref = grid.colRef(ref.col);\n                    break;\n                case 'sheet':\n                    ref = this._sheet._sheetRef;\n                    break;\n                }\n                return ref;\n            },\n            startSelection: function (ref, mode, addToExisting) {\n                if (mode == 'autofill') {\n                    this._sheet.startAutoFill();\n                } else {\n                    this._sheet.startSelection();\n                    this.select(ref, mode, addToExisting);\n                }\n            },\n            completeSelection: function () {\n                this._sheet.completeSelection();\n            },\n            selectForContextMenu: function (ref, mode) {\n                var sheet = this._sheet;\n                if (!sheet.select().contains(this.refForMode(ref, mode))) {\n                    this.select(ref, mode);\n                }\n            },\n            modifySelection: function (action) {\n                var direction = this.determineDirection(action);\n                var sheet = this._sheet;\n                var viewPortHeight = this._viewPortHeight;\n                var rows = sheet._grid._rows;\n                var columns = sheet._grid._columns;\n                var originalSelection = sheet.currentOriginalSelectionRange();\n                var selection = sheet.select().toRangeRef();\n                var activeCell = sheet.activeCell();\n                var topLeft = originalSelection.topLeft.clone();\n                var bottomRight = originalSelection.bottomRight.clone();\n                var scrollInto;\n                this.colEdge.boundary(selection.topLeft.row, selection.bottomRight.row);\n                this.rowEdge.boundary(selection.topLeft.col, selection.bottomRight.col);\n                switch (direction) {\n                case 'expand-left':\n                    topLeft.col = this.colEdge.prevLeft(topLeft.col);\n                    scrollInto = topLeft;\n                    break;\n                case 'shrink-right':\n                    topLeft.col = this.colEdge.nextLeft(topLeft.col);\n                    scrollInto = topLeft;\n                    break;\n                case 'expand-right':\n                    bottomRight.col = this.colEdge.nextRight(bottomRight.col);\n                    scrollInto = bottomRight;\n                    break;\n                case 'shrink-left':\n                    bottomRight.col = this.colEdge.prevRight(bottomRight.col);\n                    scrollInto = bottomRight;\n                    break;\n                case 'expand-up':\n                    topLeft.row = this.rowEdge.prevLeft(topLeft.row);\n                    scrollInto = topLeft;\n                    break;\n                case 'shrink-down':\n                    topLeft.row = this.rowEdge.nextLeft(topLeft.row);\n                    scrollInto = topLeft;\n                    break;\n                case 'expand-down':\n                    bottomRight.row = this.rowEdge.nextRight(bottomRight.row);\n                    scrollInto = bottomRight;\n                    break;\n                case 'shrink-up':\n                    bottomRight.row = this.rowEdge.prevRight(bottomRight.row);\n                    scrollInto = bottomRight;\n                    break;\n                case 'expand-page-up':\n                    topLeft.row = rows.prevPage(topLeft.row, viewPortHeight);\n                    break;\n                case 'shrink-page-up':\n                    bottomRight.row = rows.prevPage(bottomRight.row, viewPortHeight);\n                    break;\n                case 'expand-page-down':\n                    bottomRight.row = rows.nextPage(bottomRight.row, viewPortHeight);\n                    break;\n                case 'shrink-page-down':\n                    topLeft.row = rows.nextPage(topLeft.row, viewPortHeight);\n                    break;\n                case 'first-col':\n                    topLeft.col = columns.firstVisible();\n                    bottomRight.col = activeCell.bottomRight.col;\n                    scrollInto = topLeft;\n                    break;\n                case 'last-col':\n                    bottomRight.col = columns.lastVisible();\n                    topLeft.col = activeCell.topLeft.col;\n                    scrollInto = bottomRight;\n                    break;\n                case 'first-row':\n                    topLeft.row = rows.firstVisible();\n                    bottomRight.row = activeCell.bottomRight.row;\n                    scrollInto = topLeft;\n                    break;\n                case 'last-row':\n                    bottomRight.row = rows.lastVisible();\n                    topLeft.row = activeCell.topLeft.row;\n                    scrollInto = bottomRight;\n                    break;\n                case 'last':\n                    bottomRight.row = rows.lastVisible();\n                    bottomRight.col = columns.lastVisible();\n                    topLeft = activeCell.topLeft;\n                    scrollInto = bottomRight;\n                    break;\n                case 'first':\n                    topLeft.row = rows.firstVisible();\n                    topLeft.col = columns.firstVisible();\n                    bottomRight = activeCell.bottomRight;\n                    scrollInto = topLeft;\n                    break;\n                }\n                var newSelection = new RangeRef(topLeft, bottomRight);\n                if (!this.union(newSelection).intersects(activeCell)) {\n                    this.modifySelection(direction.replace('shrink', 'expand'));\n                    return;\n                }\n                if (scrollInto) {\n                    sheet.focus(scrollInto);\n                }\n                this.updateCurrentSelectionRange(newSelection);\n            },\n            moveActiveCell: function (direction) {\n                var sheet = this._sheet;\n                var activeCell = sheet.activeCell();\n                var topLeft = activeCell.topLeft;\n                var bottomRight = activeCell.bottomRight;\n                var cell = sheet.originalActiveCell();\n                var rows = sheet._grid._rows;\n                var columns = sheet._grid._columns;\n                var row = cell.row;\n                var column = cell.col;\n                switch (direction) {\n                case 'left':\n                    column = columns.prevVisible(topLeft.col);\n                    break;\n                case 'up':\n                    row = rows.prevVisible(topLeft.row);\n                    break;\n                case 'right':\n                    column = columns.nextVisible(bottomRight.col);\n                    break;\n                case 'down':\n                    row = rows.nextVisible(bottomRight.row);\n                    break;\n                case 'first-col':\n                    column = columns.firstVisible();\n                    break;\n                case 'last-col':\n                    column = columns.lastVisible();\n                    break;\n                case 'first-row':\n                    row = rows.firstVisible();\n                    break;\n                case 'last-row':\n                    row = rows.lastVisible();\n                    break;\n                case 'last':\n                    row = rows.lastVisible();\n                    column = columns.lastVisible();\n                    break;\n                case 'first':\n                    row = rows.firstVisible();\n                    column = columns.firstVisible();\n                    break;\n                case 'next-page':\n                    row = rows.nextPage(bottomRight.row, this._viewPortHeight);\n                    break;\n                case 'prev-page':\n                    row = rows.prevPage(bottomRight.row, this._viewPortHeight);\n                    break;\n                }\n                sheet.select(new CellRef(row, column));\n            },\n            navigateInSelection: function (direction) {\n                var sheet = this._sheet;\n                var activeCell = sheet.activeCell();\n                var topLeft = activeCell.topLeft;\n                var cell = sheet.originalActiveCell();\n                var rows = sheet._grid._rows;\n                var columns = sheet._grid._columns;\n                var row = cell.row;\n                var column = cell.col;\n                var selection = sheet.currentNavigationRange();\n                var selTopLeft = selection.topLeft;\n                var selBottomRight = selection.bottomRight;\n                var done = false;\n                var topLeftCol = topLeft.col;\n                var topLeftRow = topLeft.row;\n                while (!done) {\n                    var current = new CellRef(row, column);\n                    switch (direction) {\n                    case 'next':\n                        if (selBottomRight.eq(current)) {\n                            selection = sheet.nextNavigationRange();\n                            row = selection.topLeft.row;\n                            column = selection.topLeft.col;\n                        } else {\n                            column = columns.nextVisible(topLeftCol, true);\n                            if (column > selBottomRight.col) {\n                                column = selTopLeft.col;\n                                row = rows.nextVisible(row, true);\n                            }\n                        }\n                        break;\n                    case 'previous':\n                        if (selTopLeft.eq(current)) {\n                            selection = sheet.previousNavigationRange();\n                            row = selection.bottomRight.row;\n                            column = selection.bottomRight.col;\n                        } else {\n                            column = columns.prevVisible(topLeftCol, true);\n                            if (column < selTopLeft.col) {\n                                column = selBottomRight.col;\n                                row = rows.prevVisible(row, true);\n                            }\n                        }\n                        break;\n                    case 'lower':\n                        if (selBottomRight.eq(current)) {\n                            selection = sheet.nextNavigationRange();\n                            row = selection.topLeft.row;\n                            column = selection.topLeft.col;\n                        } else {\n                            row = rows.nextVisible(topLeftRow, true);\n                            if (row > selBottomRight.row) {\n                                row = selTopLeft.row;\n                                column = columns.nextVisible(column, true);\n                            }\n                        }\n                        break;\n                    case 'upper':\n                        if (selTopLeft.eq(current)) {\n                            selection = sheet.previousNavigationRange();\n                            row = selection.bottomRight.row;\n                            column = selection.bottomRight.col;\n                        } else {\n                            row = rows.prevVisible(topLeftRow, true);\n                            if (row < selTopLeft.row) {\n                                row = selBottomRight.row;\n                                column = columns.prevVisible(column, true);\n                            }\n                        }\n                        break;\n                    default:\n                        throw new Error('Unknown entry navigation: ' + direction);\n                    }\n                    done = !this.shouldSkip(row, column);\n                    topLeftCol = column;\n                    topLeftRow = row;\n                }\n                if (sheet.singleCellSelection()) {\n                    sheet.select(new CellRef(row, column));\n                } else {\n                    sheet.activeCell(new CellRef(row, column));\n                }\n            },\n            extendSelection: function (ref, mode) {\n                var sheet = this._sheet;\n                var grid = sheet._grid;\n                if (mode === 'autofill') {\n                    this.resizeAutoFill(ref);\n                    return;\n                }\n                if (mode === 'range') {\n                    ref = grid.normalize(ref);\n                } else if (mode === 'row') {\n                    ref = grid.rowRef(ref.row).bottomRight;\n                } else if (mode === 'column') {\n                    ref = grid.colRef(ref.col).bottomRight;\n                }\n                var activeCell = sheet.originalActiveCell().toRangeRef();\n                this.updateCurrentSelectionRange(new RangeRef(activeCell.topLeft, ref));\n            },\n            shouldSkip: function (row, col) {\n                var ref = new CellRef(row, col);\n                var isMerged = false;\n                this._sheet.forEachMergedCell(function (merged) {\n                    if (merged.intersects(ref) && !merged.collapse().eq(ref)) {\n                        isMerged = true;\n                    }\n                });\n                return isMerged;\n            },\n            resizeAutoFill: function (ref) {\n                var sheet = this._sheet;\n                var selection = sheet.select();\n                var origin = sheet._autoFillOrigin;\n                var dest = this.autoFillCalculator.autoFillDest(selection, ref);\n                var punch = this.punch(selection, dest);\n                var hint, direction, row;\n                if (!punch) {\n                    var preview = sheet.range(dest)._previewFillFrom(sheet.range(origin));\n                    if (preview) {\n                        direction = preview.direction;\n                        var props = preview.props;\n                        if (direction === 0 || direction == 1) {\n                            row = props[props.length - 1];\n                            hint = row[row.length - 1].value;\n                        } else if (direction === 2) {\n                            row = props[0];\n                            hint = row[row.length - 1].value;\n                        } else if (direction === 3) {\n                            row = props[props.length - 1];\n                            hint = row[0].value;\n                        }\n                    }\n                }\n                sheet.updateAutoFill(dest, punch, hint, direction);\n            },\n            determineDirection: function (action) {\n                var selection = this._sheet.currentSelectionRange();\n                var activeCell = this._sheet.activeCell();\n                var leftMode = activeCell.topLeft.col == selection.topLeft.col;\n                var rightMode = activeCell.bottomRight.col == selection.bottomRight.col;\n                var topMode = activeCell.topLeft.row == selection.topLeft.row;\n                var bottomMode = activeCell.bottomRight.row == selection.bottomRight.row;\n                switch (action) {\n                case 'left':\n                    action = rightMode ? 'expand-left' : 'shrink-left';\n                    break;\n                case 'right':\n                    action = leftMode ? 'expand-right' : 'shrink-right';\n                    break;\n                case 'up':\n                    action = bottomMode ? 'expand-up' : 'shrink-up';\n                    break;\n                case 'down':\n                    action = topMode ? 'expand-down' : 'shrink-down';\n                    break;\n                case 'prev-page':\n                    action = bottomMode ? 'expand-page-up' : 'shrink-page-up';\n                    break;\n                case 'next-page':\n                    action = topMode ? 'expand-page-down' : 'shrink-page-down';\n                    break;\n                }\n                return action;\n            },\n            updateCurrentSelectionRange: function (ref) {\n                var sheet = this._sheet;\n                sheet.select(sheet.originalSelect().replaceAt(sheet.selectionRangeIndex(), ref), false);\n            },\n            punch: function (selection, subset) {\n                var punch;\n                if (subset.topLeft.eq(selection.topLeft)) {\n                    if (subset.bottomRight.row < selection.bottomRight.row) {\n                        var bottomRow = this.rowEdge.nextRight(subset.bottomRight.row);\n                        punch = new RangeRef(new CellRef(bottomRow, selection.topLeft.col), selection.bottomRight);\n                    } else if (subset.bottomRight.col < selection.bottomRight.col) {\n                        var bottomCol = this.colEdge.nextRight(subset.bottomRight.col);\n                        punch = new RangeRef(new CellRef(selection.topLeft.row, bottomCol), selection.bottomRight);\n                    }\n                }\n                return punch;\n            }\n        });\n        kendo.spreadsheet.SheetNavigator = SheetNavigator;\n    }(kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/axismanager', ['kendo.core'], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var AxisManager = kendo.Class.extend({\n            init: function (sheet) {\n                this._sheet = sheet;\n            },\n            forEachSelectedColumn: function (callback) {\n                var sheet = this._sheet;\n                sheet.batch(function () {\n                    sheet.select().forEachColumnIndex(function (index, i) {\n                        callback(sheet, index, i);\n                    });\n                }, {\n                    layout: true,\n                    recalc: true\n                });\n            },\n            forEachSelectedRow: function (callback) {\n                var sheet = this._sheet;\n                sheet.batch(function () {\n                    sheet.select().forEachRowIndex(function (index, i) {\n                        callback(sheet, index, i);\n                    });\n                }, {\n                    layout: true,\n                    recalc: true\n                });\n            },\n            includesHiddenColumns: function (ref) {\n                return this._sheet._grid._columns.includesHidden(ref.topLeft.col, ref.bottomRight.col);\n            },\n            includesHiddenRows: function (ref) {\n                return this._sheet._grid._rows.includesHidden(ref.topLeft.row, ref.bottomRight.row);\n            },\n            selectionIncludesHiddenColumns: function () {\n                return this.includesHiddenColumns(this._sheet.select());\n            },\n            selectionIncludesHiddenRows: function () {\n                return this.includesHiddenRows(this._sheet.select());\n            },\n            deleteSelectedColumns: function () {\n                this.forEachSelectedColumn(function (sheet, index, i) {\n                    sheet.deleteColumn(index - i);\n                });\n            },\n            deleteSelectedRows: function () {\n                this.forEachSelectedRow(function (sheet, index, i) {\n                    sheet.deleteRow(index - i);\n                });\n            },\n            hideSelectedColumns: function () {\n                this.forEachSelectedColumn(function (sheet, index) {\n                    sheet.hideColumn(index);\n                });\n            },\n            hideSelectedRows: function () {\n                this.forEachSelectedRow(function (sheet, index) {\n                    sheet.hideRow(index);\n                });\n            },\n            unhideSelectedColumns: function () {\n                this.forEachSelectedColumn(function (sheet, index) {\n                    sheet.unhideColumn(index);\n                });\n            },\n            unhideSelectedRows: function () {\n                this.forEachSelectedRow(function (sheet, index) {\n                    sheet.unhideRow(index);\n                });\n            },\n            addColumnLeft: function () {\n                this.forEachSelectedColumn(function (sheet, index, i) {\n                    sheet.insertColumn(index - i);\n                });\n            },\n            addColumnRight: function () {\n                this.forEachSelectedColumn(function (sheet, index, i) {\n                    sheet.insertColumn(index + (i + 1));\n                });\n            },\n            canAddRow: function () {\n                var range = this._sheet.select().toRangeRef();\n                var rowCount = range.height();\n                return this._sheet.canInsertRow(0, rowCount);\n            },\n            addRowAbove: function () {\n                this.forEachSelectedRow(function (sheet, index, i) {\n                    sheet.insertRow(index - i);\n                });\n            },\n            addRowBelow: function () {\n                this.forEachSelectedRow(function (sheet, index, i) {\n                    sheet.insertRow(index + (i + 1));\n                });\n            }\n        });\n        kendo.spreadsheet.AxisManager = AxisManager;\n    }(kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/clipboard', ['kendo.core'], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var $ = kendo.jQuery;\n        var RangeRef = kendo.spreadsheet.RangeRef;\n        var CellRef = kendo.spreadsheet.CellRef;\n        var Clipboard = kendo.Class.extend({\n            init: function (workbook) {\n                this.workbook = workbook;\n                this.origin = kendo.spreadsheet.NULLREF;\n                this.iframe = document.createElement('iframe');\n                this.iframe.className = 'k-spreadsheet-clipboard-paste';\n                this.menuInvoked = true;\n                this._external = {};\n                this._uid = kendo.guid();\n                document.body.appendChild(this.iframe);\n            },\n            canCopy: function () {\n                var status = { canCopy: true };\n                var selection = this.workbook.activeSheet().select();\n                if (selection === kendo.spreadsheet.NULLREF) {\n                    status.canCopy = false;\n                }\n                if (selection instanceof kendo.spreadsheet.UnionRef) {\n                    status.canCopy = false;\n                    status.multiSelection = true;\n                }\n                if (this.menuInvoked) {\n                    status.canCopy = false;\n                    status.menuInvoked = true;\n                }\n                return status;\n            },\n            canPaste: function () {\n                var sheet = this.workbook.activeSheet();\n                var ref = this.pasteRef();\n                var status = { canPaste: true };\n                if (ref === kendo.spreadsheet.NULLREF) {\n                    var external = this._external.hasOwnProperty('html') || this._external.hasOwnProperty('plain');\n                    status.pasteOnMerged = this.intersectsMerged();\n                    status.canPaste = status.pasteOnMerged ? false : external;\n                    return status;\n                }\n                if (!ref.eq(sheet.unionWithMerged(ref))) {\n                    status.canPaste = false;\n                    status.pasteOnMerged = true;\n                }\n                if (this.menuInvoked) {\n                    status.canPaste = false;\n                    status.menuInvoked = true;\n                }\n                return status;\n            },\n            intersectsMerged: function () {\n                var sheet = this.workbook.activeSheet();\n                var state = this.parse(this._external);\n                this.origin = this.stateRangeRef(state);\n                var ref = this.pasteRef();\n                return !ref.eq(sheet.unionWithMerged(ref));\n            },\n            copy: function () {\n                var sheet = this.workbook.activeSheet();\n                this.origin = sheet.select();\n                this.contents = sheet.selection().getState();\n            },\n            cut: function () {\n                var sheet = this.workbook.activeSheet();\n                this.copy();\n                sheet.range(sheet.select()).clear();\n            },\n            pasteRef: function () {\n                var sheet = this.workbook.activeSheet();\n                var destination = sheet.activeCell().first();\n                var originActiveCell = this.origin.first();\n                var rowDelta = originActiveCell.row - destination.row;\n                var colDelta = originActiveCell.col - destination.col;\n                return this.origin.relative(rowDelta, colDelta, 3);\n            },\n            stateRangeRef: function (state) {\n                var rows = [];\n                var cols = [];\n                for (var key in state) {\n                    if (key === 'mergedCells' || key === 'ref') {\n                        continue;\n                    }\n                    var address = key.split(',');\n                    rows.push(address[0]);\n                    cols.push(address[1]);\n                }\n                var topLeft = new CellRef(Math.min.apply(null, rows), Math.min.apply(null, cols));\n                var bottomRight = new CellRef(Math.max.apply(null, rows), Math.max.apply(null, cols));\n                return new RangeRef(topLeft, bottomRight);\n            },\n            destroy: function () {\n                document.body.removeChild(this.iframe);\n            },\n            paste: function () {\n                var state = {};\n                var sheet = this.workbook.activeSheet();\n                if (this._isInternal()) {\n                    state = this.contents;\n                } else {\n                    state = this.parse(this._external);\n                    this.origin = this.stateRangeRef(state);\n                }\n                var pasteRef = this.pasteRef();\n                sheet.range(pasteRef).clear().setState(state);\n                sheet.triggerChange({\n                    recalc: true,\n                    ref: pasteRef\n                });\n            },\n            external: function (data) {\n                if (data.html || data.plain) {\n                    this._external = data;\n                } else {\n                    return this._external;\n                }\n            },\n            parse: function (data) {\n                var state = {\n                    ref: new CellRef(0, 0, 0),\n                    mergedCells: []\n                };\n                if (data.html) {\n                    var doc = this.iframe.contentWindow.document;\n                    doc.open();\n                    doc.write(data.html);\n                    doc.close();\n                    var table = $(doc).find('table:first');\n                    if (table.length) {\n                        state = this._parseHTML(table.find('tbody:first'));\n                    } else {\n                        if (!data.plain) {\n                            var element = $(doc.body).find(':not(style)');\n                            state['0,0'] = this._cellState(element.text());\n                        } else {\n                            state = this._parseTSV(data.plain);\n                        }\n                    }\n                } else {\n                    state = this._parseTSV(data.plain);\n                }\n                return state;\n            },\n            _parseHTML: function (tbody) {\n                var that = this;\n                var state = {\n                    ref: new CellRef(0, 0, 0),\n                    mergedCells: []\n                };\n                tbody.find('tr').each(function (rowIndex, tr) {\n                    $(tr).find('td').each(function (colIndex, td) {\n                        var rowspan = parseInt($(td).attr('rowspan'), 10) - 1 || 0;\n                        var colspan = parseInt($(td).attr('colspan'), 10) - 1 || 0;\n                        var blankCell = '<td/>';\n                        var ci;\n                        if (rowspan) {\n                            var endRow = rowIndex + rowspan;\n                            for (var ri = rowIndex; ri <= endRow; ri++) {\n                                var row = tbody.find('tr').eq(ri);\n                                if (ri > rowIndex) {\n                                    blankCell = '<td class=\\'rowspan\\'></td>';\n                                    if (colIndex === 0) {\n                                        row.find('td').eq(colIndex).after(blankCell);\n                                    } else {\n                                        var last = Math.min(row.find('td').length, colIndex);\n                                        row.find('td').eq(last - 1).after(blankCell);\n                                    }\n                                }\n                                if (colspan) {\n                                    for (ci = colIndex; ci < colspan + colIndex; ci++) {\n                                        blankCell = '<td class=\\'rowspan colspan\\'></td>';\n                                        row.find('td').eq(ci).after(blankCell);\n                                    }\n                                }\n                            }\n                        } else {\n                            if (colspan) {\n                                for (ci = colIndex; ci < colspan + colIndex; ci++) {\n                                    blankCell = '<td class=\\'colspan\\'></td>';\n                                    $(tr).find('td').eq(ci).after(blankCell);\n                                }\n                            }\n                        }\n                    });\n                });\n                tbody.find('tr').each(function (rowIndex, tr) {\n                    $(tr).find('td').each(function (colIndex, td) {\n                        var key = rowIndex + ',' + colIndex;\n                        var rowspan = parseInt($(td).attr('rowspan'), 10) - 1 || 0;\n                        var colspan = parseInt($(td).attr('colspan'), 10) - 1 || 0;\n                        var cellState = that._cellState($(td));\n                        state[key] = cellState;\n                        if (rowspan || colspan) {\n                            var startCol = String.fromCharCode(65 + colIndex);\n                            var endCol = String.fromCharCode(65 + colIndex + colspan);\n                            var address = startCol + (rowIndex + 1) + ':' + endCol + (rowIndex + 1 + rowspan);\n                            state.mergedCells.push(address);\n                        }\n                    });\n                });\n                return state;\n            },\n            _parseTSV: function (data) {\n                var state = {\n                    ref: new CellRef(0, 0, 0),\n                    mergedCells: []\n                };\n                if (data.indexOf('\\t') === -1 && data.indexOf('\\n') == -1) {\n                    state['0,0'] = { value: data };\n                } else {\n                    var rows = data.split('\\n');\n                    for (var ri = 0; ri < rows.length; ri++) {\n                        var cols = rows[ri].split('\\t');\n                        for (var ci = 0; ci < cols.length; ci++) {\n                            state[ri + ',' + ci] = { value: cols[ci] };\n                        }\n                    }\n                }\n                return state;\n            },\n            _isInternal: function () {\n                if (this._external.html === undefined) {\n                    return true;\n                }\n                var internalHTML = $('<div/>').html(this._external.html).find('table.kendo-clipboard-' + this._uid).length ? true : false;\n                var internalPlain = $('<div/>').html(this._external.plain).find('table.kendo-clipboard-' + this._uid).length ? true : false;\n                if (internalHTML || internalPlain) {\n                    return true;\n                }\n                return false;\n            },\n            _cellState: function (element) {\n                var styles = window.getComputedStyle(element[0]);\n                var text = element.text();\n                var borders = this._borderObject(styles);\n                var state = {\n                    value: text === '' ? null : text,\n                    borderBottom: borders.borderBottom,\n                    borderRight: borders.borderRight,\n                    borderLeft: borders.borderLeft,\n                    borderTop: borders.borderTop,\n                    fontSize: parseInt(styles['font-size'], 10)\n                };\n                if (styles['background-color'] !== 'rgb(0, 0, 0)' && styles['background-color'] !== 'rgba(0, 0, 0, 0)') {\n                    state.background = styles['background-color'];\n                }\n                if (styles.color !== 'rgb(0, 0, 0)' && styles.color !== 'rgba(0, 0, 0, 0)') {\n                    state.color = styles.color;\n                }\n                if (styles['text-decoration'] == 'underline') {\n                    state.underline = true;\n                }\n                if (styles['font-style'] == 'italic') {\n                    state.italic = true;\n                }\n                if (styles['font-weight'] == 'bold') {\n                    state.bold = true;\n                }\n                if (this._strippedStyle(styles['text-align']) !== 'right') {\n                    state.textAlign = this._strippedStyle(styles['text-align']);\n                }\n                if (styles['vertical-align'] !== 'middle') {\n                    state.verticalAlign = styles['vertical-align'];\n                }\n                if (styles['word-wrap'] !== 'normal') {\n                    state.wrap = true;\n                }\n                return state;\n            },\n            _strippedStyle: function (style) {\n                var prefixes = [\n                    '-ms-',\n                    '-moz-',\n                    '-webkit-'\n                ];\n                prefixes.forEach(function (prefix) {\n                    style = style.replace(prefix, '');\n                });\n                return style;\n            },\n            _borderObject: function (styles) {\n                var borderObject = {};\n                var borders = [\n                    'borderBottom',\n                    'borderRight',\n                    'borderLeft',\n                    'borderTop'\n                ];\n                borders.forEach(function (key) {\n                    if (styles[key + 'Style'] == 'none') {\n                        borderObject[key] = null;\n                        return;\n                    }\n                    borderObject[key] = {\n                        size: 1,\n                        color: styles[key + 'Color']\n                    };\n                });\n                return borderObject;\n            }\n        });\n        kendo.spreadsheet.Clipboard = Clipboard;\n    }(kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/range', [\n        'kendo.core',\n        'util/text-metrics'\n    ], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var $ = kendo.jQuery;\n        var UnionRef = kendo.spreadsheet.UnionRef;\n        var styles = [\n            'color',\n            'fontFamily',\n            'underline',\n            'italic',\n            'bold',\n            'textAlign',\n            'verticalAlign',\n            'background'\n        ];\n        var borders = {\n            borderTop: {\n                complement: 'borderBottom',\n                direction: {\n                    top: -1,\n                    bottom: -1\n                }\n            },\n            borderLeft: {\n                complement: 'borderRight',\n                direction: {\n                    left: -1,\n                    right: -1\n                }\n            },\n            borderRight: {\n                complement: 'borderLeft',\n                direction: {\n                    left: 1,\n                    right: 1\n                }\n            },\n            borderBottom: {\n                complement: 'borderTop',\n                direction: {\n                    top: 1,\n                    bottom: 1\n                }\n            }\n        };\n        var Range = kendo.Class.extend({\n            init: function (ref, sheet) {\n                this._sheet = sheet;\n                this._ref = ref;\n            },\n            _normalize: function (ref) {\n                return this._sheet._grid.normalize(ref);\n            },\n            _set: function (name, value, noTrigger) {\n                var sheet = this._sheet;\n                this._ref.forEach(function (ref) {\n                    sheet._set(ref.toRangeRef(), name, value);\n                });\n                if (!noTrigger) {\n                    sheet.triggerChange({\n                        recalc: name == 'formula' || name == 'value' || name == 'validation',\n                        value: value,\n                        ref: this._ref\n                    });\n                }\n                return this;\n            },\n            _get: function (name) {\n                return this._sheet._get(this._ref.toRangeRef(), name);\n            },\n            _property: function (name, value) {\n                if (value === undefined) {\n                    return this._get(name);\n                } else {\n                    return this._set(name, value);\n                }\n            },\n            value: function (value) {\n                if (value !== undefined) {\n                    this._set('formula', null, true);\n                }\n                return this._property('value', value);\n            },\n            resize: function (direction) {\n                var ref = this._resizedRef(direction);\n                return new Range(ref, this._sheet);\n            },\n            _resizedRef: function (direction) {\n                return this._ref.map(function (ref) {\n                    return ref.toRangeRef().resize(direction);\n                });\n            },\n            _border: function (property, value) {\n                var result;\n                var complement = borders[property].complement;\n                var direction = borders[property].direction;\n                var sheet = this._sheet;\n                sheet.batch(function () {\n                    result = this._property(property, value);\n                    if (value !== undefined) {\n                        this._resizedRef(direction).forEach(function (ref) {\n                            if (ref !== kendo.spreadsheet.NULLREF) {\n                                new Range(ref, sheet)._property(complement, null);\n                            }\n                        });\n                    }\n                }.bind(this), {});\n                return result;\n            },\n            _collapsedBorder: function (property) {\n                var result = this._property(property);\n                var complement = borders[property].complement;\n                var direction = borders[property].direction;\n                this._resizedRef(direction).forEach(function (ref) {\n                    if (!result && ref !== kendo.spreadsheet.NULLREF) {\n                        var range = new Range(ref, this._sheet);\n                        result = range._property(complement);\n                    }\n                }.bind(this));\n                return result;\n            },\n            borderTop: function (value) {\n                return this._border('borderTop', value);\n            },\n            borderRight: function (value) {\n                return this._border('borderRight', value);\n            },\n            borderBottom: function (value) {\n                return this._border('borderBottom', value);\n            },\n            borderLeft: function (value) {\n                return this._border('borderLeft', value);\n            },\n            collapsedBorderTop: function () {\n                return this._collapsedBorder('borderTop');\n            },\n            collapsedBorderRight: function () {\n                return this._collapsedBorder('borderRight');\n            },\n            collapsedBorderBottom: function () {\n                return this._collapsedBorder('borderBottom');\n            },\n            collapsedBorderLeft: function () {\n                return this._collapsedBorder('borderLeft');\n            },\n            input: function (value) {\n                if (value !== undefined) {\n                    var tl = this._ref.toRangeRef().topLeft;\n                    var x = kendo.spreadsheet.calc.parse(this._sheet.name(), tl.row, tl.col, value);\n                    this._sheet.batch(function () {\n                        var formula = null;\n                        if (x.type == 'exp') {\n                            formula = kendo.spreadsheet.calc.compile(x);\n                        } else if (x.type == 'date') {\n                            this.format(toExcelFormat(kendo.culture().calendar.patterns.d));\n                        } else if (x.type == 'percent') {\n                            this.format(x.value * 100 == (x.value * 100 | 0) ? '0%' : '0.00%');\n                        }\n                        this.formula(formula);\n                        if (!formula) {\n                            this.value(x.value);\n                        }\n                    }.bind(this), {\n                        recalc: true,\n                        value: value,\n                        ref: this._ref,\n                        editorChange: this._sheet.isInEditMode()\n                    });\n                    return this;\n                } else {\n                    value = this._get('value');\n                    var format = this._get('format');\n                    var formula = this._get('formula');\n                    var type = format && !formula && kendo.spreadsheet.formatting.type(value, format);\n                    if (formula) {\n                        value = '=' + formula;\n                    } else if (type === 'date') {\n                        value = kendo.toString(kendo.spreadsheet.numberToDate(value), kendo.culture().calendar.patterns.d);\n                    } else if (type === 'percent') {\n                        value = value * 100 + '%';\n                    } else if (typeof value == 'string' && (/^[=']/.test(value) || /^(?:true|false)$/i.test(value) || looksLikeANumber(value))) {\n                        value = '\\'' + value;\n                    }\n                    return value;\n                }\n            },\n            enable: function (value) {\n                if (value === undefined) {\n                    value = true;\n                    this._sheet.forEach(this._ref.toRangeRef(), function (_, _, data) {\n                        if (data.enable === false) {\n                            value = false;\n                        }\n                    });\n                    return value;\n                }\n                this._property('enable', value);\n            },\n            format: function (value) {\n                return this._property('format', value);\n            },\n            formula: function (value) {\n                if (value === undefined) {\n                    var f = this._get('formula');\n                    return f ? '' + f : null;\n                }\n                return this._property('formula', value);\n            },\n            validation: function (value) {\n                if (value === undefined) {\n                    var f = this._get('validation');\n                    return f ? f.toJSON() : null;\n                }\n                return this._property('validation', value);\n            },\n            _getValidationState: function () {\n                var ref = this._ref.toRangeRef();\n                var topLeftRow = ref.topLeft.row;\n                var topLeftCol = ref.topLeft.col;\n                var bottomRightRow = ref.bottomRight.row;\n                var bottomRightCol = ref.bottomRight.col;\n                var ci, ri;\n                for (ci = topLeftCol; ci <= bottomRightCol; ci++) {\n                    for (ri = topLeftRow; ri <= bottomRightRow; ri++) {\n                        var validation = this._sheet._validation(ri, ci);\n                        if (validation && validation.type === 'reject' && validation.value === false) {\n                            return validation;\n                        }\n                    }\n                }\n                return false;\n            },\n            merge: function () {\n                this._ref = this._sheet._merge(this._ref);\n                return this;\n            },\n            unmerge: function () {\n                var mergedCells = this._sheet._mergedCells;\n                this._ref.forEach(function (ref) {\n                    ref.toRangeRef().intersecting(mergedCells).forEach(function (mergedRef) {\n                        mergedCells.splice(mergedCells.indexOf(mergedRef), 1);\n                    });\n                });\n                this._sheet.triggerChange({});\n                return this;\n            },\n            select: function () {\n                this._sheet.select(this._ref);\n                return this;\n            },\n            values: function (values) {\n                if (this._ref instanceof UnionRef) {\n                    throw new Error('Unsupported for multiple ranges.');\n                }\n                if (this._ref === kendo.spreadsheet.NULLREF) {\n                    if (values !== undefined) {\n                        throw new Error('Unsupported for NULLREF.');\n                    } else {\n                        return [];\n                    }\n                }\n                var ref = this._ref.toRangeRef();\n                var topLeftRow = ref.topLeft.row;\n                var topLeftCol = ref.topLeft.col;\n                var bottomRightRow = ref.bottomRight.row;\n                var bottomRightCol = ref.bottomRight.col;\n                var ci, ri;\n                if (values === undefined) {\n                    values = new Array(ref.height());\n                    for (var vi = 0; vi < values.length; vi++) {\n                        values[vi] = new Array(ref.width());\n                    }\n                    for (ci = topLeftCol; ci <= bottomRightCol; ci++) {\n                        for (ri = topLeftRow; ri <= bottomRightRow; ri++) {\n                            values[ri - topLeftRow][ci - topLeftCol] = this._sheet._value(ri, ci);\n                        }\n                    }\n                    return values;\n                } else {\n                    for (ci = topLeftCol; ci <= bottomRightCol; ci++) {\n                        for (ri = topLeftRow; ri <= bottomRightRow; ri++) {\n                            var row = values[ri - topLeftRow];\n                            if (row) {\n                                var value = row[ci - topLeftCol];\n                                if (value !== undefined) {\n                                    this._sheet._value(ri, ci, value);\n                                }\n                            }\n                        }\n                    }\n                    this._sheet.triggerChange({ recalc: true });\n                    return this;\n                }\n            },\n            _properties: function (props) {\n                if (this._ref instanceof UnionRef) {\n                    throw new Error('Unsupported for multiple ranges.');\n                }\n                if (this._ref === kendo.spreadsheet.NULLREF) {\n                    if (props !== undefined) {\n                        throw new Error('Unsupported for NULLREF.');\n                    } else {\n                        return [];\n                    }\n                }\n                var ref = this._ref.toRangeRef();\n                var topLeftRow = ref.topLeft.row;\n                var topLeftCol = ref.topLeft.col;\n                var bottomRightRow = ref.bottomRight.row;\n                var bottomRightCol = ref.bottomRight.col;\n                var ci, ri;\n                var sheet = this._sheet;\n                if (props === undefined) {\n                    props = new Array(ref.height());\n                    sheet.forEach(ref, function (row, col, data) {\n                        row -= topLeftRow;\n                        col -= topLeftCol;\n                        var line = props[row] || (props[row] = []);\n                        line[col] = data;\n                    });\n                    return props;\n                } else {\n                    var data;\n                    ref = ref.clone();\n                    var setProp = function (propName) {\n                        var propValue = data[propName];\n                        ref.topLeft.row = ref.bottomRight.row = ri;\n                        ref.topLeft.col = ref.bottomRight.col = ci;\n                        sheet._set(ref, propName, propValue);\n                    };\n                    for (ci = topLeftCol; ci <= bottomRightCol; ci++) {\n                        for (ri = topLeftRow; ri <= bottomRightRow; ri++) {\n                            var row = props[ri - topLeftRow];\n                            if (row) {\n                                data = row[ci - topLeftCol];\n                                if (data) {\n                                    Object.keys(data).forEach(setProp);\n                                }\n                            }\n                        }\n                    }\n                    sheet.triggerChange({\n                        recalc: true,\n                        ref: this._ref\n                    });\n                    return this;\n                }\n            },\n            clear: function (options) {\n                var clearAll = !options || !Object.keys(options).length;\n                var sheet = this._sheet;\n                var reason = {\n                    recalc: clearAll || options && options.contentsOnly === true,\n                    ref: this._ref\n                };\n                sheet.batch(function () {\n                    if (reason.recalc) {\n                        this.formula(null);\n                    }\n                    if (clearAll) {\n                        this.validation(null);\n                    }\n                    if (clearAll || options && options.formatOnly === true) {\n                        styles.forEach(function (x) {\n                            this[x](null);\n                        }.bind(this));\n                        this.format(null);\n                        this.unmerge();\n                    }\n                }.bind(this), reason);\n                return this;\n            },\n            clearContent: function () {\n                return this.clear({ contentsOnly: true });\n            },\n            clearFormat: function () {\n                return this.clear({ formatOnly: true });\n            },\n            isSortable: function () {\n                return !(this._ref instanceof UnionRef || this._ref === kendo.spreadsheet.NULLREF);\n            },\n            sort: function (spec) {\n                if (this._ref instanceof UnionRef) {\n                    throw new Error('Unsupported for multiple ranges.');\n                }\n                if (this._ref === kendo.spreadsheet.NULLREF) {\n                    throw new Error('Unsupported for NULLREF.');\n                }\n                if (spec === undefined) {\n                    spec = { column: 0 };\n                }\n                spec = spec instanceof Array ? spec : [spec];\n                this._sheet._sortBy(this._ref.toRangeRef(), spec.map(function (spec, index) {\n                    if (typeof spec === 'number') {\n                        spec = { column: spec };\n                    }\n                    return {\n                        index: spec.column === undefined ? index : spec.column,\n                        ascending: spec.ascending === undefined ? true : spec.ascending\n                    };\n                }));\n                return this;\n            },\n            isFilterable: function () {\n                return !(this._ref instanceof UnionRef);\n            },\n            filter: function (spec) {\n                if (this._ref instanceof UnionRef) {\n                    throw new Error('Unsupported for multiple ranges.');\n                }\n                if (spec === false) {\n                    this.clearFilters();\n                } else {\n                    spec = spec === true ? [] : spec instanceof Array ? spec : [spec];\n                    this._sheet._filterBy(this._ref.toRangeRef(), spec.map(function (spec, index) {\n                        return {\n                            index: spec.column === undefined ? index : spec.column,\n                            filter: spec.filter\n                        };\n                    }));\n                }\n                return this;\n            },\n            clearFilter: function (spec) {\n                this._sheet.clearFilter(spec);\n            },\n            clearFilters: function () {\n                var filter = this._sheet.filter();\n                var spec = [];\n                if (filter) {\n                    for (var i = 0; i < filter.columns.length; i++) {\n                        spec.push(i);\n                    }\n                    this._sheet.batch(function () {\n                        this.clearFilter(spec);\n                        this._filter = null;\n                    }, {\n                        layout: true,\n                        filter: true\n                    });\n                }\n            },\n            hasFilter: function () {\n                var filter = this._sheet.filter();\n                return !!filter;\n            },\n            leftColumn: function () {\n                return new Range(this._ref.leftColumn(), this._sheet);\n            },\n            rightColumn: function () {\n                return new Range(this._ref.rightColumn(), this._sheet);\n            },\n            topRow: function () {\n                return new Range(this._ref.topRow(), this._sheet);\n            },\n            bottomRow: function () {\n                return new Range(this._ref.bottomRow(), this._sheet);\n            },\n            column: function (column) {\n                return new Range(this._ref.toColumn(column), this._sheet);\n            },\n            row: function (row) {\n                return new Range(this._ref.toRow(row), this._sheet);\n            },\n            forEachRow: function (callback) {\n                this._ref.forEachRow(function (ref) {\n                    callback(new Range(ref, this._sheet));\n                }.bind(this));\n            },\n            forEachColumn: function (callback) {\n                this._ref.forEachColumn(function (ref) {\n                    callback(new Range(ref, this._sheet));\n                }.bind(this));\n            },\n            sheet: function () {\n                return this._sheet;\n            },\n            topLeft: function () {\n                return this._ref.toRangeRef().topLeft;\n            },\n            intersectingMerged: function () {\n                var sheet = this._sheet;\n                var mergedCells = [];\n                sheet._mergedCells.forEach(function (ref) {\n                    if (ref.intersects(this._ref)) {\n                        mergedCells.push(ref.toString());\n                    }\n                }.bind(this));\n                return mergedCells;\n            },\n            getState: function (propertyName) {\n                var state = { ref: this._ref.first() };\n                var properties;\n                if (!propertyName) {\n                    properties = kendo.spreadsheet.ALL_PROPERTIES;\n                    state.mergedCells = this.intersectingMerged();\n                } else if (propertyName === 'input') {\n                    properties = [\n                        'value',\n                        'formula'\n                    ];\n                } else if (propertyName === 'border') {\n                    properties = [\n                        'borderLeft',\n                        'borderTop',\n                        'borderRight',\n                        'borderBottom'\n                    ];\n                } else {\n                    properties = [propertyName];\n                }\n                this.forEachCell(function (row, col, cell) {\n                    var cellState = state[row + ',' + col] = {};\n                    properties.forEach(function (property) {\n                        cellState[property] = cell[property] || null;\n                    });\n                });\n                return state;\n            },\n            setState: function (state) {\n                var sheet = this._sheet;\n                var origin = this._ref.first();\n                var rowDelta = state.ref.row - origin.row;\n                var colDelta = state.ref.col - origin.col;\n                sheet.batch(function () {\n                    if (state.mergedCells) {\n                        this.unmerge();\n                    }\n                    this.forEachCell(function (row, col) {\n                        var cellState = state[row + rowDelta + ',' + (col + colDelta)];\n                        var range = sheet.range(row, col);\n                        for (var property in cellState) {\n                            if (property != 'value') {\n                                range._set(property, cellState[property]);\n                            }\n                        }\n                        if (!cellState.formula) {\n                            range._set('value', cellState.value);\n                        }\n                    });\n                    if (state.mergedCells) {\n                        state.mergedCells.forEach(function (merged) {\n                            merged = sheet._ref(merged).relative(rowDelta, colDelta, 3);\n                            sheet.range(merged).merge();\n                        }, this);\n                    }\n                }.bind(this), { recalc: true });\n            },\n            _adjustRowHeight: function () {\n                var sheet = this._sheet;\n                var state = this.getState();\n                var mergedCells = [];\n                for (var i = 0; i < state.mergedCells.length; i++) {\n                    mergedCells.push(sheet.range(state.mergedCells[i]));\n                }\n                this.forEachRow(function (row) {\n                    var maxHeight = row.sheet().rowHeight(row.topLeft().row);\n                    row.forEachCell(function (rowIndex, colIndex, cell) {\n                        var cellRange = sheet.range(rowIndex, colIndex);\n                        var totalWidth = 0;\n                        for (var i = 0; i < mergedCells.length; i++) {\n                            if (cellRange._ref.intersects(mergedCells[i]._ref)) {\n                                totalWidth += cell.width;\n                                break;\n                            }\n                        }\n                        var width = Math.max(sheet.columnWidth(colIndex), totalWidth);\n                        maxHeight = Math.max(maxHeight, kendo.spreadsheet.util.getTextHeight(cell.value, width, cell.fontSize, cell.wrap));\n                    });\n                    sheet.rowHeight(row.topLeft().row, Math.max(sheet.rowHeight(row.topLeft().row), maxHeight));\n                });\n            },\n            forEachCell: function (callback) {\n                this._ref.forEach(function (ref) {\n                    this._sheet.forEach(ref.toRangeRef(), callback.bind(this));\n                }.bind(this));\n            },\n            hasValue: function () {\n                var result = false;\n                this.forEachCell(function (row, col, cell) {\n                    if (Object.keys(cell).length !== 0) {\n                        result = true;\n                    }\n                });\n                return result;\n            },\n            wrap: function (flag) {\n                if (flag === undefined) {\n                    return !!this._property('wrap');\n                }\n                this.forEachRow(function (range) {\n                    var maxHeight = range.sheet().rowHeight(range.topLeft().row);\n                    range.forEachCell(function (row, col, cell) {\n                        var width = this._sheet.columnWidth(col);\n                        if (cell.value !== null && cell.value !== undefined) {\n                            maxHeight = Math.max(maxHeight, kendo.spreadsheet.util.getTextHeight(cell.value, width, cell.fontSize, true));\n                        }\n                    });\n                    range.sheet().rowHeight(range.topLeft().row, maxHeight);\n                }.bind(this));\n                this._property('wrap', flag);\n                return this;\n            },\n            fontSize: function (size) {\n                if (size === undefined) {\n                    return this._property('fontSize');\n                }\n                this.forEachRow(function (range) {\n                    var maxHeight = range.sheet().rowHeight(range.topLeft().row);\n                    range.forEachCell(function (row, col, cell) {\n                        var width = this._sheet.columnWidth(col);\n                        if (cell.value !== null && cell.value !== undefined) {\n                            maxHeight = Math.max(maxHeight, kendo.spreadsheet.util.getTextHeight(cell.value, width, size, cell.wrap));\n                        }\n                    });\n                    range.sheet().rowHeight(range.topLeft().row, maxHeight);\n                }.bind(this));\n                this._property('fontSize', size);\n                return this;\n            },\n            draw: function (options, callback) {\n                this._sheet.draw(this, options, callback);\n            }\n        });\n        $.each(styles, function (i, property) {\n            Range.prototype[property] = function (value) {\n                return this._property(property, value);\n            };\n        });\n        function toExcelFormat(format) {\n            return format.replace(/M/g, 'm').replace(/'/g, '\"').replace(/tt/, 'am/pm');\n        }\n        function looksLikeANumber(str) {\n            return !/^=/.test(str) && /number|percent/.test(kendo.spreadsheet.calc.parse(null, 0, 0, str).type);\n        }\n        var measureBox = $('<div style=\"position: absolute !important; top: -4000px !important; height: auto !important;' + 'padding: 1px !important; margin: 0 !important; border: 1px solid black !important;' + 'line-height: normal !important; visibility: hidden !important;' + 'white-space: pre-wrap !important; word-break: break-all !important;\" />')[0];\n        function getTextHeight(text, width, fontSize, wrap) {\n            var styles = {\n                'baselineMarkerSize': 0,\n                'width': width + 'px',\n                'font-size': (fontSize || 12) + 'px',\n                'word-break': wrap === true ? 'break-all' : 'normal',\n                'white-space': wrap === true ? 'pre-wrap' : 'pre'\n            };\n            return kendo.util.measureText(text, styles, measureBox).height;\n        }\n        kendo.spreadsheet.util = { getTextHeight: getTextHeight };\n        kendo.spreadsheet.Range = Range;\n    }(window.kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/runtime', ['spreadsheet/references'], f);\n}(function () {\n    'use strict';\n    if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n        return;\n    }\n    var calc = {};\n    var spreadsheet = kendo.spreadsheet;\n    spreadsheet.calc = calc;\n    var exports = calc.runtime = {};\n    var Class = kendo.Class;\n    var Ref = spreadsheet.Ref;\n    var CellRef = spreadsheet.CellRef;\n    var RangeRef = spreadsheet.RangeRef;\n    var UnionRef = spreadsheet.UnionRef;\n    var NULL = spreadsheet.NULLREF;\n    function CalcError(code) {\n        if (code instanceof CalcError) {\n            return code;\n        }\n        this.code = code;\n    }\n    CalcError.prototype.toString = function () {\n        return '#' + this.code + (this.code == 'NAME' ? '?' : '!');\n    };\n    var Context = Class.extend({\n        init: function Context(callback, formula, ss, parent) {\n            this.callback = callback;\n            this.formula = formula;\n            this.ss = ss;\n            this.parent = parent;\n        },\n        resolve: function (val) {\n            var self = this;\n            if (val instanceof Ref) {\n                self.resolveCells([val], function () {\n                    val = self.getRefData(val);\n                    if (Array.isArray(val)) {\n                        val = val[0];\n                    }\n                    self._resolve(val);\n                });\n            } else {\n                self._resolve(val);\n            }\n        },\n        _resolve: function (val) {\n            if (val === undefined) {\n                val = null;\n            }\n            var f = this.formula;\n            f.value = val;\n            if (this.ss.onFormula(f) && this.callback) {\n                this.callback.call(f, val);\n            }\n        },\n        resolveCells: function (a, f) {\n            var context = this, formulas = [];\n            (function loop(a) {\n                for (var i = 0; i < a.length; ++i) {\n                    var x = a[i];\n                    if (x instanceof Ref) {\n                        add(context.getRefCells(x));\n                    }\n                    if (Array.isArray(x)) {\n                        loop(x);\n                    }\n                }\n            }(a));\n            if (!formulas.length) {\n                return f.call(context);\n            }\n            for (var pending = formulas.length, i = 0; i < formulas.length; ++i) {\n                fetch(formulas[i]);\n            }\n            function fetch(cell) {\n                cell.formula.exec(context.ss, function () {\n                    if (!--pending) {\n                        f.call(context);\n                    }\n                }, context);\n            }\n            function add(a) {\n                for (var i = 0; i < a.length; ++i) {\n                    var cell = a[i];\n                    if (cell.formula) {\n                        formulas.push(cell);\n                    }\n                }\n                return true;\n            }\n        },\n        cellValues: function (a, f) {\n            var ret = [];\n            for (var i = 0; i < a.length; ++i) {\n                var val = a[i];\n                if (val instanceof Ref) {\n                    val = this.getRefData(val);\n                    ret = ret.concat(val);\n                } else if (Array.isArray(val)) {\n                    ret = ret.concat(this.cellValues(val));\n                } else if (val instanceof Matrix) {\n                    ret = ret.concat(this.cellValues(val.data));\n                } else {\n                    ret.push(val);\n                }\n            }\n            if (f) {\n                return f.apply(this, ret);\n            }\n            return ret;\n        },\n        force: function (val) {\n            if (val instanceof Ref) {\n                return this.getRefData(val);\n            }\n            return val;\n        },\n        func: function (fname, callback, args) {\n            fname = fname.toLowerCase();\n            var f = FUNCS[fname];\n            if (f) {\n                return f.call(this, callback, args);\n            }\n            callback(new CalcError('NAME'));\n        },\n        bool: function (val) {\n            if (val instanceof Ref) {\n                val = this.getRefData(val);\n            }\n            if (typeof val == 'string') {\n                return val.toLowerCase() == 'true';\n            }\n            if (typeof val == 'number') {\n                return val !== 0;\n            }\n            if (typeof val == 'boolean') {\n                return val;\n            }\n            return val != null;\n        },\n        asMatrix: function (range) {\n            if (range instanceof Matrix) {\n                return range;\n            }\n            var self = this;\n            if (range instanceof RangeRef) {\n                var tl = range.topLeft;\n                var top = tl.row, left = tl.col;\n                var cells = self.getRefCells(range);\n                var m = new Matrix(self);\n                if (isFinite(range.width())) {\n                    m.width = range.width();\n                }\n                if (isFinite(range.height())) {\n                    m.height = range.height();\n                }\n                if (!isFinite(top)) {\n                    top = 0;\n                }\n                if (!isFinite(left)) {\n                    left = 0;\n                }\n                cells.forEach(function (cell) {\n                    m.set(cell.row - top, cell.col - left, cell.value);\n                });\n                return m;\n            }\n            if (Array.isArray(range) && range.length > 0) {\n                var m = new Matrix(self), row = 0;\n                range.forEach(function (line) {\n                    var col = 0;\n                    var h = 1;\n                    line.forEach(function (el) {\n                        var isRange = el instanceof RangeRef;\n                        if (el instanceof Ref && !isRange) {\n                            el = self.getRefData(el);\n                        }\n                        if (isRange || Array.isArray(el)) {\n                            el = self.asMatrix(el);\n                        }\n                        if (el instanceof Matrix) {\n                            el.each(function (el, r, c) {\n                                m.set(row + r, col + c, el);\n                            });\n                            h = Math.max(h, el.height);\n                            col += el.width;\n                        } else {\n                            m.set(row, col++, el);\n                        }\n                    });\n                    row += h;\n                });\n                return m;\n            }\n        },\n        getRefCells: function (refs, hiddenInfo) {\n            return this.ss.getRefCells(refs, hiddenInfo);\n        },\n        getRefData: function (ref) {\n            return this.ss.getData(ref);\n        },\n        workbook: function () {\n            return this.ss.workbook;\n        }\n    });\n    var Matrix = Class.extend({\n        init: function Matrix(context) {\n            this.context = context;\n            this.height = 0;\n            this.width = 0;\n            this.data = [];\n        },\n        clone: function () {\n            var m = new Matrix(this.context);\n            m.height = this.height;\n            m.width = this.width;\n            m.data = this.data.map(function (row) {\n                return row.slice();\n            });\n            return m;\n        },\n        get: function (row, col) {\n            var line = this.data[row];\n            var val = line ? line[col] : null;\n            return val instanceof Ref ? this.context.getRefData(val) : val;\n        },\n        set: function (row, col, data) {\n            var line = this.data[row];\n            if (line == null) {\n                line = this.data[row] = [];\n            }\n            line[col] = data;\n            if (row >= this.height) {\n                this.height = row + 1;\n            }\n            if (col >= this.width) {\n                this.width = col + 1;\n            }\n        },\n        each: function (f, includeEmpty) {\n            for (var row = 0; row < this.height; ++row) {\n                for (var col = 0; col < this.width; ++col) {\n                    var val = this.get(row, col);\n                    if (includeEmpty || val != null) {\n                        val = f.call(this.context, val, row, col);\n                        if (val !== undefined) {\n                            return val;\n                        }\n                    }\n                }\n            }\n        },\n        map: function (f, includeEmpty) {\n            var m = new Matrix(this.context);\n            this.each(function (el, row, col) {\n                m.set(row, col, f.call(this, el, row, col));\n            }, includeEmpty);\n            return m;\n        },\n        eachRow: function (f) {\n            for (var row = 0; row < this.height; ++row) {\n                var val = f.call(this.context, row);\n                if (val !== undefined) {\n                    return val;\n                }\n            }\n        },\n        eachCol: function (f) {\n            for (var col = 0; col < this.width; ++col) {\n                var val = f.call(this.context, col);\n                if (val !== undefined) {\n                    return val;\n                }\n            }\n        },\n        mapRow: function (f) {\n            var m = new Matrix(this.context);\n            this.eachRow(function (row) {\n                m.set(row, 0, f.call(this.context, row));\n            });\n            return m;\n        },\n        mapCol: function (f) {\n            var m = new Matrix(this.context);\n            this.eachCol(function (col) {\n                m.set(0, col, f.call(this.context, col));\n            });\n            return m;\n        },\n        toString: function () {\n            return JSON.stringify(this.data);\n        },\n        transpose: function () {\n            var m = new Matrix(this.context);\n            this.each(function (el, row, col) {\n                m.set(col, row, el);\n            });\n            return m;\n        },\n        unit: function (n) {\n            this.width = this.height = n;\n            var a = this.data = new Array(n);\n            for (var i = n; --i >= 0;) {\n                var row = a[i] = new Array(n);\n                for (var j = n; --j >= 0;) {\n                    row[j] = i == j ? 1 : 0;\n                }\n            }\n            return this;\n        },\n        multiply: function (b) {\n            var a = this, m = new Matrix(a.context);\n            for (var row = 0; row < a.height; ++row) {\n                for (var col = 0; col < b.width; ++col) {\n                    var s = 0;\n                    for (var i = 0; i < a.width; ++i) {\n                        var va = a.get(row, i);\n                        var vb = b.get(i, col);\n                        if (typeof va != 'number' || typeof vb != 'number') {\n                            throw new CalcError('VALUE');\n                        }\n                        s += va * vb;\n                    }\n                    m.set(row, col, s);\n                }\n            }\n            return m;\n        },\n        adds: function (b, s) {\n            var a = this, m = new Matrix(a.context);\n            var sign = s ? -1 : 1;\n            for (var row = 0; row < a.height; ++row) {\n                for (var col = 0; col < a.width; ++col) {\n                    var x = a.get(row, col), y = b.get(row, col);\n                    m.set(row, col, x + sign * y);\n                }\n            }\n            return m;\n        },\n        determinant: function () {\n            var a = this.clone().data;\n            var n = a.length;\n            var d = 1, C, L, i, k;\n            for (C = 0; C < n; C++) {\n                for (L = C; L < n && !a[L][C]; L++) {\n                }\n                if (L == n) {\n                    return 0;\n                }\n                if (L != C) {\n                    d = -d;\n                    for (k = C; k < n; k++) {\n                        var t = a[C][k];\n                        a[C][k] = a[L][k];\n                        a[L][k] = t;\n                    }\n                }\n                for (i = C + 1; i < n; i++) {\n                    for (k = C + 1; k < n; k++) {\n                        a[i][k] -= a[C][k] * a[i][C] / a[C][C];\n                    }\n                }\n                d *= a[C][C];\n            }\n            return d;\n        },\n        inverse: function () {\n            var n = this.width;\n            var m = this.augment(new Matrix(this.context).unit(n));\n            var a = m.data;\n            var tmp;\n            for (var k = 0; k < n; ++k) {\n                var imax = argmax(k, n, function (i) {\n                    return a[i][k];\n                });\n                if (!a[imax][k]) {\n                    return null;\n                }\n                if (k != imax) {\n                    tmp = a[k];\n                    a[k] = a[imax];\n                    a[imax] = tmp;\n                }\n                for (var i = k + 1; i < n; ++i) {\n                    for (var j = k + 1; j < 2 * n; ++j) {\n                        a[i][j] -= a[k][j] * a[i][k] / a[k][k];\n                    }\n                    a[i][k] = 0;\n                }\n            }\n            for (var i = 0; i < n; ++i) {\n                for (var f = a[i][i], j = 0; j < 2 * n; ++j) {\n                    a[i][j] /= f;\n                }\n            }\n            for (var k = n; --k >= 0;) {\n                for (var i = k; --i >= 0;) {\n                    if (a[i][k]) {\n                        for (var j = 2 * n; --j >= n;) {\n                            a[i][j] -= a[k][j] * a[i][k];\n                        }\n                    }\n                }\n            }\n            return m.slice(0, n, n, n);\n        },\n        augment: function (m) {\n            var ret = this.clone(), n = ret.width;\n            m.each(function (val, row, col) {\n                ret.set(row, col + n, val);\n            });\n            return ret;\n        },\n        slice: function (row, col, height, width) {\n            var m = new Matrix(this.context);\n            for (var i = 0; i < height; ++i) {\n                for (var j = 0; j < width; ++j) {\n                    m.set(i, j, this.get(row + i, col + j));\n                }\n            }\n            return m;\n        }\n    });\n    function argmax(i, end, f) {\n        var max = f(i), pos = i;\n        while (++i < end) {\n            var v = f(i);\n            if (v > max) {\n                max = v;\n                pos = i;\n            }\n        }\n        return pos;\n    }\n    var Formula = Class.extend({\n        init: function Formula(refs, handler, printer, sheet, row, col) {\n            this.refs = refs;\n            this.handler = handler;\n            this.print = printer;\n            this.absrefs = null;\n            this.sheet = sheet;\n            this.row = row;\n            this.col = col;\n            this.onReady = [];\n            this.pending = false;\n        },\n        clone: function (sheet, row, col) {\n            var lcsheet = sheet.toLowerCase();\n            var refs = this.refs;\n            if (lcsheet != this.sheet.toLowerCase()) {\n                refs = refs.map(function (ref) {\n                    if (!ref.hasSheet() && ref.sheet.toLowerCase() != lcsheet) {\n                        ref = ref.clone().setSheet(sheet);\n                    }\n                    return ref;\n                });\n            }\n            return new Formula(refs, this.handler, this.print, sheet, row, col);\n        },\n        resolve: function (val) {\n            this.pending = false;\n            this.onReady.forEach(function (callback) {\n                callback(val);\n            });\n        },\n        exec: function (ss, callback, parentContext) {\n            if ('value' in this) {\n                if (callback) {\n                    callback(this.value);\n                }\n            } else {\n                if (callback) {\n                    this.onReady.push(callback);\n                }\n                var ctx = new Context(this.resolve, this, ss, parentContext);\n                while (parentContext) {\n                    if (parentContext.formula === this) {\n                        this.pending = false;\n                        ctx.resolve(new CalcError('CIRCULAR'));\n                        return;\n                    }\n                    parentContext = parentContext.parent;\n                }\n                if (this.pending) {\n                    return;\n                }\n                this.pending = true;\n                if (!this.absrefs) {\n                    this.absrefs = this.refs.map(function (ref) {\n                        return ref.absolute(this.row, this.col);\n                    }, this);\n                }\n                this.handler.call(ctx);\n            }\n        },\n        reset: function () {\n            this.onReady = [];\n            this.pending = false;\n            delete this.value;\n        },\n        renameSheet: function (oldSheetName, newSheetName) {\n            oldSheetName = oldSheetName.toLowerCase();\n            this.absrefs = null;\n            if (this.sheet.toLowerCase() == oldSheetName) {\n                this.sheet = newSheetName;\n            }\n            this.refs.forEach(function (ref) {\n                if (ref.sheet.toLowerCase() == oldSheetName) {\n                    ref.sheet = newSheetName;\n                }\n            });\n        },\n        adjust: function (affectedSheet, operation, start, delta) {\n            affectedSheet = affectedSheet.toLowerCase();\n            var formulaRow = this.row;\n            var formulaCol = this.col;\n            var formulaSheet = this.sheet.toLowerCase();\n            var formulaMoves = false;\n            if (formulaSheet == affectedSheet) {\n                if (operation == 'row' && formulaRow >= start) {\n                    this.row += delta;\n                    formulaMoves = true;\n                }\n                if (operation == 'col' && formulaCol >= start) {\n                    this.col += delta;\n                    formulaMoves = true;\n                }\n            }\n            var newFormulaRow = this.row;\n            var newFormulaCol = this.col;\n            this.absrefs = null;\n            this.refs = this.refs.map(function (ref) {\n                if (ref === NULL) {\n                    return ref;\n                }\n                if (ref.sheet.toLowerCase() != affectedSheet) {\n                    if (formulaMoves) {\n                        if (operation == 'row' && formulaRow >= start) {\n                            ref = ref.relative(delta, 0);\n                        }\n                        if (operation == 'col' && formulaCol >= start) {\n                            ref = ref.relative(0, delta);\n                        }\n                    }\n                    return ref;\n                }\n                return ref.adjust(formulaRow, formulaCol, newFormulaRow, newFormulaCol, operation == 'row', start, delta);\n            }, this);\n        },\n        toString: function () {\n            return this.print(this.row, this.col);\n        }\n    });\n    var FUNCS = Object.create(null);\n    FUNCS['if'] = function (callback, args) {\n        var self = this;\n        var co = args[0], th = args[1], el = args[2];\n        this.resolveCells([co], function () {\n            var comatrix = self.asMatrix(co);\n            if (comatrix) {\n                th(function (th) {\n                    el(function (el) {\n                        var thmatrix = self.asMatrix(th);\n                        var elmatrix = self.asMatrix(el);\n                        callback(comatrix.map(function (val, row, col) {\n                            if (self.bool(val)) {\n                                return thmatrix ? thmatrix.get(row, col) : th;\n                            } else {\n                                return elmatrix ? elmatrix.get(row, col) : el;\n                            }\n                        }));\n                    });\n                });\n            } else {\n                if (self.bool(co)) {\n                    th(callback);\n                } else {\n                    el(callback);\n                }\n            }\n        });\n    };\n    FUNCS[''] = function (callback) {\n        callback((1 + Math.sqrt(5)) / 2);\n    };\n    function compileArgumentChecks(functionName, args) {\n        var arrayArgs = 'function arrayArgs(args) { var xargs = [], width = 0, height = 0, arrays = [], i = 0; ';\n        var resolve = 'function resolve(args, callback) { var toResolve = [], i = 0; ';\n        var name, forced, main = '\\'use strict\\'; function check(args) { var stack = [], tmp, xargs = [], i = 0, m, err = \\'VALUE\\'; ', haveForced = false;\n        var canBeArrayArg = false, hasArrayArgs = false;\n        main += args.map(comp).join('');\n        main += 'if (i < args.length) return new CalcError(\\'N/A\\'); ';\n        main += 'return xargs; } ';\n        arrayArgs += 'return { args: xargs, width: width, height: height, arrays: arrays }; } ';\n        var f;\n        if (haveForced) {\n            resolve += 'this.resolveCells(toResolve, callback); } ';\n            f = new Function('CalcError', main + resolve + arrayArgs + ' return { resolve: resolve, check: check, arrayArgs: arrayArgs };');\n        } else {\n            f = new Function('CalcError', main + ' return { check: check };');\n        }\n        f = f(CalcError);\n        if (!hasArrayArgs) {\n            delete f.arrayArgs;\n        }\n        return f;\n        function comp(x) {\n            name = x[0];\n            var code = '{ ';\n            if (Array.isArray(name)) {\n                arrayArgs += 'while (i < args.length) { ';\n                resolve += 'while (i < args.length) { ';\n                code += 'xargs.push(tmp = []); stack.push(xargs); xargs = tmp; ';\n                code += 'while (i < args.length) { ';\n                code += x.map(comp).join('');\n                code += '} ';\n                code += 'xargs = stack.pop(); ';\n                resolve += '} ';\n                arrayArgs += '} ';\n            } else if (name == '+') {\n                arrayArgs += 'while (i < args.length) { ';\n                resolve += 'while (i < args.length) { ';\n                code += 'xargs.push(tmp = []); stack.push(xargs); xargs = tmp; ';\n                code += 'do { ';\n                code += x.slice(1).map(comp).join('');\n                code += '} while (i < args.length); ';\n                code += 'xargs = stack.pop(); ';\n                resolve += '} ';\n                arrayArgs += '} ';\n            } else if (name == '?') {\n                code += 'if (!(' + cond(x[1]) + ')) return new CalcError(err); ';\n            } else {\n                var type = x[1];\n                if (Array.isArray(type) && /^#?collect/.test(type[0])) {\n                    var n = type[2];\n                    force();\n                    code += 'try {' + 'var $' + name + ' = this.cellValues(args.slice(i';\n                    if (n) {\n                        code += ', i + ' + n;\n                    }\n                    code += ')).filter(function($' + name + '){ ';\n                    if (type[0] == 'collect') {\n                        code += 'if ($' + name + ' instanceof CalcError) throw $' + name + '; ';\n                    }\n                    code += 'return ' + cond(type[1]) + '; }, this); ';\n                    if (n) {\n                        code += 'i += ' + n + '; ';\n                    } else {\n                        code += 'i = args.length; ';\n                    }\n                    code += 'xargs.push($' + name + ')' + '} catch(ex) { if (ex instanceof CalcError) return ex; throw ex; } ';\n                    resolve += 'toResolve.push(args.slice(i)); ';\n                } else if (type == 'rest') {\n                    code += 'xargs.push(args.slice(i)); i = args.length; ';\n                } else {\n                    if (canBeArrayArg = /^\\*/.test(name)) {\n                        hasArrayArgs = true;\n                        name = name.substr(1);\n                    }\n                    code += 'var $' + name + ' = args[i++]; ';\n                    var allowError = false;\n                    if (/!$/.test(type)) {\n                        type = type.substr(0, type.length - 1);\n                        allowError = true;\n                    } else {\n                        code += 'if ($' + name + ' instanceof CalcError) return $' + name + '; ';\n                    }\n                    code += typeCheck(type, allowError) + 'xargs.push($' + name + '); ';\n                }\n            }\n            code += '} ';\n            return code;\n        }\n        function force() {\n            if (forced) {\n                return '$' + name + '';\n            }\n            haveForced = true;\n            forced = true;\n            resolve += 'toResolve.push(args[i++]); ';\n            return '($' + name + ' = this.force($' + name + '))';\n        }\n        function typeCheck(type, allowError) {\n            forced = false;\n            var ret = 'if (!(' + cond(type) + ')) { ';\n            if (forced && !allowError) {\n                ret += ' if ($' + name + ' instanceof CalcError) return $' + name + '; ';\n            }\n            ret += 'return new CalcError(err); } ';\n            if (!forced) {\n                resolve += 'i++; ';\n            }\n            if (canBeArrayArg) {\n                arrayArgs += 'var $' + name + ' = this.asMatrix(args[i]); ' + 'if ($' + name + ') { ' + 'xargs.push($' + name + '); ' + 'width = Math.max(width, $' + name + '.width); ' + 'height = Math.max(height, $' + name + '.height); ' + 'arrays.push(true) } else { ' + 'xargs.push(args[i]); ' + 'arrays.push(false); } i++; ';\n            } else {\n                arrayArgs += 'xargs.push(args[i++]); arrays.push(false); ';\n            }\n            return ret;\n        }\n        function cond(type) {\n            if (Array.isArray(type)) {\n                if (type[0] == 'or') {\n                    return '(' + type.slice(1).map(cond).join(') || (') + ')';\n                }\n                if (type[0] == 'and') {\n                    return '(' + type.slice(1).map(cond).join(') && (') + ')';\n                }\n                if (type[0] == 'values') {\n                    return '(' + type.slice(1).map(function (val) {\n                        return force() + ' === ' + val;\n                    }).join(') || (') + ')';\n                }\n                if (type[0] == 'null') {\n                    return '(' + cond('null') + ' ? (($' + name + ' = ' + type[1] + '), true) : false)';\n                }\n                if (type[0] == 'between' || type[0] == '[between]') {\n                    return '(' + force() + ' >= ' + type[1] + ' && ' + '$' + name + ' <= ' + type[2] + ' ? true : ((err = \\'NUM\\'), false))';\n                }\n                if (type[0] == '(between)') {\n                    return '(' + force() + ' > ' + type[1] + ' && ' + '$' + name + ' < ' + type[2] + ' ? true : ((err = \\'NUM\\'), false))';\n                }\n                if (type[0] == '(between]') {\n                    return '(' + force() + ' > ' + type[1] + ' && ' + '$' + name + ' <= ' + type[2] + ' ? true : ((err = \\'NUM\\'), false))';\n                }\n                if (type[0] == '[between)') {\n                    return '(' + force() + ' >= ' + type[1] + ' && ' + '$' + name + ' < ' + type[2] + ' ? true : ((err = \\'NUM\\'), false))';\n                }\n                if (type[0] == 'assert') {\n                    var err = type[2] || 'N/A';\n                    return '((' + type[1] + ') ? true : (err = ' + JSON.stringify(err) + ', false))';\n                }\n                if (type[0] == 'not') {\n                    return '!(' + cond(type[1]) + ')';\n                }\n                throw new Error('Unknown array type condition: ' + type[0]);\n            }\n            if (type == 'number') {\n                return '(typeof ' + force() + ' == \\'number\\' || typeof $' + name + ' == \\'boolean\\')';\n            }\n            if (type == 'integer') {\n                return '((typeof ' + force() + ' == \\'number\\' || typeof $' + name + ' == \\'boolean\\') ? ($' + name + ' |= 0, true) : false)';\n            }\n            if (type == 'date') {\n                return '((typeof ' + force() + ' == \\'number\\') ? ($' + name + ' |= 0, true) : false)';\n            }\n            if (type == 'datetime') {\n                return '(typeof ' + force() + ' == \\'number\\')';\n            }\n            if (type == 'divisor') {\n                return '((typeof ' + force() + ' == \\'number\\' || typeof $' + name + ' == \\'boolean\\') && ' + '($' + name + ' == 0 ? ((err = \\'DIV/0\\'), false) : true))';\n            }\n            if (type == 'number+') {\n                return '((typeof ' + force() + ' == \\'number\\' || typeof $' + name + ' == \\'boolean\\') && ($' + name + ' >= 0 ? true : ((err = \\'NUM\\'), false)))';\n            }\n            if (type == 'integer+') {\n                return '((typeof ' + force() + ' == \\'number\\' || typeof $' + name + ' == \\'boolean\\') && (($' + name + ' |= 0) >= 0 ? true : ((err = \\'NUM\\'), false)))';\n            }\n            if (type == 'number++') {\n                return '((typeof ' + force() + ' == \\'number\\' || typeof $' + name + ' == \\'boolean\\') && ($' + name + ' > 0 ? true : ((err = \\'NUM\\'), false)))';\n            }\n            if (type == 'integer++') {\n                return '((typeof ' + force() + ' == \\'number\\' || typeof $' + name + ' == \\'boolean\\') && (($' + name + ' |= 0 ) > 0) ? true : ((err = \\'NUM\\'), false))';\n            }\n            if (type == 'string') {\n                return '(typeof ' + force() + ' == \\'string\\')';\n            }\n            if (type == 'boolean') {\n                return '(typeof ' + force() + ' == \\'boolean\\')';\n            }\n            if (type == 'logical') {\n                return '(typeof ' + force() + ' == \\'boolean\\' || (typeof $' + name + ' == \\'number\\' ? ($' + name + ' = !!$' + name + ', true) : false))';\n            }\n            if (type == 'matrix') {\n                force();\n                return '((m = this.asMatrix($' + name + ')) ? ($' + name + ' = m) : false)';\n            }\n            if (type == '#matrix') {\n                return '((m = this.asMatrix($' + name + ')) ? ($' + name + ' = m) : false)';\n            }\n            if (type == 'ref') {\n                return '($' + name + ' instanceof kendo.spreadsheet.Ref)';\n            }\n            if (type == 'area') {\n                return '($' + name + ' instanceof kendo.spreadsheet.CellRef || $' + name + ' instanceof kendo.spreadsheet.RangeRef)';\n            }\n            if (type == 'cell') {\n                return '($' + name + ' instanceof kendo.spreadsheet.CellRef)';\n            }\n            if (type == 'null') {\n                return '(' + force() + ' == null)';\n            }\n            if (type == 'anyvalue') {\n                return '(' + force() + ' != null && i <= args.length)';\n            }\n            if (type == 'forced') {\n                return '(' + force() + ', i <= args.length)';\n            }\n            if (type == 'anything') {\n                return '(i <= args.length)';\n            }\n            if (type == 'blank') {\n                return '(' + force() + ' == null || $' + name + ' === \\'\\')';\n            }\n            throw new Error('Can\\'t check for type: ' + type);\n        }\n    }\n    function withErrorHandling(obj, f, args) {\n        if (args instanceof CalcError) {\n            return args;\n        }\n        try {\n            return f.apply(obj, args);\n        } catch (ex) {\n            if (ex instanceof CalcError) {\n                return ex;\n            } else {\n                throw ex;\n            }\n        }\n    }\n    function makeSyncFunction(handler, resolve, check, arrayArgs) {\n        return function (callback, args) {\n            function doit() {\n                if (arrayArgs) {\n                    var x = arrayArgs.call(this, args);\n                    args = x.args;\n                    if (x.width > 0 && x.height > 0) {\n                        var result = new Matrix(this);\n                        for (var row = 0; row < x.height; ++row) {\n                            for (var col = 0; col < x.width; ++col) {\n                                var xargs = [];\n                                for (var i = 0; i < args.length; ++i) {\n                                    if (x.arrays[i]) {\n                                        xargs[i] = args[i].get(row, col);\n                                    } else {\n                                        xargs[i] = args[i];\n                                    }\n                                }\n                                xargs = check.call(this, xargs);\n                                result.set(row, col, withErrorHandling(this, handler, xargs));\n                            }\n                        }\n                        return callback(result);\n                    }\n                }\n                var xargs = check.call(this, args);\n                callback(withErrorHandling(this, handler, xargs));\n            }\n            if (resolve) {\n                resolve.call(this, args, doit);\n            } else {\n                doit.call(this);\n            }\n        };\n    }\n    function makeAsyncFunction(handler, resolve, check, arrayArgs) {\n        return function (callback, args) {\n            function doit() {\n                if (arrayArgs) {\n                    var x = arrayArgs.call(this, args);\n                    args = x.args;\n                    if (x.width > 0 && x.height > 0) {\n                        var result = new Matrix(this);\n                        var count = x.width * x.height;\n                        var makeCallback = function (row, col) {\n                            return function (value) {\n                                result.set(row, col, value);\n                                --count;\n                                if (count === 0) {\n                                    return callback(result);\n                                }\n                            };\n                        };\n                        for (var row = 0; row < x.height && count > 0; ++row) {\n                            for (var col = 0; col < x.width && count > 0; ++col) {\n                                var xargs = [];\n                                for (var i = 0; i < args.length; ++i) {\n                                    if (x.arrays[i]) {\n                                        xargs[i] = args[i].get(row, col);\n                                    } else {\n                                        xargs[i] = args[i];\n                                    }\n                                }\n                                xargs = check.call(this, xargs);\n                                if (xargs instanceof CalcError) {\n                                    result.set(row, col, xargs);\n                                    --count;\n                                    if (count === 0) {\n                                        return callback(result);\n                                    }\n                                } else {\n                                    xargs.unshift(makeCallback(row, col));\n                                    handler.apply(this, xargs);\n                                }\n                            }\n                        }\n                        return;\n                    }\n                }\n                var x = check.call(this, args);\n                if (x instanceof CalcError) {\n                    callback(x);\n                } else {\n                    x.unshift(callback);\n                    handler.apply(this, x);\n                }\n            }\n            if (resolve) {\n                resolve.call(this, args, doit);\n            } else {\n                doit.call(this);\n            }\n        };\n    }\n    function defineFunction(name, func) {\n        name = name.toLowerCase();\n        FUNCS[name] = func;\n        return {\n            args: function (args, log) {\n                var code = compileArgumentChecks(name, args);\n                if (log) {\n                    if (code.arrayArgs) {\n                        console.log(code.arrayArgs.toString());\n                    }\n                    if (code.resolve) {\n                        console.log(code.resolve.toString());\n                    }\n                    if (code.check) {\n                        console.log(code.check.toString());\n                    }\n                }\n                var f = FUNCS[name] = makeSyncFunction(func, code.resolve, code.check, code.arrayArgs);\n                f.kendoSpreadsheetArgs = args;\n                return this;\n            },\n            argsAsync: function (args, log) {\n                var code = compileArgumentChecks(name, args);\n                if (log) {\n                    if (code.arrayArgs) {\n                        console.log(code.arrayArgs.toString());\n                    }\n                    if (code.resolve) {\n                        console.log(code.resolve.toString());\n                    }\n                    if (code.check) {\n                        console.log(code.check.toString());\n                    }\n                }\n                var f = FUNCS[name] = makeAsyncFunction(func, code.resolve, code.check, code.arrayArgs);\n                f.kendoSpreadsheetArgs = args;\n                return this;\n            }\n        };\n    }\n    function dateToJulianDays(y, m, d) {\n        m++;\n        return (1461 * (y + 4800 + ((m - 14) / 12 | 0)) / 4 | 0) + (367 * (m - 2 - 12 * ((m - 14) / 12 | 0)) / 12 | 0) - (3 * ((y + 4900 + ((m - 14) / 12 | 0)) / 100 | 0) / 4 | 0) + d - 32075;\n    }\n    function julianDaysToDate(jd) {\n        var l, n, j, i, m, d, y;\n        l = jd + 68569;\n        n = 4 * l / 146097 | 0;\n        l = l - ((146097 * n + 3) / 4 | 0);\n        i = 4000 * (l + 1) / 1461001 | 0;\n        l = l - (1461 * i / 4 | 0) + 31;\n        j = 80 * l / 2447 | 0;\n        d = l - (2447 * j / 80 | 0);\n        l = j / 11 | 0;\n        m = j + 2 - 12 * l;\n        y = 100 * (n - 49) + i + l;\n        m--;\n        return {\n            year: y,\n            month: m,\n            date: d,\n            day: (jd + 1) % 7,\n            ord: ORDINAL_ADD_DAYS[isLeapYear(y)][m] + d\n        };\n    }\n    var BASE_DATE = dateToJulianDays(1900, 0, -1);\n    var DAYS_IN_MONTH = [\n        31,\n        28,\n        31,\n        30,\n        31,\n        30,\n        31,\n        31,\n        30,\n        31,\n        30,\n        31\n    ];\n    var ORDINAL_ADD_DAYS = [\n        [\n            0,\n            31,\n            59,\n            90,\n            120,\n            151,\n            181,\n            212,\n            243,\n            273,\n            304,\n            334\n        ],\n        [\n            0,\n            31,\n            60,\n            91,\n            121,\n            152,\n            182,\n            213,\n            244,\n            274,\n            305,\n            335\n        ]\n    ];\n    function isLeapYear(yr) {\n        if (yr % 4) {\n            return 0;\n        }\n        if (yr % 100) {\n            return 1;\n        }\n        if (yr % 400) {\n            return 0;\n        }\n        return 1;\n    }\n    function daysInYear(yr) {\n        return isLeapYear(yr) ? 366 : 365;\n    }\n    function daysInMonth(yr, mo) {\n        return isLeapYear(yr) && mo == 1 ? 29 : DAYS_IN_MONTH[mo];\n    }\n    function unpackDate(serial) {\n        return julianDaysToDate((serial | 0) + BASE_DATE);\n    }\n    function packDate(year, month, date) {\n        return dateToJulianDays(year, month, date) - BASE_DATE;\n    }\n    var MS_IN_MIN = 60 * 1000;\n    var MS_IN_HOUR = 60 * MS_IN_MIN;\n    var MS_IN_DAY = 24 * MS_IN_HOUR;\n    function unpackTime(serial) {\n        var frac = serial - (serial | 0);\n        if (frac < 0) {\n            frac++;\n        }\n        var ms = Math.round(MS_IN_DAY * frac);\n        var hours = Math.floor(ms / MS_IN_HOUR);\n        ms -= hours * MS_IN_HOUR;\n        var minutes = Math.floor(ms / MS_IN_MIN);\n        ms -= minutes * MS_IN_MIN;\n        var seconds = Math.floor(ms / 1000);\n        ms -= seconds * 1000;\n        return {\n            hours: hours,\n            minutes: minutes,\n            seconds: seconds,\n            milliseconds: ms\n        };\n    }\n    function serialToDate(serial) {\n        var d = unpackDate(serial), t = unpackTime(serial);\n        return new Date(d.year, d.month, d.date, t.hours, t.minutes, t.seconds, t.milliseconds);\n    }\n    function packTime(hours, minutes, seconds, ms) {\n        return (hours + minutes / 60 + seconds / 3600 + ms / 3600000) / 24;\n    }\n    function dateToSerial(date) {\n        var time = packTime(date.getHours(), date.getMinutes(), date.getSeconds(), date.getMilliseconds());\n        date = packDate(date.getFullYear(), date.getMonth(), date.getDate());\n        if (date < 0) {\n            return date - 1 + time;\n        } else {\n            return date + time;\n        }\n    }\n    function parseDate(str) {\n        return kendo.parseDate(str, [\n            'MM/dd/yyyy',\n            'MM-dd-yyyy',\n            'MM/dd/yy',\n            'MM-dd-yy',\n            'MMMM dd yyyy',\n            'MMMM dd yy',\n            'MMM dd yyyy',\n            'MMM dd yy',\n            'dd MMMM yyyy',\n            'dd MMMM yy',\n            'dd MMM yyyy',\n            'dd MMM yy',\n            'MMMM dd, yyyy',\n            'MMMM dd, yy',\n            'MMM dd, yyyy',\n            'MMM dd, yy',\n            'MMMM dd',\n            'MMM dd',\n            'MMMM yyyy',\n            'MMM yyyy',\n            'dd MMMM',\n            'dd MMM',\n            'MM-dd',\n            'MM/dd'\n        ]) || kendo.parseDate(str);\n    }\n    exports.CalcError = CalcError;\n    exports.Formula = Formula;\n    exports.Matrix = Matrix;\n    exports.packDate = packDate;\n    exports.unpackDate = unpackDate;\n    exports.packTime = packTime;\n    exports.unpackTime = unpackTime;\n    exports.serialToDate = serialToDate;\n    exports.dateToSerial = dateToSerial;\n    exports.daysInMonth = daysInMonth;\n    exports.isLeapYear = isLeapYear;\n    exports.daysInYear = daysInYear;\n    exports.parseDate = parseDate;\n    spreadsheet.dateToNumber = dateToSerial;\n    spreadsheet.numberToDate = serialToDate;\n    spreadsheet.defineFunction = defineFunction;\n    spreadsheet.CalcError = CalcError;\n    exports.defineFunction = defineFunction;\n    exports.defineAlias = function (alias, name) {\n        var orig = FUNCS[name];\n        if (!orig) {\n            throw new Error('Function ' + name + ' is not yet defined');\n        }\n        if (!orig.kendoSpreadsheetAliases) {\n            orig.kendoSpreadsheetAliases = [name];\n        }\n        orig.kendoSpreadsheetAliases.push(alias);\n        FUNCS[alias] = orig;\n    };\n    exports.FUNCS = FUNCS;\n    var ARGS_NUMERIC = [\n        [\n            '*a',\n            'number'\n        ],\n        [\n            '*b',\n            'number'\n        ]\n    ];\n    var ARGS_ANYVALUE = [\n        [\n            '*a',\n            'anyvalue'\n        ],\n        [\n            '*b',\n            'anyvalue'\n        ]\n    ];\n    defineFunction('binary+', function (a, b) {\n        return a + b;\n    }).args(ARGS_NUMERIC);\n    defineFunction('binary-', function (a, b) {\n        return a - b;\n    }).args(ARGS_NUMERIC);\n    defineFunction('binary*', function (a, b) {\n        return a * b;\n    }).args(ARGS_NUMERIC);\n    defineFunction('binary/', function (a, b) {\n        return a / b;\n    }).args([\n        [\n            '*a',\n            'number'\n        ],\n        [\n            '*b',\n            'divisor'\n        ]\n    ]);\n    defineFunction('binary^', function (a, b) {\n        return Math.pow(a, b);\n    }).args(ARGS_NUMERIC);\n    defineFunction('binary&', function (a, b) {\n        if (a == null) {\n            a = '';\n        }\n        if (b == null) {\n            b = '';\n        }\n        return '' + a + b;\n    }).args([\n        [\n            '*a',\n            [\n                'or',\n                'number',\n                'string',\n                'boolean',\n                'null'\n            ]\n        ],\n        [\n            '*b',\n            [\n                'or',\n                'number',\n                'string',\n                'boolean',\n                'null'\n            ]\n        ]\n    ]);\n    defineFunction('binary=', function (a, b) {\n        return a === b;\n    }).args(ARGS_ANYVALUE);\n    defineFunction('binary<>', function (a, b) {\n        return a !== b;\n    }).args(ARGS_ANYVALUE);\n    defineFunction('binary<', binaryCompare(function (a, b) {\n        return a < b;\n    })).args(ARGS_ANYVALUE);\n    defineFunction('binary<=', binaryCompare(function (a, b) {\n        return a <= b;\n    })).args(ARGS_ANYVALUE);\n    defineFunction('binary>', binaryCompare(function (a, b) {\n        return a > b;\n    })).args(ARGS_ANYVALUE);\n    defineFunction('binary>=', binaryCompare(function (a, b) {\n        return a >= b;\n    })).args(ARGS_ANYVALUE);\n    defineFunction('unary+', function (a) {\n        return a;\n    }).args([[\n            '*a',\n            'number'\n        ]]);\n    defineFunction('unary-', function (a) {\n        return -a;\n    }).args([[\n            '*a',\n            'number'\n        ]]);\n    defineFunction('unary%', function (a) {\n        return a / 100;\n    }).args([[\n            '*a',\n            'number'\n        ]]);\n    defineFunction('binary:', function (a, b) {\n        return new RangeRef(a, b).setSheet(a.sheet || this.formula.sheet, a.hasSheet());\n    }).args([\n        [\n            'a',\n            'cell'\n        ],\n        [\n            'b',\n            'cell'\n        ]\n    ]);\n    defineFunction('binary,', function (a, b) {\n        return new UnionRef([\n            a,\n            b\n        ]);\n    }).args([\n        [\n            'a',\n            'ref'\n        ],\n        [\n            'b',\n            'ref'\n        ]\n    ]);\n    defineFunction('binary ', function (a, b) {\n        return a.intersect(b);\n    }).args([\n        [\n            'a',\n            'ref'\n        ],\n        [\n            'b',\n            'ref'\n        ]\n    ]);\n    defineFunction('not', function (a) {\n        return !this.bool(a);\n    }).args([[\n            '*a',\n            'anyvalue'\n        ]]);\n    defineFunction('isblank', function (val) {\n        if (val instanceof CellRef) {\n            val = this.getRefData(val);\n            return val == null;\n        }\n        return false;\n    }).args([[\n            '*value',\n            'anything!'\n        ]]);\n    defineFunction('iserror', function (val) {\n        return val instanceof CalcError;\n    }).args([[\n            '*value',\n            'forced!'\n        ]]);\n    defineFunction('iserr', function (val) {\n        return val instanceof CalcError && val.code != 'N/A';\n    }).args([[\n            '*value',\n            'forced!'\n        ]]);\n    defineFunction('isna', function (val) {\n        return val instanceof CalcError && val.code == 'N/A';\n    }).args([[\n            '*value',\n            'forced!'\n        ]]);\n    defineFunction('islogical', function (val) {\n        return typeof val == 'boolean';\n    }).args([[\n            '*value',\n            'forced!'\n        ]]);\n    defineFunction('isnontext', function (val) {\n        return typeof val != 'string';\n    }).args([[\n            '*value',\n            'forced!'\n        ]]);\n    defineFunction('istext', function (val) {\n        return typeof val == 'string';\n    }).args([[\n            '*value',\n            'forced!'\n        ]]);\n    defineFunction('isnumber', function (val) {\n        return typeof val == 'number';\n    }).args([[\n            '*value',\n            'forced!'\n        ]]);\n    defineFunction('isref', function (val) {\n        return val instanceof CellRef || val instanceof RangeRef;\n    }).args([[\n            '*value',\n            'anything!'\n        ]]);\n    function binaryCompare(func) {\n        return function (left, right) {\n            if (typeof left == 'string' && typeof right != 'string') {\n                right = right == null ? '' : right + '';\n            }\n            if (typeof left != 'string' && typeof right == 'string') {\n                left = left == null ? '' : left + '';\n            }\n            if (typeof left == 'number' && right == null) {\n                right = 0;\n            }\n            if (typeof right == 'number' && left == null) {\n                left = 0;\n            }\n            if (typeof left == 'string' && typeof right == 'string') {\n                left = left.toLowerCase();\n                right = right.toLowerCase();\n            }\n            if (typeof right == typeof left) {\n                return func(left, right);\n            } else {\n                return new CalcError('VALUE');\n            }\n        };\n    }\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/validation', ['spreadsheet/runtime'], f);\n}(function () {\n    'use strict';\n    var $ = kendo.jQuery;\n    if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n        return;\n    }\n    var spreadsheet = kendo.spreadsheet;\n    var exports = {};\n    spreadsheet.validation = exports;\n    var calc = spreadsheet.calc;\n    var Class = kendo.Class;\n    var TRANSPOSE_FORMAT = '_matrix({0})';\n    var DATE_FORMAT = 'DATEVALUE(\"{0}\")';\n    calc.runtime.defineFunction('_matrix', function (m) {\n        return m;\n    }).args([[\n            'm',\n            'matrix'\n        ]]);\n    function compileValidation(sheet, row, col, validation) {\n        var validationHandler;\n        var comparer;\n        var parsedFromDate;\n        var parsedToDate;\n        if (typeof validation === 'string') {\n            validation = JSON.parse(validation);\n        }\n        if (validation.from) {\n            if (validation.dataType === 'list') {\n                validation.from = kendo.format(TRANSPOSE_FORMAT, validation.from);\n            }\n            if (validation.dataType === 'date') {\n                parsedFromDate = calc.runtime.parseDate(validation.from);\n                if (parsedFromDate) {\n                    validation.from = kendo.format(DATE_FORMAT, validation.from);\n                    validation.fromIsDateValue = true;\n                }\n            }\n            validation.from = calc.compile(calc.parseFormula(sheet, row, col, validation.from));\n        }\n        if (validation.to) {\n            if (validation.dataType === 'date') {\n                parsedToDate = calc.runtime.parseDate(validation.to);\n                if (parsedToDate) {\n                    validation.to = kendo.format(DATE_FORMAT, validation.to);\n                    validation.toIsDateValue = true;\n                }\n            }\n            validation.to = calc.compile(calc.parseFormula(sheet, row, col, validation.to));\n        }\n        if (validation.dataType == 'custom') {\n            comparer = exports.validationComparers.custom;\n        } else if (validation.dataType == 'list') {\n            comparer = exports.validationComparers.list;\n        } else {\n            comparer = exports.validationComparers[validation.comparerType];\n        }\n        if (!comparer) {\n            throw kendo.format('\\'{0}\\' comparer is not implemented.', validation.comparerType);\n        }\n        validationHandler = function (valueToCompare) {\n            var toValue = this.to && this.to.value ? this.to.value : undefined;\n            if (valueToCompare === null || valueToCompare === '') {\n                if (this.allowNulls) {\n                    this.value = true;\n                } else {\n                    this.value = false;\n                }\n            } else if (this.dataType == 'custom') {\n                this.value = comparer(valueToCompare, this.from.value, toValue);\n            } else if (this.dataType == 'list') {\n                var data = this._getListData();\n                this.value = comparer(valueToCompare, data, toValue);\n            } else {\n                this.value = comparer(valueToCompare, this.from.value, toValue);\n            }\n            return this.value;\n        };\n        return new kendo.spreadsheet.validation.Validation($.extend(validation, {\n            handler: validationHandler,\n            sheet: sheet,\n            row: row,\n            col: col\n        }));\n    }\n    var Validation = Class.extend({\n        init: function Validation(options) {\n            this.handler = options.handler;\n            this.from = options.from;\n            this.to = options.to;\n            this.dataType = options.dataType;\n            this.comparerType = options.comparerType;\n            this.type = options.type ? options.type : 'warning';\n            this.allowNulls = options.allowNulls ? true : false;\n            this.fromIsDateValue = options.fromIsDateValue ? true : false;\n            this.toIsDateValue = options.toIsDateValue ? true : false;\n            this.sheet = options.sheet;\n            this.row = options.row;\n            this.col = options.col;\n            if (options.tooltipMessageTemplate) {\n                this.tooltipMessageTemplate = options.tooltipMessageTemplate;\n            }\n            if (options.tooltipTitleTemplate) {\n                this.tooltipTitleTemplate = options.tooltipTitleTemplate;\n            }\n            if (options.messageTemplate) {\n                this.messageTemplate = options.messageTemplate;\n            }\n            if (options.titleTemplate) {\n                this.titleTemplate = options.titleTemplate;\n            }\n        },\n        _formatMessages: function (format) {\n            var from = this.from ? this.from.value : '';\n            var to = this.to ? this.to.value : '';\n            var fromFormula = this.from ? this.from.toString() : '';\n            var toFormula = this.to ? this.to.toString() : '';\n            var dataType = this.dataType;\n            var type = this.type;\n            var comparerType = this.comparerType;\n            return kendo.format(format, from, to, fromFormula, toFormula, dataType, type, comparerType);\n        },\n        _setMessages: function () {\n            this.title = '';\n            this.message = '';\n            if (this.tooltipTitleTemplate) {\n                this.tooltipTitle = this._formatMessages(this.tooltipTitleTemplate);\n            }\n            if (this.tooltipMessageTemplate) {\n                this.tooltipMessage = this._formatMessages(this.tooltipMessageTemplate);\n            }\n            if (this.titleTemplate) {\n                this.title = this._formatMessages(this.titleTemplate);\n            }\n            if (this.messageTemplate) {\n                this.message = this._formatMessages(this.messageTemplate);\n            }\n        },\n        _getListData: function () {\n            if (!this.from.value || !this.from.value.data) {\n                return [];\n            }\n            var cube = this.from.value.data;\n            var i;\n            var y;\n            var data = [];\n            for (i = 0; i < cube.length; i++) {\n                var array = cube[i];\n                if (array) {\n                    for (y = 0; y < array.length; y++) {\n                        data.push(array[y]);\n                    }\n                }\n            }\n            return data;\n        },\n        clone: function (sheet, row, col) {\n            var options = this._getOptions();\n            if (options.from) {\n                options.from = options.from.clone(sheet, row, col);\n            }\n            if (options.to) {\n                options.to = options.to.clone(sheet, row, col);\n            }\n            return new Validation($.extend(options, { handler: this.handler }, {\n                sheet: sheet,\n                row: row,\n                col: col\n            }));\n        },\n        exec: function (ss, compareValue, compareFormat, callback) {\n            var self = this;\n            var calculateFromCallBack = function () {\n                self.value = self.handler.call(self, compareValue, compareFormat);\n                self._setMessages();\n                if (callback) {\n                    callback(self.value);\n                }\n            };\n            if (self.to) {\n                self.to.exec(ss, function () {\n                    self.from.exec(ss, calculateFromCallBack);\n                });\n            } else {\n                self.from.exec(ss, calculateFromCallBack);\n            }\n        },\n        reset: function () {\n            if (this.from) {\n                this.from.reset();\n            }\n            if (this.to) {\n                this.to.reset();\n            }\n            delete this.value;\n        },\n        adjust: function (affectedSheet, operation, start, delta) {\n            if (this.from) {\n                this.from.adjust(affectedSheet, operation, start, delta);\n            }\n            if (this.to) {\n                this.to.adjust(affectedSheet, operation, start, delta);\n            }\n            if (this.sheet.toLowerCase() == affectedSheet.toLowerCase()) {\n                var formulaRow = this.row;\n                var formulaCol = this.col;\n                switch (operation) {\n                case 'row':\n                    if (formulaRow >= start) {\n                        this.row += delta;\n                    }\n                    break;\n                case 'col':\n                    if (formulaCol >= start) {\n                        this.col += delta;\n                    }\n                    break;\n                }\n            }\n        },\n        toJSON: function () {\n            var options = this._getOptions();\n            if (options.from) {\n                options.from = options.from.toString();\n                if (options.dataType === 'list') {\n                    options.from = options.from.replace(/^_matrix\\((.*)\\)$/i, '$1');\n                }\n                if (options.dataType === 'date') {\n                    if (this.fromIsDateValue) {\n                        options.from = options.from.replace(/^DATEVALUE\\(\"(.*)\"\\)$/i, '$1');\n                    }\n                }\n            }\n            if (options.to) {\n                options.to = options.to.toString();\n                if (options.dataType === 'date') {\n                    if (this.toIsDateValue) {\n                        options.to = options.to.replace(/^DATEVALUE\\(\"(.*)\"\\)$/i, '$1');\n                    }\n                }\n            }\n            return options;\n        },\n        _getOptions: function () {\n            return {\n                from: this.from,\n                to: this.to,\n                dataType: this.dataType,\n                type: this.type,\n                comparerType: this.comparerType,\n                row: this.row,\n                col: this.col,\n                sheet: this.sheet,\n                allowNulls: this.allowNulls,\n                tooltipMessageTemplate: this.tooltipMessageTemplate,\n                tooltipTitleTemplate: this.tooltipTitleTemplate,\n                messageTemplate: this.messageTemplate,\n                titleTemplate: this.titleTemplate\n            };\n        }\n    });\n    exports.compile = compileValidation;\n    exports.validationComparers = {\n        greaterThan: function (valueToCompare, from) {\n            return valueToCompare > from;\n        },\n        lessThan: function (valueToCompare, from) {\n            return valueToCompare < from;\n        },\n        between: function (valueToCompare, from, to) {\n            return valueToCompare > from && valueToCompare < to;\n        },\n        equalTo: function (valueToCompare, from) {\n            return valueToCompare == from;\n        },\n        notEqualTo: function (valueToCompare, from) {\n            return valueToCompare != from;\n        },\n        greaterThanOrEqualTo: function (valueToCompare, from) {\n            return valueToCompare >= from;\n        },\n        lessThanOrEqualTo: function (valueToCompare, from) {\n            return valueToCompare <= from;\n        },\n        notBetween: function (valueToCompare, from, to) {\n            return valueToCompare < from || valueToCompare > to;\n        },\n        custom: function (valueToCompare, from) {\n            return from;\n        },\n        list: function (valueToCompare, data) {\n            return data.indexOf(valueToCompare) > -1;\n        }\n    };\n    exports.Validation = Validation;\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/sheet', [\n        'kendo.core',\n        'kendo.color',\n        'spreadsheet/runtime',\n        'spreadsheet/validation',\n        'spreadsheet/references'\n    ], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var RangeRef = kendo.spreadsheet.RangeRef;\n        var CellRef = kendo.spreadsheet.CellRef;\n        var Range = kendo.spreadsheet.Range;\n        var Color = kendo.Color;\n        var Selection = kendo.Class.extend({\n            init: function (sheet) {\n                this._sheet = sheet;\n                this.selection = kendo.spreadsheet.FIRSTREF.toRangeRef();\n                this.originalSelection = kendo.spreadsheet.FIRSTREF.toRangeRef();\n                this._activeCell = kendo.spreadsheet.FIRSTREF.toRangeRef();\n                this.originalActiveCell = kendo.spreadsheet.FIRSTREF;\n            },\n            currentSelectionRange: function () {\n                return this.selection.rangeAt(this.selectionRangeIndex).toRangeRef();\n            },\n            currentOriginalNavigationRange: function () {\n                return this.originalSelection.rangeAt(this.selectionRangeIndex).toRangeRef();\n            },\n            currentNavigationRange: function () {\n                if (this.singleCellSelection()) {\n                    return this._sheet._sheetRef;\n                } else {\n                    return this.selection.rangeAt(this.selectionRangeIndex).toRangeRef();\n                }\n            },\n            nextNavigationRange: function () {\n                if (!this.singleCellSelection()) {\n                    this.selectionRangeIndex = this.selection.nextRangeIndex(this.selectionRangeIndex);\n                }\n                return this.currentNavigationRange();\n            },\n            previousNavigationRange: function () {\n                if (!this.singleCellSelection()) {\n                    this.selectionRangeIndex = this.selection.previousRangeIndex(this.selectionRangeIndex);\n                }\n                return this.currentNavigationRange();\n            },\n            activeCell: function (ref) {\n                if (ref) {\n                    this.originalActiveCell = ref;\n                    this._activeCell = this._sheet.unionWithMerged(ref.toRangeRef());\n                    this._sheet.focus(ref);\n                    this._sheet.triggerChange({\n                        activeCell: true,\n                        selection: true\n                    });\n                }\n                return this._activeCell;\n            },\n            select: function (ref, expanded, changeActiveCell) {\n                if (ref) {\n                    if (ref.eq(this.originalSelection)) {\n                        return;\n                    }\n                    this.originalSelection = ref;\n                    this.selection = expanded;\n                    if (changeActiveCell !== false) {\n                        if (ref.isCell()) {\n                            this.activeCell(ref);\n                        } else {\n                            this.activeCell(this.selection.lastRange().first());\n                        }\n                        this.selectionRangeIndex = this.selection.size() - 1;\n                    } else {\n                        this._sheet.triggerChange({ selection: true });\n                    }\n                }\n                return this.selection;\n            },\n            singleCellSelection: function () {\n                return this._activeCell.eq(this.selection);\n            }\n        });\n        var Sheet = kendo.Observable.extend({\n            init: function (rowCount, columnCount, rowHeight, columnWidth, headerHeight, headerWidth) {\n                kendo.Observable.prototype.init.call(this);\n                var cellCount = rowCount * columnCount - 1;\n                this._rows = new kendo.spreadsheet.Axis(rowCount, rowHeight);\n                this._columns = new kendo.spreadsheet.Axis(columnCount, columnWidth);\n                this._mergedCells = [];\n                this._frozenRows = 0;\n                this._frozenColumns = 0;\n                this._suspendChanges = false;\n                this._filter = null;\n                this._grid = new kendo.spreadsheet.Grid(this._rows, this._columns, rowCount, columnCount, headerHeight, headerWidth);\n                this._sheetRef = this._grid.normalize(kendo.spreadsheet.SHEETREF);\n                this._properties = new kendo.spreadsheet.PropertyBag(cellCount);\n                this._sorter = new kendo.spreadsheet.Sorter(this._grid, this._properties.sortable());\n                this._viewSelection = new Selection(this);\n                this._editSelection = new Selection(this);\n                this._formulaSelections = [];\n                this.options = { showGridLines: true };\n            },\n            _selectionState: function () {\n                return this._inEdit ? this._editSelection : this._viewSelection;\n            },\n            navigator: function () {\n                if (!this._navigator) {\n                    this._navigator = new kendo.spreadsheet.SheetNavigator(this);\n                }\n                return this._navigator;\n            },\n            axisManager: function () {\n                if (!this._axisManager) {\n                    this._axisManager = new kendo.spreadsheet.AxisManager(this);\n                }\n                return this._axisManager;\n            },\n            _name: function (value) {\n                if (!value) {\n                    return this._sheetName;\n                }\n                this._sheetName = value;\n                return this;\n            },\n            name: function () {\n                return this._name();\n            },\n            _property: function (accessor, value, reason) {\n                if (value === undefined) {\n                    return accessor();\n                } else {\n                    accessor(value);\n                    return this.triggerChange(reason);\n                }\n            },\n            _field: function (name, value, reason) {\n                if (value === undefined) {\n                    return this[name];\n                } else {\n                    this[name] = value;\n                    return this.triggerChange(reason);\n                }\n            },\n            suspendChanges: function (value) {\n                if (value === undefined) {\n                    return this._suspendChanges;\n                }\n                this._suspendChanges = value;\n                return this;\n            },\n            triggerChange: function (reason) {\n                if (!this._suspendChanges) {\n                    this.trigger('change', reason);\n                }\n                return this;\n            },\n            setDataSource: function (dataSource, columns) {\n                if (this.dataSourceBinder) {\n                    this.dataSourceBinder.destroy();\n                }\n                this.dataSourceBinder = new kendo.spreadsheet.SheetDataSourceBinder({\n                    dataSource: dataSource,\n                    sheet: this,\n                    columns: columns\n                });\n            },\n            hideColumn: function (columnIndex) {\n                return this._property(this._columns.hide.bind(this._columns), columnIndex, { layout: true });\n            },\n            unhideColumn: function (columnIndex) {\n                return this._property(this._columns.unhide.bind(this._columns), columnIndex, { layout: true });\n            },\n            isHiddenColumn: function (columnIndex) {\n                return this._grid._columns.hidden(columnIndex);\n            },\n            _copyRange: function (sourceRangeRef, targetRef) {\n                var grid = this._grid;\n                var rowCount = grid.rowCount;\n                var nextRefTopLeft = grid.normalize(sourceRangeRef.topLeft);\n                var nextRefBottomRight = grid.normalize(sourceRangeRef.bottomRight);\n                var nextIndex = nextRefTopLeft.col * rowCount + nextRefTopLeft.row;\n                var nextBottomIndex = nextRefBottomRight.col * rowCount + nextRefBottomRight.row;\n                var targetIndex = targetRef.col * rowCount + targetRef.row;\n                this._properties.copy(nextIndex, nextBottomIndex, targetIndex);\n            },\n            _adjustReferences: function (operation, start, delta, mergedCells) {\n                this._mergedCells = mergedCells.reduce(function (a, ref) {\n                    ref = ref.adjust(null, null, null, null, operation == 'row', start, delta);\n                    if (ref !== kendo.spreadsheet.NULLREF) {\n                        a.push(ref);\n                    }\n                    return a;\n                }, []);\n                if (this._workbook) {\n                    var affectedSheet = this._name();\n                    this._workbook._sheets.forEach(function (sheet) {\n                        sheet._forFormulas(function (formula) {\n                            formula.adjust(affectedSheet, operation, start, delta);\n                        });\n                        sheet._forValidations(function (validation) {\n                            validation.adjust(affectedSheet, operation, start, delta);\n                        });\n                    });\n                    this._workbook.adjustNames(affectedSheet, operation == 'row', start, delta);\n                }\n                var selection = this.select();\n                selection = selection.adjust(null, null, null, null, operation == 'row', start, delta);\n                if (selection !== kendo.spreadsheet.NULLREF) {\n                    this.select(selection);\n                }\n            },\n            _forFormulas: function (callback) {\n                var props = this._properties;\n                var formulas = props.get('formula').values();\n                var n = formulas.length;\n                formulas.forEach(function (f, i) {\n                    callback.call(this, f.value, i, n);\n                }, this);\n            },\n            _forValidations: function (callback) {\n                var props = this._properties;\n                props.get('validation').values().forEach(function (v) {\n                    callback.call(this, v.value);\n                }, this);\n            },\n            canInsertRow: function (rowIndex, count) {\n                count = count || 1;\n                var grid = this._grid;\n                var range = this.range(grid.rowCount - count, 0, count, grid.columnCount);\n                return !range.hasValue();\n            },\n            insertRow: function (rowIndex) {\n                if (!this.canInsertRow(rowIndex)) {\n                    throw new Error('Shifting nonblank cells off the worksheet is not supported!');\n                }\n                this.batch(function () {\n                    var grid = this._grid;\n                    var columnCount = grid.columnCount;\n                    var rowCount = grid.rowCount;\n                    var frozenRows = this.frozenRows();\n                    if (rowIndex < frozenRows) {\n                        this.frozenRows(frozenRows + 1);\n                    }\n                    var mergedCells = this._mergedCells.slice();\n                    for (var ci = 0; ci < columnCount; ci++) {\n                        var ref = new RangeRef(new CellRef(rowIndex, ci), new CellRef(rowIndex, ci));\n                        var topLeft = grid.normalize(ref.topLeft);\n                        var bottomRight = grid.normalize(ref.bottomRight);\n                        var nextRef = new RangeRef(new CellRef(topLeft.row, topLeft.col), new CellRef(rowCount - 2, bottomRight.col));\n                        this._copyRange(nextRef, new CellRef(topLeft.row + 1, topLeft.col));\n                        new Range(ref, this).clear();\n                    }\n                    this._adjustReferences('row', rowIndex, 1, mergedCells);\n                }, {\n                    recalc: true,\n                    layout: true\n                });\n                this.trigger('insertRow', { index: rowIndex });\n                return this;\n            },\n            isEnabledRow: function (rowIndex) {\n                var ref = new RangeRef(new CellRef(rowIndex, 0), new CellRef(rowIndex, this._grid.columnCount));\n                return new Range(ref, this).enable();\n            },\n            deleteRow: function (rowIndex) {\n                if (!this.isEnabledRow(rowIndex)) {\n                    return this;\n                }\n                this.batch(function () {\n                    var grid = this._grid;\n                    var columnCount = grid.columnCount;\n                    var frozenRows = this.frozenRows();\n                    if (rowIndex < frozenRows) {\n                        this.frozenRows(frozenRows - 1);\n                    }\n                    var mergedCells = this._mergedCells.slice();\n                    for (var ci = 0; ci < columnCount; ci++) {\n                        var ref = new RangeRef(new CellRef(rowIndex, ci), new CellRef(rowIndex, ci));\n                        new Range(ref, this).clear();\n                        var topLeft = grid.normalize(ref.topLeft);\n                        var bottomRight = grid.normalize(ref.bottomRight);\n                        var nextRef = new RangeRef(new CellRef(topLeft.row + 1, topLeft.col), new CellRef(Infinity, bottomRight.col));\n                        this._copyRange(nextRef, topLeft);\n                        var nextRefBottomRight = grid.normalize(nextRef.bottomRight);\n                        new Range(new RangeRef(nextRefBottomRight, nextRefBottomRight), this).clear();\n                    }\n                    this._adjustReferences('row', rowIndex, -1, mergedCells);\n                }, {\n                    recalc: true,\n                    layout: true\n                });\n                this.trigger('deleteRow', { index: rowIndex });\n                return this;\n            },\n            insertColumn: function (columnIndex) {\n                this.batch(function () {\n                    var grid = this._grid;\n                    var columnCount = grid.columnCount;\n                    var frozenColumns = this.frozenColumns();\n                    if (columnIndex < frozenColumns) {\n                        this.frozenColumns(frozenColumns + 1);\n                    }\n                    var mergedCells = this._mergedCells.slice();\n                    for (var ci = columnCount; ci >= columnIndex; ci--) {\n                        var ref = new RangeRef(new CellRef(0, ci), new CellRef(Infinity, ci));\n                        new Range(ref, this).clear();\n                        if (ci == columnIndex) {\n                            break;\n                        }\n                        var topLeft = grid.normalize(ref.topLeft);\n                        var bottomRight = grid.normalize(ref.bottomRight);\n                        var nextRef = new RangeRef(new CellRef(topLeft.row, topLeft.col - 1), new CellRef(bottomRight.row, bottomRight.col - 1));\n                        this._copyRange(nextRef, topLeft);\n                    }\n                    this._adjustReferences('col', columnIndex, 1, mergedCells);\n                }, {\n                    recalc: true,\n                    layout: true\n                });\n                return this;\n            },\n            isEnabledColumn: function (columnIndex) {\n                var ref = new RangeRef(new CellRef(0, columnIndex), new CellRef(Infinity, columnIndex));\n                return new Range(ref, this).enable();\n            },\n            deleteColumn: function (columnIndex) {\n                if (!this.isEnabledColumn(columnIndex)) {\n                    return this;\n                }\n                this.batch(function () {\n                    var grid = this._grid;\n                    var columnCount = grid.columnCount;\n                    var frozenColumns = this.frozenColumns();\n                    if (columnIndex < frozenColumns) {\n                        this.frozenColumns(frozenColumns - 1);\n                    }\n                    var mergedCells = this._mergedCells.slice();\n                    for (var ci = columnIndex; ci < columnCount; ci++) {\n                        var ref = new RangeRef(new CellRef(0, ci), new CellRef(Infinity, ci));\n                        new Range(ref, this).clear();\n                        if (ci == columnCount - 1) {\n                            break;\n                        }\n                        var topLeft = grid.normalize(ref.topLeft);\n                        var bottomRight = grid.normalize(ref.bottomRight);\n                        var nextRef = new RangeRef(new CellRef(topLeft.row, topLeft.col + 1), new CellRef(bottomRight.row, bottomRight.col + 1));\n                        this._copyRange(nextRef, topLeft);\n                    }\n                    this._adjustReferences('col', columnIndex, -1, mergedCells);\n                }, {\n                    recalc: true,\n                    layout: true\n                });\n                return this;\n            },\n            hideRow: function (rowIndex) {\n                return this._property(this._rows.hide.bind(this._rows), rowIndex, { layout: true });\n            },\n            unhideRow: function (rowIndex) {\n                return this._property(this._rows.unhide.bind(this._rows), rowIndex, { layout: true });\n            },\n            isHiddenRow: function (rowIndex) {\n                return this._grid._rows.hidden(rowIndex);\n            },\n            columnWidth: function (columnIndex, width) {\n                return this._property(this._columns.value.bind(this._columns, columnIndex, columnIndex), width, { layout: true });\n            },\n            rowHeight: function (rowIndex, height) {\n                return this._property(this._rows.value.bind(this._rows, rowIndex, rowIndex), height, { layout: true });\n            },\n            frozenRows: function (value) {\n                return this._field('_frozenRows', value, { layout: true });\n            },\n            frozenColumns: function (value) {\n                return this._field('_frozenColumns', value, { layout: true });\n            },\n            _ref: function (row, column, numRows, numColumns) {\n                var ref = null;\n                if (row instanceof kendo.spreadsheet.Ref) {\n                    return row;\n                }\n                if (row instanceof kendo.spreadsheet.Range) {\n                    return row._ref.toRangeRef();\n                }\n                if (typeof row === 'string') {\n                    ref = kendo.spreadsheet.calc.parseReference(row);\n                } else {\n                    if (!numRows) {\n                        numRows = 1;\n                    }\n                    if (!numColumns) {\n                        numColumns = 1;\n                    }\n                    ref = new RangeRef(new CellRef(row, column), new CellRef(row + numRows - 1, column + numColumns - 1));\n                }\n                return ref;\n            },\n            range: function (row, column, numRows, numColumns) {\n                return new Range(this._ref(row, column, numRows, numColumns), this);\n            },\n            forEachMergedCell: function (ref, callback) {\n                var selectAll = false;\n                if (typeof callback === 'undefined') {\n                    callback = ref;\n                    selectAll = true;\n                }\n                this._mergedCells.forEach(function (merged) {\n                    if (selectAll || merged.intersects(ref)) {\n                        callback(merged);\n                    }\n                });\n            },\n            forEachFilterHeader: function (ref, callback) {\n                var selectAll = false;\n                if (typeof callback === 'undefined') {\n                    callback = ref;\n                    selectAll = true;\n                }\n                if (this._filter) {\n                    var refs = [];\n                    this._filter.ref.forEachColumn(function (columnRef) {\n                        if (selectAll || columnRef.intersects(ref)) {\n                            refs.push(columnRef.topLeft);\n                        }\n                    });\n                    this._mergedCells.forEach(function (merged) {\n                        refs = refs.map(function (ref) {\n                            if (merged.intersects(ref)) {\n                                return merged;\n                            }\n                            return ref;\n                        });\n                    });\n                    refs.reduce(function unique(result, element) {\n                        if (result.indexOf(element) < 0) {\n                            result.push(element);\n                        }\n                        return result;\n                    }, []).forEach(callback);\n                }\n            },\n            forEach: function (ref, callback) {\n                if (!(ref instanceof RangeRef)) {\n                    ref = this._ref(ref);\n                }\n                var topLeft = this._grid.normalize(ref.topLeft);\n                var bottomRight = this._grid.normalize(ref.bottomRight);\n                for (var ci = topLeft.col; ci <= bottomRight.col; ci++) {\n                    var ri = topLeft.row;\n                    var startCellIndex = this._grid.index(ri, ci);\n                    var endCellIndex = this._grid.index(bottomRight.row, ci);\n                    this._properties.forEach(startCellIndex, endCellIndex, function (value) {\n                        callback(ri++, ci, value);\n                    });\n                }\n            },\n            startResizing: function (initialPosition) {\n                this._initialPosition = initialPosition;\n                this._resizeInProgress = true;\n            },\n            startAutoFill: function () {\n                this._autoFillInProgress = true;\n                var selection = this.select();\n                this._autoFillOrigin = selection;\n                this._autoFillDest = selection;\n                this.triggerChange({ selection: true });\n            },\n            updateAutoFill: function (dest, punch, hint, direction) {\n                this._autoFillDest = dest;\n                this._autoFillPunch = punch;\n                this._autoFillHint = hint;\n                this._autoFillDirection = direction;\n                this.triggerChange({ selection: true });\n            },\n            autoFillRef: function () {\n                return this._autoFillDest;\n            },\n            autoFillPunch: function () {\n                return this._autoFillPunch;\n            },\n            autoFillInProgress: function () {\n                return this._autoFillInProgress;\n            },\n            resizingInProgress: function () {\n                return this._resizeInProgress;\n            },\n            completeResizing: function () {\n                if (this._resizeInProgress) {\n                    this._resizeInProgress = false;\n                    var hintPosition = this.resizeHintPosition();\n                    if (this._initialPosition && hintPosition) {\n                        var handlePosition = this.resizeHandlePosition();\n                        if (handlePosition.col !== -Infinity) {\n                            this.columnWidth(handlePosition.col, this.columnWidth(handlePosition.col) - (this._initialPosition.x - hintPosition.x));\n                        } else {\n                            this.rowHeight(handlePosition.row, this.rowHeight(handlePosition.row) - (this._initialPosition.y - hintPosition.y));\n                        }\n                    } else {\n                        this.trigger('change', { resize: true });\n                    }\n                }\n            },\n            resizeHandlePosition: function () {\n                return this._resizeHandlePosition;\n            },\n            resizeHintPosition: function (location) {\n                if (location !== undefined) {\n                    this._resizeHintPosition = location;\n                    this.trigger('change', { resize: true });\n                }\n                return this._resizeHintPosition;\n            },\n            removeResizeHandle: function () {\n                if (this._resizeHandlePosition) {\n                    this._resizeHintPosition = undefined;\n                    this._resizeHandlePosition = undefined;\n                    this._initialPosition = undefined;\n                    this.trigger('change', { resize: true });\n                }\n            },\n            positionResizeHandle: function (ref) {\n                this._resizeHandlePosition = ref;\n                this.trigger('change', { resize: true });\n            },\n            startSelection: function () {\n                this._selectionInProgress = true;\n            },\n            completeSelection: function () {\n                if (this._selectionInProgress) {\n                    this._selectionInProgress = false;\n                    this._resizeHintPosition = undefined;\n                    this.trigger('change', { selection: true });\n                }\n                if (this._autoFillInProgress) {\n                    this._autoFillInProgress = false;\n                    var dest = this._autoFillDest;\n                    var origin = this._autoFillOrigin;\n                    if (this._autoFillPunch) {\n                        this._workbook.execute({\n                            command: 'ClearContentCommand',\n                            options: { operatingRange: this.range(this._autoFillPunch) }\n                        });\n                    } else {\n                        if (!dest.eq(origin)) {\n                            this._workbook.execute({\n                                command: 'AutoFillCommand',\n                                options: {\n                                    operatingRange: this.range(dest),\n                                    origin: this.range(origin)\n                                }\n                            });\n                        } else {\n                            this.triggerChange({ selection: true });\n                        }\n                    }\n                    this._autoFillDest = null;\n                    this._autoFillPunch = null;\n                    this._autoFillOrigin = null;\n                    this.select(dest);\n                }\n            },\n            selectionInProgress: function () {\n                return this._selectionInProgress;\n            },\n            select: function (ref, changeActiveCell) {\n                var selectionState = this._selectionState();\n                var expandedRef;\n                if (ref) {\n                    ref = this._ref(ref);\n                    expandedRef = this._grid.isAxis(ref) ? ref : this.unionWithMerged(ref);\n                }\n                return selectionState.select(ref, expandedRef, changeActiveCell);\n            },\n            originalSelect: function () {\n                return this._selectionState().originalSelection;\n            },\n            currentSelectionRange: function () {\n                return this._selectionState().currentSelectionRange();\n            },\n            currentOriginalSelectionRange: function () {\n                return this._selectionState().currentOriginalNavigationRange();\n            },\n            currentNavigationRange: function () {\n                return this._selectionState().currentNavigationRange();\n            },\n            nextNavigationRange: function () {\n                return this._selectionState().nextNavigationRange();\n            },\n            previousNavigationRange: function () {\n                return this._selectionState().previousNavigationRange();\n            },\n            selectionRangeIndex: function () {\n                return this._selectionState().selectionRangeIndex;\n            },\n            activeCell: function (ref) {\n                return this._selectionState().activeCell(ref);\n            },\n            originalActiveCell: function () {\n                return this._selectionState().originalActiveCell;\n            },\n            singleCellSelection: function () {\n                return this._selectionState().singleCellSelection();\n            },\n            unionWithMerged: function (ref) {\n                var mergedCells = this._mergedCells;\n                return ref.map(function (ref) {\n                    return ref.toRangeRef().union(mergedCells);\n                });\n            },\n            trim: function (ref) {\n                var trims = [];\n                var grid = this._grid;\n                this._properties.forEachProperty(function (property) {\n                    trims.push(grid.trim(ref, property.list));\n                });\n                return this.unionWithMerged(ref.topLeft.toRangeRef().union(trims));\n            },\n            focus: function (ref) {\n                if (ref) {\n                    this._focus = ref.toRangeRef();\n                } else {\n                    var focus = this._focus;\n                    this._focus = null;\n                    return focus;\n                }\n            },\n            activeCellSelection: function () {\n                return new Range(this._grid.normalize(this.activeCell()), this);\n            },\n            selection: function () {\n                return new Range(this._grid.normalize(this._selectionState().selection), this);\n            },\n            selectedHeaders: function () {\n                var selection = this.select();\n                var rows = {};\n                var cols = {};\n                var allCols = false;\n                var allRows = false;\n                selection.forEach(function (ref) {\n                    var i;\n                    var rowState = 'partial';\n                    var colState = 'partial';\n                    ref = ref.toRangeRef();\n                    var bottomRight = ref.bottomRight;\n                    var rowSelection = bottomRight.col === Infinity;\n                    var colSelection = bottomRight.row === Infinity;\n                    if (colSelection) {\n                        allRows = true;\n                        colState = 'full';\n                    }\n                    if (rowSelection) {\n                        allCols = true;\n                        rowState = 'full';\n                    }\n                    if (!colSelection) {\n                        for (i = ref.topLeft.row; i <= bottomRight.row; i++) {\n                            if (rows[i] !== 'full') {\n                                rows[i] = rowState;\n                            }\n                        }\n                    }\n                    if (!rowSelection) {\n                        for (i = ref.topLeft.col; i <= bottomRight.col; i++) {\n                            if (cols[i] !== 'full') {\n                                cols[i] = colState;\n                            }\n                        }\n                    }\n                });\n                return {\n                    rows: rows,\n                    cols: cols,\n                    allRows: allRows,\n                    allCols: allCols,\n                    all: allRows && allCols\n                };\n            },\n            isInEditMode: function (isInEdit) {\n                if (isInEdit === undefined) {\n                    return this._inEdit;\n                }\n                this._inEdit = isInEdit;\n                if (isInEdit) {\n                    this._editSelection.selection = this._viewSelection.selection.clone();\n                    this._editSelection.originalSelection = this._viewSelection.originalSelection.clone();\n                    this._editSelection._activeCell = this._viewSelection._activeCell.clone();\n                    this._editSelection.originalActiveCell = this._viewSelection.originalActiveCell.clone();\n                }\n            },\n            _setFormulaSelections: function (selection) {\n                this._formulaSelections = (selection || []).slice();\n                this.triggerChange({ selection: true });\n            },\n            _viewActiveCell: function () {\n                return this._viewSelection._activeCell.toRangeRef();\n            },\n            toJSON: function () {\n                var positions = {};\n                var rows = this._rows.toJSON('height', positions);\n                var columns = this._columns.toJSON('width', {});\n                var viewSelection = this._viewSelection;\n                this.forEach(kendo.spreadsheet.SHEETREF, function (row, col, cell) {\n                    if (Object.keys(cell).length === 0) {\n                        return;\n                    }\n                    var position = positions[row];\n                    if (position === undefined) {\n                        position = rows.length;\n                        rows.push({ index: row });\n                        positions[row] = position;\n                    }\n                    row = rows[position];\n                    cell.index = col;\n                    if (row.cells === undefined) {\n                        row.cells = [];\n                    }\n                    if (cell.formula) {\n                        cell.formula = cell.formula.toString();\n                    }\n                    if (cell.validation) {\n                        cell.validation = cell.validation.toJSON();\n                    }\n                    if (cell.color) {\n                        cell.color = new Color(cell.color).toHex();\n                    }\n                    if (cell.background) {\n                        cell.background = new Color(cell.background).toHex();\n                    }\n                    if (cell.borderTop && cell.borderTop.color) {\n                        cell.borderTop.color = new Color(cell.borderTop.color).toHex();\n                    }\n                    if (cell.borderBottom && cell.borderBottom.color) {\n                        cell.borderBottom.color = new Color(cell.borderBottom.color).toHex();\n                    }\n                    if (cell.borderRight && cell.borderRight.color) {\n                        cell.borderRight.color = new Color(cell.borderRight.color).toHex();\n                    }\n                    if (cell.borderLeft && cell.borderLeft.color) {\n                        cell.borderLeft.color = new Color(cell.borderLeft.color).toHex();\n                    }\n                    row.cells.push(cell);\n                });\n                var json = {\n                    name: this._name(),\n                    rows: rows,\n                    columns: columns,\n                    selection: viewSelection.selection.toString(),\n                    activeCell: viewSelection.activeCell().toString(),\n                    frozenRows: this.frozenRows(),\n                    frozenColumns: this.frozenColumns(),\n                    mergedCells: this._mergedCells.map(function (ref) {\n                        return ref.toString();\n                    })\n                };\n                if (this._sort) {\n                    json.sort = {\n                        ref: this._sort.ref.toString(),\n                        columns: this._sort.columns.map(function (column) {\n                            return {\n                                index: column.index,\n                                ascending: column.ascending\n                            };\n                        })\n                    };\n                }\n                if (this._filter) {\n                    json.filter = {\n                        ref: this._filter.ref.toString(),\n                        columns: this._filter.columns.map(function (column) {\n                            var filter = column.filter.toJSON();\n                            filter.index = column.index;\n                            return filter;\n                        })\n                    };\n                }\n                return json;\n            },\n            fromJSON: function (json) {\n                this.batch(function () {\n                    if (json.name !== undefined) {\n                        this._name(json.name);\n                    }\n                    if (json.frozenColumns !== undefined) {\n                        this.frozenColumns(json.frozenColumns);\n                    }\n                    if (json.frozenRows !== undefined) {\n                        this.frozenRows(json.frozenRows);\n                    }\n                    if (json.columns !== undefined) {\n                        this._columns.fromJSON('width', json.columns);\n                    }\n                    if (json.rows !== undefined) {\n                        this._rows.fromJSON('height', json.rows);\n                        for (var ri = 0; ri < json.rows.length; ri++) {\n                            var row = json.rows[ri];\n                            var rowIndex = row.index;\n                            if (rowIndex === undefined) {\n                                rowIndex = ri;\n                            }\n                            if (row.cells) {\n                                for (var ci = 0; ci < row.cells.length; ci++) {\n                                    var cell = row.cells[ci];\n                                    var columnIndex = cell.index;\n                                    if (columnIndex === undefined) {\n                                        columnIndex = ci;\n                                    }\n                                    if (cell.formula) {\n                                        cell.formula = this._compileFormula(rowIndex, columnIndex, cell.formula);\n                                    }\n                                    if (cell.validation) {\n                                        cell.validation = this._compileValidation(rowIndex, columnIndex, cell.validation);\n                                    }\n                                    this._properties.fromJSON(this._grid.index(rowIndex, columnIndex), cell);\n                                }\n                            }\n                        }\n                    }\n                    if (json.selection) {\n                        this._viewSelection.selection = this._viewSelection.originalSelection = this._ref(json.selection);\n                    }\n                    if (json.activeCell) {\n                        var activeCellRef = this._ref(json.activeCell);\n                        this._viewSelection._activeCell = activeCellRef.toRangeRef();\n                        this._viewSelection.originalActiveCell = activeCellRef;\n                    }\n                    if (json.mergedCells) {\n                        json.mergedCells.forEach(function (ref) {\n                            this.range(ref).merge();\n                        }, this);\n                    }\n                    if (json.sort) {\n                        this._sort = {\n                            ref: this._ref(json.sort.ref),\n                            columns: json.sort.columns.slice(0)\n                        };\n                    }\n                    if (json.filter) {\n                        var ref = json.filter.ref;\n                        var columns = json.filter.columns === undefined ? [] : json.filter.columns;\n                        if (!ref) {\n                            kendo.logToConsole('Dropping filter for sheet \\'' + json.name + '\\' due to missing ref');\n                        } else {\n                            this._filter = {\n                                ref: this._ref(ref),\n                                columns: columns.map(function (column) {\n                                    return {\n                                        index: column.index,\n                                        filter: kendo.spreadsheet.Filter.create(column)\n                                    };\n                                })\n                            };\n                            this._refreshFilter();\n                        }\n                    }\n                });\n            },\n            formula: function (ref) {\n                return this._properties.get('formula', this._grid.cellRefIndex(ref));\n            },\n            validation: function (ref) {\n                return this._properties.get('validation', this._grid.cellRefIndex(ref));\n            },\n            resetFormulas: function () {\n                this._forFormulas(function (formula) {\n                    formula.reset();\n                });\n            },\n            resetValidations: function () {\n                this._forValidations(function (validation) {\n                    validation.reset();\n                });\n            },\n            recalc: function (context, callback) {\n                var formulas = this._properties.get('formula').values();\n                var count = formulas.length, pending = 0, i = 0;\n                if (!count && callback) {\n                    return callback();\n                }\n                function next() {\n                    pending--;\n                    if (i == count && !pending) {\n                        callback();\n                    }\n                }\n                while (i < count) {\n                    pending++;\n                    formulas[i++].value.exec(context, callback ? next : null);\n                }\n            },\n            revalidate: function (context) {\n                var self = this;\n                this._forValidations(function (validation) {\n                    var cellRef = new CellRef(validation.row, validation.col);\n                    var ref = new RangeRef(cellRef, cellRef);\n                    validation.exec(context, self._get(ref, 'value'), self._get(ref, 'format'));\n                });\n            },\n            _value: function (row, col, value) {\n                var index = this._grid.index(row, col);\n                if (value !== undefined) {\n                    this._properties.set('value', index, index, value);\n                } else {\n                    return this._properties.get('value', index);\n                }\n            },\n            _validation: function (row, col) {\n                var index = this._grid.index(row, col);\n                return this._properties.get('validation', index);\n            },\n            _compileValidation: function (row, col, validation) {\n                if (validation.from) {\n                    validation.from = (validation.from + '').replace(/^=/, '');\n                }\n                if (validation.to) {\n                    validation.to = (validation.to + '').replace(/^=/, '');\n                }\n                return kendo.spreadsheet.validation.compile(this._name(), row, col, validation);\n            },\n            _compileFormula: function (row, col, f) {\n                f = f.replace(/^=/, '');\n                f = kendo.spreadsheet.calc.parseFormula(this._name(), row, col, f);\n                return kendo.spreadsheet.calc.compile(f);\n            },\n            _copyValuesInRange: function (topLeft, bottomRight, value, property) {\n                var ci, start, end;\n                for (ci = topLeft.col; ci <= bottomRight.col; ci++) {\n                    start = this._grid.index(topLeft.row, ci);\n                    end = this._grid.index(bottomRight.row, ci);\n                    for (var index = start, row = topLeft.row; index <= end; ++index, ++row) {\n                        value = value.clone(this._name(), row, ci);\n                        this._properties.set(property, index, index, value);\n                    }\n                }\n                return value;\n            },\n            _set: function (ref, name, value) {\n                var topLeft = this._grid.normalize(ref.topLeft);\n                var bottomRight = this._grid.normalize(ref.bottomRight);\n                var ci, start, end;\n                if (value && name == 'formula') {\n                    if (typeof value == 'string') {\n                        value = this._compileFormula(topLeft.row, topLeft.col, value);\n                    }\n                    value = this._copyValuesInRange(topLeft, bottomRight, value, 'formula');\n                } else if (value && name == 'validation') {\n                    value = this._compileValidation(topLeft.row, topLeft.col, value);\n                    value = this._copyValuesInRange(topLeft, bottomRight, value, 'validation');\n                } else {\n                    for (ci = topLeft.col; ci <= bottomRight.col; ci++) {\n                        start = this._grid.index(topLeft.row, ci);\n                        end = this._grid.index(bottomRight.row, ci);\n                        this._properties.set(name, start, end, value);\n                        if (name == 'formula') {\n                            this._properties.set('value', start, end, null);\n                        }\n                    }\n                }\n            },\n            _get: function (ref, name) {\n                var topLeft = this._grid.normalize(ref.topLeft);\n                var index = this._grid.index(topLeft.row, topLeft.col);\n                return this._properties.get(name, index);\n            },\n            batch: function (callback, reason) {\n                var suspended = this.suspendChanges();\n                this.suspendChanges(true);\n                callback.call(this);\n                return this.suspendChanges(suspended).triggerChange(reason);\n            },\n            _sortBy: function (ref, columns) {\n                var indices = null;\n                columns.forEach(function (column) {\n                    indices = this._sorter.sortBy(ref, column.index, this._properties.get('value'), column.ascending, indices);\n                }, this);\n                this._sort = {\n                    ref: ref,\n                    columns: columns\n                };\n                this._refreshFilter();\n                this.triggerChange({ recalc: true });\n            },\n            _refreshFilter: function () {\n                if (this._filter) {\n                    this._filterBy(this._filter.ref, this._filter.columns);\n                }\n            },\n            _filterBy: function (ref, columns) {\n                this.batch(function () {\n                    for (var ri = ref.topLeft.row; ri <= ref.bottomRight.row; ri++) {\n                        if (this._rows.hidden(ri)) {\n                            this._rows.unhide(ri);\n                        }\n                    }\n                    columns.forEach(function (column) {\n                        var columnRef = ref.resize({ top: 1 }).toColumn(column.index);\n                        var cells = [];\n                        if (columnRef === kendo.spreadsheet.NULLREF) {\n                            return;\n                        }\n                        this.forEach(columnRef, function (row, col, cell) {\n                            cell.row = row;\n                            cells.push(cell);\n                        });\n                        column.filter.prepare(cells);\n                        for (var ci = 0; ci < cells.length; ci++) {\n                            var cell = cells[ci];\n                            var value = column.filter.value(cell);\n                            if (column.filter.matches(value) === false) {\n                                this.hideRow(cell.row);\n                            }\n                        }\n                    }, this);\n                    this._filter = {\n                        ref: ref,\n                        columns: columns\n                    };\n                }, {\n                    layout: true,\n                    filter: true\n                });\n            },\n            filterColumn: function (ref) {\n                var filterRef = this.filter().ref;\n                return ref.toRangeRef().topLeft.col - filterRef.topLeft.col;\n            },\n            filter: function () {\n                return this._filter;\n            },\n            clearFilter: function (spec) {\n                this._clearFilter(spec instanceof Array ? spec : [spec]);\n            },\n            _clearFilter: function (indices) {\n                if (this._filter) {\n                    this.batch(function () {\n                        this._filter.columns = this._filter.columns.filter(function (column) {\n                            return indices.indexOf(column.index) < 0;\n                        });\n                        this._refreshFilter();\n                    }, {\n                        layout: true,\n                        filter: true\n                    });\n                }\n            },\n            getAxisState: function () {\n                return {\n                    rows: this._rows.getState(),\n                    columns: this._columns.getState()\n                };\n            },\n            setAxisState: function (state) {\n                this._rows.setState(state.rows);\n                this._columns.setState(state.columns);\n                this.triggerChange({ layout: true });\n            },\n            getState: function () {\n                return {\n                    rows: this._rows.getState(),\n                    columns: this._columns.getState(),\n                    mergedCells: this._mergedCells.map(function (cell) {\n                        return cell.clone();\n                    }),\n                    properties: this._properties.getState()\n                };\n            },\n            setState: function (state) {\n                this._rows.setState(state.rows);\n                this._columns.setState(state.columns);\n                this._mergedCells = state.mergedCells;\n                this._properties.setState(state.properties);\n                this.triggerChange(kendo.spreadsheet.ALL_REASONS);\n            },\n            _merge: function (ref) {\n                var mergedCells = this._mergedCells;\n                var sheet = this;\n                var mergedRef;\n                this.batch(function () {\n                    mergedRef = ref.map(function (ref) {\n                        if (ref instanceof kendo.spreadsheet.CellRef) {\n                            return ref;\n                        }\n                        var currentRef = ref.toRangeRef().union(mergedCells, function (ref) {\n                            mergedCells.splice(mergedCells.indexOf(ref), 1);\n                        });\n                        var range = new Range(currentRef, sheet);\n                        var formula = range._get('formula');\n                        var value = range.value();\n                        var format = range.format();\n                        var background = range.background();\n                        range.value(null);\n                        range.format(null);\n                        range.background(null);\n                        var topLeft = new Range(currentRef.collapse(), sheet);\n                        if (formula) {\n                            topLeft._set('formula', formula);\n                        } else {\n                            topLeft.value(value);\n                        }\n                        topLeft.format(format);\n                        topLeft.background(background);\n                        mergedCells.push(currentRef);\n                        return currentRef;\n                    });\n                    var viewSelection = sheet._viewSelection;\n                    viewSelection.selection = sheet.unionWithMerged(viewSelection.originalSelection);\n                    viewSelection._activeCell = sheet.unionWithMerged(viewSelection.originalActiveCell);\n                }, {\n                    activeCell: true,\n                    selection: true\n                });\n                return mergedRef;\n            }\n        });\n        kendo.spreadsheet.Sheet = Sheet;\n    }(kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/sheetsbar', [\n        'kendo.core',\n        'kendo.sortable'\n    ], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var $ = kendo.jQuery;\n        var DOT = '.';\n        var EMPTYCHAR = ' ';\n        var sheetsBarClassNames = {\n            sheetsBarWrapper: 'k-widget k-header',\n            sheetsBarSheetsWrapper: 'k-tabstrip k-floatwrap k-tabstrip-bottom',\n            sheetsBarActive: 'k-spreadsheet-sheets-bar-active',\n            sheetsBarInactive: 'k-spreadsheet-sheets-bar-inactive',\n            sheetsBarAdd: 'k-spreadsheet-sheets-bar-add',\n            sheetsBarRemove: 'k-spreadsheet-sheets-remove',\n            sheetsBarItems: 'k-spreadsheet-sheets-items',\n            sheetsBarEditor: 'k-spreadsheet-sheets-editor',\n            sheetsBarScrollable: 'k-tabstrip-scrollable',\n            sheetsBarNext: 'k-tabstrip-next',\n            sheetsBarPrev: 'k-tabstrip-prev',\n            sheetsBarKItem: 'k-item k-state-default',\n            sheetsBarKActive: 'k-state-active k-state-tab-on-top',\n            sheetsBarKTextbox: 'k-textbox',\n            sheetsBarKLink: 'k-link',\n            sheetsBarKIcon: 'k-icon',\n            sheetsBarKFontIcon: 'k-font-icon',\n            sheetsBarKButton: 'k-button k-button-icon',\n            sheetsBarKButtonBare: 'k-button-bare',\n            sheetsBarKArrowW: 'k-i-arrow-w',\n            sheetsBarKArrowE: 'k-i-arrow-e',\n            sheetsBarKReset: 'k-reset k-tabstrip-items',\n            sheetsBarKIconX: 'k-i-x',\n            sheetsBarKSprite: 'k-sprite',\n            sheetsBarKIconPlus: 'k-i-plus',\n            sheetsBarHintWrapper: 'k-widget k-tabstrip k-tabstrip-bottom k-spreadsheet-sheets-items-hint',\n            sheetsBarKResetItems: 'k-reset k-tabstrip-items'\n        };\n        var SheetsBar = kendo.ui.Widget.extend({\n            init: function (element, options) {\n                var classNames = SheetsBar.classNames;\n                kendo.ui.Widget.call(this, element, options);\n                element = this.element;\n                element.addClass(classNames.sheetsBarWrapper);\n                this._tree = new kendo.dom.Tree(element[0]);\n                this._tree.render([\n                    this._addButton(),\n                    this._createSheetsWrapper([])\n                ]);\n                this._createSortable();\n                this._sortable.bind('start', this._onSheetReorderStart.bind(this));\n                this._sortable.bind('end', this._onSheetReorderEnd.bind(this));\n                element.on('click', DOT + classNames.sheetsBarRemove, this._onSheetRemove.bind(this));\n                element.on('click', 'li', this._onSheetSelect.bind(this));\n                element.on('dblclick', 'li' + DOT + classNames.sheetsBarActive, this._createEditor.bind(this));\n                element.on('click', DOT + classNames.sheetsBarAdd, this._onAddSelect.bind(this));\n            },\n            options: {\n                name: 'SheetsBar',\n                scrollable: { distance: 200 }\n            },\n            events: [\n                'select',\n                'reorder',\n                'rename'\n            ],\n            _createEditor: function () {\n                if (this._editor) {\n                    return;\n                }\n                this._renderSheets(this._sheets, this._selectedIndex, true);\n                this._editor = this.element.find(kendo.format('input{0}{1}', DOT, SheetsBar.classNames.sheetsBarEditor)).focus().on('keydown', this._onEditorKeydown.bind(this)).on('blur', this._onEditorBlur.bind(this));\n            },\n            _destroyEditor: function () {\n                this._editor.off();\n                this._editor = null;\n                this._renderSheets(this._sheets, this._selectedIndex, false);\n            },\n            renderSheets: function (sheets, selectedIndex) {\n                if (!sheets || selectedIndex < 0) {\n                    return;\n                }\n                this._renderSheets(sheets, selectedIndex, false);\n            },\n            _renderSheets: function (sheets, selectedIndex, isInEditMode) {\n                var that = this;\n                var wrapperOffsetWidth;\n                var sheetsGroupScrollWidth;\n                var scrollPrevButton;\n                var scrollNextButton;\n                var sheetsWrapper = that._sheetsWrapper();\n                var sheetsGroup = that._sheetsGroup();\n                var classNames = SheetsBar.classNames;\n                var addButtonWidth = $(DOT + classNames.sheetsBarAdd).outerWidth() + 11;\n                that._isRtl = kendo.support.isRtl(that.element);\n                that._sheets = sheets;\n                that._selectedIndex = selectedIndex;\n                if (!that._scrollableAllowed()) {\n                    that._renderHtml(isInEditMode, false);\n                    return;\n                }\n                sheetsWrapper.addClass(classNames.sheetsBarScrollable + EMPTYCHAR + classNames.sheetsBarSheetsWrapper);\n                wrapperOffsetWidth = sheetsWrapper[0].offsetWidth;\n                sheetsGroupScrollWidth = sheetsGroup[0].scrollWidth + addButtonWidth + 11;\n                if (sheetsGroupScrollWidth > wrapperOffsetWidth) {\n                    if (!that._scrollableModeActive) {\n                        var scrollPrevButtonWidth;\n                        that._nowScrollingSheets = false;\n                        that._renderHtml(isInEditMode, true);\n                        scrollPrevButton = sheetsWrapper.children(DOT + classNames.sheetsBarPrev);\n                        scrollNextButton = sheetsWrapper.children(DOT + classNames.sheetsBarNext);\n                        scrollPrevButtonWidth = scrollPrevButton.outerWidth();\n                        scrollPrevButton.css({ marginLeft: scrollPrevButtonWidth + 4 });\n                        that._sheetsGroup().css({\n                            marginLeft: scrollPrevButtonWidth + addButtonWidth,\n                            marginRight: scrollNextButton.outerWidth() + 12\n                        });\n                        that._scrollableModeActive = true;\n                        that._toggleScrollEvents(true);\n                        that._toggleScrollButtons();\n                    } else {\n                        that._toggleScrollButtons();\n                        that._renderHtml(isInEditMode, true);\n                    }\n                } else if (that._scrollableModeActive && sheetsGroupScrollWidth <= wrapperOffsetWidth) {\n                    that._scrollableModeActive = false;\n                    that._toggleScrollEvents(false);\n                    that._renderHtml(isInEditMode, false);\n                    that._sheetsGroup().css({\n                        marginLeft: addButtonWidth,\n                        marginRight: ''\n                    });\n                } else {\n                    that._renderHtml(isInEditMode, false);\n                    that._sheetsGroup().css({ marginLeft: addButtonWidth });\n                }\n            },\n            _toggleScrollEvents: function (toggle) {\n                var that = this;\n                var classNames = SheetsBar.classNames;\n                var options = that.options;\n                var scrollPrevButton;\n                var scrollNextButton;\n                var sheetsWrapper = that._sheetsWrapper();\n                scrollPrevButton = sheetsWrapper.children(DOT + classNames.sheetsBarPrev);\n                scrollNextButton = sheetsWrapper.children(DOT + classNames.sheetsBarNext);\n                if (toggle) {\n                    scrollPrevButton.on('mousedown', function () {\n                        that._nowScrollingSheets = true;\n                        that._scrollSheetsByDelta(options.scrollable.distance * (that._isRtl ? 1 : -1));\n                    });\n                    scrollNextButton.on('mousedown', function () {\n                        that._nowScrollingSheets = true;\n                        that._scrollSheetsByDelta(options.scrollable.distance * (that._isRtl ? -1 : 1));\n                    });\n                    scrollPrevButton.add(scrollNextButton).on('mouseup', function () {\n                        that._nowScrollingSheets = false;\n                    });\n                } else {\n                    scrollPrevButton.off();\n                    scrollNextButton.off();\n                }\n            },\n            _renderHtml: function (isInEditMode, renderScrollButtons) {\n                var idx;\n                var sheetElements = [];\n                var dom = kendo.dom;\n                var element = dom.element;\n                var sheets = this._sheets;\n                var selectedIndex = this._selectedIndex;\n                var classNames = SheetsBar.classNames;\n                for (idx = 0; idx < sheets.length; idx++) {\n                    var sheet = sheets[idx];\n                    var isSelectedSheet = idx === selectedIndex;\n                    var attr = { className: classNames.sheetsBarKItem + EMPTYCHAR };\n                    var elementContent = [];\n                    if (isSelectedSheet) {\n                        attr.className += classNames.sheetsBarKActive + EMPTYCHAR + classNames.sheetsBarActive;\n                    } else {\n                        attr.className += classNames.sheetsBarInactive;\n                    }\n                    if (isSelectedSheet && isInEditMode) {\n                        elementContent.push(element('input', {\n                            type: 'text',\n                            value: sheet.name(),\n                            className: classNames.sheetsBarKTextbox + EMPTYCHAR + classNames.sheetsBarEditor,\n                            maxlength: 50\n                        }, []));\n                    } else {\n                        elementContent.push(element('span', {\n                            className: classNames.sheetsBarKLink,\n                            title: sheet.name()\n                        }, [dom.text(sheet.name())]));\n                        var deleteIcon = element('span', { className: classNames.sheetsBarKIcon + EMPTYCHAR + classNames.sheetsBarKFontIcon + EMPTYCHAR + classNames.sheetsBarKIconX }, []);\n                        elementContent.push(element('span', { className: classNames.sheetsBarKLink + EMPTYCHAR + classNames.sheetsBarRemove }, [deleteIcon]));\n                    }\n                    sheetElements.push(element('li', attr, elementContent));\n                }\n                this._tree.render([\n                    this._addButton(),\n                    this._createSheetsWrapper(sheetElements, renderScrollButtons)\n                ]);\n            },\n            _createSheetsWrapper: function (sheetElements, renderScrollButtons) {\n                var element = kendo.dom.element;\n                var classNames = SheetsBar.classNames;\n                var childrenElements = [element('ul', { className: classNames.sheetsBarKReset }, sheetElements)];\n                if (renderScrollButtons) {\n                    var baseButtonClass = classNames.sheetsBarKButton + EMPTYCHAR + classNames.sheetsBarKButtonBare + EMPTYCHAR;\n                    childrenElements.push(element('span', { className: baseButtonClass + classNames.sheetsBarPrev }, [element('span', { className: classNames.sheetsBarKIcon + EMPTYCHAR + classNames.sheetsBarKArrowW }, [])]));\n                    childrenElements.push(element('span', { className: baseButtonClass + classNames.sheetsBarNext }, [element('span', { className: classNames.sheetsBarKIcon + EMPTYCHAR + classNames.sheetsBarKArrowE }, [])]));\n                }\n                return element('div', { className: classNames.sheetsBarItems }, childrenElements);\n            },\n            _createSortable: function () {\n                var classNames = SheetsBar.classNames;\n                this._sortable = new kendo.ui.Sortable(this.element, {\n                    filter: kendo.format('ul li.{0},ul li.{1}', classNames.sheetsBarActive, classNames.sheetsBarInactive),\n                    container: DOT + classNames.sheetsBarItems,\n                    axis: 'x',\n                    animation: false,\n                    ignore: 'input',\n                    hint: function (element) {\n                        var hint = $(element).clone();\n                        return hint.wrap('<div class=\\'' + classNames.sheetsBarHintWrapper + '\\'><ul class=\\'' + classNames.sheetsBarKResetItems + '\\'></ul></div>').closest('div');\n                    }\n                });\n            },\n            _onEditorKeydown: function (e) {\n                if (this._editor) {\n                    if (e.which === 13) {\n                        this._destroyEditor();\n                        this._onSheetRename($(e.target).val());\n                    }\n                    if (e.which === 27) {\n                        this._destroyEditor();\n                        this._onSheetRename();\n                    }\n                }\n            },\n            _onEditorBlur: function (e) {\n                if (this._editor) {\n                    this._destroyEditor();\n                    this._onSheetRename($(e.target).val());\n                }\n            },\n            _onSheetReorderEnd: function (e) {\n                e.preventDefault();\n                this.trigger('reorder', {\n                    oldIndex: e.oldIndex,\n                    newIndex: e.newIndex\n                });\n            },\n            _onSheetReorderStart: function (e) {\n                if (this._editor) {\n                    e.preventDefault();\n                }\n            },\n            _onSheetRemove: function (e) {\n                var removedSheetName = $(e.target).closest('li').text();\n                if (this._editor) {\n                    this._destroyEditor();\n                    this._onSheetRename(this._editor.val());\n                }\n                this.trigger('remove', { name: removedSheetName });\n            },\n            _onSheetSelect: function (e) {\n                var selectedSheetText = $(e.target).text();\n                if ($(e.target).is(DOT + SheetsBar.classNames.sheetsBarEditor) || !selectedSheetText) {\n                    e.preventDefault();\n                    return;\n                }\n                if (this._editor) {\n                    var editorValue = this._editor.val();\n                    this._destroyEditor();\n                    this._onSheetRename(editorValue);\n                }\n                this._scrollSheetsToItem($(e.target).closest('li'));\n                this.trigger('select', {\n                    name: selectedSheetText,\n                    isAddButton: false\n                });\n            },\n            _onSheetRename: function (newSheetName) {\n                this.trigger('rename', {\n                    name: newSheetName,\n                    sheetIndex: this._selectedIndex\n                });\n            },\n            _onAddSelect: function () {\n                this.trigger('select', { isAddButton: true });\n            },\n            _addButton: function () {\n                var element = kendo.dom.element;\n                var classNames = SheetsBar.classNames;\n                return element('a', { className: classNames.sheetsBarAdd + EMPTYCHAR + classNames.sheetsBarKButton }, [element('span', { className: classNames.sheetsBarKSprite + EMPTYCHAR + classNames.sheetsBarKIcon + EMPTYCHAR + classNames.sheetsBarKFontIcon + EMPTYCHAR + classNames.sheetsBarKIconPlus }, [])]);\n            },\n            destroy: function () {\n                this._sortable.destroy();\n            },\n            _scrollableAllowed: function () {\n                var options = this.options;\n                return options.scrollable && !isNaN(options.scrollable.distance);\n            },\n            _scrollSheetsToItem: function (item) {\n                var that = this;\n                if (!that._scrollableModeActive) {\n                    return;\n                }\n                var sheetsGroup = that._sheetsGroup();\n                var currentScrollOffset = sheetsGroup.scrollLeft();\n                var itemWidth = item.outerWidth();\n                var itemOffset = that._isRtl ? item.position().left : item.position().left - sheetsGroup.children().first().position().left;\n                var sheetsGroupWidth = sheetsGroup[0].offsetWidth;\n                var sheetsGroupPadding = Math.ceil(parseFloat(sheetsGroup.css('padding-left')));\n                var itemPosition;\n                if (that._isRtl) {\n                    if (itemOffset < 0) {\n                        itemPosition = currentScrollOffset + itemOffset - (sheetsGroupWidth - currentScrollOffset) - sheetsGroupPadding;\n                    } else if (itemOffset + itemWidth > sheetsGroupWidth) {\n                        itemPosition = currentScrollOffset + itemOffset - itemWidth + sheetsGroupPadding * 2;\n                    }\n                } else {\n                    if (currentScrollOffset + sheetsGroupWidth < itemOffset + itemWidth) {\n                        itemPosition = itemOffset + itemWidth - sheetsGroupWidth + sheetsGroupPadding * 2;\n                    } else if (currentScrollOffset > itemOffset) {\n                        itemPosition = itemOffset - sheetsGroupPadding;\n                    }\n                }\n                sheetsGroup.finish().animate({ 'scrollLeft': itemPosition }, 'fast', 'linear', function () {\n                    that._toggleScrollButtons();\n                });\n            },\n            _sheetsGroup: function () {\n                return this._sheetsWrapper().children('ul');\n            },\n            _sheetsWrapper: function () {\n                return this.element.find(DOT + SheetsBar.classNames.sheetsBarItems);\n            },\n            _scrollSheetsByDelta: function (delta) {\n                var that = this;\n                var sheetsGroup = that._sheetsGroup();\n                var scrLeft = sheetsGroup.scrollLeft();\n                sheetsGroup.finish().animate({ 'scrollLeft': scrLeft + delta }, 'fast', 'linear', function () {\n                    if (that._nowScrollingSheets) {\n                        that._scrollSheetsByDelta(delta);\n                    } else {\n                        that._toggleScrollButtons();\n                    }\n                });\n            },\n            _toggleScrollButtons: function () {\n                var that = this;\n                var ul = that._sheetsGroup();\n                var wrapper = that._sheetsWrapper();\n                var scrollLeft = ul.scrollLeft();\n                wrapper.find(DOT + SheetsBar.classNames.sheetsBarPrev).toggle(that._isRtl ? scrollLeft < ul[0].scrollWidth - ul[0].offsetWidth - 1 : scrollLeft !== 0);\n                wrapper.find(DOT + SheetsBar.classNames.sheetsBarNext).toggle(that._isRtl ? scrollLeft !== 0 : scrollLeft < ul[0].scrollWidth - ul[0].offsetWidth - 1);\n            }\n        });\n        kendo.spreadsheet.SheetsBar = SheetsBar;\n        $.extend(true, SheetsBar, { classNames: sheetsBarClassNames });\n    }(window.kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/calc', ['spreadsheet/runtime'], f);\n}(function () {\n    'use strict';\n    if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n        return;\n    }\n    var spreadsheet = kendo.spreadsheet;\n    var RangeRef = spreadsheet.RangeRef;\n    var CellRef = spreadsheet.CellRef;\n    var NameRef = spreadsheet.NameRef;\n    var exports = spreadsheet.calc;\n    var runtime = exports.runtime;\n    var OPERATORS = Object.create(null);\n    var ParseError = kendo.Class.extend({\n        init: function ParseError(message, pos) {\n            this.message = message;\n            this.pos = pos;\n        },\n        toString: function () {\n            return this.message;\n        }\n    });\n    (function (ops) {\n        ops.forEach(function (cls, i) {\n            cls.forEach(function (op) {\n                OPERATORS[op] = ops.length - i;\n            });\n        });\n    }([\n        [':'],\n        [' '],\n        [','],\n        ['%'],\n        ['^'],\n        [\n            '*',\n            '/'\n        ],\n        [\n            '+',\n            '-'\n        ],\n        ['&'],\n        [\n            '=',\n            '<',\n            '>',\n            '<=',\n            '>=',\n            '<>'\n        ]\n    ]));\n    var TRUE = {\n        type: 'bool',\n        value: true\n    };\n    var FALSE = {\n        type: 'bool',\n        value: false\n    };\n    function getcol(str) {\n        str = str.toUpperCase();\n        for (var col = 0, i = 0; i < str.length; ++i) {\n            col = col * 26 + str.charCodeAt(i) - 64;\n        }\n        return col - 1;\n    }\n    function getrow(str) {\n        return parseInt(str, 10) - 1;\n    }\n    function parseReference(name, noThrow) {\n        if (name.toLowerCase() == '#sheet') {\n            return spreadsheet.SHEETREF;\n        }\n        OUT: {\n            var m;\n            if (m = /^(\\$)?([a-z]+)(\\$)?(\\d+)$/i.exec(name)) {\n                var row = getrow(m[4]), col = getcol(m[2]);\n                if (row <= 1048576 && col <= 16383) {\n                    return new CellRef(getrow(m[4]), getcol(m[2]));\n                }\n                break OUT;\n            }\n            var stream = TokenStream(name, {});\n            var a = [];\n            while (true) {\n                var ref = stream.next();\n                if (ref instanceof CellRef) {\n                    ref.rel = 0;\n                } else if (ref instanceof RangeRef) {\n                    ref.topLeft.rel = 0;\n                    ref.bottomRight.rel = 0;\n                } else {\n                    break OUT;\n                }\n                a.push(ref);\n                if (stream.eof()) {\n                    break;\n                }\n                if (!stream.is('op', ',')) {\n                    break OUT;\n                }\n                stream.next();\n            }\n            return a.length == 1 ? a[0] : new spreadsheet.UnionRef(a);\n        }\n        if (!noThrow) {\n            throw new Error('Cannot parse reference: ' + name);\n        }\n    }\n    function parseFormula(sheet, row, col, input) {\n        var refs = [];\n        input = TokenStream(input, {\n            row: row,\n            col: col\n        });\n        var is = input.is;\n        return {\n            type: 'exp',\n            ast: parseExpression(true),\n            refs: refs,\n            sheet: sheet,\n            row: row,\n            col: col\n        };\n        function addReference(ref) {\n            ref.index = refs.length;\n            refs.push(ref);\n            return ref;\n        }\n        function skip(type, value) {\n            if (is(type, value)) {\n                return input.next();\n            } else {\n                var tok = input.peek();\n                if (tok) {\n                    input.croak('Expected ' + type + ' \\xAB' + value + '\\xBB but found ' + tok.type + ' \\xAB' + tok.value + '\\xBB');\n                } else {\n                    input.croak('Expected ' + type + ' \\xAB' + value + '\\xBB');\n                }\n            }\n        }\n        function parseExpression(commas) {\n            return maybeBinary(maybeIntersect(parseAtom(commas)), 0, commas);\n        }\n        function parseSymbol(tok) {\n            if (tok.upper == 'TRUE' || tok.upper == 'FALSE') {\n                return tok.upper == 'TRUE' ? TRUE : FALSE;\n            }\n            return addReference(new NameRef(tok.value));\n        }\n        function parseFuncall() {\n            var fname = input.next();\n            fname = fname.value;\n            skip('punc', '(');\n            var args = [];\n            if (!is('punc', ')')) {\n                while (1) {\n                    if (is('op', ',')) {\n                        args.push({ type: 'null' });\n                        input.next();\n                        continue;\n                    }\n                    args.push(parseExpression(false));\n                    if (input.eof() || is('punc', ')')) {\n                        break;\n                    }\n                    skip('op', ',');\n                }\n            }\n            skip('punc', ')');\n            return {\n                type: 'func',\n                func: fname,\n                args: args\n            };\n        }\n        function fixReference(ref) {\n            if (!ref.hasSheet()) {\n                ref.setSheet(sheet);\n            }\n            return addReference(ref);\n        }\n        function parseAtom(commas) {\n            var exp;\n            if (is('ref')) {\n                exp = fixReference(input.next());\n            } else if (is('func')) {\n                exp = parseFuncall();\n            } else if (is('punc', '(')) {\n                input.next();\n                exp = parseExpression(true);\n                skip('punc', ')');\n            } else if (is('punc', '{')) {\n                input.next();\n                exp = parseArray();\n                skip('punc', '}');\n            } else if (is('num') || is('str')) {\n                exp = input.next();\n            } else if (is('sym')) {\n                exp = parseSymbol(input.next());\n            } else if (is('op', '+') || is('op', '-')) {\n                exp = {\n                    type: 'prefix',\n                    op: input.next().value,\n                    exp: parseExpression(commas)\n                };\n            } else if (!input.peek()) {\n                input.croak('Incomplete expression');\n            } else {\n                input.croak('Parse error');\n            }\n            return maybePercent(exp);\n        }\n        function parseArray() {\n            var row = [], value = [row], first = true;\n            while (!input.eof() && !is('punc', '}')) {\n                if (first) {\n                    first = false;\n                } else if (is('punc', ';')) {\n                    value.push(row = []);\n                    input.next();\n                } else {\n                    skip('op', ',');\n                }\n                row.push(parseExpression(false));\n            }\n            return {\n                type: 'matrix',\n                value: value\n            };\n        }\n        function maybeIntersect(exp) {\n            if (is('punc', '(') || is('ref') || is('num') || is('func')) {\n                return {\n                    type: 'binary',\n                    op: ' ',\n                    left: exp,\n                    right: parseExpression(false)\n                };\n            } else {\n                return exp;\n            }\n        }\n        function maybePercent(exp) {\n            if (is('op', '%')) {\n                input.next();\n                return maybePercent({\n                    type: 'postfix',\n                    op: '%',\n                    exp: exp\n                });\n            } else {\n                return exp;\n            }\n        }\n        function maybeBinary(left, my_prec, commas) {\n            var tok = is('op');\n            if (tok && (commas || tok.value != ',')) {\n                var his_prec = OPERATORS[tok.value];\n                if (his_prec > my_prec) {\n                    input.next();\n                    var right = maybeBinary(parseAtom(commas), his_prec, commas);\n                    return maybeBinary({\n                        type: 'binary',\n                        op: tok.value,\n                        left: left,\n                        right: right\n                    }, my_prec, commas);\n                }\n            }\n            return left;\n        }\n    }\n    function makePrinter(exp) {\n        return makeClosure('function(row, col){return(' + print(exp.ast, 0) + ')}');\n        function print(node, prec) {\n            switch (node.type) {\n            case 'num':\n            case 'bool':\n                return JSON.stringify(node.value);\n            case 'str':\n                return JSON.stringify(JSON.stringify(node.value));\n            case 'ref':\n                return 'this.refs[' + node.index + '].print(row, col)';\n            case 'prefix':\n                return withParens(node.op, prec, function () {\n                    return JSON.stringify(node.op) + ' + ' + print(node.exp, OPERATORS[node.op]);\n                });\n            case 'postfix':\n                return withParens(node.op, prec, function () {\n                    return print(node.exp, OPERATORS[node.op]) + ' + ' + JSON.stringify(node.op);\n                });\n            case 'binary':\n                return withParens(node.op, prec, function () {\n                    var left = parenthesize(print(node.left, OPERATORS[node.op]), node.left instanceof NameRef && node.op == ':');\n                    var right = parenthesize(print(node.right, OPERATORS[node.op]), node.right instanceof NameRef && node.op == ':');\n                    return left + ' + ' + JSON.stringify(node.op) + ' + ' + right;\n                });\n            case 'func':\n                return JSON.stringify(node.func + '(') + ' + ' + (node.args.length > 0 ? node.args.map(function (arg) {\n                    return print(arg, 0);\n                }).join(' + \\', \\' + ') : '\\'\\'') + ' + \\')\\'';\n            case 'matrix':\n                return '\\'{ \\' + ' + node.value.map(function (el) {\n                    return el.map(function (el) {\n                        return print(el, 0);\n                    }).join(' + \\', \\' + ');\n                }).join(' + \\'; \\' + ') + '+ \\' }\\'';\n            case 'null':\n                return '\\'\\'';\n            }\n            throw new Error('Cannot make printer for node ' + node.type);\n        }\n        function parenthesize(code, cond) {\n            return cond ? '\\'(\\' + ' + code + ' + \\')\\'' : code;\n        }\n        function withParens(op, prec, f) {\n            var needParens = OPERATORS[op] < prec || !prec && op == ',';\n            return parenthesize(f(), needParens);\n        }\n    }\n    function toCPS(ast, k) {\n        var GENSYM = 0;\n        return cps(ast, k);\n        function cps(node, k) {\n            switch (node.type) {\n            case 'ref':\n            case 'num':\n            case 'str':\n            case 'null':\n            case 'bool':\n                return cpsAtom(node, k);\n            case 'prefix':\n            case 'postfix':\n                return cpsUnary(node, k);\n            case 'binary':\n                return cpsBinary(node, k);\n            case 'func':\n                return cpsFunc(node, k);\n            case 'lambda':\n                return cpsLambda(node, k);\n            case 'matrix':\n                return cpsMatrix(node.value, k, true);\n            }\n            throw new Error('Cannot CPS ' + node.type);\n        }\n        function cpsAtom(node, k) {\n            return k(node);\n        }\n        function cpsUnary(node, k) {\n            return cps({\n                type: 'func',\n                func: 'unary' + node.op,\n                args: [node.exp]\n            }, k);\n        }\n        function cpsBinary(node, k) {\n            return cps({\n                type: 'func',\n                func: 'binary' + node.op,\n                args: [\n                    node.left,\n                    node.right\n                ]\n            }, k);\n        }\n        function cpsIf(co, th, el, k) {\n            return cps(co, function (co) {\n                var rest = makeContinuation(k);\n                var thenK = gensym('T');\n                var elseK = gensym('E');\n                return {\n                    type: 'func',\n                    func: 'if',\n                    args: [\n                        rest,\n                        co,\n                        {\n                            type: 'lambda',\n                            vars: [thenK],\n                            body: cps(th || TRUE, function (th) {\n                                return {\n                                    type: 'call',\n                                    func: {\n                                        type: 'var',\n                                        name: thenK\n                                    },\n                                    args: [th]\n                                };\n                            })\n                        },\n                        {\n                            type: 'lambda',\n                            vars: [elseK],\n                            body: cps(el || FALSE, function (el) {\n                                return {\n                                    type: 'call',\n                                    func: {\n                                        type: 'var',\n                                        name: elseK\n                                    },\n                                    args: [el]\n                                };\n                            })\n                        }\n                    ]\n                };\n            });\n        }\n        function cpsAnd(args, k) {\n            if (args.length === 0) {\n                return cpsAtom(TRUE, k);\n            }\n            return cps({\n                type: 'func',\n                func: 'IF',\n                args: [\n                    args[0],\n                    {\n                        type: 'func',\n                        func: 'AND',\n                        args: args.slice(1)\n                    },\n                    FALSE\n                ]\n            }, k);\n        }\n        function cpsOr(args, k) {\n            if (args.length === 0) {\n                return cpsAtom(FALSE, k);\n            }\n            return cps({\n                type: 'func',\n                func: 'IF',\n                args: [\n                    args[0],\n                    TRUE,\n                    {\n                        type: 'func',\n                        func: 'OR',\n                        args: args.slice(1)\n                    }\n                ]\n            }, k);\n        }\n        function cpsFunc(node, k) {\n            switch (node.func.toLowerCase()) {\n            case 'if':\n                return cpsIf(node.args[0], node.args[1], node.args[2], k);\n            case 'and':\n                return cpsAnd(node.args, k);\n            case 'or':\n                return cpsOr(node.args, k);\n            case 'true':\n                return k(TRUE);\n            case 'false':\n                return k(FALSE);\n            }\n            return function loop(args, i) {\n                if (i == node.args.length) {\n                    return {\n                        type: 'func',\n                        func: node.func,\n                        args: args\n                    };\n                } else {\n                    return cps(node.args[i], function (value) {\n                        return loop(args.concat([value]), i + 1);\n                    });\n                }\n            }([makeContinuation(k)], 0);\n        }\n        function cpsLambda(node, k) {\n            var cont = gensym('K');\n            var body = cps(node.body, function (body) {\n                return {\n                    type: 'call',\n                    func: {\n                        type: 'var',\n                        value: cont\n                    },\n                    args: [body]\n                };\n            });\n            return k({\n                type: 'lambda',\n                vars: [cont].concat(node.vars),\n                body: body\n            });\n        }\n        function cpsMatrix(elements, k, isMatrix) {\n            var a = [];\n            return function loop(i) {\n                if (i == elements.length) {\n                    return k({\n                        type: 'matrix',\n                        value: a\n                    });\n                } else {\n                    return (isMatrix ? cpsMatrix : cps)(elements[i], function (val) {\n                        a[i] = val;\n                        return loop(i + 1);\n                    });\n                }\n            }(0);\n        }\n        function makeContinuation(k) {\n            var cont = gensym('R');\n            return {\n                type: 'lambda',\n                vars: [cont],\n                body: k({\n                    type: 'var',\n                    name: cont\n                })\n            };\n        }\n        function gensym(name) {\n            if (!name) {\n                name = '';\n            }\n            name = '_' + name;\n            return name + ++GENSYM;\n        }\n    }\n    var makeClosure = function (cache) {\n        return function (code) {\n            var f = cache[code];\n            if (!f) {\n                f = cache[code] = new Function('\\'use strict\\';return(' + code + ')')();\n            }\n            return f;\n        };\n    }(Object.create(null));\n    var FORMULA_CACHE = Object.create(null);\n    function makeFormula(exp) {\n        var printer = makePrinter(exp);\n        var hash = printer.call(exp);\n        var formula = FORMULA_CACHE[hash];\n        if (formula) {\n            return formula.clone(exp.sheet, exp.row, exp.col);\n        }\n        var code = js(toCPS(exp.ast, function (ret) {\n            return {\n                type: 'return',\n                value: ret\n            };\n        }));\n        code = [\n            'function(){',\n            'var context = this, refs = context.formula.absrefs',\n            code,\n            '}'\n        ].join(';\\n');\n        formula = new runtime.Formula(exp.refs, makeClosure(code), printer, exp.sheet, exp.row, exp.col);\n        FORMULA_CACHE[hash] = formula;\n        return formula;\n        function js(node) {\n            var type = node.type;\n            if (type == 'num') {\n                return node.value + '';\n            } else if (type == 'str') {\n                return JSON.stringify(node.value);\n            } else if (type == 'return') {\n                return 'context.resolve(' + js(node.value) + ')';\n            } else if (type == 'func') {\n                return 'context.func(' + JSON.stringify(node.func) + ', ' + js(node.args[0]) + ', ' + jsArray(node.args.slice(1)) + ')';\n            } else if (type == 'call') {\n                return js(node.func) + '(' + node.args.map(js).join(', ') + ')';\n            } else if (type == 'ref') {\n                return 'refs[' + node.index + ']';\n            } else if (type == 'bool') {\n                return '' + node.value;\n            } else if (type == 'if') {\n                return '(context.bool(' + js(node.co) + ') ? ' + js(node.th) + ' : ' + js(node.el) + ')';\n            } else if (type == 'lambda') {\n                return '(function(' + node.vars.join(', ') + '){ return(' + js(node.body) + ') })';\n            } else if (type == 'var') {\n                return node.name;\n            } else if (type == 'matrix') {\n                return jsArray(node.value);\n            } else if (type == 'null') {\n                return 'null';\n            } else {\n                throw new Error('Cannot compile expression ' + type);\n            }\n        }\n        function jsArray(a) {\n            return '[ ' + a.map(js).join(', ') + ' ]';\n        }\n    }\n    function identity(x) {\n        return x;\n    }\n    function TokenStream(input, options) {\n        input = RawTokenStream(InputStream(input), options);\n        var ahead = input.ahead;\n        var skip = input.skip;\n        var token = null;\n        var fixCell = options.row != null && options.col != null ? function (cell) {\n            if (cell.rel & 1) {\n                cell.col -= options.col;\n            }\n            if (cell.rel & 2) {\n                cell.row -= options.row;\n            }\n            return cell;\n        } : identity;\n        var addPos = options.forEditor ? function (thing, startToken, endToken) {\n            thing.begin = startToken.begin;\n            thing.end = endToken.end;\n            return thing;\n        } : identity;\n        return {\n            peek: peek,\n            next: next,\n            croak: input.croak,\n            eof: input.eof,\n            is: is\n        };\n        function is(type, value) {\n            var tok = peek();\n            return tok != null && (type == null || tok.type === type) && (value == null || tok.value === value) ? tok : null;\n        }\n        function peek() {\n            if (token == null) {\n                token = readNext();\n            }\n            return token;\n        }\n        function next() {\n            if (token != null) {\n                var tmp = token;\n                token = null;\n                return tmp;\n            }\n            return readNext();\n        }\n        function readNext() {\n            var ret;\n            var t = input.peek();\n            if (t) {\n                if (t.type == 'sym' || t.type == 'rc' || t.type == 'num') {\n                    ret = ahead(8, refRange3D) || ahead(6, refCell3D) || ahead(6, refSheetRange) || ahead(4, refSheetCell) || ahead(4, refRange) || ahead(2, refCell) || ahead(2, funcall);\n                }\n                if (!ret) {\n                    ret = input.next();\n                }\n            }\n            return ret;\n        }\n        function toCell(tok, isFirst) {\n            if (tok.type == 'rc') {\n                if (tok.rel && !options.forEditor && (options.row == null || options.col == null)) {\n                    input.croak('Cannot read relative cell in RC notation');\n                }\n                return new CellRef(tok.row, tok.col, tok.rel);\n            }\n            if (tok.type == 'num') {\n                if (tok.value <= 1048577) {\n                    return fixCell(new CellRef(getrow(tok.value), isFirst ? -Infinity : +Infinity, 2));\n                } else {\n                    return null;\n                }\n            }\n            var name = tok.value;\n            var m = /^(\\$)?([a-z]+)(\\$)?(\\d+)$/i.exec(name);\n            if (m) {\n                var row = getrow(m[4]), col = getcol(m[2]);\n                if (row <= 1048576 && col <= 16383) {\n                    return fixCell(new CellRef(getrow(m[4]), getcol(m[2]), (m[1] ? 0 : 1) | (m[3] ? 0 : 2)));\n                } else {\n                    return null;\n                }\n            }\n            var abs = name.charAt(0) == '$';\n            if (abs) {\n                name = name.substr(1);\n            }\n            if (/^\\d+$/.test(name)) {\n                var row = getrow(name);\n                if (row <= 1048576) {\n                    return fixCell(new CellRef(getrow(name), isFirst ? -Infinity : +Infinity, abs ? 0 : 2));\n                }\n            } else {\n                var col = getcol(name);\n                if (col <= 16383) {\n                    return fixCell(new CellRef(isFirst ? -Infinity : +Infinity, getcol(name), abs ? 0 : 1));\n                }\n            }\n        }\n        function refRange3D(a, b, c, d, e, f, g, h) {\n            if (a.type == 'sym' && b.type == 'op' && b.value == ':' && c.type == 'sym' && d.type == 'punc' && d.value == '!' && (e.type == 'sym' || e.type == 'rc' || e.type == 'num' && e.value == e.value | 0) && f.type == 'op' && f.value == ':' && (g.type == 'sym' || g.type == 'rc' || g.type == 'num' && g.value == g.value | 0) && g.type == e.type && !(h.type == 'punc' && h.value == '(' && !g.space)) {\n                var tl = toCell(e, true), br = toCell(g, false);\n                if (tl && br) {\n                    skip(7);\n                    return addPos(new RangeRef(tl.setSheet(a.value, true), br.setSheet(c.value, true)).setSheet(a.value, true), a, g);\n                }\n            }\n        }\n        function refCell3D(a, b, c, d, e, f) {\n            if (a.type == 'sym' && b.type == 'op' && b.value == ':' && c.type == 'sym' && d.type == 'punc' && d.value == '!' && (e.type == 'sym' || e.type == 'rc' || e.type == 'num' && e.value == e.value | 0) && !(f.type == 'punc' && f.value == '(' && !e.space)) {\n                var tl = toCell(e);\n                if (tl) {\n                    skip(5);\n                    var br = tl.clone();\n                    return addPos(new RangeRef(tl.setSheet(a.value, true), br.setSheet(c.value, true)).setSheet(a.value, true), a, e);\n                }\n            }\n        }\n        function refSheetRange(a, b, c, d, e, f) {\n            if (a.type == 'sym' && b.type == 'punc' && b.value == '!' && (c.type == 'sym' || c.type == 'rc' || c.type == 'num' && c.value == c.value | 0) && d.type == 'op' && d.value == ':' && (e.type == 'sym' || e.type == 'rc' || e.type == 'num' && e.value == e.value | 0) && !(f.type == 'punc' && f.value == '(' && !e.space)) {\n                var tl = toCell(c, true), br = toCell(e, false);\n                if (tl && br) {\n                    skip(5);\n                    return addPos(new RangeRef(tl, br).setSheet(a.value, true), a, e);\n                }\n            }\n        }\n        function refSheetCell(a, b, c, d) {\n            if (a.type == 'sym' && b.type == 'punc' && b.value == '!' && (c.type == 'sym' || c.type == 'rc' || c.type == 'num' && c.value == c.value | 0) && !(d.type == 'punc' && d.value == '(' && !c.space)) {\n                skip(3);\n                var x = toCell(c);\n                if (!x) {\n                    x = new NameRef(c.value);\n                }\n                return addPos(x.setSheet(a.value, true), a, c);\n            }\n        }\n        function refRange(a, b, c, d) {\n            if ((a.type == 'sym' || a.type == 'rc' || a.type == 'num' && a.value == a.value | 0) && (b.type == 'op' && b.value == ':') && (c.type == 'sym' || c.type == 'rc' || c.type == 'num' && c.value == c.value | 0) && !(d.type == 'punc' && d.value == '(' && !c.space)) {\n                var tl = toCell(a, true), br = toCell(c, false);\n                if (tl && br) {\n                    skip(3);\n                    return addPos(new RangeRef(tl, br), a, c);\n                }\n            }\n        }\n        function refCell(a, b) {\n            if ((a.type == 'sym' || a.type == 'rc') && !(b.type == 'punc' && b.value == '(' && !a.space)) {\n                var x = toCell(a);\n                if (x && isFinite(x.row) && isFinite(x.col)) {\n                    skip(1);\n                    return addPos(x, a, a);\n                }\n            }\n        }\n        function funcall(a, b) {\n            if (a.type == 'sym' && b.type == 'punc' && b.value == '(' && !a.space) {\n                a.type = 'func';\n                skip(1);\n                return a;\n            }\n        }\n    }\n    function RawTokenStream(input, options) {\n        var tokens = [], index = 0;\n        var readWhile = input.readWhile;\n        return {\n            next: next,\n            peek: peek,\n            eof: eof,\n            croak: input.croak,\n            ahead: ahead,\n            skip: skip\n        };\n        function isDigit(ch) {\n            return /[0-9]/i.test(ch);\n        }\n        function isIdStart(ch) {\n            return /[a-z$_]/i.test(ch) || ch.toLowerCase() != ch.toUpperCase();\n        }\n        function isId(ch) {\n            return isIdStart(ch) || isDigit(ch) || ch == '.';\n        }\n        function isOpChar(ch) {\n            return ch in OPERATORS;\n        }\n        function isPunc(ch) {\n            return '!;(){}[]'.indexOf(ch) >= 0;\n        }\n        function isWhitespace(ch) {\n            return ' \\t\\n\\xA0'.indexOf(ch) >= 0;\n        }\n        function readNumber() {\n            var has_dot = false;\n            var number = readWhile(function (ch) {\n                if (ch == '.') {\n                    if (has_dot) {\n                        return false;\n                    }\n                    has_dot = true;\n                    return true;\n                }\n                return isDigit(ch);\n            });\n            return {\n                type: 'num',\n                value: parseFloat(number)\n            };\n        }\n        function symbol(id, quote) {\n            return {\n                type: 'sym',\n                value: id,\n                upper: id.toUpperCase(),\n                space: isWhitespace(input.peek()),\n                quote: quote\n            };\n        }\n        function getRC(a, b, c) {\n            if (!a && !c || a && c) {\n                var negative = a && /-$/.test(a);\n                var num = parseInt(b, 10);\n                if (negative) {\n                    num = -num;\n                }\n                if (!a) {\n                    num--;\n                }\n                return num;\n            }\n        }\n        function readSymbol() {\n            var m = input.lookingAt(/^R(\\[-?)?([0-9]+)(\\])?C(\\[-?)?([0-9]+)(\\])?/i);\n            if (m) {\n                var row = getRC(m[1], m[2], m[3]);\n                var col = getRC(m[4], m[5], m[6]);\n                if (row != null && col != null) {\n                    input.skip(m);\n                    return {\n                        type: 'rc',\n                        row: row,\n                        col: col,\n                        rel: (m[4] ? 1 : 0) | (m[1] ? 2 : 0)\n                    };\n                }\n            }\n            return symbol(readWhile(isId));\n        }\n        function readString() {\n            input.next();\n            return {\n                type: 'str',\n                value: input.readEscaped('\"')\n            };\n        }\n        function readSheetName() {\n            input.next();\n            return symbol(input.readEscaped('\\''), true);\n        }\n        function readOperator() {\n            return {\n                type: 'op',\n                value: readWhile(function (ch, op) {\n                    return op + ch in OPERATORS;\n                })\n            };\n        }\n        function readPunc() {\n            return {\n                type: 'punc',\n                value: input.next()\n            };\n        }\n        function readNext() {\n            if (input.eof()) {\n                return null;\n            }\n            var ch = input.peek(), m;\n            if (ch == '\"') {\n                return readString();\n            }\n            if (ch == '\\'') {\n                return readSheetName();\n            }\n            if (isDigit(ch)) {\n                return readNumber();\n            }\n            if (isIdStart(ch)) {\n                return readSymbol();\n            }\n            if (isOpChar(ch)) {\n                return readOperator();\n            }\n            if (isPunc(ch)) {\n                return readPunc();\n            }\n            if (m = input.lookingAt(/^#([a-z\\/]+)[?!]/i)) {\n                input.skip(m);\n                return {\n                    type: 'error',\n                    value: m[1]\n                };\n            }\n            if (!options.forEditor) {\n                input.croak('Can\\'t handle character: ' + ch);\n            }\n            return {\n                type: 'error',\n                value: input.next()\n            };\n        }\n        function peek() {\n            while (tokens.length <= index) {\n                readWhile(isWhitespace);\n                var begin = input.pos();\n                var tok = readNext();\n                if (options.forEditor && tok) {\n                    tok.begin = begin;\n                    tok.end = input.pos();\n                }\n                tokens.push(tok);\n            }\n            return tokens[index];\n        }\n        function next() {\n            var tok = peek();\n            if (tok) {\n                index++;\n            }\n            return tok;\n        }\n        function ahead(n, f) {\n            var pos = index, a = [];\n            while (n-- > 0) {\n                a.push(next() || EOF);\n            }\n            index = pos;\n            return f.apply(a, a);\n        }\n        function skip(n) {\n            index += n;\n        }\n        function eof() {\n            return peek() == null;\n        }\n    }\n    var EOF = { type: 'eof' };\n    function InputStream(input) {\n        var pos = 0, line = 1, col = 0;\n        return {\n            next: next,\n            peek: peek,\n            eof: eof,\n            croak: croak,\n            readWhile: readWhile,\n            readEscaped: readEscaped,\n            lookingAt: lookingAt,\n            skip: skip,\n            forward: forward,\n            pos: location\n        };\n        function location() {\n            return pos;\n        }\n        function next() {\n            var ch = input.charAt(pos++);\n            if (ch == '\\n') {\n                line++;\n                col = 0;\n            } else {\n                col++;\n            }\n            return ch;\n        }\n        function peek() {\n            return input.charAt(pos);\n        }\n        function eof() {\n            return peek() === '';\n        }\n        function croak(msg) {\n            throw new ParseError(msg, pos);\n        }\n        function skip(ch) {\n            if (typeof ch == 'string') {\n                if (input.substr(pos, ch.length) != ch) {\n                    croak('Expected ' + ch);\n                }\n                forward(ch.length);\n            } else if (ch instanceof RegExp) {\n                var m = ch.exec(input.substr(pos));\n                if (m) {\n                    forward(m[0].length);\n                    return m;\n                }\n            } else {\n                forward(ch[0].length);\n            }\n        }\n        function forward(n) {\n            while (n-- > 0) {\n                next();\n            }\n        }\n        function readEscaped(end) {\n            var escaped = false, str = '';\n            while (!eof()) {\n                var ch = next();\n                if (escaped) {\n                    str += ch;\n                    escaped = false;\n                } else if (ch == '\\\\') {\n                    escaped = true;\n                } else if (ch == end) {\n                    break;\n                } else {\n                    str += ch;\n                }\n            }\n            return str;\n        }\n        function readWhile(predicate) {\n            var str = '';\n            while (!eof() && predicate(peek(), str)) {\n                str += next();\n            }\n            return str;\n        }\n        function lookingAt(rx) {\n            return rx.exec(input.substr(pos));\n        }\n    }\n    exports.parse = function (sheet, row, col, input) {\n        if (input instanceof Date) {\n            return {\n                type: 'date',\n                value: runtime.dateToSerial(input)\n            };\n        }\n        if (typeof input == 'number') {\n            return {\n                type: 'number',\n                value: input\n            };\n        }\n        if (typeof input == 'boolean') {\n            return {\n                type: 'boolean',\n                value: input\n            };\n        }\n        input += '';\n        if (/^'/.test(input)) {\n            return {\n                type: 'string',\n                value: input.substr(1)\n            };\n        }\n        if (/^[0-9.]+%$/.test(input)) {\n            var str = input.substr(0, input.length - 1);\n            var num = parseFloat(str);\n            if (!isNaN(num) && num == str) {\n                return {\n                    type: 'percent',\n                    value: num / 100\n                };\n            }\n        }\n        if (/^=/.test(input)) {\n            input = input.substr(1);\n            if (/\\S/.test(input)) {\n                return parseFormula(sheet, row, col, input);\n            } else {\n                return {\n                    type: 'string',\n                    value: '=' + input\n                };\n            }\n        }\n        if (input.toLowerCase() == 'true') {\n            return {\n                type: 'boolean',\n                value: true\n            };\n        }\n        if (input.toLowerCase() == 'false') {\n            return {\n                type: 'boolean',\n                value: false\n            };\n        }\n        var date = runtime.parseDate(input);\n        if (date) {\n            return {\n                type: 'date',\n                value: runtime.dateToSerial(date)\n            };\n        }\n        var num = parseFloat(input);\n        if (!isNaN(num) && input.length > 0 && num == input) {\n            return {\n                type: 'number',\n                value: num\n            };\n        }\n        return {\n            type: 'string',\n            value: input\n        };\n    };\n    function tokenize(input, row, col) {\n        var tokens = [];\n        input = TokenStream(input, {\n            forEditor: true,\n            row: row,\n            col: col\n        });\n        while (!input.eof()) {\n            tokens.push(next());\n        }\n        var tok = tokens[0];\n        if (tok.type == 'op' && tok.value == '=') {\n            tok.type = 'startexp';\n        }\n        return tokens;\n        function next() {\n            var tok = input.next();\n            if (tok.type == 'sym') {\n                if (tok.upper == 'TRUE') {\n                    tok.type = 'bool';\n                    tok.value = true;\n                } else if (tok.upper == 'FALSE') {\n                    tok.type = 'bool';\n                    tok.value = false;\n                }\n            } else if (tok.type == 'ref') {\n                tok = {\n                    type: 'ref',\n                    ref: row != null && col != null ? tok.absolute(row, col) : tok,\n                    begin: tok.begin,\n                    end: tok.end\n                };\n            }\n            return tok;\n        }\n    }\n    exports.parseFormula = parseFormula;\n    exports.parseReference = parseReference;\n    exports.compile = makeFormula;\n    exports.InputStream = InputStream;\n    exports.ParseError = ParseError;\n    exports.tokenize = tokenize;\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/excel-reader', [\n        'kendo.core',\n        'kendo.color',\n        'util/parse-xml',\n        'spreadsheet/calc'\n    ], f);\n}(function () {\n    'use strict';\n    if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n        return;\n    }\n    var $ = kendo.jQuery;\n    var parseXML = kendo.util.parseXML;\n    var parseReference = kendo.spreadsheet.calc.parseReference;\n    function readExcel(file, workbook, deferred) {\n        var reader = new FileReader();\n        reader.onload = function (e) {\n            var zip = new JSZip(e.target.result);\n            readWorkbook(zip, workbook, deferred);\n        };\n        reader.readAsArrayBuffer(file);\n    }\n    var SEL_CELL = [\n        'sheetData',\n        'row',\n        'c'\n    ];\n    var SEL_COL = [\n        'cols',\n        'col'\n    ];\n    var SEL_DEFINED_NAME = [\n        'definedNames',\n        'definedName'\n    ];\n    var SEL_FORMULA = [\n        'sheetData',\n        'row',\n        'c',\n        'f'\n    ];\n    var SEL_MERGE = [\n        'mergeCells',\n        'mergeCell'\n    ];\n    var SEL_PANE = [\n        'sheetViews',\n        'sheetView',\n        'pane'\n    ];\n    var SEL_ROW = [\n        'sheetData',\n        'row'\n    ];\n    var SEL_SELECTION = [\n        'sheetViews',\n        'sheetView',\n        'selection'\n    ];\n    var SEL_SHEET = [\n        'sheets',\n        'sheet'\n    ];\n    var SEL_STRING = [\n        'sheetData',\n        'row',\n        'c',\n        'is'\n    ];\n    var SEL_TEXT = ['t'];\n    var SEL_SHARED_STRING = ['si'];\n    var SEL_VALUE = [\n        'sheetData',\n        'row',\n        'c',\n        'v'\n    ];\n    var SEL_VIEW = [\n        'bookViews',\n        'workbookView'\n    ];\n    var SEL_SHEET_VIEW = [\n        'sheetViews',\n        'sheetView'\n    ];\n    function readWorkbook(zip, workbook, deferred) {\n        var strings = readStrings(zip);\n        var relationships = readRelationships(zip, 'workbook.xml');\n        var theme = readTheme(zip, relationships.byType.theme[0]);\n        var styles = readStyles(zip, theme);\n        var items = [];\n        var activeSheet = 0;\n        parse(zip, 'xl/workbook.xml', {\n            enter: function (tag, attrs) {\n                if (this.is(SEL_SHEET)) {\n                    var relId = attrs['r:id'];\n                    var file = relationships.byId[relId];\n                    var name = attrs.name;\n                    var dim = sheetDimensions(zip, file);\n                    items.push({\n                        workbook: workbook,\n                        zip: zip,\n                        strings: strings,\n                        styles: styles,\n                        file: file,\n                        options: {\n                            name: name,\n                            rows: Math.max(workbook.options.rows || 0, dim.rows),\n                            columns: Math.max(workbook.options.columns || 0, dim.cols),\n                            columnWidth: dim.columnWidth,\n                            rowHeight: dim.rowHeight\n                        }\n                    });\n                } else if (this.is(SEL_VIEW)) {\n                    if (attrs.activeTab) {\n                        activeSheet = integer(attrs.activeTab);\n                    }\n                }\n            },\n            text: function (text) {\n                var attrs = this.is(SEL_DEFINED_NAME);\n                if (attrs && !(bool(attrs['function']) || bool(attrs.vbProcedure))) {\n                    var ref = parseReference(text, true);\n                    workbook.defineName(attrs.name, ref, bool(attrs.hidden));\n                }\n            }\n        });\n        loadSheets(items, workbook, deferred).then(function () {\n            var sheets = workbook.sheets();\n            recalcSheets(sheets);\n            workbook.activeSheet(sheets[activeSheet]);\n        });\n    }\n    function loadSheets(items, workbook, deferred) {\n        var ready = new $.Deferred().resolve();\n        for (var i = 0; i < items.length; i++) {\n            (function (entry, i) {\n                ready = ready.then(function () {\n                    var sheet = workbook.insertSheet(entry.options);\n                    sheet.suspendChanges(true);\n                    var promise = queueSheet(sheet, entry);\n                    if (deferred) {\n                        var args = {\n                            sheet: sheet,\n                            progress: i / (items.length - 1)\n                        };\n                        promise.then(function () {\n                            deferred.notify(args);\n                        });\n                    }\n                    return promise;\n                });\n            }(items[i], i));\n        }\n        if (deferred) {\n            ready.then(function () {\n                deferred.resolve();\n            });\n        }\n        return ready;\n    }\n    function queueSheet(sheet, ctx) {\n        var deferred = new $.Deferred();\n        setTimeout(function () {\n            readSheet(ctx.zip, ctx.file, sheet, ctx.strings, ctx.styles);\n            deferred.resolve();\n        }, 0);\n        return deferred;\n    }\n    function recalcSheets(sheets) {\n        for (var i = 0; i < sheets.length; i++) {\n            sheets[i].suspendChanges(false).triggerChange({ recalc: true });\n        }\n    }\n    function sheetDimensions(zip, file) {\n        var dim = {\n            rows: 0,\n            cols: 0\n        };\n        parse(zip, 'xl/' + file, {\n            enter: function (tag, attrs) {\n                if (tag == 'dimension') {\n                    var ref = parseReference(attrs.ref);\n                    if (ref.bottomRight) {\n                        dim.cols = ref.bottomRight.col + 1;\n                        dim.rows = ref.bottomRight.row + 1;\n                    }\n                } else if (tag === 'sheetFormatPr') {\n                    if (attrs.defaultColWidth) {\n                        dim.columnWidth = toColWidth(parseFloat(attrs.defaultColWidth));\n                    }\n                    if (attrs.defaultRowHeight) {\n                        dim.rowHeight = toRowHeight(parseFloat(attrs.defaultRowHeight));\n                    }\n                } else if (this.is(SEL_ROW)) {\n                    this.exit();\n                }\n            }\n        });\n        return dim;\n    }\n    function toColWidth(size) {\n        var maximumDigitWidth = 7;\n        var fraction = (256 * size + Math.floor(128 / maximumDigitWidth)) / 256;\n        return Math.floor(fraction) * maximumDigitWidth;\n    }\n    function toRowHeight(pts) {\n        return pts * 1.5625;\n    }\n    function readSheet(zip, file, sheet, strings, styles) {\n        var ref, type, value, formula, formulaRange;\n        var nCols = sheet._columns._count;\n        parse(zip, 'xl/' + file, {\n            enter: function (tag, attrs) {\n                if (this.is(SEL_CELL)) {\n                    value = null;\n                    formula = null;\n                    formulaRange = null;\n                    ref = attrs.r;\n                    type = attrs.t;\n                    var styleIndex = attrs.s;\n                    if (styleIndex != null) {\n                        applyStyle(sheet, ref, styles, styleIndex);\n                    }\n                } else if (this.is(SEL_MERGE)) {\n                    sheet.range(attrs.ref).merge();\n                } else if (this.is(SEL_COL)) {\n                    var start = integer(attrs.min) - 1;\n                    var stop = Math.min(nCols, integer(attrs.max)) - 1;\n                    if (attrs.width) {\n                        var width = toColWidth(parseFloat(attrs.width));\n                        sheet._columns.values.value(start, stop, width);\n                    }\n                    if (attrs.hidden === '1') {\n                        for (var ci = start; ci <= stop; ci++) {\n                            sheet.hideColumn(ci);\n                        }\n                    }\n                } else if (this.is(SEL_ROW)) {\n                    var row = integer(attrs.r) - 1;\n                    if (attrs.ht) {\n                        var height = toRowHeight(parseFloat(attrs.ht));\n                        sheet._rows.values.value(row, row, height);\n                    }\n                    if (attrs.hidden === '1') {\n                        sheet.hideRow(row);\n                    }\n                } else if (this.is(SEL_SELECTION)) {\n                    if (attrs.activeCell) {\n                        var acRef = parseReference(attrs.activeCell);\n                        sheet.select(acRef, true);\n                    }\n                } else if (this.is(SEL_PANE)) {\n                    if (attrs.state == 'frozen') {\n                        if (attrs.xSplit) {\n                            sheet.frozenColumns(integer(attrs.xSplit));\n                        }\n                        if (attrs.ySplit) {\n                            sheet.frozenRows(integer(attrs.ySplit));\n                        }\n                    }\n                } else if (this.is(SEL_SHEET_VIEW)) {\n                    sheet.options.showGridLines = bool(attrs.showGridLines, true);\n                }\n            },\n            leave: function (tag) {\n                if (this.is(SEL_CELL)) {\n                    if (formula != null) {\n                        try {\n                            sheet.range(formulaRange || ref).formula(formula);\n                        } catch (ex) {\n                            sheet.range(formulaRange || ref).value(formula).background('#ffaaaa');\n                        }\n                    } else if (value != null) {\n                        var range = sheet.range(ref);\n                        if (type == 'str') {\n                            range.formula(value);\n                        } else if (!range._get('formula')) {\n                            if (!type || type == 'n') {\n                                value = parseFloat(value);\n                            } else if (type == 's') {\n                                value = strings[integer(value)];\n                            } else if (type == 'b') {\n                                value = value === '1';\n                            } else if (type == 'd') {\n                                value = kendo.parseDate(value);\n                            }\n                            range.value(value);\n                        }\n                    }\n                } else if (tag == 'cols') {\n                    sheet._columns._refresh();\n                } else if (tag == 'sheetData') {\n                    sheet._rows._refresh();\n                }\n            },\n            text: function (text) {\n                var attrs;\n                if (this.is(SEL_VALUE) || this.is(SEL_STRING)) {\n                    value = text;\n                } else if (attrs = this.is(SEL_FORMULA)) {\n                    formula = text;\n                    if (attrs.t == 'shared') {\n                        formulaRange = attrs.ref;\n                    }\n                }\n            }\n        });\n    }\n    var BORDER_WIDTHS = {\n        'none': 0,\n        'thin': 1,\n        'medium': 2,\n        'dashed': 1,\n        'dotted': 1,\n        'thick': 3,\n        'double': 3,\n        'hair': 1,\n        'mediumDashed': 2,\n        'dashDot': 1,\n        'mediumDashDot': 2,\n        'dashDotDot': 1,\n        'mediumDashDotDot': 2,\n        'slantDashDot': 1\n    };\n    var DEFAULT_FORMATS = {\n        0: 'General',\n        1: '0',\n        2: '0.00',\n        3: '#,##0',\n        4: '#,##0.00',\n        9: '0%',\n        10: '0.00%',\n        11: '0.00E+00',\n        12: '# ?/?',\n        13: '# ??/??',\n        14: 'mm-dd-yy',\n        15: 'd-mmm-yy',\n        16: 'd-mmm',\n        17: 'mmm-yy',\n        18: 'h:mm AM/PM',\n        19: 'h:mm:ss AM/PM',\n        20: 'h:mm',\n        21: 'h:mm:ss',\n        22: 'm/d/yy h:mm',\n        37: '#,##0 ;(#,##0)',\n        38: '#,##0 ;[Red](#,##0)',\n        39: '#,##0.00;(#,##0.00)',\n        40: '#,##0.00;[Red](#,##0.00)',\n        45: 'mm:ss',\n        46: '[h]:mm:ss',\n        47: 'mmss.0',\n        48: '##0.0E+0',\n        49: '@'\n    };\n    function applyStyle(sheet, ref, styles, styleIndex) {\n        var range = sheet.range(ref);\n        var xf = styles.inlineStyles[styleIndex], base, value;\n        if (xf.xfId) {\n            base = styles.namedStyles[xf.xfId];\n        }\n        if (shouldSet('applyBorder', 'borderId')) {\n            setBorder(styles.borders[value]);\n        }\n        if (shouldSet('applyFont', 'fontId')) {\n            setFont(styles.fonts[value]);\n        }\n        if (shouldSet('applyAlignment', 'textAlign')) {\n            range.textAlign(value);\n        }\n        if (shouldSet('applyAlignment', 'verticalAlign')) {\n            range.verticalAlign(value);\n        }\n        if (shouldSet('applyAlignment', 'wrapText')) {\n            range._property('wrap', value);\n        }\n        if (shouldSet('applyFill', 'fillId')) {\n            setFill(styles.fills[value]);\n        }\n        if (shouldSet('applyNumberFormat', 'numFmtId')) {\n            setFormat(styles.numFmts[value] || DEFAULT_FORMATS[value]);\n        }\n        function setFormat(f) {\n            var format = typeof f == 'string' ? f : f.formatCode;\n            if (format != null && !/^general$/i.test(format)) {\n                format = format.replace(/^\\[\\$-[0-9]+\\]/, '');\n                range.format(format);\n            }\n        }\n        function setFill(f) {\n            if (f.type == 'solid') {\n                range.background(f.color);\n            }\n        }\n        function setFont(f) {\n            range.fontFamily(f.name);\n            range._property('fontSize', f.size);\n            if (f.bold) {\n                range.bold(true);\n            }\n            if (f.italic) {\n                range.italic(true);\n            }\n        }\n        function setBorder(b) {\n            function set(side, prop) {\n                var border = b[side];\n                if (!border) {\n                    return;\n                }\n                var width = BORDER_WIDTHS[border.style];\n                if (width === 0) {\n                    return;\n                }\n                var color = border.color;\n                if (color == null) {\n                    color = '#000';\n                }\n                range._property(prop, {\n                    size: width,\n                    color: color\n                });\n            }\n            set('left', 'borderLeft');\n            set('top', 'borderTop');\n            set('right', 'borderRight');\n            set('bottom', 'borderBottom');\n        }\n        function shouldSet(applyName, propName) {\n            var t = xf[applyName];\n            if (t != null && !t) {\n                return false;\n            }\n            value = xf[propName];\n            if (base && value == null) {\n                t = base[applyName];\n                if (t != null && !t) {\n                    return false;\n                }\n                value = base[propName];\n            }\n            return value != null;\n        }\n    }\n    function parse(zip, file, callbacks) {\n        var part = zip.files[file];\n        if (part) {\n            parseXML(part.asUint8Array(), callbacks);\n        }\n    }\n    function readStrings(zip) {\n        var strings = [];\n        var current;\n        parse(zip, 'xl/sharedStrings.xml', {\n            enter: function () {\n                if (this.is(SEL_SHARED_STRING)) {\n                    current = '';\n                }\n            },\n            leave: function () {\n                if (this.is(SEL_SHARED_STRING)) {\n                    strings.push(current);\n                }\n            },\n            text: function (text) {\n                if (this.is(SEL_TEXT)) {\n                    current += text;\n                }\n            }\n        });\n        return strings;\n    }\n    function readRelationships(zip, file) {\n        var map = {\n            byId: {},\n            byType: { theme: [] }\n        };\n        parse(zip, 'xl/_rels/' + file + '.rels', {\n            enter: function (tag, attrs) {\n                if (tag == 'Relationship') {\n                    map.byId[attrs.Id] = attrs.Target;\n                    var type = attrs.Type.match(/\\w+$/)[0];\n                    var entries = map.byType[type] || [];\n                    entries.push(attrs.Target);\n                    map.byType[type] = entries;\n                }\n            }\n        });\n        return map;\n    }\n    var SEL_BORDER = [\n        'borders',\n        'border'\n    ];\n    var SEL_FILL = [\n        'fills',\n        'fill'\n    ];\n    var SEL_FONT = [\n        'fonts',\n        'font'\n    ];\n    var SEL_INLINE_STYLE = [\n        'cellXfs',\n        'xf'\n    ];\n    var SEL_NAMED_STYLE = [\n        'cellStyleXfs',\n        'xf'\n    ];\n    var SEL_NUM_FMT = [\n        'numFmts',\n        'numFmt'\n    ];\n    var INDEXED_COLORS = [\n        toCSSColor('FF000000'),\n        toCSSColor('FFFFFFFF'),\n        toCSSColor('FFFF0000'),\n        toCSSColor('FF00FF00'),\n        toCSSColor('FF0000FF'),\n        toCSSColor('FFFFFF00'),\n        toCSSColor('FFFF00FF'),\n        toCSSColor('FF00FFFF'),\n        toCSSColor('FF000000'),\n        toCSSColor('FFFFFFFF'),\n        toCSSColor('FFFF0000'),\n        toCSSColor('FF00FF00'),\n        toCSSColor('FF0000FF'),\n        toCSSColor('FFFFFF00'),\n        toCSSColor('FFFF00FF'),\n        toCSSColor('FF00FFFF'),\n        toCSSColor('FF800000'),\n        toCSSColor('FF008000'),\n        toCSSColor('FF000080'),\n        toCSSColor('FF808000'),\n        toCSSColor('FF800080'),\n        toCSSColor('FF008080'),\n        toCSSColor('FFC0C0C0'),\n        toCSSColor('FF808080'),\n        toCSSColor('FF9999FF'),\n        toCSSColor('FF993366'),\n        toCSSColor('FFFFFFCC'),\n        toCSSColor('FFCCFFFF'),\n        toCSSColor('FF660066'),\n        toCSSColor('FFFF8080'),\n        toCSSColor('FF0066CC'),\n        toCSSColor('FFCCCCFF'),\n        toCSSColor('FF000080'),\n        toCSSColor('FFFF00FF'),\n        toCSSColor('FFFFFF00'),\n        toCSSColor('FF00FFFF'),\n        toCSSColor('FF800080'),\n        toCSSColor('FF800000'),\n        toCSSColor('FF008080'),\n        toCSSColor('FF0000FF'),\n        toCSSColor('FF00CCFF'),\n        toCSSColor('FFCCFFFF'),\n        toCSSColor('FFCCFFCC'),\n        toCSSColor('FFFFFF99'),\n        toCSSColor('FF99CCFF'),\n        toCSSColor('FFFF99CC'),\n        toCSSColor('FFCC99FF'),\n        toCSSColor('FFFFCC99'),\n        toCSSColor('FF3366FF'),\n        toCSSColor('FF33CCCC'),\n        toCSSColor('FF99CC00'),\n        toCSSColor('FFFFCC00'),\n        toCSSColor('FFFF9900'),\n        toCSSColor('FFFF6600'),\n        toCSSColor('FF666699'),\n        toCSSColor('FF969696'),\n        toCSSColor('FF003366'),\n        toCSSColor('FF339966'),\n        toCSSColor('FF003300'),\n        toCSSColor('FF333300'),\n        toCSSColor('FF993300'),\n        toCSSColor('FF993366'),\n        toCSSColor('FF333399'),\n        toCSSColor('FF333333'),\n        toCSSColor('FF000000'),\n        toCSSColor('FFFFFFFF')\n    ];\n    function readStyles(zip, theme) {\n        var styles = {\n            fonts: [],\n            numFmts: {},\n            fills: [],\n            borders: [],\n            namedStyles: [],\n            inlineStyles: []\n        };\n        var font = null;\n        var fill = null;\n        var border = null;\n        var xf = null;\n        parse(zip, 'xl/styles.xml', {\n            enter: function (tag, attrs, closed) {\n                if (this.is(SEL_NUM_FMT)) {\n                    styles.numFmts[attrs.numFmtId] = attrs;\n                } else if (this.is(SEL_FONT)) {\n                    styles.fonts.push(font = {});\n                } else if (font) {\n                    if (tag == 'sz') {\n                        font.size = parseFloat(attrs.val);\n                    } else if (tag == 'name') {\n                        font.name = attrs.val;\n                    } else if (tag == 'b') {\n                        font.bold = bool(attrs.val, true);\n                    } else if (tag == 'i') {\n                        font.italic = bool(attrs.val, true);\n                    }\n                } else if (this.is(SEL_FILL)) {\n                    styles.fills.push(fill = {});\n                } else if (fill) {\n                    if (tag == 'patternFill') {\n                        fill.type = attrs.patternType;\n                    } else if (tag == 'fgColor' && fill.type === 'solid') {\n                        fill.color = getColor(attrs);\n                    } else if (tag == 'bgColor' && fill.type !== 'solid') {\n                        fill.color = getColor(attrs);\n                    }\n                } else if (this.is(SEL_BORDER)) {\n                    styles.borders.push(border = {});\n                } else if (border) {\n                    if (/^(?:left|top|right|bottom)$/.test(tag) && attrs.style) {\n                        border[tag] = { style: attrs.style };\n                    }\n                    if (tag == 'color') {\n                        var side = this.stack[this.stack.length - 2].$tag;\n                        border[side].color = getColor(attrs);\n                    }\n                } else if (this.is(SEL_NAMED_STYLE)) {\n                    xf = getXf(attrs);\n                    styles.namedStyles.push(xf);\n                    if (closed) {\n                        xf = null;\n                    }\n                } else if (this.is(SEL_INLINE_STYLE)) {\n                    xf = getXf(attrs);\n                    styles.inlineStyles.push(xf);\n                    if (closed) {\n                        xf = null;\n                    }\n                } else if (xf) {\n                    if (tag == 'alignment') {\n                        if (/^(?:left|center|right|justify)$/.test(attrs.horizontal)) {\n                            xf.textAlign = attrs.horizontal;\n                        }\n                        if (/^(?:top|center|bottom)$/.test(attrs.vertical)) {\n                            xf.verticalAlign = attrs.vertical;\n                        }\n                        if (attrs.wrapText != null) {\n                            xf.wrapText = bool(attrs.wrapText);\n                        }\n                    }\n                }\n            },\n            leave: function (tag) {\n                if (this.is(SEL_FONT)) {\n                    font = null;\n                } else if (this.is(SEL_FILL)) {\n                    fill = null;\n                } else if (this.is(SEL_BORDER)) {\n                    border = null;\n                } else if (tag == 'xf') {\n                    xf = null;\n                }\n            }\n        });\n        function getXf(attrs) {\n            var xf = {\n                borderId: integer(attrs.borderId),\n                fillId: integer(attrs.fillId),\n                fontId: integer(attrs.fontId),\n                numFmtId: integer(attrs.numFmtId),\n                pivotButton: bool(attrs.pivotButton),\n                quotePrefix: bool(attrs.quotePrefix),\n                xfId: integer(attrs.xfId)\n            };\n            addBool('applyAlignment');\n            addBool('applyBorder');\n            addBool('applyFill');\n            addBool('applyFont');\n            addBool('applyNumberFormat');\n            addBool('applyProtection');\n            function addBool(name) {\n                if (attrs[name] != null) {\n                    xf[name] = bool(attrs[name]);\n                }\n            }\n            return xf;\n        }\n        function getColor(attrs) {\n            if (attrs.rgb) {\n                return toCSSColor(attrs.rgb);\n            } else if (attrs.indexed) {\n                return INDEXED_COLORS[integer(attrs.indexed)];\n            } else if (attrs.theme) {\n                var themeColor = theme.colorScheme[integer(attrs.theme)];\n                var color = kendo.parseColor(themeColor);\n                if (attrs.tint) {\n                    color = color.toHSL();\n                    var tint = parseFloat(attrs.tint);\n                    if (tint < 0) {\n                        color.l = color.l * (1 + tint);\n                    } else {\n                        color.l = color.l * (1 - tint) + (100 - 100 * (1 - tint));\n                    }\n                }\n                return color.toCssRgba();\n            }\n        }\n        return styles;\n    }\n    var SEL_SCHEME_RGBCLR = [\n        'a:clrScheme',\n        '*',\n        'a:srgbClr'\n    ];\n    var SEL_SCHEME_SYSCLR = [\n        'a:clrScheme',\n        '*',\n        'a:sysClr'\n    ];\n    function readTheme(zip, rel) {\n        var scheme = [];\n        var theme = { colorScheme: scheme };\n        var file = 'xl/' + rel;\n        if (zip.files[file]) {\n            parse(zip, file, {\n                enter: function (tag, attrs) {\n                    if (this.is(SEL_SCHEME_SYSCLR)) {\n                        scheme.push(toCSSColor(attrs.val == 'window' ? 'FFFFFFFF' : 'FF000000'));\n                    } else if (this.is(SEL_SCHEME_RGBCLR)) {\n                        scheme.push(toCSSColor('FF' + attrs.val));\n                    }\n                }\n            });\n            if (scheme.length > 3) {\n                swap(scheme, 0, 1);\n                swap(scheme, 2, 3);\n            }\n        }\n        function swap(arr, a, b) {\n            var tmp = arr[a];\n            arr[a] = arr[b];\n            arr[b] = tmp;\n        }\n        return theme;\n    }\n    function integer(val) {\n        return val == null ? null : parseInt(val, 10);\n    }\n    function bool(val, def) {\n        if (val == null) {\n            return def;\n        }\n        return val == 'true' || val === true || val == 1;\n    }\n    function toCSSColor(rgb) {\n        var m = /^([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})$/i.exec(rgb);\n        return 'rgba(' + parseInt(m[2], 16) + ', ' + parseInt(m[3], 16) + ', ' + parseInt(m[4], 16) + ', ' + parseInt(m[1], 16) / 255 + ')';\n    }\n    kendo.spreadsheet.readExcel = readExcel;\n    kendo.spreadsheet._readSheet = readSheet;\n    kendo.spreadsheet._readStrings = readStrings;\n    kendo.spreadsheet._readStyles = readStyles;\n    kendo.spreadsheet._readTheme = readTheme;\n    kendo.spreadsheet._readWorkbook = readWorkbook;\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/workbook', [\n        'kendo.core',\n        'spreadsheet/runtime',\n        'spreadsheet/references',\n        'spreadsheet/excel-reader'\n    ], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var $ = kendo.jQuery;\n        var Workbook = kendo.Observable.extend({\n            init: function (options, view) {\n                kendo.Observable.fn.init.call(this);\n                this.options = options;\n                this._view = view;\n                this._sheets = [];\n                this._sheetsSearchCache = {};\n                this._sheet = this.insertSheet({\n                    rows: this.options.rows,\n                    columns: this.options.columns,\n                    rowHeight: this.options.rowHeight,\n                    columnWidth: this.options.columnWidth,\n                    headerHeight: this.options.headerHeight,\n                    headerWidth: this.options.headerWidth,\n                    dataSource: this.options.dataSource\n                });\n                this.undoRedoStack = new kendo.util.UndoRedoStack();\n                this.undoRedoStack.bind([\n                    'undo',\n                    'redo'\n                ], this._onUndoRedo.bind(this));\n                this._context = new kendo.spreadsheet.FormulaContext(this);\n                this._validationContext = new kendo.spreadsheet.ValidationFormulaContext(this);\n                this._names = Object.create(null);\n                this.fromJSON(this.options);\n            },\n            clipboard: function () {\n                if (!this._clipboard) {\n                    this._clipboard = new kendo.spreadsheet.Clipboard(this);\n                }\n                return this._clipboard;\n            },\n            destroy: function () {\n                this.unbind();\n                if (this._clipboard) {\n                    this._clipboard.destroy();\n                }\n            },\n            events: [\n                'change',\n                'excelImport',\n                'excelExport'\n            ],\n            _sheetChange: function (e) {\n                this.trigger('change', e);\n            },\n            _inputForRef: function (ref) {\n                return new kendo.spreadsheet.Range(ref, this._sheet).input();\n            },\n            _onUndoRedo: function (e) {\n                e.command.range().select();\n            },\n            execute: function (options) {\n                var commandOptions = $.extend({ workbook: this }, options.options);\n                var command = new kendo.spreadsheet[options.command](commandOptions);\n                var sheet = this.activeSheet();\n                if (commandOptions.origin) {\n                    command.origin(commandOptions.origin);\n                }\n                if (commandOptions.operatingRange) {\n                    command.range(commandOptions.operatingRange);\n                } else if (commandOptions.editActiveCell) {\n                    command.range(sheet.activeCellSelection());\n                } else {\n                    command.range(sheet.selection());\n                }\n                var result = command.exec();\n                if (!result || result.reason !== 'error') {\n                    this.undoRedoStack.push(command);\n                }\n                return result;\n            },\n            resetFormulas: function () {\n                this._sheets.forEach(function (sheet) {\n                    sheet.resetFormulas();\n                });\n            },\n            resetValidations: function () {\n                this._sheets.forEach(function (sheet) {\n                    sheet.resetValidations();\n                });\n            },\n            refresh: function (reason) {\n                if (reason.recalc) {\n                    this.resetFormulas();\n                    this.resetValidations();\n                    this._sheet.recalc(this._context);\n                    this._sheet.revalidate(this._validationContext);\n                }\n            },\n            activeSheet: function (sheet) {\n                if (sheet === undefined) {\n                    return this._sheet;\n                }\n                if (!this.sheetByName(sheet.name())) {\n                    return;\n                }\n                this._sheet = sheet;\n                sheet.triggerChange(kendo.spreadsheet.ALL_REASONS);\n            },\n            moveSheetToIndex: function (sheet, toIndex) {\n                var fromIndex = this.sheetIndex(sheet);\n                var sheets = this._sheets;\n                if (fromIndex === -1) {\n                    return;\n                }\n                this._sheetsSearchCache = {};\n                sheets.splice(toIndex, 0, sheets.splice(fromIndex, 1)[0]);\n                this.trigger('change', { sheetSelection: true });\n            },\n            insertSheet: function (options) {\n                options = options || {};\n                var that = this;\n                var insertIndex = typeof options.index === 'number' ? options.index : that._sheets.length;\n                var sheetName;\n                var sheets = that._sheets;\n                var getUniqueSheetName = function (sheetNameSuffix) {\n                    sheetNameSuffix = sheetNameSuffix ? sheetNameSuffix : 1;\n                    var name = 'Sheet' + sheetNameSuffix;\n                    if (!that.sheetByName(name)) {\n                        return name;\n                    }\n                    return getUniqueSheetName(sheetNameSuffix + 1);\n                };\n                if (options.name && that.sheetByName(options.name)) {\n                    return;\n                }\n                this._sheetsSearchCache = {};\n                sheetName = options.name || getUniqueSheetName();\n                var sheet = new kendo.spreadsheet.Sheet(options.rows || this.options.rows, options.columns || this.options.columns, options.rowHeight || this.options.rowHeight, options.columnWidth || this.options.columnWidth, options.headerHeight || this.options.headerHeight, options.headerWidth || this.options.headerWidth);\n                sheet._workbook = this;\n                sheet._name(sheetName);\n                sheet.bind('change', this._sheetChange.bind(this));\n                sheets.splice(insertIndex, 0, sheet);\n                if (options.data) {\n                    sheet.fromJSON(options.data);\n                }\n                if (options.dataSource) {\n                    sheet.setDataSource(options.dataSource);\n                }\n                this.trigger('change', { sheetSelection: true });\n                return sheet;\n            },\n            sheets: function () {\n                return this._sheets.slice();\n            },\n            sheetByName: function (sheetName) {\n                return this._sheets[this.sheetIndex(sheetName)];\n            },\n            sheetByIndex: function (index) {\n                return this._sheets[index];\n            },\n            sheetIndex: function (sheet) {\n                var sheets = this._sheets;\n                var sheetName = (typeof sheet == 'string' ? sheet : sheet.name()).toLowerCase();\n                var idx = this._sheetsSearchCache[sheetName];\n                if (idx >= 0) {\n                    return idx;\n                }\n                for (idx = 0; idx < sheets.length; idx++) {\n                    var name = sheets[idx].name().toLowerCase();\n                    this._sheetsSearchCache[name] = idx;\n                    if (name === sheetName) {\n                        return idx;\n                    }\n                }\n                return -1;\n            },\n            renameSheet: function (sheet, newSheetName) {\n                var oldSheetName = sheet.name();\n                if (!newSheetName || oldSheetName === newSheetName) {\n                    return;\n                }\n                sheet = this.sheetByName(oldSheetName);\n                if (!sheet) {\n                    return;\n                }\n                this._sheetsSearchCache = {};\n                this._sheets.forEach(function (sheet) {\n                    sheet._forFormulas(function (formula) {\n                        formula.renameSheet(oldSheetName, newSheetName);\n                    });\n                });\n                sheet._name(newSheetName);\n                this.trigger('change', { sheetSelection: true });\n                return sheet;\n            },\n            removeSheet: function (sheet) {\n                var that = this;\n                var sheets = that._sheets;\n                var name = sheet.name();\n                var index = that.sheetIndex(sheet);\n                if (sheets.length === 1) {\n                    return;\n                }\n                this._sheetsSearchCache = {};\n                if (index > -1) {\n                    sheet.unbind();\n                    sheets.splice(index, 1);\n                    if (that.activeSheet().name() === name) {\n                        var newSheet = sheets[index === sheets.length ? index - 1 : index];\n                        that.activeSheet(newSheet);\n                    } else {\n                        this.trigger('change', {\n                            recalc: true,\n                            sheetSelection: true\n                        });\n                    }\n                }\n            },\n            fromJSON: function (json) {\n                if (json.sheets) {\n                    for (var idx = 0; idx < json.sheets.length; idx++) {\n                        var sheet = this.sheetByIndex(idx);\n                        if (!sheet) {\n                            sheet = this.insertSheet();\n                        }\n                        sheet.fromJSON(json.sheets[idx]);\n                        var dataSource = json.sheets[idx].dataSource;\n                        if (dataSource) {\n                            sheet.setDataSource(dataSource);\n                        }\n                    }\n                }\n                if (json.activeSheet) {\n                    this.activeSheet(this.sheetByName(json.activeSheet));\n                }\n            },\n            toJSON: function () {\n                this.resetFormulas();\n                this.resetValidations();\n                return {\n                    activeSheet: this.activeSheet().name(),\n                    sheets: this._sheets.map(function (sheet) {\n                        sheet.recalc(this._context);\n                        return sheet.toJSON();\n                    }, this)\n                };\n            },\n            fromFile: function (file) {\n                var deferred = new $.Deferred();\n                var promise = deferred.promise();\n                var args = {\n                    file: file,\n                    promise: promise\n                };\n                if (file && !this.trigger('excelImport', args)) {\n                    for (var i = 0; i < this._sheets.length; i++) {\n                        this._sheets[i].unbind();\n                    }\n                    this._sheets = [];\n                    this._sheetsSearchCache = {};\n                    kendo.spreadsheet.readExcel(file, this, deferred);\n                } else {\n                    deferred.reject();\n                }\n                return promise;\n            },\n            saveAsExcel: function (options) {\n                options = $.extend({}, this.options.excel, options);\n                var data = this.toJSON();\n                if (!this.trigger('excelExport', { workbook: data })) {\n                    var workbook = new kendo.ooxml.Workbook(data);\n                    kendo.saveAs({\n                        dataURI: workbook.toDataURL(),\n                        fileName: data.fileName || options.fileName,\n                        proxyURL: options.proxyURL,\n                        forceProxy: options.forceProxy\n                    });\n                }\n            },\n            draw: function (options, callback) {\n                if (typeof options == 'function' && !callback) {\n                    callback = options;\n                    options = {};\n                }\n                var parts = [], sheets = this._sheets;\n                (function loop(i) {\n                    if (i < sheets.length) {\n                        sheets[i].draw(kendo.spreadsheet.SHEETREF, options, function (group) {\n                            parts.push(group);\n                            loop(i + 1);\n                        });\n                    } else {\n                        var group = parts[0];\n                        for (i = 1; i < parts.length; ++i) {\n                            group.children = group.children.concat(parts[i].children);\n                        }\n                        callback(group);\n                    }\n                }(0));\n            },\n            defineName: function (name, value, hidden) {\n                this._names[name] = {\n                    value: value,\n                    hidden: hidden\n                };\n            },\n            undefineName: function (name) {\n                delete this._names[name];\n            },\n            nameValue: function (name) {\n                if (name in this._names) {\n                    return this._names[name].value;\n                }\n                return null;\n            },\n            adjustNames: function (affectedSheet, forRow, start, delta) {\n                affectedSheet = affectedSheet.toLowerCase();\n                Object.keys(this._names).forEach(function (name) {\n                    var ref = this.nameValue(name);\n                    if (ref instanceof kendo.spreadsheet.Ref && ref.sheet.toLowerCase() == affectedSheet) {\n                        ref = ref.adjust(null, null, null, null, forRow, start, delta);\n                        this.defineName(name, ref);\n                    }\n                }, this);\n            },\n            options: {}\n        });\n        kendo.spreadsheet.Workbook = Workbook;\n        if (kendo.PDFMixin) {\n            kendo.PDFMixin.extend(Workbook.prototype);\n            Workbook.prototype.saveAsPDF = function (options) {\n                var progress = new $.Deferred();\n                var promise = progress.promise();\n                var args = { promise: promise };\n                if (this.trigger('pdfExport', args)) {\n                    return;\n                }\n                this._drawPDF(options, progress).then(function (root) {\n                    return kendo.drawing.exportPDF(root);\n                }).done(function (dataURI) {\n                    kendo.saveAs({\n                        dataURI: dataURI,\n                        fileName: options.fileName,\n                        proxyURL: options.proxyURL,\n                        forceProxy: options.forceProxy,\n                        proxyTarget: options.proxyTarget\n                    });\n                    progress.resolve();\n                }).fail(function (err) {\n                    progress.reject(err);\n                });\n                return promise;\n            };\n            Workbook.prototype._drawPDF = function (options) {\n                var result = new $.Deferred();\n                var callback = function (group) {\n                    result.resolve(group);\n                };\n                switch (options.area) {\n                case 'workbook':\n                    options.workbook.draw(options, callback);\n                    break;\n                case 'sheet':\n                    options.workbook.activeSheet().draw(options, callback);\n                    break;\n                case 'selection':\n                    options.workbook.activeSheet().selection().draw(options, callback);\n                    break;\n                }\n                return result.promise();\n            };\n        }\n    }(kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/formulacontext', ['kendo.core'], f);\n}(function () {\n    if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n        return;\n    }\n    var spreadsheet = kendo.spreadsheet;\n    var CellRef = spreadsheet.CellRef;\n    var RangeRef = spreadsheet.RangeRef;\n    var UnionRef = spreadsheet.UnionRef;\n    var NameRef = spreadsheet.NameRef;\n    var Ref = spreadsheet.Ref;\n    var FormulaContext = kendo.Class.extend({\n        init: function (workbook) {\n            this.workbook = workbook;\n        },\n        getRefCells: function (ref, hiddenInfo) {\n            var sheet, formula, value, i;\n            if (ref instanceof CellRef) {\n                sheet = this.workbook.sheetByName(ref.sheet);\n                if (!sheet || !ref.valid()) {\n                    return [{ value: new kendo.spreadsheet.calc.runtime.CalcError('REF') }];\n                }\n                formula = sheet.formula(ref);\n                value = sheet.range(ref.row, ref.col).value();\n                if (formula != null || value != null) {\n                    return [{\n                            formula: formula,\n                            value: value,\n                            row: ref.row,\n                            col: ref.col,\n                            sheet: ref.sheet,\n                            hidden: hiddenInfo ? sheet.columnWidth(ref.col) === 0 || sheet.rowHeight(ref.row) === 0 : false\n                        }];\n                } else {\n                    return [];\n                }\n            }\n            if (ref instanceof RangeRef) {\n                i = this.workbook.sheetIndex(ref.sheet);\n                var states = [], n = i;\n                if (ref.endSheet) {\n                    n = this.workbook.sheetIndex(ref.endSheet);\n                    if (i > n) {\n                        var tmp = i;\n                        i = n;\n                        n = tmp;\n                    }\n                }\n                if (i < 0 || n < 0 || !ref.valid()) {\n                    return [{ value: new kendo.spreadsheet.calc.runtime.CalcError('REF') }];\n                }\n                while (i <= n) {\n                    sheet = this.workbook.sheetByIndex(i++);\n                    var tl = sheet._grid.normalize(ref.topLeft);\n                    var br = sheet._grid.normalize(ref.bottomRight);\n                    var startCellIndex = sheet._grid.cellRefIndex(tl);\n                    var endCellIndex = sheet._grid.cellRefIndex(br);\n                    var values = sheet._properties.iterator('value', startCellIndex, endCellIndex);\n                    for (var col = tl.col; col <= br.col; ++col) {\n                        for (var row = tl.row; row <= br.row; ++row) {\n                            var index = sheet._grid.index(row, col);\n                            formula = sheet._properties.get('formula', index);\n                            value = values.at(index);\n                            if (formula != null || value != null) {\n                                states.push({\n                                    formula: formula,\n                                    value: value,\n                                    row: row,\n                                    col: col,\n                                    sheet: sheet.name(),\n                                    hidden: hiddenInfo ? sheet.columnWidth(col) === 0 || sheet.rowHeight(row) === 0 : false\n                                });\n                            }\n                        }\n                    }\n                }\n                return states;\n            }\n            if (ref instanceof UnionRef) {\n                var a = [];\n                for (i = 0; i < ref.refs.length; ++i) {\n                    a = a.concat(this.getRefCells(ref.refs[i], hiddenInfo));\n                }\n                return a;\n            }\n            if (ref instanceof NameRef) {\n                var val = this.workbook.nameValue(ref.name);\n                if (val instanceof Ref) {\n                    return this.getRefCells(val, hiddenInfo);\n                }\n                return [{ value: new kendo.spreadsheet.calc.runtime.CalcError('NAME') }];\n            }\n            return [];\n        },\n        getData: function (ref) {\n            var single = ref instanceof CellRef;\n            if (ref instanceof NameRef) {\n                single = this.workbook.nameValue(ref) instanceof CellRef;\n            }\n            var data = this.getRefCells(ref).map(function (cell) {\n                return cell.value;\n            });\n            return single ? data[0] : data;\n        },\n        onFormula: function (f) {\n            var sheet = this.workbook.sheetByName(f.sheet);\n            var row = f.row, col = f.col, value = f.value;\n            var currentFormula = sheet.formula({\n                row: row,\n                col: col\n            });\n            if (currentFormula !== f) {\n                return false;\n            }\n            if (value instanceof kendo.spreadsheet.calc.runtime.Matrix) {\n                value.each(function (value, r, c) {\n                    sheet._value(row + r, col + c, value);\n                });\n            } else {\n                sheet._value(row, col, value);\n            }\n            return true;\n        }\n    });\n    var ValidationFormulaContext = FormulaContext.extend({\n        onFormula: function () {\n            return true;\n        }\n    });\n    spreadsheet.FormulaContext = FormulaContext;\n    spreadsheet.ValidationFormulaContext = ValidationFormulaContext;\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/controller', ['kendo.core'], f);\n}(function () {\n    (function (kendo) {\n        'use strict';\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var $ = kendo.jQuery;\n        var alphaNumRegExp = /:alphanum$/;\n        var ACTIONS = {\n            'up': 'up',\n            'down': 'down',\n            'left': 'left',\n            'right': 'right',\n            'home': 'first-col',\n            'ctrl+left': 'first-col',\n            'end': 'last-col',\n            'ctrl+right': 'last-col',\n            'ctrl+up': 'first-row',\n            'ctrl+down': 'last-row',\n            'ctrl+home': 'first',\n            'ctrl+end': 'last',\n            'pageup': 'prev-page',\n            'pagedown': 'next-page'\n        };\n        var ENTRY_ACTIONS = {\n            'tab': 'next',\n            'shift+tab': 'previous',\n            'enter': 'lower',\n            'shift+enter': 'upper',\n            'delete': 'clearContents',\n            'backspace': 'clearContents',\n            'shift+:alphanum': 'edit',\n            ':alphanum': 'edit',\n            'ctrl+:alphanum': 'ctrl',\n            ':edit': 'edit'\n        };\n        var CONTAINER_EVENTS = {\n            'wheel': 'onWheel',\n            '*+mousedown': 'onMouseDown',\n            'contextmenu': 'onContextMenu',\n            '*+mousedrag': 'onMouseDrag',\n            '*+mouseup': 'onMouseUp',\n            '*+dblclick': 'onDblClick',\n            'mousemove': 'onMouseMove'\n        };\n        var CLIPBOARD_EVENTS = {\n            '*+pageup': 'onPageUp',\n            '*+pagedown': 'onPageDown',\n            'mouseup': 'onMouseUp',\n            '*+cut': 'onCut',\n            '*+paste': 'onPaste',\n            '*+copy': 'onCopy'\n        };\n        var EDITOR_EVENTS = {\n            'esc': 'onEditorEsc',\n            'enter': 'onEditorBlur',\n            'shift+enter': 'onEditorBlur',\n            'tab': 'onEditorBlur',\n            'shift+tab': 'onEditorBlur'\n        };\n        var FORMULABAR_EVENTS = $.extend({ focus: 'onEditorBarFocus' }, EDITOR_EVENTS);\n        var FORMULAINPUT_EVENTS = $.extend({ focus: 'onEditorCellFocus' }, EDITOR_EVENTS);\n        var SELECTION_MODES = {\n            cell: 'range',\n            rowheader: 'row',\n            columnheader: 'column',\n            topcorner: 'sheet',\n            autofill: 'autofill'\n        };\n        function toActionSelector(selectors) {\n            return selectors.map(function (action) {\n                return '[data-action=\"' + action + '\"]';\n            }).join(',');\n        }\n        var COMPOSITE_UNAVAILABLE_ACTION_SELECTORS = toActionSelector([\n            'cut',\n            'copy',\n            'paste',\n            'insert-left',\n            'insert-right',\n            'insert-above',\n            'insert-below'\n        ]);\n        var UNHIDE_ACTION_SELECTORS = toActionSelector([\n            'unhide-row',\n            'unhide-column'\n        ]);\n        var ACTION_KEYS = [];\n        var SHIFT_ACTION_KEYS = [];\n        var ENTRY_ACTION_KEYS = [];\n        for (var key in ACTIONS) {\n            ACTION_KEYS.push(key);\n            SHIFT_ACTION_KEYS.push('shift+' + key);\n        }\n        for (key in ENTRY_ACTIONS) {\n            ENTRY_ACTION_KEYS.push(key);\n        }\n        CLIPBOARD_EVENTS[ACTION_KEYS] = 'onAction';\n        CLIPBOARD_EVENTS[SHIFT_ACTION_KEYS] = 'onShiftAction';\n        CLIPBOARD_EVENTS[ENTRY_ACTION_KEYS] = 'onEntryAction';\n        FORMULAINPUT_EVENTS[ACTION_KEYS] = 'onEditorAction';\n        FORMULAINPUT_EVENTS[SHIFT_ACTION_KEYS] = 'onEditorShiftAction';\n        var Controller = kendo.Class.extend({\n            init: function (view, workbook) {\n                this.view = view;\n                this.workbook(workbook);\n                this.container = $(view.container);\n                this.clipboardElement = $(view.clipboard);\n                this.cellContextMenu = view.cellContextMenu;\n                this.rowHeaderContextMenu = view.rowHeaderContextMenu;\n                this.colHeaderContextMenu = view.colHeaderContextMenu;\n                this.scroller = view.scroller;\n                this.tabstrip = view.tabstrip;\n                this.sheetsbar = view.sheetsbar;\n                this.editor = view.editor;\n                this.editor.bind('change', this.onEditorChange.bind(this));\n                this.editor.bind('activate', this.onEditorActivate.bind(this));\n                this.editor.bind('deactivate', this.onEditorDeactivate.bind(this));\n                this.editor.bind('update', this.onEditorUpdate.bind(this));\n                $(view.scroller).on('scroll', this.onScroll.bind(this));\n                this.listener = new kendo.spreadsheet.EventListener(this.container, this, CONTAINER_EVENTS);\n                this.keyListener = new kendo.spreadsheet.EventListener(this.clipboardElement, this, CLIPBOARD_EVENTS);\n                this.barKeyListener = new kendo.spreadsheet.EventListener(this.editor.barElement(), this, FORMULABAR_EVENTS);\n                this.inputKeyListener = new kendo.spreadsheet.EventListener(this.editor.cellElement(), this, FORMULAINPUT_EVENTS);\n                if (this.sheetsbar) {\n                    this.sheetsbar.bind('select', this.onSheetBarSelect.bind(this));\n                    this.sheetsbar.bind('reorder', this.onSheetBarReorder.bind(this));\n                    this.sheetsbar.bind('rename', this.onSheetBarRename.bind(this));\n                    this.sheetsbar.bind('remove', this.onSheetBarRemove.bind(this));\n                }\n                this.cellContextMenu.bind('select', this.onContextMenuSelect.bind(this));\n                this.rowHeaderContextMenu.bind('select', this.onContextMenuSelect.bind(this));\n                this.colHeaderContextMenu.bind('select', this.onContextMenuSelect.bind(this));\n                this.cellContextMenu.element.add(this.rowHeaderContextMenu.element).add(this.colHeaderContextMenu.element).on('contextmenu', false);\n                if (this.tabstrip) {\n                    this.tabstrip.bind('action', this.onCommandRequest.bind(this));\n                    this.tabstrip.bind('dialog', this.onDialogRequest.bind(this));\n                }\n            },\n            _execute: function (options) {\n                var result = this._workbook.execute(options);\n                if (options.command === 'EditCommand' && !result) {\n                    this._workbook.trigger('change', { editorClose: true });\n                }\n                if (result) {\n                    if (result.reason === 'error') {\n                        this.view.showError(result);\n                    } else {\n                        this.view.openDialog(result.reason);\n                    }\n                }\n                return result;\n            },\n            _activeTooltip: function () {\n                return this._workbook.activeSheet().activeCell().simplify().toString();\n            },\n            onContextMenuSelect: function (e) {\n                var action = $(e.item).data('action');\n                var command;\n                switch (action) {\n                case 'cut':\n                    command = {\n                        command: 'ToolbarCutCommand',\n                        options: { workbook: this._workbook }\n                    };\n                    break;\n                case 'copy':\n                    command = {\n                        command: 'ToolbarCopyCommand',\n                        options: { workbook: this._workbook }\n                    };\n                    break;\n                case 'paste':\n                    command = {\n                        command: 'ToolbarPasteCommand',\n                        options: { workbook: this._workbook }\n                    };\n                    break;\n                case 'unmerge':\n                    command = {\n                        command: 'MergeCellCommand',\n                        options: { value: 'unmerge' }\n                    };\n                    break;\n                case 'merge':\n                    this.view.openDialog('merge');\n                    break;\n                case 'hide-row':\n                    command = {\n                        command: 'HideLineCommand',\n                        options: { axis: 'row' }\n                    };\n                    break;\n                case 'hide-column':\n                    command = {\n                        command: 'HideLineCommand',\n                        options: { axis: 'column' }\n                    };\n                    break;\n                case 'unhide-row':\n                    command = {\n                        command: 'UnHideLineCommand',\n                        options: { axis: 'row' }\n                    };\n                    break;\n                case 'unhide-column':\n                    command = {\n                        command: 'UnHideLineCommand',\n                        options: { axis: 'column' }\n                    };\n                    break;\n                case 'delete-row':\n                    command = { command: 'DeleteRowCommand' };\n                    break;\n                case 'delete-column':\n                    command = { command: 'DeleteColumnCommand' };\n                    break;\n                }\n                if (command) {\n                    this._execute(command);\n                }\n            },\n            onSheetBarRemove: function (e) {\n                var sheet = this._workbook.sheetByName(e.name);\n                if (!sheet) {\n                    return;\n                }\n                this._workbook.removeSheet(sheet);\n            },\n            destroy: function () {\n                this.listener.destroy();\n                this.keyListener.destroy();\n                this.inputKeyListener.destroy();\n            },\n            onSheetBarSelect: function (e) {\n                var sheet;\n                var workbook = this._workbook;\n                if (e.isAddButton) {\n                    sheet = workbook.insertSheet();\n                } else {\n                    sheet = workbook.sheetByName(e.name);\n                }\n                if (workbook.activeSheet().name() !== sheet.name()) {\n                    workbook.activeSheet(sheet);\n                }\n            },\n            onSheetBarReorder: function (e) {\n                var sheet = this._workbook.sheetByIndex(e.oldIndex);\n                this._workbook.moveSheetToIndex(sheet, e.newIndex);\n                this._workbook.activeSheet(sheet);\n            },\n            onSheetBarRename: function (e) {\n                var sheet = this._workbook.sheetByIndex(e.sheetIndex);\n                this._workbook.renameSheet(sheet, e.name);\n                this.clipboardElement.focus();\n            },\n            sheet: function (sheet) {\n                this.navigator = sheet.navigator();\n                this.axisManager = sheet.axisManager();\n            },\n            workbook: function (workbook) {\n                this._workbook = workbook;\n                this.clipboard = workbook.clipboard();\n            },\n            refresh: function () {\n                var editor = this.editor;\n                var workbook = this._workbook;\n                var sheet = workbook.activeSheet();\n                this._viewPortHeight = this.view.scroller.clientHeight;\n                this.navigator.height(this._viewPortHeight);\n                if (!editor.isActive()) {\n                    editor.enable(sheet.selection().enable() !== false);\n                    editor.value(workbook._inputForRef(sheet.activeCell()));\n                }\n            },\n            onScroll: function () {\n                this.view.render();\n            },\n            onWheel: function (event) {\n                var deltaX = event.originalEvent.deltaX;\n                var deltaY = event.originalEvent.deltaY;\n                if (event.originalEvent.deltaMode === 1) {\n                    deltaX *= 10;\n                    deltaY *= 10;\n                }\n                this.scrollWith(deltaX, deltaY);\n                event.preventDefault();\n            },\n            onAction: function (event, action) {\n                this.navigator.moveActiveCell(ACTIONS[action]);\n                event.preventDefault();\n            },\n            onPageUp: function () {\n                this.scrollDown(-this._viewPortHeight);\n            },\n            onPageDown: function () {\n                this.scrollDown(this._viewPortHeight);\n            },\n            onEntryAction: function (event, action) {\n                if (event.mod) {\n                    var shouldPrevent = true;\n                    var key = String.fromCharCode(event.keyCode);\n                    switch (key) {\n                    case 'A':\n                        this.navigator.selectAll();\n                        break;\n                    case 'Y':\n                        this._workbook.undoRedoStack.redo();\n                        break;\n                    case 'Z':\n                        this._workbook.undoRedoStack.undo();\n                        break;\n                    default:\n                        shouldPrevent = false;\n                        break;\n                    }\n                    if (shouldPrevent) {\n                        event.preventDefault();\n                    }\n                } else {\n                    var disabled = this._workbook.activeSheet().selection().enable() === false;\n                    if (action == 'delete' || action == 'backspace') {\n                        if (disabled) {\n                            return;\n                        }\n                        this._execute({ command: 'ClearContentCommand' });\n                        event.preventDefault();\n                    } else if (alphaNumRegExp.test(action) || action === ':edit') {\n                        if (disabled) {\n                            return;\n                        }\n                        if (action !== ':edit') {\n                            this.editor.value('');\n                        }\n                        this.editor.activate({\n                            range: this._workbook.activeSheet()._viewActiveCell(),\n                            rect: this.view.activeCellRectangle(),\n                            tooltip: this._activeTooltip()\n                        }).focus();\n                    } else {\n                        this.navigator.navigateInSelection(ENTRY_ACTIONS[action]);\n                        event.preventDefault();\n                    }\n                }\n            },\n            onShiftAction: function (event, action) {\n                this.navigator.modifySelection(ACTIONS[action.replace('shift+', '')], this.appendSelection);\n                event.preventDefault();\n            },\n            onMouseMove: function (event) {\n                var sheet = this._workbook.activeSheet();\n                if (sheet.resizingInProgress() || sheet.selectionInProgress()) {\n                    return;\n                }\n                var object = this.objectAt(event);\n                if (object.type === 'columnresizehandle' || object.type === 'rowresizehandle') {\n                    sheet.positionResizeHandle(object.ref);\n                } else {\n                    sheet.removeResizeHandle();\n                }\n            },\n            onMouseDown: function (event) {\n                var object = this.objectAt(event);\n                if (object.pane) {\n                    this.originFrame = object.pane;\n                }\n                if (this.editor.canInsertRef(false) && object.ref) {\n                    this._workbook.activeSheet()._setFormulaSelections(this.editor.highlightedRefs());\n                    this.navigator.startSelection(object.ref, this._selectionMode, this.appendSelection);\n                    event.preventDefault();\n                    return;\n                } else {\n                    this.editor.deactivate();\n                    if (this.editor.isActive()) {\n                        event.preventDefault();\n                        return;\n                    }\n                }\n                var sheet = this._workbook.activeSheet();\n                if (object.type === 'columnresizehandle' || object.type === 'rowresizehandle') {\n                    sheet.startResizing({\n                        x: object.x,\n                        y: object.y\n                    });\n                    event.preventDefault();\n                    return;\n                }\n                if (object.type === 'filtericon') {\n                    this.openFilterMenu(event);\n                    event.preventDefault();\n                    return;\n                }\n                this._selectionMode = SELECTION_MODES[object.type];\n                this.appendSelection = event.mod;\n                this.navigator.startSelection(object.ref, this._selectionMode, this.appendSelection);\n            },\n            onContextMenu: function (event) {\n                var sheet = this._workbook.activeSheet();\n                if (sheet.resizingInProgress()) {\n                    return;\n                }\n                event.preventDefault();\n                this.cellContextMenu.close();\n                this.colHeaderContextMenu.close();\n                this.rowHeaderContextMenu.close();\n                var menu;\n                var location = {\n                    pageX: event.pageX,\n                    pageY: event.pageY\n                };\n                var object = this.objectAt(location);\n                if (object.type === 'columnresizehandle' || object.type === 'rowresizehandle') {\n                    return;\n                }\n                this.navigator.selectForContextMenu(object.ref, SELECTION_MODES[object.type]);\n                var isComposite = this.navigator._sheet.select() instanceof kendo.spreadsheet.UnionRef;\n                var showUnhide = false;\n                var showUnmerge = false;\n                if (object.type == 'columnheader') {\n                    menu = this.colHeaderContextMenu;\n                    showUnhide = !isComposite && this.axisManager.selectionIncludesHiddenColumns();\n                } else if (object.type == 'rowheader') {\n                    menu = this.rowHeaderContextMenu;\n                    showUnhide = !isComposite && this.axisManager.selectionIncludesHiddenRows();\n                } else {\n                    menu = this.cellContextMenu;\n                    showUnmerge = this.navigator.selectionIncludesMergedCells();\n                }\n                menu.element.find(COMPOSITE_UNAVAILABLE_ACTION_SELECTORS).toggle(!isComposite);\n                menu.element.find(UNHIDE_ACTION_SELECTORS).toggle(showUnhide);\n                menu.element.find('[data-action=unmerge]').toggle(showUnmerge);\n                setTimeout(function () {\n                    menu.open(event.pageX, event.pageY);\n                });\n            },\n            prevent: function (event) {\n                event.preventDefault();\n            },\n            constrainResize: function (type, ref) {\n                var sheet = this._workbook.activeSheet();\n                var resizeHandle = sheet.resizeHandlePosition();\n                return !resizeHandle || type === 'outside' || type === 'topcorner' || ref.col < resizeHandle.col || ref.row < resizeHandle.row;\n            },\n            onMouseDrag: function (event) {\n                if (this._selectionMode === 'sheet') {\n                    return;\n                }\n                var location = {\n                    pageX: event.pageX,\n                    pageY: event.pageY\n                };\n                var object = this.objectAt(location);\n                var sheet = this._workbook.activeSheet();\n                if (sheet.resizingInProgress()) {\n                    if (!this.constrainResize(object.type, object.ref)) {\n                        sheet.resizeHintPosition({\n                            x: object.x,\n                            y: object.y\n                        });\n                    }\n                    return;\n                }\n                if (object.type === 'outside') {\n                    this.startAutoScroll(object);\n                    return;\n                }\n                if (this.originFrame === object.pane) {\n                    this.selectToLocation(location);\n                } else {\n                    var frame = this.originFrame._grid;\n                    if (object.x > frame.right) {\n                        this.scrollLeft();\n                    }\n                    if (object.y > frame.bottom) {\n                        this.scrollTop();\n                    }\n                    if (object.y < frame.top || object.x < frame.left) {\n                        this.startAutoScroll(object, location);\n                    } else {\n                        this.selectToLocation(location);\n                    }\n                }\n                event.preventDefault();\n            },\n            onMouseUp: function (event) {\n                var sheet = this._workbook.activeSheet();\n                sheet.completeResizing();\n                this.navigator.completeSelection();\n                this.stopAutoScroll();\n                var editor = this.editor.activeEditor();\n                if (!editor) {\n                    return;\n                }\n                var el = event.target;\n                while (el) {\n                    if (el === editor.element[0]) {\n                        return;\n                    }\n                    el = el.parentNode;\n                }\n                var object = this.objectAt(event);\n                if (object && object.ref && editor.canInsertRef(false)) {\n                    editor.refAtPoint(sheet.selection()._ref);\n                    sheet._setFormulaSelections(editor.highlightedRefs());\n                }\n            },\n            onDblClick: function (event) {\n                var object = this.objectAt(event);\n                var disabled = this._workbook.activeSheet().selection().enable() === false;\n                if (object.type !== 'cell' || disabled) {\n                    return;\n                }\n                this.editor.activate({\n                    range: this._workbook.activeSheet()._viewActiveCell(),\n                    rect: this.view.activeCellRectangle(),\n                    tooltip: this._activeTooltip()\n                }).focus();\n                this.onEditorUpdate();\n            },\n            onCut: function (e) {\n                if (e) {\n                    var table = this.clipboardElement.find('table.kendo-clipboard-' + this.clipboard._uid).detach();\n                    this.clipboardElement.append(table.clone(false));\n                    setTimeout(function () {\n                        this.clipboardElement.empty().append(table);\n                    }.bind(this));\n                }\n                this._execute({\n                    command: 'CutCommand',\n                    options: { workbook: this.view._workbook }\n                });\n            },\n            clipBoardValue: function () {\n                return this.clipboardElement.html();\n            },\n            onPaste: function (e) {\n                var html = '';\n                var plain = '';\n                this.clipboard.menuInvoked = e === undefined;\n                if (e) {\n                    if (e.originalEvent.clipboardData && e.originalEvent.clipboardData.getData) {\n                        e.preventDefault();\n                        var hasHTML = false;\n                        var hasPlainText = false;\n                        if (window.DOMStringList && e.originalEvent.clipboardData.types instanceof window.DOMStringList) {\n                            hasHTML = e.originalEvent.clipboardData.types.contains('text/html');\n                            hasPlainText = e.originalEvent.clipboardData.types.contains('text/plain');\n                        } else {\n                            hasHTML = /text\\/html/.test(e.originalEvent.clipboardData.types);\n                            hasPlainText = /text\\/plain/.test(e.originalEvent.clipboardData.types);\n                        }\n                        if (hasHTML) {\n                            html = e.originalEvent.clipboardData.getData('text/html');\n                        }\n                        if (hasPlainText) {\n                            plain = e.originalEvent.clipboardData.getData('text/plain').trim();\n                        }\n                    } else {\n                        var table = this.clipboardElement.find('table.kendo-clipboard-' + this.clipboard._uid).detach();\n                        this.clipboardElement.empty();\n                        setTimeout(function () {\n                            this.clipboard.external({\n                                html: this.clipboardElement.html(),\n                                plain: window.clipboardData.getData('Text').trim()\n                            });\n                            this.clipboardElement.empty().append(table);\n                            this._execute({\n                                command: 'PasteCommand',\n                                options: { workbook: this.view._workbook }\n                            });\n                            this.clipboard.menuInvoked = true;\n                        }.bind(this));\n                        return;\n                    }\n                } else {\n                    if (kendo.support.browser.msie) {\n                        this.clipboardElement.focus().select();\n                        document.execCommand('paste');\n                        return;\n                    } else {\n                        this.clipboard.menuInvoked = true;\n                    }\n                }\n                this.clipboard.external({\n                    html: html,\n                    plain: plain\n                });\n                this._execute({\n                    command: 'PasteCommand',\n                    options: { workbook: this.view._workbook }\n                });\n            },\n            onCopy: function (e) {\n                this.clipboard.menuInvoked = e === undefined;\n                this._execute({\n                    command: 'CopyCommand',\n                    options: { workbook: this.view._workbook }\n                });\n            },\n            scrollTop: function () {\n                this.scroller.scrollTop = 0;\n            },\n            scrollLeft: function () {\n                this.scroller.scrollLeft = 0;\n            },\n            scrollDown: function (value) {\n                this.scroller.scrollTop += value;\n            },\n            scrollRight: function (value) {\n                this.scroller.scrollLeft += value;\n            },\n            scrollWith: function (right, down) {\n                this.scroller.scrollTop += down;\n                this.scroller.scrollLeft += right;\n            },\n            objectAt: function (location) {\n                var offset = this.container.offset();\n                var coordinates = {\n                    left: location.pageX - offset.left,\n                    top: location.pageY - offset.top\n                };\n                return this.view.objectAt(coordinates.left, coordinates.top);\n            },\n            selectToLocation: function (cellLocation) {\n                var object = this.objectAt(cellLocation);\n                if (object.pane) {\n                    this.extendSelection(object);\n                    this.lastKnownCellLocation = cellLocation;\n                    this.originFrame = object.pane;\n                }\n                this.stopAutoScroll();\n            },\n            extendSelection: function (object) {\n                this.navigator.extendSelection(object.ref, this._selectionMode, this.appendSelection);\n            },\n            autoScroll: function () {\n                var x = this._autoScrollTarget.x;\n                var y = this._autoScrollTarget.y;\n                var boundaries = this.originFrame._grid;\n                var scroller = this.view.scroller;\n                var scrollStep = 8;\n                var scrollLeft = scroller.scrollLeft;\n                var scrollTop = scroller.scrollTop;\n                if (x < boundaries.left) {\n                    this.scrollRight(-scrollStep);\n                }\n                if (x > boundaries.right) {\n                    this.scrollRight(scrollStep);\n                }\n                if (y < boundaries.top) {\n                    this.scrollDown(-scrollStep);\n                }\n                if (y > boundaries.bottom) {\n                    this.scrollDown(scrollStep);\n                }\n                if (scrollTop === scroller.scrollTop && scrollLeft === scroller.scrollLeft) {\n                    this.selectToLocation(this.finalLocation);\n                } else {\n                    this.extendSelection(this.objectAt(this.lastKnownCellLocation));\n                }\n            },\n            startAutoScroll: function (viewObject, location) {\n                if (!this._scrollInterval) {\n                    this._scrollInterval = setInterval(this.autoScroll.bind(this), 50);\n                }\n                this.finalLocation = location || this.lastKnownCellLocation;\n                this._autoScrollTarget = viewObject;\n            },\n            stopAutoScroll: function () {\n                clearInterval(this._scrollInterval);\n                this._scrollInterval = null;\n            },\n            openFilterMenu: function (event) {\n                var object = this.objectAt(event);\n                var sheet = this._workbook.activeSheet();\n                var column = sheet.filterColumn(object.ref);\n                var filterMenu = this.view.createFilterMenu(column);\n                filterMenu.bind('action', this.onCommandRequest.bind(this));\n                filterMenu.bind('action', filterMenu.close.bind(filterMenu));\n                filterMenu.openFor(event.target);\n            },\n            onEditorChange: function (e) {\n                this._workbook.activeSheet().isInEditMode(false);\n                var result = this._execute({\n                    command: 'EditCommand',\n                    options: {\n                        editActiveCell: true,\n                        value: e.value\n                    }\n                });\n                if (result && result.reason === 'error') {\n                    e.preventDefault();\n                }\n            },\n            onEditorActivate: function () {\n                var workbook = this._workbook;\n                var sheet = workbook.activeSheet();\n                sheet._setFormulaSelections(this.editor.highlightedRefs());\n                sheet.isInEditMode(true);\n            },\n            onEditorDeactivate: function () {\n                var sheet = this._workbook.activeSheet();\n                sheet.isInEditMode(false);\n                sheet._setFormulaSelections([]);\n            },\n            onEditorUpdate: function () {\n                this._workbook.activeSheet()._setFormulaSelections(this.editor.highlightedRefs());\n            },\n            onEditorBarFocus: function () {\n                this.editor.activate({\n                    range: this._workbook.activeSheet()._viewActiveCell(),\n                    rect: this.view.activeCellRectangle(),\n                    tooltip: this._activeTooltip()\n                });\n            },\n            onEditorCellFocus: function () {\n                this.editor.scale();\n            },\n            onEditorEsc: function () {\n                this.editor.value(this._workbook._inputForRef(this._workbook.activeSheet()._viewActiveCell()));\n                this.editor.deactivate();\n                this.clipboardElement.focus();\n            },\n            onEditorBlur: function (_, action) {\n                if (this.editor.isFiltered()) {\n                    return;\n                }\n                this.editor.deactivate();\n                if (!this.editor.isActive()) {\n                    this.clipboardElement.focus();\n                    this.navigator.navigateInSelection(ENTRY_ACTIONS[action]);\n                }\n            },\n            onEditorAction: function (event, action) {\n                var editor = this.editor;\n                var sheet = this._workbook.activeSheet();\n                if (editor.canInsertRef(true)) {\n                    this.navigator.moveActiveCell(ACTIONS[action]);\n                    editor.activeEditor().refAtPoint(sheet.selection()._ref);\n                    sheet._setFormulaSelections(editor.highlightedRefs());\n                    event.preventDefault();\n                }\n            },\n            onEditorShiftAction: function (event, action) {\n                var editor = this.editor;\n                var sheet = this._workbook.activeSheet();\n                if (editor.canInsertRef(true)) {\n                    this.navigator.modifySelection(ACTIONS[action.replace('shift+', '')], this.appendSelection);\n                    editor.activeEditor().refAtPoint(sheet.selection()._ref);\n                    sheet._setFormulaSelections(editor.highlightedRefs());\n                    event.preventDefault();\n                }\n            },\n            onCommandRequest: function (e) {\n                if (e.command) {\n                    this._execute(e);\n                } else {\n                    this._workbook.undoRedoStack[e.action]();\n                }\n            },\n            onDialogRequest: function (e) {\n                var exportOptions = {\n                    pdfExport: this._workbook.options.pdf,\n                    excelExport: this._workbook.options.excel\n                };\n                if (e.options) {\n                    $.extend(true, e.options, exportOptions);\n                } else {\n                    e.options = exportOptions;\n                }\n                this.view.openDialog(e.name, e.options);\n            }\n        });\n        kendo.spreadsheet.Controller = Controller;\n    }(window.kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/view', [\n        'kendo.core',\n        'kendo.menu',\n        'spreadsheet/sheetsbar'\n    ], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var $ = kendo.jQuery;\n        var CellRef = kendo.spreadsheet.CellRef;\n        var DOT = '.';\n        var RESIZE_HANDLE_WIDTH = 7;\n        var viewClassNames = {\n            view: 'k-spreadsheet-view',\n            fixedContainer: 'k-spreadsheet-fixed-container',\n            scroller: 'k-spreadsheet-scroller',\n            viewSize: 'k-spreadsheet-view-size',\n            clipboard: 'k-spreadsheet-clipboard',\n            cellEditor: 'k-spreadsheet-cell-editor',\n            barEditor: 'k-spreadsheet-editor',\n            topCorner: 'k-spreadsheet-top-corner',\n            filterHeadersWrapper: 'k-filter-wrapper',\n            filterRange: 'k-filter-range',\n            filterButton: 'k-spreadsheet-filter',\n            filterButtonActive: 'k-state-active',\n            icon: 'k-icon k-font-icon',\n            iconFilterDefault: 'k-i-arrow-s',\n            sheetsBar: 'k-spreadsheet-sheets-bar',\n            sheetsBarActive: 'k-spreadsheet-sheets-bar-active',\n            sheetsBarInactive: 'k-spreadsheet-sheets-bar-inactive',\n            cellContextMenu: 'k-spreadsheet-cell-context-menu',\n            rowHeaderContextMenu: 'k-spreadsheet-row-header-context-menu',\n            colHeaderContextMenu: 'k-spreadsheet-col-header-context-menu'\n        };\n        var VIEW_MESAGES = kendo.spreadsheet.messages.view = {\n            errors: {\n                openUnsupported: 'Unsupported format. Please select an .xlsx file.',\n                shiftingNonblankCells: 'Cannot insert cells due to data loss possibility. Select another insert location or delete the data from the end of your worksheet.',\n                filterRangeContainingMerges: 'Cannot create a filter within a range containing merges',\n                sortRangeContainingMerges: 'Cannot sort a range containing merges',\n                validationError: 'The value that you entered violates the validation rules set on the cell.'\n            },\n            tabs: {\n                home: 'Home',\n                insert: 'Insert',\n                data: 'Data'\n            }\n        };\n        function selectElementContents(el) {\n            var sel = window.getSelection();\n            sel.removeAllRanges();\n            var range = document.createRange();\n            range.selectNodeContents(el);\n            sel.addRange(range);\n        }\n        function cellBefore(table, row) {\n            var cells = table.trs[row].children;\n            return cells[cells.length - 2];\n        }\n        function cellAbove(table, row) {\n            var prevRow = table.trs[row - 1];\n            var index = table.trs[row].children.length - 1;\n            if (prevRow && index >= 0) {\n                return prevRow.children[index];\n            }\n        }\n        function cellBorder(value) {\n            return [\n                'solid',\n                (value.size || 1) + 'px',\n                value.color || '#000'\n            ].join(' ');\n        }\n        function drawCell(collection, cell, cls, hBorders, vBorders, showGrid) {\n            if (!cls && !kendo.spreadsheet.draw.shouldDrawCell(cell)) {\n                return;\n            }\n            var left = cell.left;\n            var top = cell.top;\n            var width = cell.width + 1;\n            var height = cell.height + 1;\n            var style = {};\n            var background = cell.background;\n            var defaultBorder = null;\n            if (background) {\n                defaultBorder = background;\n                if (showGrid) {\n                    defaultBorder = kendo.parseColor(defaultBorder).toHSV();\n                    defaultBorder.v *= 0.9;\n                    defaultBorder = defaultBorder.toCssRgba();\n                }\n                defaultBorder = cellBorder({ color: defaultBorder });\n            }\n            if (background) {\n                style.backgroundColor = background;\n            }\n            if (cell.color) {\n                style.color = cell.color;\n            }\n            if (cell.fontFamily) {\n                style.fontFamily = cell.fontFamily;\n            }\n            if (cell.underline) {\n                style.textDecoration = 'underline';\n            }\n            if (cell.italic) {\n                style.fontStyle = 'italic';\n            }\n            if (cell.textAlign) {\n                style.textAlign = cell.textAlign;\n            }\n            if (cell.bold) {\n                style.fontWeight = 'bold';\n            }\n            if (cell.fontSize) {\n                style.fontSize = cell.fontSize + 'px';\n            }\n            if (cell.wrap === true) {\n                style.whiteSpace = 'pre-wrap';\n                style.wordBreak = 'break-all';\n            }\n            if (cell.borderLeft) {\n                style.borderLeft = cellBorder(cell.borderLeft);\n                if (vBorders) {\n                    vBorders[cell.left] = true;\n                }\n            } else if (defaultBorder && vBorders && !vBorders[cell.left]) {\n                style.borderLeft = defaultBorder;\n            } else {\n                left++;\n                width--;\n            }\n            if (cell.borderTop) {\n                style.borderTop = cellBorder(cell.borderTop);\n                if (hBorders) {\n                    hBorders[cell.top] = true;\n                }\n            } else if (defaultBorder && hBorders && !hBorders[cell.top]) {\n                style.borderTop = defaultBorder;\n            } else {\n                top++;\n                height--;\n            }\n            if (cell.borderRight) {\n                style.borderRight = cellBorder(cell.borderRight);\n                if (vBorders) {\n                    vBorders[cell.right] = true;\n                }\n            } else if (defaultBorder && vBorders && !vBorders[cell.right]) {\n                style.borderRight = defaultBorder;\n            } else {\n                width--;\n            }\n            if (cell.borderBottom) {\n                style.borderBottom = cellBorder(cell.borderBottom);\n                if (hBorders) {\n                    hBorders[cell.bottom] = true;\n                }\n            } else if (defaultBorder && hBorders && !hBorders[cell.bottom]) {\n                style.borderBottom = defaultBorder;\n            } else {\n                height--;\n            }\n            style.left = left + 'px';\n            style.top = top + 'px';\n            style.width = width + 'px';\n            style.height = height + 'px';\n            var data = cell.value, type = typeof data;\n            if (cell.format && data !== null) {\n                data = kendo.spreadsheet.formatting.format(data, cell.format);\n                if (data.__dataType) {\n                    type = data.__dataType;\n                }\n            } else if (data !== null && data !== undefined) {\n                data = kendo.dom.text(data);\n            }\n            if (!style.textAlign) {\n                switch (type) {\n                case 'number':\n                case 'date':\n                case 'percent':\n                    style.textAlign = 'right';\n                    break;\n                case 'boolean':\n                    style.textAlign = 'center';\n                    break;\n                }\n            }\n            var classNames = [paneClassNames.cell];\n            if (cls) {\n                classNames.push(cls);\n            }\n            if (cell.enable === false) {\n                classNames.push('k-state-disabled');\n            }\n            if (cell.merged) {\n                classNames.push('k-spreadsheet-merged-cell');\n            }\n            var verticalAlign = cell.verticalAlign || 'bottom';\n            if (verticalAlign && data) {\n                data = kendo.dom.element('div', { className: 'k-vertical-align-' + verticalAlign }, [data]);\n            }\n            var children = data ? [data] : [];\n            var properties = { style: style };\n            var validation = cell.validation;\n            if (validation && !validation.value) {\n                children.push(kendo.dom.element('span', { className: 'k-dirty' }));\n                classNames.push('k-dirty-cell');\n                properties.title = validation._getOptions().messageTemplate;\n            }\n            properties.className = classNames.join(' ');\n            var div = kendo.dom.element('div', properties, children);\n            collection.push(div);\n            return div;\n        }\n        function addCell(table, row, cell) {\n            var style = {};\n            if (cell.background) {\n                style.backgroundColor = cell.background;\n            }\n            if (cell.color) {\n                style.color = cell.color;\n            }\n            if (cell.fontFamily) {\n                style.fontFamily = cell.fontFamily;\n            }\n            if (cell.underline) {\n                style.textDecoration = 'underline';\n            }\n            if (cell.italic) {\n                style.fontStyle = 'italic';\n            }\n            if (cell.textAlign) {\n                style.textAlign = cell.textAlign;\n            }\n            if (cell.verticalAlign) {\n                style.verticalAlign = cell.verticalAlign === 'center' ? 'middle' : cell.verticalAlign;\n            }\n            if (cell.bold) {\n                style.fontWeight = 'bold';\n            }\n            if (cell.fontSize) {\n                style.fontSize = cell.fontSize + 'px';\n            }\n            if (cell.wrap === true) {\n                style.whiteSpace = 'pre-wrap';\n                style.wordBreak = 'break-all';\n            }\n            if (cell.borderRight) {\n                style.borderRight = cellBorder(cell.borderRight);\n            } else if (cell.background) {\n                style.borderRightColor = cell.background;\n            }\n            if (cell.borderBottom) {\n                style.borderBottom = cellBorder(cell.borderBottom);\n            } else if (cell.background) {\n                style.borderBottomColor = cell.background;\n            }\n            var data = cell.value, type = typeof data;\n            if (cell.format && data !== null) {\n                data = kendo.spreadsheet.formatting.format(data, cell.format);\n                if (data.__dataType) {\n                    type = data.__dataType;\n                }\n            }\n            if (!style.textAlign) {\n                switch (type) {\n                case 'number':\n                case 'date':\n                case 'percent':\n                    style.textAlign = 'right';\n                    break;\n                case 'boolean':\n                    style.textAlign = 'center';\n                    break;\n                }\n            }\n            var className = null;\n            if (cell.enable === false) {\n                className = 'k-state-disabled';\n            }\n            var td = table.addCell(row, data, style, className, cell.validation);\n            var border, sibling;\n            if (cell.borderLeft) {\n                sibling = cellBefore(table, row);\n                border = cellBorder(cell.borderLeft);\n                if (sibling && border) {\n                    sibling.attr.style.borderRight = border;\n                }\n            } else if (cell.background) {\n                style.borderLeftColor = cell.background;\n            }\n            if (cell.borderTop) {\n                sibling = cellAbove(table, row);\n                border = cellBorder(cell.borderTop);\n                if (sibling && border) {\n                    sibling.attr.style.borderBottom = border;\n                }\n            } else if (cell.background) {\n                style.borderTopColor = cell.background;\n            }\n            return td;\n        }\n        var HtmlTable = kendo.Class.extend({\n            init: function () {\n                this.cols = [];\n                this.trs = [];\n                this._height = 0;\n                this._width = 0;\n            },\n            addColumn: function (width) {\n                this._width += width;\n                var col = kendo.dom.element('col', { style: { width: width + 'px' } });\n                col.visible = width > 0;\n                this.cols.push(col);\n            },\n            addRow: function (height) {\n                var attr = null;\n                attr = { style: { height: height + 'px' } };\n                this._height += height;\n                var tr = kendo.dom.element('tr', attr);\n                tr.visible = height > 0;\n                this.trs.push(tr);\n            },\n            addCell: function (rowIndex, text, style, className, validation) {\n                if (text === null || text === undefined) {\n                    text = '';\n                }\n                if (!(text instanceof kendo.dom.Node)) {\n                    text = kendo.dom.text(text);\n                }\n                var children = [text];\n                var properties = { style: style };\n                if (validation && !validation.value) {\n                    children.push(kendo.dom.element('span', { className: 'k-dirty' }));\n                    className = (className || '') + (className ? ' ' : '') + 'k-dirty-cell';\n                    properties.title = validation._getOptions().messageTemplate;\n                }\n                if (className) {\n                    properties.className = className;\n                }\n                var td = kendo.dom.element('td', properties, children);\n                this.trs[rowIndex].children.push(td);\n                return td;\n            },\n            toDomTree: function (x, y, className) {\n                this.trs = this.trs.filter(function (tr) {\n                    return tr.visible;\n                });\n                var offset = 0;\n                this.cols = this.cols.filter(function (col, ci) {\n                    if (!col.visible) {\n                        this.trs.forEach(function (tr) {\n                            tr.children.splice(ci - offset, 1);\n                        });\n                        offset++;\n                    }\n                    return col.visible;\n                }, this);\n                return kendo.dom.element('table', {\n                    style: {\n                        left: x + 'px',\n                        top: y + 'px',\n                        height: this._height + 'px',\n                        width: this._width + 'px'\n                    },\n                    className: className\n                }, [\n                    kendo.dom.element('colgroup', null, this.cols),\n                    kendo.dom.element('tbody', null, this.trs)\n                ]);\n            }\n        });\n        var CELL_CONTEXT_MENU = '<ul class=\"#=classNames.cellContextMenu#\">' + '<li data-action=cut>Cut</li>' + '<li data-action=copy>Copy</li>' + '<li data-action=paste>Paste</li>' + '<li class=\"k-separator\"></li>' + '<li data-action=merge>Merge</li>' + '<li data-action=unmerge>Unmerge</li>' + '</ul>';\n        var ROW_HEADER_CONTEXT_MENU = '<ul class=\"#=classNames.rowHeaderContextMenu#\">' + '<li data-action=cut>Cut</li>' + '<li data-action=copy>Copy</li>' + '<li data-action=paste>Paste</li>' + '<li class=\"k-separator\"></li>' + '<li data-action=\"delete-row\">Delete</li>' + '<li data-action=\"hide-row\">Hide</li>' + '<li data-action=\"unhide-row\">Unhide</li>' + '</ul>';\n        var COL_HEADER_CONTEXT_MENU = '<ul class=\"#=classNames.colHeaderContextMenu#\">' + '<li data-action=cut>Cut</li>' + '<li data-action=copy>Copy</li>' + '<li data-action=paste>Paste</li>' + '<li class=\"k-separator\"></li>' + '<li data-action=\"delete-column\">Delete</li>' + '<li data-action=\"hide-column\">Hide</li>' + '<li data-action=\"unhide-column\">Unhide</li>' + '</ul>';\n        kendo.spreadsheet.ContextMenu = kendo.ui.ContextMenu;\n        var VIEW_CONTENTS = kendo.template('<div class=\"#=classNames.view#\"><div class=\"#=classNames.fixedContainer#\"></div><div class=\"#=classNames.scroller#\"><div class=\"#=classNames.viewSize#\"></div></div>' + '<div tabindex=\"0\" class=\"#=classNames.clipboard#\" contenteditable=true></div><div class=\"#=classNames.cellEditor#\"></div></div><div class=\"#=classNames.sheetsBar#\"></div>' + CELL_CONTEXT_MENU + ROW_HEADER_CONTEXT_MENU + COL_HEADER_CONTEXT_MENU);\n        function within(value, min, max) {\n            return value >= min && value <= max;\n        }\n        var View = kendo.Class.extend({\n            init: function (element, options) {\n                var classNames = View.classNames;\n                this.element = element;\n                this.options = $.extend(true, {}, this.options, options);\n                this._chrome();\n                this._dialogs = [];\n                element.append(VIEW_CONTENTS({ classNames: classNames }));\n                this._formulaInput();\n                this.wrapper = element.find(DOT + classNames.view);\n                this.container = element.find(DOT + classNames.fixedContainer)[0];\n                this.scroller = element.find(DOT + classNames.scroller)[0];\n                this.clipboard = element.find(DOT + classNames.clipboard);\n                this.viewSize = $(this.scroller.firstChild);\n                this.tree = new kendo.dom.Tree(this.container);\n                this.clipboardContents = new kendo.dom.Tree(this.clipboard[0]);\n                this.editor = new kendo.spreadsheet.SheetEditor(this);\n                this._sheetsbar();\n                var contextMenuConfig = {\n                    target: element,\n                    animation: false,\n                    showOn: 'never'\n                };\n                this.cellContextMenu = new kendo.spreadsheet.ContextMenu(element.find(DOT + classNames.cellContextMenu), contextMenuConfig);\n                this.colHeaderContextMenu = new kendo.spreadsheet.ContextMenu(element.find(DOT + classNames.colHeaderContextMenu), contextMenuConfig);\n                this.rowHeaderContextMenu = new kendo.spreadsheet.ContextMenu(element.find(DOT + classNames.rowHeaderContextMenu), contextMenuConfig);\n                var scrollbar = kendo.support.scrollbar();\n                $(this.container).css({\n                    width: this.wrapper[0].clientWidth - scrollbar,\n                    height: this.wrapper[0].clientHeight - scrollbar\n                });\n            },\n            _resize: function () {\n                var tabstripHeight = this.tabstrip ? this.tabstrip.element.outerHeight() : 0;\n                var formulaBarHeight = this.formulaBar ? this.formulaBar.element.outerHeight() : 0;\n                var sheetsBarHeight = this.sheetsbar ? this.sheetsbar.element.outerHeight() : 0;\n                this.wrapper.height(this.element.height() - (tabstripHeight + formulaBarHeight + sheetsBarHeight));\n                if (this.tabstrip) {\n                    this.tabstrip.quickAccessAdjust();\n                }\n            },\n            _chrome: function () {\n                var formulaBar = $('<div />').prependTo(this.element);\n                this.formulaBar = new kendo.spreadsheet.FormulaBar(formulaBar);\n                if (this.options.toolbar) {\n                    this._tabstrip();\n                }\n            },\n            _formulaInput: function () {\n                var editor = this.element.find(DOT + View.classNames.cellEditor);\n                this.formulaInput = new kendo.spreadsheet.FormulaInput(editor, { autoScale: true });\n            },\n            _sheetsbar: function () {\n                if (this.options.sheetsbar) {\n                    this.sheetsbar = new kendo.spreadsheet.SheetsBar(this.element.find(DOT + View.classNames.sheetsBar), $.extend(true, {}, this.options.sheetsbar));\n                }\n            },\n            _tabstrip: function () {\n                var messages = VIEW_MESAGES.tabs;\n                var options = $.extend(true, {\n                    home: true,\n                    insert: true,\n                    data: true\n                }, this.options.toolbar);\n                var tabs = [];\n                if (this.tabstrip) {\n                    this.tabstrip.destroy();\n                    this.element.children('.k-tabstrip').remove();\n                }\n                for (var name in options) {\n                    if (options[name] === true || options[name] instanceof Array) {\n                        tabs.push({\n                            id: name,\n                            text: messages[name],\n                            content: ''\n                        });\n                    }\n                }\n                this.tabstrip = new kendo.spreadsheet.TabStrip($('<div />').prependTo(this.element), {\n                    animation: false,\n                    dataTextField: 'text',\n                    dataContentField: 'content',\n                    dataSource: tabs,\n                    toolbarOptions: options,\n                    view: this\n                });\n                this.tabstrip.select(0);\n            },\n            _executeCommand: function (e) {\n                this._workbook.execute(e);\n            },\n            workbook: function (workbook) {\n                this._workbook = workbook;\n            },\n            sheet: function (sheet) {\n                this._sheet = sheet;\n            },\n            activeCellRectangle: function () {\n                return this.cellRectangle(this._sheet._viewActiveCell());\n            },\n            _rectangle: function (pane, ref) {\n                return pane._grid.boundingRectangle(ref.toRangeRef());\n            },\n            isColumnResizer: function (x, pane, ref) {\n                var rectangle = this._rectangle(pane, ref);\n                x -= this._sheet._grid._headerWidth;\n                var handleWidth = RESIZE_HANDLE_WIDTH / 2;\n                var right = rectangle.right - this.scroller.scrollLeft;\n                return right - handleWidth <= x && x <= right + handleWidth;\n            },\n            isRowResizer: function (y, pane, ref) {\n                var rectangle = this._rectangle(pane, ref);\n                y -= this._sheet._grid._headerHeight;\n                var handleWidth = RESIZE_HANDLE_WIDTH / 2;\n                var bottom = rectangle.bottom - this.scroller.scrollTop;\n                return bottom - handleWidth <= y && y <= bottom + handleWidth;\n            },\n            isFilterIcon: function (x, y, pane, ref) {\n                var result = false;\n                x -= this._sheet._grid._headerWidth - this.scroller.scrollLeft;\n                y -= this._sheet._grid._headerHeight - this.scroller.scrollTop;\n                this._sheet.forEachFilterHeader(ref, function (ref) {\n                    var rect = this._rectangle(pane, ref);\n                    result = result || pane.filterIconRect(rect).intersects(x, y);\n                }.bind(this));\n                return result;\n            },\n            isAutoFill: function (x, y, pane) {\n                var selection = this._sheet.select();\n                if (selection.size > 1) {\n                    return false;\n                }\n                x -= this._sheet._grid._headerWidth;\n                y -= this._sheet._grid._headerHeight;\n                if (!pane._grid.columns.frozen) {\n                    x += this.scroller.scrollLeft;\n                }\n                if (!pane._grid.rows.frozen) {\n                    y += this.scroller.scrollTop;\n                }\n                var rectangle = this._rectangle(pane, selection);\n                return Math.abs(rectangle.right - x) < 8 && Math.abs(rectangle.bottom - y) < 8;\n            },\n            objectAt: function (x, y) {\n                var grid = this._sheet._grid;\n                var object, pane;\n                if (x < 0 || y < 0 || x > this.scroller.clientWidth || y > this.scroller.clientHeight) {\n                    object = { type: 'outside' };\n                } else if (x < grid._headerWidth && y < grid._headerHeight) {\n                    object = { type: 'topcorner' };\n                } else {\n                    pane = this.paneAt(x, y);\n                    var row = pane._grid.rows.index(y, this.scroller.scrollTop);\n                    var column = pane._grid.columns.index(x, this.scroller.scrollLeft);\n                    var type = 'cell';\n                    var ref = new CellRef(row, column);\n                    if (this.isAutoFill(x, y, pane)) {\n                        type = 'autofill';\n                    } else if (this.isFilterIcon(x, y, pane, ref)) {\n                        type = 'filtericon';\n                    } else if (x < grid._headerWidth) {\n                        ref = new CellRef(row, -Infinity);\n                        type = this.isRowResizer(y, pane, ref) ? 'rowresizehandle' : 'rowheader';\n                    } else if (y < grid._headerHeight) {\n                        ref = new CellRef(-Infinity, column);\n                        type = this.isColumnResizer(x, pane, ref) ? 'columnresizehandle' : 'columnheader';\n                    }\n                    object = {\n                        type: type,\n                        ref: ref\n                    };\n                }\n                object.pane = pane;\n                object.x = x;\n                object.y = y;\n                return object;\n            },\n            paneAt: function (x, y) {\n                return this.panes.filter(function paneLocationWithin(pane) {\n                    var grid = pane._grid;\n                    return within(y, grid.top, grid.bottom) && within(x, grid.left, grid.right);\n                })[0];\n            },\n            containingPane: function (cell) {\n                return this.panes.filter(function (pane) {\n                    if (pane._grid.contains(cell)) {\n                        return true;\n                    }\n                    return false;\n                })[0];\n            },\n            cellRectangle: function (cell) {\n                var theGrid = this.containingPane(cell)._grid;\n                var rectangle = this._sheet._grid.rectangle(cell);\n                return rectangle.offset(theGrid.headerWidth - this.scroller.scrollLeft, theGrid.headerHeight - this.scroller.scrollTop);\n            },\n            refresh: function (reason) {\n                var sheet = this._sheet;\n                if (this.tabstrip) {\n                    this.tabstrip.refreshTools(sheet.range(sheet.activeCell()));\n                }\n                if (reason.sheetSelection && this.sheetsbar) {\n                    this.sheetsbar.renderSheets(this._workbook.sheets(), this._workbook.sheetIndex(this._sheet));\n                }\n                this._resize();\n                this.viewSize[0].style.height = sheet._grid.totalHeight() + 'px';\n                this.viewSize[0].style.width = sheet._grid.totalWidth() + 'px';\n                if (reason.layout) {\n                    var frozenColumns = sheet.frozenColumns();\n                    var frozenRows = sheet.frozenRows();\n                    this.panes = [this._pane(frozenRows, frozenColumns)];\n                    if (frozenColumns > 0) {\n                        this.panes.push(this._pane(frozenRows, 0, null, frozenColumns));\n                    }\n                    if (frozenRows > 0) {\n                        this.panes.push(this._pane(0, frozenColumns, frozenRows, null));\n                    }\n                    if (frozenRows > 0 && frozenColumns > 0) {\n                        this.panes.push(this._pane(0, 0, frozenRows, frozenColumns));\n                    }\n                }\n                if (reason.filter) {\n                    this._destroyFilterMenu();\n                }\n                if (reason.activeCell) {\n                    this._focus = sheet.activeCell().toRangeRef();\n                }\n            },\n            createFilterMenu: function (column) {\n                if (this._filterMenu && this._filterMenu.options.column == column) {\n                    return this._filterMenu;\n                }\n                this._destroyFilterMenu();\n                var sheet = this._sheet;\n                var ref = sheet.filter().ref;\n                var range = new kendo.spreadsheet.Range(ref, sheet);\n                var element = $('<div />').appendTo(this.element);\n                var options = {\n                    column: column,\n                    range: range\n                };\n                var filterMenu = new kendo.spreadsheet.FilterMenu(element, options);\n                this._filterMenu = filterMenu;\n                return filterMenu;\n            },\n            selectClipBoardContents: function () {\n                this.clipboard.focus();\n                selectElementContents(this.clipboard[0]);\n            },\n            scrollIntoView: function (cell) {\n                var willScroll = false;\n                var theGrid = this.containingPane(cell)._grid;\n                var boundaries = theGrid.scrollBoundaries(cell);\n                var scroller = this.scroller;\n                var scrollTop = theGrid.rows.frozen ? 0 : scroller.scrollTop;\n                var scrollLeft = theGrid.columns.frozen ? 0 : scroller.scrollLeft;\n                if (boundaries.top < scrollTop) {\n                    willScroll = true;\n                    scroller.scrollTop = boundaries.scrollTop;\n                }\n                if (boundaries.bottom > scrollTop) {\n                    willScroll = true;\n                    scroller.scrollTop = boundaries.scrollBottom;\n                }\n                if (boundaries.left < scrollLeft) {\n                    willScroll = true;\n                    scroller.scrollLeft = boundaries.scrollLeft;\n                }\n                if (boundaries.right > scrollLeft) {\n                    willScroll = true;\n                    scroller.scrollLeft = boundaries.scrollRight;\n                }\n                return willScroll;\n            },\n            _destroyDialog: function () {\n                this._dialogs.pop();\n            },\n            openDialog: function (name, options) {\n                var sheet = this._sheet;\n                var ref = sheet.activeCell();\n                var range = new kendo.spreadsheet.Range(ref, sheet);\n                var dialog = kendo.spreadsheet.dialogs.create(name, options);\n                if (dialog) {\n                    dialog.bind('action', this._executeCommand.bind(this));\n                    dialog.bind('deactivate', this._destroyDialog.bind(this));\n                    this._dialogs.push(dialog);\n                    dialog.open(range);\n                    return dialog;\n                }\n            },\n            showError: function (options) {\n                var errorMessages = VIEW_MESAGES.errors;\n                this.openDialog('message', {\n                    title: options.title || 'Error',\n                    text: options.body ? options.body : errorMessages[options.type],\n                    activate: function () {\n                        this.dialog().element.find('.k-button').focus();\n                    },\n                    close: function () {\n                        this.editor.focusLastActive();\n                    }.bind(this)\n                });\n            },\n            destroy: function () {\n                this._dialogs.forEach(function (dialog) {\n                    dialog.destroy();\n                });\n                this.cellContextMenu.destroy();\n                this.rowHeaderContextMenu.destroy();\n                this.colHeaderContextMenu.destroy();\n                if (this.tabstrip) {\n                    this.tabstrip.destroy();\n                }\n                this._destroyFilterMenu();\n            },\n            _destroyFilterMenu: function () {\n                if (this._filterMenu) {\n                    this._filterMenu.destroy();\n                    this._filterMenu = undefined;\n                    this._filterMenuColumn = undefined;\n                }\n            },\n            render: function () {\n                if (!this.element.is(':visible')) {\n                    return;\n                }\n                var sheet = this._sheet;\n                var focus = sheet.focus();\n                if (focus && this.scrollIntoView(focus)) {\n                    return;\n                }\n                var grid = sheet._grid;\n                var scrollTop = this.scroller.scrollTop;\n                var scrollLeft = this.scroller.scrollLeft;\n                if (scrollTop < 0) {\n                    scrollTop = 0;\n                }\n                if (scrollLeft < 0) {\n                    scrollLeft = 0;\n                }\n                var result = this.panes.map(function (pane) {\n                    return pane.render(scrollLeft, scrollTop);\n                }, this);\n                var merged = [];\n                merged = Array.prototype.concat.apply(merged, result);\n                var topCorner = kendo.dom.element('div', {\n                    style: {\n                        width: grid._headerWidth + 'px',\n                        height: grid._headerHeight + 'px'\n                    },\n                    className: View.classNames.topCorner\n                });\n                merged.push(topCorner);\n                if (sheet.resizeHandlePosition() && sheet.resizeHintPosition()) {\n                    merged.push(this.renderResizeHint());\n                }\n                this.tree.render(merged);\n                if (this.editor.isActive()) {\n                    this.editor.toggleTooltip(this.activeCellRectangle());\n                } else if (!sheet.selectionInProgress() && !sheet.resizingInProgress() && !sheet.isInEditMode()) {\n                    this.renderClipboardContents();\n                }\n            },\n            renderResizeHint: function () {\n                var sheet = this._sheet;\n                var ref = sheet.resizeHandlePosition();\n                var horizontal = ref.col !== -Infinity;\n                var style;\n                if (horizontal) {\n                    style = {\n                        height: this.scroller.clientHeight + 'px',\n                        width: RESIZE_HANDLE_WIDTH + 'px',\n                        left: sheet.resizeHintPosition().x + 'px',\n                        top: '0px'\n                    };\n                } else {\n                    style = {\n                        height: RESIZE_HANDLE_WIDTH + 'px',\n                        width: this.scroller.clientWidth + 'px',\n                        top: sheet.resizeHintPosition().y + 'px',\n                        left: '0px'\n                    };\n                }\n                var classNames = Pane.classNames;\n                return kendo.dom.element('div', {\n                    className: classNames.resizeHint + (!horizontal ? ' ' + classNames.resizeHintVertical : ''),\n                    style: style\n                }, [\n                    kendo.dom.element('div', { className: classNames.resizeHintHandle }),\n                    kendo.dom.element('div', { className: classNames.resizeHintMarker })\n                ]);\n            },\n            renderClipboardContents: function () {\n                var sheet = this._sheet;\n                var grid = sheet._grid;\n                var selection = sheet.select().toRangeRef();\n                var status = this._workbook.clipboard().canCopy();\n                if (status.canCopy === false && status.multiSelection) {\n                    this.clipboardContents.render([]);\n                    this.selectClipBoardContents();\n                    return;\n                }\n                selection = sheet.trim(selection);\n                var table = new HtmlTable();\n                var selectionView = grid.rangeDimensions(selection);\n                selectionView.rows.forEach(function (height) {\n                    table.addRow(height);\n                });\n                selectionView.columns.forEach(function (width) {\n                    table.addColumn(width);\n                });\n                var primaryMergedCells = {};\n                var secondaryMergedCells = {};\n                sheet.forEachMergedCell(selection, function (ref) {\n                    var topLeft = ref.topLeft;\n                    grid.forEach(ref, function (cellRef) {\n                        if (topLeft.eq(cellRef)) {\n                            primaryMergedCells[cellRef.print()] = ref;\n                        } else {\n                            secondaryMergedCells[cellRef.print()] = true;\n                        }\n                    });\n                });\n                sheet.forEach(selection, function (row, col, cell) {\n                    var location = new CellRef(row, col).print();\n                    if (!secondaryMergedCells[location]) {\n                        var td = addCell(table, row - selection.topLeft.row, cell);\n                        var mergedCell = primaryMergedCells[location];\n                        if (mergedCell) {\n                            td.attr.colspan = mergedCell.width();\n                            td.attr.rowspan = mergedCell.height();\n                        }\n                    }\n                });\n                this.clipboardContents.render([table.toDomTree(0, 0, 'kendo-clipboard-' + this._workbook.clipboard()._uid)]);\n                this.selectClipBoardContents();\n            },\n            _pane: function (row, column, rowCount, columnCount) {\n                var pane = new Pane(this._sheet, this._sheet._grid.pane({\n                    row: row,\n                    column: column,\n                    rowCount: rowCount,\n                    columnCount: columnCount\n                }));\n                pane.refresh(this.scroller.clientWidth, this.scroller.clientHeight);\n                return pane;\n            }\n        });\n        var paneClassNames = {\n            cell: 'k-spreadsheet-cell',\n            vaxis: 'k-spreadsheet-vaxis',\n            haxis: 'k-spreadsheet-haxis',\n            rowHeader: 'k-spreadsheet-row-header',\n            columnHeader: 'k-spreadsheet-column-header',\n            pane: 'k-spreadsheet-pane',\n            data: 'k-spreadsheet-data',\n            mergedCell: 'k-spreadsheet-merged-cell',\n            mergedCellsWrapper: 'k-merged-cells-wrapper',\n            activeCell: 'k-spreadsheet-active-cell',\n            selection: 'k-spreadsheet-selection',\n            selectionWrapper: 'k-selection-wrapper',\n            autoFillWrapper: 'k-auto-fill-wrapper',\n            single: 'k-single',\n            top: 'k-top',\n            right: 'k-right',\n            bottom: 'k-bottom',\n            left: 'k-left',\n            resizeHandle: 'k-resize-handle',\n            resizeHint: 'k-resize-hint',\n            resizeHintHandle: 'k-resize-hint-handle',\n            resizeHintMarker: 'k-resize-hint-marker',\n            resizeHintVertical: 'k-resize-hint-vertical',\n            selectionHighlight: 'k-spreadsheet-selection-highlight',\n            series: [\n                'k-series-a',\n                'k-series-b',\n                'k-series-c',\n                'k-series-d',\n                'k-series-e',\n                'k-series-f'\n            ]\n        };\n        var Pane = kendo.Class.extend({\n            init: function (sheet, grid) {\n                this._sheet = sheet;\n                this._grid = grid;\n            },\n            refresh: function (width, height) {\n                this._grid.refresh(width, height);\n            },\n            isVisible: function (scrollLeft, scrollTop, ref) {\n                return this._grid.view(scrollLeft, scrollTop).ref.intersects(ref);\n            },\n            render: function (scrollLeft, scrollTop) {\n                var classNames = Pane.classNames;\n                var sheet = this._sheet;\n                var grid = this._grid;\n                var view = grid.view(scrollLeft, scrollTop);\n                this._currentView = view;\n                this._currentRect = this._rectangle(view.ref);\n                this._selectedHeaders = sheet.selectedHeaders();\n                var children = [];\n                children.push(this.renderData());\n                children.push(this.renderSelection());\n                children.push(this.renderAutoFill());\n                children.push(this.renderEditorSelection());\n                children.push(this.renderFilterHeaders());\n                if (grid.hasRowHeader) {\n                    var rowHeader = kendo.dom.element('div', {\n                        className: classNames.rowHeader,\n                        style: {\n                            width: grid.headerWidth + 'px',\n                            top: view.rowOffset + 'px'\n                        }\n                    });\n                    children.push(rowHeader);\n                    sheet.forEach(view.ref.leftColumn(), function (row) {\n                        if (!sheet.isHiddenRow(row)) {\n                            var text = row + 1, height = sheet.rowHeight(row);\n                            rowHeader.children.push(kendo.dom.element('div', {\n                                className: this.headerClassName(row, 'row'),\n                                style: {\n                                    width: grid.headerWidth + 'px',\n                                    height: height + 'px'\n                                }\n                            }, [kendo.dom.element('div', { className: 'k-vertical-align-center' }, [kendo.dom.text(text + '')])]));\n                        }\n                    }.bind(this));\n                }\n                if (grid.hasColumnHeader) {\n                    var columnHeader = kendo.dom.element('div', {\n                        className: classNames.columnHeader,\n                        style: {\n                            top: '0px',\n                            left: view.columnOffset + 'px',\n                            width: this._currentRect.width + 'px',\n                            height: grid.headerHeight + 'px'\n                        }\n                    });\n                    children.push(columnHeader);\n                    var left = 0;\n                    sheet.forEach(view.ref.topRow(), function (row, col) {\n                        if (!sheet.isHiddenColumn(col)) {\n                            var text = kendo.spreadsheet.Ref.display(null, Infinity, col), width = sheet.columnWidth(col);\n                            columnHeader.children.push(kendo.dom.element('div', {\n                                className: this.headerClassName(col, 'col'),\n                                style: {\n                                    position: 'absolute',\n                                    left: left + 'px',\n                                    width: width + 'px',\n                                    height: grid.headerHeight + 'px'\n                                }\n                            }, [kendo.dom.element('div', { className: 'k-vertical-align-center' }, [kendo.dom.text(text + '')])]));\n                            left += width;\n                        }\n                    }.bind(this));\n                }\n                if (sheet.resizeHandlePosition() && (grid.hasColumnHeader || grid.hasRowHeader)) {\n                    var ref = sheet._grid.normalize(sheet.resizeHandlePosition());\n                    if (view.ref.intersects(ref)) {\n                        if (!sheet.resizeHintPosition()) {\n                            children.push(this.renderResizeHandler());\n                        }\n                    }\n                }\n                var paneClasses = [classNames.pane];\n                if (grid.hasColumnHeader) {\n                    paneClasses.push(classNames.top);\n                }\n                if (grid.hasRowHeader) {\n                    paneClasses.push(classNames.left);\n                }\n                return kendo.dom.element('div', {\n                    style: grid.style,\n                    className: paneClasses.join(' ')\n                }, children);\n            },\n            headerClassName: function (index, type) {\n                var selectedHeaders = this._selectedHeaders;\n                var itemSelection;\n                var allHeaders;\n                if (type === 'row') {\n                    itemSelection = selectedHeaders.rows[index];\n                    allHeaders = selectedHeaders.allRows;\n                } else {\n                    itemSelection = selectedHeaders.cols[index];\n                    allHeaders = selectedHeaders.allCols;\n                }\n                var className = itemSelection || (selectedHeaders.all ? 'full' : allHeaders ? 'partial' : 'none');\n                if (className) {\n                    className = 'k-selection-' + className;\n                }\n                return className;\n            },\n            renderData: function () {\n                var view = this._currentView;\n                var cont = kendo.dom.element('div', {\n                    className: Pane.classNames.data,\n                    style: {\n                        position: 'relative',\n                        left: view.columnOffset + 'px',\n                        top: view.rowOffset + 'px'\n                    }\n                });\n                var rect = this._currentRect;\n                var layout = kendo.spreadsheet.draw.doLayout(this._sheet, view.ref, { forScreen: true }), prev;\n                var showGridLines = this._sheet.options.showGridLines;\n                if (showGridLines) {\n                    prev = null;\n                    layout.xCoords.forEach(function (x) {\n                        if (x !== prev) {\n                            prev = x;\n                            cont.children.push(kendo.dom.element('div', {\n                                className: paneClassNames.vaxis,\n                                style: {\n                                    left: x + 'px',\n                                    height: rect.height + 'px'\n                                }\n                            }));\n                        }\n                    });\n                    prev = null;\n                    layout.yCoords.forEach(function (y) {\n                        if (y !== prev) {\n                            prev = y;\n                            cont.children.push(kendo.dom.element('div', {\n                                className: paneClassNames.haxis,\n                                style: {\n                                    top: y + 'px',\n                                    width: rect.width + 'px'\n                                }\n                            }));\n                        }\n                    });\n                }\n                var vBorders = {}, hBorders = {};\n                layout.cells.forEach(function (cell) {\n                    var hb = hBorders[cell.col] || (hBorders[cell.col] = {});\n                    var vb = vBorders[cell.row] || (vBorders[cell.row] = {});\n                    drawCell(cont.children, cell, null, hb, vb, showGridLines);\n                });\n                return cont;\n            },\n            renderResizeHandler: function () {\n                var sheet = this._sheet;\n                var ref = sheet.resizeHandlePosition();\n                var rectangle = this._rectangle(ref);\n                var style;\n                if (ref.col !== -Infinity) {\n                    style = {\n                        height: this._grid.headerHeight + 'px',\n                        width: RESIZE_HANDLE_WIDTH + 'px',\n                        left: rectangle.right - RESIZE_HANDLE_WIDTH / 2 + 'px',\n                        top: '0px'\n                    };\n                } else {\n                    style = {\n                        height: RESIZE_HANDLE_WIDTH + 'px',\n                        width: this._grid.headerWidth + 'px',\n                        top: rectangle.bottom - RESIZE_HANDLE_WIDTH / 2 + 'px',\n                        left: '0px'\n                    };\n                }\n                return kendo.dom.element('div', {\n                    className: Pane.classNames.resizeHandle,\n                    style: style\n                });\n            },\n            filterIconRect: function (rect) {\n                var BUTTON_SIZE = 16;\n                var BUTTON_OFFSET = 3;\n                return new kendo.spreadsheet.Rectangle(rect.right - BUTTON_SIZE - BUTTON_OFFSET, rect.top + BUTTON_OFFSET, BUTTON_SIZE, BUTTON_SIZE);\n            },\n            renderFilterHeaders: function () {\n                var sheet = this._sheet;\n                var children = [];\n                var classNames = View.classNames;\n                var filter = sheet.filter();\n                function icon(className) {\n                    return kendo.dom.element('span', { className: classNames.icon + ' ' + className });\n                }\n                function filterButton(classNames, position, index) {\n                    var style = {\n                        left: position.left + 'px',\n                        top: position.top + 'px'\n                    };\n                    var filtered = filter && filter.columns.some(function (c) {\n                        return c.index === index;\n                    });\n                    var classes = classNames.filterButton;\n                    if (filtered) {\n                        classes += ' ' + classNames.filterButtonActive;\n                    }\n                    var button = kendo.dom.element('span', {\n                        className: classes,\n                        style: style\n                    }, [icon(classNames.iconFilterDefault)]);\n                    return button;\n                }\n                if (filter) {\n                    this._addDiv(children, filter.ref, classNames.filterRange);\n                }\n                sheet.forEachFilterHeader(this._currentView.ref, function (ref) {\n                    var rect = this._rectangle(ref);\n                    var position = this.filterIconRect(rect);\n                    var column = this._sheet.filterColumn(ref);\n                    var button = filterButton(classNames, position, column);\n                    children.push(button);\n                }.bind(this));\n                return kendo.dom.element('div', { className: classNames.filterHeadersWrapper }, children);\n            },\n            renderEditorSelection: function () {\n                var classNames = Pane.classNames;\n                var sheet = this._sheet;\n                var selections = [];\n                sheet._formulaSelections.forEach(function (range) {\n                    var ref = range.ref;\n                    if (ref === kendo.spreadsheet.NULLREF) {\n                        return;\n                    }\n                    this._addDiv(selections, ref, classNames.selectionHighlight + ' ' + range.colorClass);\n                }.bind(this));\n                return kendo.dom.element('div', { className: classNames.selectionWrapper }, selections);\n            },\n            renderSelection: function () {\n                var classNames = Pane.classNames;\n                var selections = [];\n                var activeCellClasses = [classNames.activeCell];\n                var selectionClasses = [classNames.selection];\n                var sheet = this._sheet;\n                var activeCell = sheet.activeCell().toRangeRef();\n                var activeFormulaColor = this._activeFormulaColor();\n                var selection = sheet.select();\n                activeCellClasses = activeCellClasses.concat(activeFormulaColor, this._directionClasses(activeCell));\n                selectionClasses = selectionClasses.concat(activeFormulaColor);\n                if (sheet.singleCellSelection()) {\n                    activeCellClasses.push(classNames.single);\n                }\n                if (selection.size() === 1) {\n                    selectionClasses.push('k-single-selection');\n                }\n                if (this._sheet.autoFillPunch()) {\n                    selectionClasses.push('k-dim-auto-fill-handle');\n                }\n                selection.forEach(function (ref) {\n                    if (ref !== kendo.spreadsheet.NULLREF) {\n                        this._addDiv(selections, ref, selectionClasses.join(' '));\n                    }\n                }.bind(this));\n                this._addTable(selections, activeCell, activeCellClasses.join(' '));\n                return kendo.dom.element('div', { className: classNames.selectionWrapper }, selections);\n            },\n            renderAutoFill: function () {\n                var autoFillRectangle = [];\n                if (this._sheet.autoFillInProgress()) {\n                    var autoFillRef = this._sheet.autoFillRef();\n                    var punch = this._sheet.autoFillPunch();\n                    var direction = this._sheet._autoFillDirection;\n                    this._addDiv(autoFillRectangle, autoFillRef, 'k-auto-fill');\n                    if (punch) {\n                        this._addDiv(autoFillRectangle, punch, 'k-auto-fill-punch');\n                    } else if (direction !== undefined) {\n                        var ref, cssClass;\n                        switch (direction) {\n                        case 0:\n                            ref = autoFillRef.bottomRight;\n                            cssClass = 'k-auto-fill-br-hint';\n                            break;\n                        case 1:\n                            ref = autoFillRef.bottomRight;\n                            cssClass = 'k-auto-fill-br-hint';\n                            break;\n                        case 2:\n                            ref = new CellRef(autoFillRef.topLeft.row, autoFillRef.bottomRight.col);\n                            cssClass = 'k-auto-fill-tr-hint';\n                            break;\n                        case 3:\n                            ref = new CellRef(autoFillRef.bottomRight.row, autoFillRef.topLeft.col);\n                            cssClass = 'k-auto-fill-bl-hint';\n                            break;\n                        }\n                        var hint = kendo.dom.element('span', { className: 'k-tooltip' }, [kendo.dom.text(this._sheet._autoFillHint)]);\n                        var rectangle = this._addDiv(autoFillRectangle, ref, cssClass);\n                        if (rectangle) {\n                            rectangle.children.push(hint);\n                        }\n                    }\n                }\n                return kendo.dom.element('div', { className: Pane.classNames.autoFillWrapper }, autoFillRectangle);\n            },\n            _addDiv: function (collection, ref, className) {\n                var view = this._currentView, div;\n                if (view.ref.intersects(ref)) {\n                    div = this._rectangle(ref).resize(1, 1).toDiv(className);\n                    collection.push(div);\n                }\n                return div;\n            },\n            _addTable: function (collection, ref, className) {\n                var sheet = this._sheet;\n                var view = this._currentView;\n                if (view.ref.intersects(ref)) {\n                    sheet.forEach(ref.collapse(), function (row, col, cell) {\n                        var rectangle = this._rectangle(ref);\n                        cell.left = rectangle.left;\n                        cell.top = rectangle.top;\n                        cell.width = rectangle.width;\n                        cell.height = rectangle.height;\n                        drawCell(collection, cell, className, null, null, true);\n                    }.bind(this));\n                }\n            },\n            _activeFormulaColor: function () {\n                var activeFormulaSelection;\n                var colorClasses = [];\n                if (this._sheet.isInEditMode()) {\n                    activeFormulaSelection = this._sheet._formulaSelections.filter(function (sel) {\n                        return sel.active && sel.type == 'ref';\n                    })[0];\n                    if (activeFormulaSelection) {\n                        colorClasses.push(activeFormulaSelection.colorClass);\n                    }\n                }\n                return colorClasses;\n            },\n            _directionClasses: function (cell) {\n                var cellClasses = [];\n                var classNames = Pane.classNames;\n                var view = this._currentView.ref;\n                if (!cell.move(0, -1).intersects(view)) {\n                    cellClasses.push(classNames.left);\n                }\n                if (!cell.move(-1, 0).intersects(view)) {\n                    cellClasses.push(classNames.top);\n                }\n                if (!cell.move(0, 1).intersects(view)) {\n                    cellClasses.push(classNames.right);\n                }\n                if (!cell.move(1, 0).intersects(view)) {\n                    cellClasses.push(classNames.bottom);\n                }\n                return cellClasses;\n            },\n            _rectangle: function (ref) {\n                return this._grid.boundingRectangle(ref.toRangeRef()).offset(-this._currentView.mergedCellLeft, -this._currentView.mergedCellTop);\n            }\n        });\n        kendo.spreadsheet.View = View;\n        kendo.spreadsheet.Pane = Pane;\n        kendo.spreadsheet.drawCell = drawCell;\n        $.extend(true, View, { classNames: viewClassNames });\n        $.extend(true, Pane, { classNames: paneClassNames });\n    }(window.kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/grid', [\n        'kendo.core',\n        'spreadsheet/references'\n    ], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var CellRef = kendo.spreadsheet.CellRef;\n        var RangeRef = kendo.spreadsheet.RangeRef;\n        var UnionRef = kendo.spreadsheet.UnionRef;\n        var Rectangle = kendo.Class.extend({\n            init: function (left, top, width, height) {\n                this.left = left;\n                this.width = width;\n                this.right = left + width;\n                this.top = top;\n                this.height = height;\n                this.bottom = top + height;\n            },\n            offset: function (left, top) {\n                return new Rectangle(this.left + left, this.top + top, this.width, this.height);\n            },\n            resize: function (width, height) {\n                return new Rectangle(this.left, this.top, this.width + width, this.height + height);\n            },\n            intersects: function (x, y) {\n                return this.left < x && x < this.left + this.width && this.top < y && y < this.top + this.height;\n            },\n            toDiv: function (className) {\n                return kendo.dom.element('div', {\n                    className: className,\n                    style: {\n                        width: this.width + 'px',\n                        height: this.height + 'px',\n                        top: this.top + 'px',\n                        left: this.left + 'px'\n                    }\n                });\n            }\n        });\n        var Grid = kendo.Class.extend({\n            init: function (rows, columns, rowCount, columnCount, headerHeight, headerWidth) {\n                this.rowCount = rowCount;\n                this.columnCount = columnCount;\n                this._columns = columns;\n                this._rows = rows;\n                this._headerHeight = headerHeight;\n                this._headerWidth = headerWidth;\n            },\n            isAxis: function (ref) {\n                ref = ref.toRangeRef();\n                var topLeft = ref.topLeft;\n                var bottomRight = ref.bottomRight;\n                return topLeft.row === 0 && bottomRight.row === this.rowCount - 1 || topLeft.col === 0 && bottomRight.col === this.columnCount - 1;\n            },\n            width: function (start, end) {\n                return this._columns.sum(start, end);\n            },\n            height: function (start, end) {\n                return this._rows.sum(start, end);\n            },\n            totalHeight: function () {\n                return this._rows.total + this._headerHeight;\n            },\n            totalWidth: function () {\n                return this._columns.total + this._headerWidth;\n            },\n            index: function (row, column) {\n                return column * this.rowCount + row;\n            },\n            cellRef: function (index) {\n                return new CellRef(index % this.rowCount, index / this.rowCount >> 0);\n            },\n            rowRef: function (row) {\n                return new RangeRef(new CellRef(row, 0), new CellRef(row, this.columnCount - 1));\n            },\n            colRef: function (col) {\n                return new RangeRef(new CellRef(0, col), new CellRef(this.rowCount - 1, col));\n            },\n            cellRefIndex: function (ref) {\n                return this.index(ref.row, ref.col);\n            },\n            normalize: function (ref) {\n                if (ref instanceof RangeRef) {\n                    return new RangeRef(this.normalize(ref.topLeft), this.normalize(ref.bottomRight)).setSheet(ref.sheet, ref.hasSheet());\n                }\n                if (ref instanceof UnionRef) {\n                    return ref.map(function (ref) {\n                        return this.normalize(ref);\n                    }, this);\n                }\n                var clone = ref.clone();\n                clone.col = Math.max(0, Math.min(this.columnCount - 1, ref.col));\n                clone.row = Math.max(0, Math.min(this.rowCount - 1, ref.row));\n                return clone;\n            },\n            rectangle: function (ref) {\n                var topLeft = this.normalize(ref.topLeft);\n                var bottomRight = this.normalize(ref.bottomRight);\n                return new Rectangle(this.width(0, topLeft.col - 1), this.height(0, topLeft.row - 1), this.width(topLeft.col, bottomRight.col), this.height(topLeft.row, bottomRight.row));\n            },\n            pane: function (options) {\n                return new PaneGrid(new kendo.spreadsheet.PaneAxis(this._rows, options.row, options.rowCount, this._headerHeight), new kendo.spreadsheet.PaneAxis(this._columns, options.column, options.columnCount, this._headerWidth), this);\n            },\n            rangeDimensions: function (rangeRef) {\n                return {\n                    rows: this._rows.values.iterator(rangeRef.topLeft.row, rangeRef.bottomRight.row),\n                    columns: this._columns.values.iterator(rangeRef.topLeft.col, rangeRef.bottomRight.col)\n                };\n            },\n            forEach: function (ref, callback) {\n                var topLeft = this.normalize(ref.topLeft);\n                var bottomRight = this.normalize(ref.bottomRight);\n                for (var ci = topLeft.col; ci <= bottomRight.col; ci++) {\n                    for (var ri = topLeft.row; ri <= bottomRight.row; ri++) {\n                        callback(new CellRef(ri, ci));\n                    }\n                }\n            },\n            trim: function (ref, property) {\n                var topLeft = ref.topLeft;\n                var bottomRight = ref.bottomRight;\n                var bottomRightRow = topLeft.row;\n                var bottomRightCol = topLeft.col;\n                for (var ci = topLeft.col; ci <= bottomRight.col; ci++) {\n                    var start = this.index(topLeft.row, ci);\n                    var end = this.index(bottomRight.row, ci);\n                    var values = property.tree.intersecting(start, end);\n                    if (values.length) {\n                        var cell = this.cellRef(values[values.length - 1].end);\n                        bottomRightRow = Math.max(bottomRightRow, cell.row);\n                        bottomRightCol = ci;\n                    }\n                }\n                return new RangeRef(ref.topLeft, new CellRef(Math.min(bottomRightRow, ref.bottomRight.row), bottomRightCol));\n            }\n        });\n        var PaneGrid = kendo.Class.extend({\n            init: function (rows, columns, grid) {\n                this.rows = rows;\n                this.columns = columns;\n                this._grid = grid;\n                this.headerHeight = rows.headerSize;\n                this.headerWidth = columns.headerSize;\n                this.hasRowHeader = columns.hasHeader;\n                this.hasColumnHeader = rows.hasHeader;\n            },\n            refresh: function (width, height) {\n                this.columns.viewSize(width);\n                this.rows.viewSize(height);\n                var x = this.columns.paneSegment();\n                var y = this.rows.paneSegment();\n                this.left = x.offset;\n                this.top = y.offset;\n                this.right = x.offset + x.length;\n                this.bottom = y.offset + y.length;\n                this.style = {\n                    top: y.offset + 'px',\n                    left: x.offset + 'px',\n                    height: y.length + 'px',\n                    width: x.length + 'px'\n                };\n            },\n            view: function (left, top) {\n                var rows = this.rows.visible(top);\n                var columns = this.columns.visible(left);\n                return {\n                    rows: rows,\n                    columns: columns,\n                    rowOffset: rows.offset,\n                    columnOffset: columns.offset,\n                    mergedCellLeft: columns.start,\n                    mergedCellTop: rows.start,\n                    ref: new RangeRef(new CellRef(rows.values.start, columns.values.start), new CellRef(rows.values.end, columns.values.end))\n                };\n            },\n            contains: function (ref) {\n                return this.rows.contains(ref.topLeft.row, ref.bottomRight.row) && this.columns.contains(ref.topLeft.col, ref.bottomRight.col);\n            },\n            index: function (row, column) {\n                return this._grid.index(row, column);\n            },\n            boundingRectangle: function (ref) {\n                return this._grid.rectangle(ref);\n            },\n            cellRefIndex: function (ref) {\n                return this._grid.cellRefIndex(ref);\n            },\n            scrollBoundaries: function (cell) {\n                var position = this.boundingRectangle(cell);\n                var boundaries = {\n                    top: Math.max(0, position.top - this.top + (this.hasColumnHeader ? 0 : this.headerHeight)),\n                    left: Math.max(0, position.left - this.left + (this.hasRowHeader ? 0 : this.headerWidth)),\n                    right: position.right - this.columns._viewSize + this.headerWidth,\n                    bottom: position.bottom - this.rows._viewSize + this.headerHeight\n                };\n                var widthCompensation = this.columns.defaultValue / 2;\n                var heightCompensation = this.rows.defaultValue / 2;\n                boundaries.scrollTop = boundaries.top - heightCompensation;\n                boundaries.scrollBottom = boundaries.bottom + heightCompensation;\n                boundaries.scrollLeft = boundaries.left - widthCompensation;\n                boundaries.scrollRight = boundaries.right + widthCompensation;\n                return boundaries;\n            }\n        });\n        kendo.spreadsheet.Grid = Grid;\n        kendo.spreadsheet.PaneGrid = PaneGrid;\n        kendo.spreadsheet.Rectangle = Rectangle;\n    }(kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/axis', ['kendo.core'], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var Axis = kendo.Class.extend({\n            init: function (count, value) {\n                this._value = value;\n                this._count = count;\n                this.values = new kendo.spreadsheet.RangeList(0, count - 1, value);\n                this._hidden = new kendo.spreadsheet.RangeList(0, count - 1, 0);\n                this.scrollBarSize = kendo.support.scrollbar();\n                this._refresh();\n            },\n            toJSON: function (field, positions) {\n                var values = [];\n                var iterator = this.values.iterator(0, this._count - 1);\n                for (var idx = 0; idx < this._count; idx++) {\n                    var value = iterator.at(idx);\n                    if (value === this._value) {\n                        continue;\n                    }\n                    var position = positions[idx];\n                    if (position === undefined) {\n                        position = values.length;\n                        var item = { index: idx };\n                        item[field] = value;\n                        values.push(item);\n                        positions[idx] = position;\n                    }\n                }\n                return values;\n            },\n            fromJSON: function (field, values) {\n                for (var idx = 0; idx < values.length; idx++) {\n                    var value = values[idx][field];\n                    var index = values[idx].index;\n                    if (index === undefined) {\n                        index = idx;\n                    }\n                    this.value(index, index, value);\n                }\n            },\n            hide: function (index) {\n                if (!this.hidden(index)) {\n                    var value = this.value(index, index);\n                    this._hidden.value(index, index, value);\n                    this.value(index, index, 0);\n                }\n            },\n            hidden: function (index) {\n                return this._hidden.value(index, index) !== 0;\n            },\n            includesHidden: function (start, end) {\n                return this._hidden.intersecting(start, end).length > 1;\n            },\n            nextVisible: function (index, overflow) {\n                var end = this._count - 1;\n                if (index === end) {\n                    return overflow ? index + 1 : index;\n                }\n                index += 1;\n                var range = this._hidden.intersecting(index, index)[0];\n                if (range.value !== 0) {\n                    if (range.end === end) {\n                        return index - 1;\n                    } else {\n                        return range.end + 1;\n                    }\n                } else {\n                    return index;\n                }\n            },\n            nextPage: function (index, pageSize) {\n                return this.index(this.sum(0, index - 1) + pageSize);\n            },\n            prevPage: function (index, pageSize) {\n                return this.index(this.sum(0, index) - pageSize);\n            },\n            firstVisible: function () {\n                var firstHidden = this._hidden.first();\n                if (firstHidden.value === 0) {\n                    return 0;\n                } else {\n                    return firstHidden.end + 1;\n                }\n            },\n            lastVisible: function () {\n                var lastHidden = this._hidden.last();\n                if (lastHidden.value === 0) {\n                    return this._count - 1;\n                } else {\n                    return lastHidden.start - 1;\n                }\n            },\n            prevVisible: function (index, overflow) {\n                if (index === 0) {\n                    return overflow ? -1 : 0;\n                }\n                index -= 1;\n                var range = this._hidden.intersecting(index, index)[0];\n                if (range.value !== 0) {\n                    if (range.start === 0) {\n                        return index + 1;\n                    } else {\n                        return range.start - 1;\n                    }\n                } else {\n                    return index;\n                }\n            },\n            unhide: function (index) {\n                if (this.hidden(index)) {\n                    var value = this._hidden.value(index, index);\n                    this._hidden.value(index, index, 0);\n                    this.value(index, index, value);\n                }\n            },\n            value: function (start, end, value) {\n                if (value !== undefined) {\n                    this.values.value(start, end, value);\n                    this._refresh();\n                } else {\n                    return this.values.iterator(start, end).at(0);\n                }\n            },\n            sum: function (start, end) {\n                var values = this.values.iterator(start, end);\n                var sum = 0;\n                for (var idx = start; idx <= end; idx++) {\n                    sum += values.at(idx);\n                }\n                return sum;\n            },\n            visible: function (start, end) {\n                var startSegment = null;\n                var endSegment = null;\n                var lastPage = false;\n                if (end >= this.total + this.scrollBarSize) {\n                    lastPage = true;\n                }\n                var ranges = this._pixelValues.intersecting(start, end);\n                startSegment = ranges[0];\n                endSegment = ranges[ranges.length - 1];\n                var startOffset = start - startSegment.start;\n                var startIndex = (startOffset / startSegment.value.value >> 0) + startSegment.value.start;\n                var offset = startOffset - (startIndex - startSegment.value.start) * startSegment.value.value;\n                var endOffset = end - endSegment.start;\n                var endIndex = (endOffset / endSegment.value.value >> 0) + endSegment.value.start;\n                if (endIndex > endSegment.value.end) {\n                    endIndex = endSegment.value.end;\n                }\n                if (lastPage) {\n                    offset += endSegment.value.value - (endOffset - (endIndex - endSegment.value.start) * endSegment.value.value);\n                }\n                offset = Math.min(-offset, 0);\n                return {\n                    values: this.values.iterator(startIndex, endIndex),\n                    offset: offset\n                };\n            },\n            index: function (value) {\n                var index = 0;\n                var iterator = this.values.iterator(0, this._count - 1);\n                var current = iterator.at(0);\n                while (current < value && index < this._count - 1) {\n                    current += iterator.at(++index);\n                }\n                return index;\n            },\n            _refresh: function () {\n                var current = 0;\n                this._pixelValues = this.values.map(function (range) {\n                    var start = current;\n                    current += (range.end - range.start + 1) * range.value;\n                    var end = current - 1;\n                    return new kendo.spreadsheet.ValueRange(start, end, range);\n                });\n                this.total = current;\n            },\n            getState: function () {\n                return {\n                    values: this.values.getState(),\n                    hidden: this._hidden.getState()\n                };\n            },\n            setState: function (state) {\n                this.values.setState(state.values);\n                this._hidden.setState(state.hidden);\n                this._refresh();\n            }\n        });\n        var PaneAxis = kendo.Class.extend({\n            init: function (axis, start, count, headerSize) {\n                this._axis = axis;\n                this._start = start;\n                this._count = count;\n                this.hasHeader = start === 0;\n                this.headerSize = headerSize;\n                this.defaultValue = axis._value;\n                this.frozen = count > 0;\n            },\n            viewSize: function (viewSize) {\n                this._viewSize = viewSize;\n            },\n            sum: function (start, end) {\n                return this._axis.sum(start, end - 1);\n            },\n            start: function () {\n                return this.sum(0, this._start);\n            },\n            size: function () {\n                return this.sum(this._start, this._start + this._count);\n            },\n            index: function (value, offset) {\n                return this._axis.index(value + (this.frozen ? 0 : offset) - this.headerSize);\n            },\n            paneSegment: function () {\n                var offset = this.start();\n                var length;\n                if (!this.hasHeader) {\n                    offset += this.headerSize;\n                }\n                if (this.frozen) {\n                    length = this.size();\n                    if (this.hasHeader) {\n                        length += this.headerSize;\n                    } else {\n                        length -= this.headerSize;\n                    }\n                } else {\n                    length = this._viewSize - offset;\n                }\n                return {\n                    offset: offset,\n                    length: length\n                };\n            },\n            visible: function (offset) {\n                var start = this.start();\n                var size;\n                if (this.frozen) {\n                    size = this.size();\n                    if (!this.hasHeader) {\n                        size -= this.headerSize;\n                    }\n                } else {\n                    size = this._viewSize - start - this.headerSize;\n                    start += offset;\n                }\n                var result = this._axis.visible(start, start + size - 1);\n                if (this.frozen) {\n                    result.offset = 0;\n                }\n                result.start = start;\n                if (this.hasHeader) {\n                    result.offset += this.headerSize;\n                    result.start -= this.headerSize;\n                }\n                return result;\n            },\n            contains: function (start, end) {\n                if (this.frozen) {\n                    if (start > this._start + this._count) {\n                        return false;\n                    }\n                    if (end < this._start) {\n                        return false;\n                    }\n                    return true;\n                } else {\n                    return end >= this._start;\n                }\n            }\n        });\n        kendo.spreadsheet.Axis = Axis;\n        kendo.spreadsheet.PaneAxis = PaneAxis;\n    }(kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/filter', [\n        'kendo.core',\n        'kendo.data'\n    ], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var Filter = kendo.spreadsheet.Filter = kendo.Class.extend({\n            prepare: function () {\n            },\n            value: function (cell) {\n                return cell.value;\n            },\n            matches: function () {\n                throw new Error('The \\'matches\\' method is not implemented.');\n            },\n            toJSON: function () {\n                throw new Error('The \\'toJSON\\' method is not implemented.');\n            }\n        });\n        Filter.create = function (options) {\n            var filter = options.filter;\n            if (!filter) {\n                throw new Error('Filter type not specified.');\n            }\n            var constructor = kendo.spreadsheet[filter.charAt(0).toUpperCase() + filter.substring(1) + 'Filter'];\n            if (!constructor) {\n                throw new Error('Filter type not recognized.');\n            }\n            return new constructor(options);\n        };\n        kendo.spreadsheet.ValueFilter = Filter.extend({\n            _values: [],\n            _dates: [],\n            _blanks: false,\n            init: function (options) {\n                if (options.values !== undefined) {\n                    this._values = options.values;\n                }\n                if (options.blanks !== undefined) {\n                    this._blanks = options.blanks;\n                }\n                if (options.dates !== undefined) {\n                    this._dates = options.dates;\n                }\n            },\n            value: function (cell) {\n                var value = cell.value;\n                if (this._dates.length > 0 && cell.format && typeof value === 'number') {\n                    var type = kendo.spreadsheet.formatting.type(value, cell.format);\n                    if (type === 'date') {\n                        value = kendo.spreadsheet.numberToDate(value);\n                    }\n                }\n                return value;\n            },\n            matches: function (value) {\n                if (value === null || value === undefined) {\n                    return this._blanks;\n                }\n                if (value instanceof Date) {\n                    return this._dates.some(function (date) {\n                        return date.year === value.getFullYear() && (date.month === undefined || date.month === value.getMonth()) && (date.day === undefined || date.day === value.getDate()) && (date.hours === undefined || date.hours === value.getHours()) && (date.minutes === undefined || date.minutes === value.getMinutes()) && (date.seconds === undefined || date.seconds === value.getSeconds());\n                    });\n                }\n                return this._values.indexOf(value) >= 0;\n            },\n            toJSON: function () {\n                return {\n                    filter: 'value',\n                    values: this._values.slice(0)\n                };\n            }\n        });\n        kendo.spreadsheet.CustomFilter = Filter.extend({\n            _logic: 'and',\n            init: function (options) {\n                if (options.logic !== undefined) {\n                    this._logic = options.logic;\n                }\n                if (options.criteria === undefined) {\n                    throw new Error('Must specify criteria.');\n                }\n                this._criteria = options.criteria;\n                var expression = kendo.data.Query.filterExpr({\n                    logic: this._logic,\n                    filters: this._criteria\n                }).expression;\n                this._matches = new Function('d', 'return ' + expression);\n            },\n            matches: function (value) {\n                if (value === null) {\n                    return false;\n                }\n                return this._matches(value);\n            },\n            value: function (cell) {\n                var value = cell.value;\n                var criterionValue = this._criteria[0].value;\n                var criterionType = criterionValue instanceof Date ? 'date' : typeof criterionValue;\n                var valueType = typeof value;\n                if (cell.format) {\n                    valueType = kendo.spreadsheet.formatting.type(value, cell.format);\n                }\n                if (valueType != criterionType) {\n                    if (criterionType == 'string') {\n                        if (cell.format) {\n                            value = kendo.spreadsheet.formatting.text(value, cell.format);\n                        }\n                        value = value + '';\n                    }\n                } else if (valueType == 'date') {\n                    value = kendo.spreadsheet.numberToDate(value);\n                }\n                return value;\n            },\n            toJSON: function () {\n                return {\n                    filter: 'custom',\n                    logic: this._logic,\n                    criteria: this._criteria\n                };\n            }\n        });\n        kendo.spreadsheet.TopFilter = Filter.extend({\n            init: function (options) {\n                this._type = options.type;\n                this._value = options.value;\n                this._values = [];\n            },\n            prepare: function (cells) {\n                var values = cells.map(this.value).sort().filter(function (value, index, array) {\n                    return index === 0 || value !== array[index - 1];\n                });\n                if (this._type === 'topNumber' || this._type == 'topPercent') {\n                    values.sort(function (x, y) {\n                        return y - x;\n                    });\n                } else {\n                    values.sort(function (x, y) {\n                        return x - y;\n                    });\n                }\n                var count = this._value;\n                if (this._type === 'topPercent' || this._type === 'bottomPercent') {\n                    count = values.length * count / 100 >> 0;\n                }\n                this._values = values.slice(0, count);\n            },\n            matches: function (value) {\n                return this._values.indexOf(value) >= 0;\n            },\n            toJSON: function () {\n                return {\n                    filter: 'top',\n                    type: this._type,\n                    value: this._value\n                };\n            }\n        });\n        kendo.spreadsheet.DynamicFilter = Filter.extend({\n            init: function (options) {\n                this._type = options.type;\n                this._predicate = this[options.type];\n                if (typeof this._predicate !== 'function') {\n                    throw new Error('DynamicFilter type \\'' + options.type + '\\' not recognized.');\n                }\n            },\n            value: function (cell) {\n                var value = cell.value;\n                if (cell.format) {\n                    var type = kendo.spreadsheet.formatting.type(value, cell.format);\n                    if (type === 'date') {\n                        value = kendo.spreadsheet.numberToDate(value);\n                    }\n                }\n                return value;\n            },\n            prepare: function (cells) {\n                var sum = 0;\n                var count = 0;\n                for (var ci = 0; ci < cells.length; ci++) {\n                    var value = this.value(cells[ci]);\n                    if (typeof value === 'number') {\n                        sum += value;\n                        count++;\n                    }\n                }\n                if (count > 0) {\n                    this._average = sum / count;\n                } else {\n                    this._average = 0;\n                }\n            },\n            matches: function (value) {\n                return this._predicate(value);\n            },\n            aboveAverage: function (value) {\n                if (value instanceof Date) {\n                    value = kendo.spreadsheet.dateToNumber(value);\n                }\n                if (typeof value !== 'number') {\n                    return false;\n                }\n                return value > this._average;\n            },\n            belowAverage: function (value) {\n                if (value instanceof Date) {\n                    value = kendo.spreadsheet.dateToNumber(value);\n                }\n                if (typeof value !== 'number') {\n                    return false;\n                }\n                return value < this._average;\n            },\n            tomorrow: function (value) {\n                if (value instanceof Date) {\n                    var tomorrow = kendo.date.addDays(kendo.date.today(), 1);\n                    return kendo.date.getDate(value).getTime() === tomorrow.getTime();\n                }\n                return false;\n            },\n            today: function (value) {\n                if (value instanceof Date) {\n                    return kendo.date.isToday(value);\n                }\n                return false;\n            },\n            yesterday: function (value) {\n                if (value instanceof Date) {\n                    var yesterday = kendo.date.addDays(kendo.date.today(), -1);\n                    return kendo.date.getDate(value).getTime() === yesterday.getTime();\n                }\n                return false;\n            },\n            nextWeek: function (value) {\n                return sameWeek(kendo.date.addDays(kendo.date.today(), 7), value);\n            },\n            thisWeek: function (value) {\n                return sameWeek(kendo.date.today(), value);\n            },\n            lastWeek: function (value) {\n                return sameWeek(kendo.date.addDays(kendo.date.today(), -7), value);\n            },\n            nextMonth: function (value) {\n                return sameMonth(value, 1);\n            },\n            thisMonth: function (value) {\n                return sameMonth(value, 0);\n            },\n            lastMonth: function (value) {\n                return sameMonth(value, -1);\n            },\n            nextQuarter: function (value) {\n                if (value instanceof Date) {\n                    var today = kendo.date.today();\n                    var diff = quarter(value) - quarter(today);\n                    return diff === 1 && today.getFullYear() === value.getFullYear() || diff == -3 && today.getFullYear() + 1 === value.getFullYear();\n                }\n                return false;\n            },\n            thisQuarter: function (value) {\n                if (value instanceof Date) {\n                    var today = kendo.date.today();\n                    var diff = quarter(value) - quarter(today);\n                    return diff === 0 && today.getFullYear() === value.getFullYear();\n                }\n                return false;\n            },\n            lastQuarter: function (value) {\n                if (value instanceof Date) {\n                    var today = kendo.date.today();\n                    var diff = quarter(today) - quarter(value);\n                    return diff === 1 && today.getFullYear() === value.getFullYear() || diff == -3 && today.getFullYear() - 1 === value.getFullYear();\n                }\n                return false;\n            },\n            nextYear: function (value) {\n                return sameYear(value, 1);\n            },\n            thisYear: function (value) {\n                return sameYear(value, 0);\n            },\n            lastYear: function (value) {\n                return sameYear(value, -1);\n            },\n            yearToDate: function (value) {\n                if (value instanceof Date) {\n                    var today = kendo.date.today();\n                    return value.getFullYear() === today.getFullYear() && value <= today;\n                }\n                return false;\n            },\n            toJSON: function () {\n                return {\n                    filter: 'dynamic',\n                    type: this._type\n                };\n            }\n        });\n        [\n            1,\n            2,\n            3,\n            4\n        ].forEach(function (target) {\n            kendo.spreadsheet.DynamicFilter.prototype['quarter' + target] = function (value) {\n                if (value instanceof Date) {\n                    return quarter(value) === target;\n                }\n                return false;\n            };\n        });\n        kendo.cultures['en-US'].calendar.months.names.forEach(function (month, index) {\n            kendo.spreadsheet.DynamicFilter.prototype[month.toLowerCase()] = function (value) {\n                if (value instanceof Date) {\n                    return value.getMonth() === index;\n                }\n                return false;\n            };\n        });\n        function quarter(value) {\n            var month = value.getMonth() + 1;\n            if (month >= 1 && month <= 3) {\n                return 1;\n            } else if (month >= 4 && month <= 6) {\n                return 2;\n            } else if (month >= 7 && month <= 9) {\n                return 3;\n            } else {\n                return 4;\n            }\n        }\n        function sameYear(value, offset) {\n            if (value instanceof Date) {\n                var today = kendo.date.today();\n                today.setFullYear(today.getFullYear() + offset);\n                return today.getFullYear() === value.getFullYear();\n            }\n            return false;\n        }\n        function sameMonth(value, offset) {\n            if (value instanceof Date) {\n                var today = kendo.date.firstDayOfMonth(kendo.date.today());\n                today.setMonth(today.getMonth() + offset, 1);\n                return today.getTime() === kendo.date.firstDayOfMonth(value).getTime();\n            }\n            return false;\n        }\n        function sameWeek(a, b) {\n            if (b instanceof Date) {\n                var firstWeek = kendo.date.dayOfWeek(kendo.date.getDate(a), 1);\n                var secondWeek = kendo.date.dayOfWeek(kendo.date.getDate(b), 1);\n                return firstWeek.getTime() === secondWeek.getTime();\n            }\n            return false;\n        }\n    }(kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/sorter', ['kendo.core'], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var Sorter = kendo.Class.extend({\n            init: function (grid, lists) {\n                this._grid = grid;\n                this._lists = lists;\n            },\n            indices: function (rangeRef, list, ascending, indices) {\n                var comparer = Sorter.ascendingComparer;\n                if (ascending === false) {\n                    comparer = Sorter.descendingComparer;\n                }\n                return list.sortedIndices(this._grid.cellRefIndex(rangeRef.topLeft), this._grid.cellRefIndex(rangeRef.bottomRight), comparer, indices);\n            },\n            sortBy: function (ref, column, list, ascending, indices) {\n                var sortedIndices = this.indices(ref.toColumn(column), list, ascending, indices);\n                for (var ci = ref.topLeft.col; ci <= ref.bottomRight.col; ci++) {\n                    var start = this._grid.index(ref.topLeft.row, ci);\n                    var end = this._grid.index(ref.bottomRight.row, ci);\n                    for (var li = 0; li < this._lists.length; li++) {\n                        if (start < this._lists[li].lastRangeStart()) {\n                            this._lists[li].sort(start, end, sortedIndices);\n                        }\n                    }\n                }\n                return sortedIndices;\n            }\n        });\n        Sorter.ascendingComparer = function (a, b) {\n            if (a === null && b === null) {\n                return 0;\n            }\n            if (a === null) {\n                return 1;\n            }\n            if (b === null) {\n                return -1;\n            }\n            var typeA = typeof a;\n            var typeB = typeof b;\n            if (typeA === 'number') {\n                if (typeB === 'number') {\n                    return a - b;\n                } else {\n                    return -1;\n                }\n            }\n            if (typeA === 'string') {\n                switch (typeB) {\n                case 'number':\n                    return 1;\n                case 'string':\n                    return a.localeCompare(b);\n                default:\n                    return -1;\n                }\n            }\n            if (typeA === 'boolean') {\n                switch (typeB) {\n                case 'number':\n                    return 1;\n                case 'string':\n                    return 1;\n                case 'boolean':\n                    return a - b;\n                default:\n                    return -1;\n                }\n            }\n            if (a instanceof kendo.spreadsheet.calc.runtime.CalcError) {\n                if (b instanceof kendo.spreadsheet.calc.runtime.CalcError) {\n                    return 0;\n                } else {\n                    return 1;\n                }\n            }\n            throw new Error('Cannot compare ' + a + ' and ' + b);\n        };\n        Sorter.descendingComparer = function (a, b) {\n            if (a === null && b === null) {\n                return 0;\n            }\n            if (a === null) {\n                return 1;\n            }\n            if (b === null) {\n                return -1;\n            }\n            return Sorter.ascendingComparer(b, a);\n        };\n        kendo.spreadsheet.Sorter = Sorter;\n    }(kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/numformat', [\n        'spreadsheet/calc',\n        'kendo.dom'\n    ], f);\n}(function () {\n    'use strict';\n    if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n        return;\n    }\n    var calc = kendo.spreadsheet.calc;\n    var dom = kendo.dom;\n    var RX_COLORS = /^\\[(black|green|white|blue|magenta|yellow|cyan|red)\\]/i;\n    var RX_CONDITION = /^\\[(<=|>=|<>|<|>|=)(-?[0-9.]+)\\]/;\n    function parse(input) {\n        input = calc.InputStream(input);\n        var sections = [], haveTimePart = false, haveConditional = false, decimalPart;\n        while (!input.eof()) {\n            var sec = readSection();\n            sections.push(sec);\n            if (sec.cond) {\n                haveConditional = true;\n            }\n        }\n        function addPlainText() {\n            sections.push({\n                cond: 'text',\n                body: [{ type: 'text' }]\n            });\n        }\n        if (haveConditional) {\n            addPlainText();\n        } else if (sections.length == 1) {\n            sections[0].cond = 'num';\n            addPlainText();\n        } else if (sections.length == 2) {\n            sections[0].cond = {\n                op: '>=',\n                value: 0\n            };\n            sections[1].cond = {\n                op: '<',\n                value: 0\n            };\n            addPlainText();\n        } else if (sections.length >= 3) {\n            sections[0].cond = {\n                op: '>',\n                value: 0\n            };\n            sections[1].cond = {\n                op: '<',\n                value: 0\n            };\n            sections[2].cond = {\n                op: '=',\n                value: 0\n            };\n            addPlainText();\n            if (sections.length > 3) {\n                sections[3].cond = 'text';\n                sections = sections.slice(0, 4);\n            }\n        }\n        return sections;\n        function maybeColor() {\n            var m = input.skip(RX_COLORS);\n            if (m) {\n                return m[1].toLowerCase();\n            }\n        }\n        function maybeCondition() {\n            var m = input.skip(RX_CONDITION);\n            if (m) {\n                var val = parseFloat(m[2]);\n                if (!isNaN(val)) {\n                    return {\n                        op: m[1],\n                        value: val\n                    };\n                }\n            }\n        }\n        function readFormat() {\n            var format = [], tok;\n            LOOP:\n                while (!input.eof() && (tok = readNext())) {\n                    format.push(tok);\n                }\n            return format;\n        }\n        function readNext() {\n            var ch, m;\n            if (m = input.skip(/^([#0?]+),([#0?]+)/)) {\n                return {\n                    type: 'digit',\n                    sep: true,\n                    format: m[1] + m[2],\n                    decimal: decimalPart\n                };\n            }\n            if (m = input.skip(/^[#0?]+/)) {\n                return {\n                    type: 'digit',\n                    sep: false,\n                    format: m[0],\n                    decimal: decimalPart\n                };\n            }\n            if (m = input.skip(/^(e)([+-])/i)) {\n                return {\n                    type: 'exp',\n                    ch: m[1],\n                    sign: m[2]\n                };\n            }\n            if (m = input.skip(/^(d{1,4}|m{1,5}|yyyy|yy)/i)) {\n                var type = 'date', m = m[1].toLowerCase();\n                if (haveTimePart && (m == 'm' || m == 'mm')) {\n                    type = 'time';\n                }\n                haveTimePart = false;\n                return {\n                    type: type,\n                    part: m.charAt(0),\n                    format: m.length\n                };\n            }\n            if (m = input.skip(/^(hh?|ss?)/i)) {\n                haveTimePart = true;\n                m = m[1].toLowerCase();\n                return {\n                    type: 'time',\n                    part: m.charAt(0),\n                    format: m.length\n                };\n            }\n            if (m = input.skip(/^\\[(hh?|mm?|ss?)\\]/i)) {\n                haveTimePart = true;\n                m = m[1].toLowerCase();\n                return {\n                    type: 'eltime',\n                    part: m.charAt(0),\n                    format: m.length\n                };\n            }\n            if (m = input.skip(/^(am\\/pm|a\\/p)/i)) {\n                m = m[1].split('/');\n                return {\n                    type: 'ampm',\n                    am: m[0],\n                    pm: m[1]\n                };\n            }\n            switch (ch = input.next()) {\n            case ';':\n                return null;\n            case '\\\\':\n                return {\n                    type: 'str',\n                    value: input.next()\n                };\n            case '\"':\n                return {\n                    type: 'str',\n                    value: input.readEscaped(ch)\n                };\n            case '@':\n                return { type: 'text' };\n            case '_':\n                return {\n                    type: 'space',\n                    value: input.next()\n                };\n            case '*':\n                return {\n                    type: 'fill',\n                    value: input.next()\n                };\n            case '.':\n                if (input.lookingAt(/^\\s*[#0?]/)) {\n                    decimalPart = true;\n                    return { type: 'dec' };\n                }\n                return {\n                    type: 'str',\n                    value: '.'\n                };\n            case '%':\n                return { type: 'percent' };\n            case ',':\n                return { type: 'comma' };\n            }\n            return {\n                type: 'str',\n                value: ch\n            };\n        }\n        function readSection() {\n            decimalPart = false;\n            var color = maybeColor(), cond = maybeCondition();\n            if (!color && cond) {\n                color = maybeColor();\n            }\n            return {\n                color: color,\n                cond: cond,\n                body: readFormat()\n            };\n        }\n    }\n    function print(sections) {\n        return sections.map(printSection).join(';');\n        function printSection(sec) {\n            var out = '';\n            if (sec.color) {\n                out += '[' + sec.color + ']';\n            }\n            if (sec.cond) {\n                if (!(sec.cond == 'text' || sec.cond == 'num')) {\n                    out += '[' + sec.cond.op + sec.cond.value + ']';\n                }\n            }\n            out += sec.body.map(printToken).join('');\n            return out;\n        }\n        function printToken(tok) {\n            if (tok.type == 'digit') {\n                if (tok.sep) {\n                    return tok.format.charAt(0) + ',' + tok.format.substr(1);\n                } else {\n                    return tok.format;\n                }\n            } else if (tok.type == 'exp') {\n                return tok.ch + tok.sign;\n            } else if (tok.type == 'date' || tok.type == 'time') {\n                return padLeft('', tok.format, tok.part);\n            } else if (tok.type == 'ampm') {\n                return tok.am + '/' + tok.pm;\n            } else if (tok.type == 'str') {\n                return JSON.stringify(tok.value);\n            } else if (tok.type == 'text') {\n                return '@';\n            } else if (tok.type == 'space') {\n                return '_' + tok.value;\n            } else if (tok.type == 'fill') {\n                return '*' + tok.value;\n            } else if (tok.type == 'dec') {\n                return '.';\n            } else if (tok.type == 'percent') {\n                return '%';\n            } else if (tok.type == 'comma') {\n                return ',';\n            }\n        }\n    }\n    function adjustDecimals(sections, x) {\n        sections.forEach(function (sec) {\n            var diff = x;\n            if (sec.cond == 'text') {\n                return;\n            }\n            var body = sec.body, adjusted = false, i = body.length;\n            while (diff !== 0 && --i >= 0) {\n                var tok = body[i];\n                if (tok.type == 'digit') {\n                    if (tok.decimal) {\n                        adjusted = true;\n                        if (diff > 0) {\n                            tok.format += padLeft('', diff, '0');\n                        } else if (diff < 0) {\n                            var tmp = tok.format.length;\n                            tok.format = tok.format.substr(0, tmp + diff);\n                            diff += tmp - tok.format.length;\n                        }\n                        if (tok.format.length === 0) {\n                            body.splice(i, 1);\n                            while (--i >= 0) {\n                                tok = body[i];\n                                if (tok.type == 'digit' && tok.decimal) {\n                                    ++i;\n                                    break;\n                                }\n                                if (tok.type == 'dec') {\n                                    body.splice(i, 1);\n                                    break;\n                                }\n                            }\n                        }\n                    }\n                    if (diff > 0) {\n                        break;\n                    }\n                }\n            }\n            if (!adjusted && diff > 0) {\n                body.splice(i + 1, 0, { type: 'dec' }, {\n                    type: 'digit',\n                    sep: false,\n                    decimal: true,\n                    format: padLeft('', diff, '0')\n                });\n            }\n        });\n    }\n    function TokenStream(parts) {\n        var index = 0;\n        return {\n            next: function () {\n                return parts[index++];\n            },\n            eof: function () {\n                return index >= parts.length;\n            },\n            ahead: function (n, f) {\n                if (index + n <= parts.length) {\n                    var val = f.apply(null, parts.slice(index, index + n));\n                    if (val) {\n                        index += n;\n                    }\n                    return val;\n                }\n            },\n            restart: function () {\n                index = 0;\n            }\n        };\n    }\n    function compileFormatPart(format) {\n        var input = TokenStream(format.body);\n        var hasDate = false;\n        var hasTime = false;\n        var hasAmpm = false;\n        var percentCount = 0;\n        var scaleCount = 0;\n        var code = '';\n        var separeThousands = false;\n        var declen = 0;\n        var intFormat = [], decFormat = [];\n        var condition = format.cond;\n        var preamble = '';\n        if (condition == 'text') {\n            preamble = 'if (typeof value == \\'string\\' || value instanceof kendo.spreadsheet.CalcError) { ';\n        } else if (condition == 'num') {\n            preamble = 'if (typeof value == \\'number\\') { ';\n        } else if (condition) {\n            var op = condition.op == '=' ? '==' : condition.op;\n            preamble = 'if (typeof value == \\'number\\' && value ' + op + ' ' + condition.value + ') { ';\n            code += 'value = Math.abs(value); ';\n        }\n        if (format.color) {\n            code += 'result.color = ' + JSON.stringify(format.color) + '; ';\n        }\n        function checkComma(a, b) {\n            if (a.type == 'digit' && b.type == 'comma' || a.type == 'comma' && a.hidden && b.type == 'comma') {\n                b.hidden = true;\n                scaleCount++;\n            }\n        }\n        while (!input.eof()) {\n            input.ahead(2, checkComma);\n            var tok = input.next();\n            if (tok.type == 'percent') {\n                percentCount++;\n            } else if (tok.type == 'digit') {\n                if (tok.decimal) {\n                    declen += tok.format.length;\n                    decFormat.push(tok.format);\n                } else {\n                    intFormat.push(tok.format);\n                    if (tok.sep) {\n                        separeThousands = true;\n                    }\n                }\n            } else if (tok.type == 'time') {\n                hasTime = true;\n            } else if (tok.type == 'date') {\n                hasDate = true;\n            } else if (tok.type == 'ampm') {\n                hasAmpm = hasTime = true;\n            }\n        }\n        if (percentCount > 0) {\n            code += 'value *= ' + Math.pow(100, percentCount) + '; ';\n        }\n        if (scaleCount > 0) {\n            code += 'value /= ' + Math.pow(1000, scaleCount) + '; ';\n        }\n        if (intFormat.length) {\n            code += 'var intPart = runtime.formatInt(culture, value, ' + JSON.stringify(intFormat) + ', ' + declen + ', ' + separeThousands + '); ';\n        }\n        if (decFormat.length) {\n            code += 'var decPart = runtime.formatDec(culture, value, ' + JSON.stringify(decFormat) + ', ' + declen + '); ';\n        }\n        if (intFormat.length || decFormat.length) {\n            code += 'type = \\'number\\'; ';\n        }\n        if (hasDate) {\n            code += 'var date = runtime.unpackDate(value); ';\n        }\n        if (hasTime) {\n            code += 'var time = runtime.unpackTime(value); ';\n        }\n        if (hasDate || hasTime) {\n            code += 'type = \\'date\\'; ';\n        }\n        if (percentCount > 0 || scaleCount > 0 || intFormat.length || decFormat.length || hasDate || hasTime) {\n            if (!preamble) {\n                preamble = 'if (typeof value == \\'number\\') { ';\n            }\n        }\n        input.restart();\n        while (!input.eof()) {\n            var tok = input.next();\n            if (tok.type == 'dec') {\n                code += 'output += culture.numberFormat[\\'.\\']; ';\n            } else if (tok.type == 'comma' && !tok.hidden) {\n                code += 'output += \\',\\'; ';\n            } else if (tok.type == 'percent') {\n                code += 'type = \\'percent\\'; ';\n                code += 'output += culture.numberFormat.percent.symbol; ';\n            } else if (tok.type == 'str') {\n                code += 'output += ' + JSON.stringify(tok.value) + '; ';\n            } else if (tok.type == 'text') {\n                code += 'type = \\'text\\'; ';\n                code += 'output += value; ';\n            } else if (tok.type == 'space') {\n                code += 'if (output) result.body.push(output); ';\n                code += 'output = \\'\\'; ';\n                code += 'result.body.push({ type: \\'space\\', value: ' + JSON.stringify(tok.value) + ' }); ';\n            } else if (tok.type == 'fill') {\n                code += 'output += runtime.fill(' + JSON.stringify(tok.value) + '); ';\n            } else if (tok.type == 'digit') {\n                code += 'output += ' + (tok.decimal ? 'decPart' : 'intPart') + '.shift(); ';\n            } else if (tok.type == 'date') {\n                code += 'output += runtime.date(culture, date, ' + JSON.stringify(tok.part) + ', ' + tok.format + '); ';\n            } else if (tok.type == 'time') {\n                code += 'output += runtime.time(culture, time, ' + JSON.stringify(tok.part) + ', ' + tok.format + ', ' + hasAmpm + '); ';\n            } else if (tok.type == 'eltime') {\n                code += 'output += runtime.eltime(culture, value, ' + JSON.stringify(tok.part) + ', ' + tok.format + '); ';\n            } else if (tok.type == 'ampm') {\n                code += 'output += time.hours < 12 ? ' + JSON.stringify(tok.am) + ' : ' + JSON.stringify(tok.pm) + '; ';\n            }\n        }\n        code += 'if (output) result.body.push(output); ';\n        code += 'result.type = type; ';\n        code += 'return result; ';\n        if (preamble) {\n            code = preamble + code + '}';\n        }\n        return code;\n    }\n    var CACHE = Object.create(null);\n    function compile(format) {\n        var f = CACHE[format];\n        if (!f) {\n            var tree = parse(format);\n            var code = tree.map(compileFormatPart).join('\\n');\n            code = '\\'use strict\\'; return function(value, culture){ ' + 'if (!culture) culture = kendo.culture(); ' + 'var output = \\'\\', type = null, result = { body: [] }; ' + code + '; return result; };';\n            f = CACHE[format] = new Function('runtime', code)(runtime);\n        }\n        return f;\n    }\n    var runtime = {\n        unpackDate: calc.runtime.unpackDate,\n        unpackTime: calc.runtime.unpackTime,\n        date: function (culture, d, part, length) {\n            switch (part) {\n            case 'd':\n                switch (length) {\n                case 1:\n                    return d.date;\n                case 2:\n                    return padLeft(d.date, 2, '0');\n                case 3:\n                    return culture.calendars.standard.days.namesAbbr[d.day];\n                case 4:\n                    return culture.calendars.standard.days.names[d.day];\n                }\n                break;\n            case 'm':\n                switch (length) {\n                case 1:\n                    return d.month + 1;\n                case 2:\n                    return padLeft(d.month + 1, 2, '0');\n                case 3:\n                    return culture.calendars.standard.months.namesAbbr[d.month];\n                case 4:\n                    return culture.calendars.standard.months.names[d.month];\n                case 5:\n                    return culture.calendars.standard.months.names[d.month].charAt(0);\n                }\n                break;\n            case 'y':\n                switch (length) {\n                case 2:\n                    return d.year % 100;\n                case 4:\n                    return d.year;\n                }\n                break;\n            }\n            return '##';\n        },\n        time: function (culture, t, part, length, ampm) {\n            switch (part) {\n            case 'h':\n                var h = ampm ? t.hours % 12 || 12 : t.hours;\n                switch (length) {\n                case 1:\n                    return h;\n                case 2:\n                    return padLeft(h, 2, '0');\n                }\n                break;\n            case 'm':\n                switch (length) {\n                case 1:\n                    return t.minutes;\n                case 2:\n                    return padLeft(t.minutes, 2, '0');\n                }\n                break;\n            case 's':\n                switch (length) {\n                case 1:\n                    return t.seconds;\n                case 2:\n                    return padLeft(t.seconds, 2, '0');\n                }\n                break;\n            }\n            return '##';\n        },\n        eltime: function (culture, value, part, length) {\n            switch (part) {\n            case 'h':\n                value = value * 24;\n                break;\n            case 'm':\n                value = value * 24 * 60;\n                break;\n            case 's':\n                value = value * 24 * 60 * 60;\n                break;\n            }\n            value |= 0;\n            switch (length) {\n            case 1:\n                return value;\n            case 2:\n                return padLeft(value, 2, '0');\n            }\n            return '##';\n        },\n        fill: function (ch) {\n            return ch;\n        },\n        formatInt: function (culture, value, parts, declen, sep) {\n            value = value.toFixed(declen).replace(/\\..*$/, '');\n            if (declen > 0) {\n                if (value === '0') {\n                    value = '';\n                } else if (value === '-0') {\n                    value = '-';\n                }\n            }\n            var iv = value.length - 1;\n            var result = [];\n            var len = 0, str;\n            function add(ch) {\n                if (sep && len && len % 3 === 0 && ch != ' ') {\n                    str = culture.numberFormat[','] + str;\n                }\n                str = ch + str;\n                len++;\n            }\n            for (var j = parts.length; --j >= 0;) {\n                var format = parts[j];\n                str = '';\n                for (var k = format.length; --k >= 0;) {\n                    var chf = format.charAt(k);\n                    if (iv < 0) {\n                        if (chf == '0') {\n                            add('0');\n                        } else if (chf == '?') {\n                            add(' ');\n                        }\n                    } else {\n                        add(value.charAt(iv--));\n                    }\n                }\n                if (j === 0) {\n                    while (iv >= 0) {\n                        add(value.charAt(iv--));\n                    }\n                }\n                result.unshift(str);\n            }\n            return result;\n        },\n        formatDec: function (culture, value, parts, declen) {\n            value = value.toFixed(declen);\n            var pos = value.indexOf('.');\n            if (pos >= 0) {\n                value = value.substr(pos + 1).replace(/0+$/, '');\n            } else {\n                value = '';\n            }\n            var iv = 0;\n            var result = [];\n            for (var j = 0; j < parts.length; ++j) {\n                var format = parts[j];\n                var str = '';\n                for (var k = 0; k < format.length; ++k) {\n                    var chf = format.charAt(k);\n                    if (iv < value.length) {\n                        str += value.charAt(iv++);\n                    } else if (chf == '0') {\n                        str += '0';\n                    } else if (chf == '?') {\n                        str += ' ';\n                    }\n                }\n                result.push(str);\n            }\n            return result;\n        }\n    };\n    function padLeft(val, width, ch) {\n        val += '';\n        while (val.length < width) {\n            val = ch + val;\n        }\n        return val;\n    }\n    function text(f) {\n        var a = f.body;\n        var text = '';\n        for (var i = 0; i < a.length; ++i) {\n            var el = a[i];\n            if (typeof el == 'string') {\n                text += el;\n            } else if (el.type == 'space') {\n                text += ' ';\n            }\n        }\n        return text;\n    }\n    kendo.spreadsheet.formatting = {\n        compile: compile,\n        parse: parse,\n        format: function (value, format, culture) {\n            var f = compile(format)(value, culture);\n            var span = dom.element('span');\n            span.__dataType = f.type;\n            var a = f.body;\n            if (f.color) {\n                span.attr.style = { color: f.color };\n            }\n            for (var i = 0; i < a.length; ++i) {\n                var el = a[i];\n                if (typeof el == 'string') {\n                    span.children.push(dom.text(el));\n                } else if (el.type == 'space') {\n                    span.children.push(dom.element('span', { style: { visibility: 'hidden' } }, [dom.text(el.value)]));\n                }\n            }\n            return span;\n        },\n        text: function (value, format, culture) {\n            var f = compile(format)(value, culture);\n            return text(f);\n        },\n        textAndColor: function (value, format, culture) {\n            var f = compile(format)(value, culture);\n            return {\n                text: text(f),\n                color: f.color,\n                type: f.type\n            };\n        },\n        type: function (value, format) {\n            return compile(format)(value).type;\n        },\n        adjustDecimals: function (format, diff) {\n            var ast = parse(format);\n            adjustDecimals(ast, diff);\n            return print(ast);\n        }\n    };\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/runtime.functions', [\n        'spreadsheet/runtime',\n        'util/main'\n    ], f);\n}(function () {\n    'use strict';\n    if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n        return;\n    }\n    var util = kendo.util;\n    var spreadsheet = kendo.spreadsheet;\n    var calc = spreadsheet.calc;\n    var runtime = calc.runtime;\n    var defineFunction = runtime.defineFunction;\n    var defineAlias = runtime.defineAlias;\n    var CalcError = runtime.CalcError;\n    var RangeRef = spreadsheet.RangeRef;\n    var CellRef = spreadsheet.CellRef;\n    var UnionRef = spreadsheet.UnionRef;\n    var Matrix = runtime.Matrix;\n    var Ref = spreadsheet.Ref;\n    var daysInMonth = runtime.daysInMonth;\n    var packDate = runtime.packDate;\n    var unpackDate = runtime.unpackDate;\n    var daysInYear = runtime.daysInYear;\n    [\n        'abs',\n        'cos',\n        'sin',\n        'acos',\n        'asin',\n        'tan',\n        'atan',\n        'exp',\n        'sqrt'\n    ].forEach(function (name) {\n        defineFunction(name, Math[name]).args([[\n                '*n',\n                'number'\n            ]]);\n    });\n    defineFunction('ln', Math.log).args([[\n            '*n',\n            'number'\n        ]]);\n    defineFunction('log', function (num, base) {\n        return Math.log(num) / Math.log(base);\n    }).args([\n        [\n            '*num',\n            'number++'\n        ],\n        [\n            '*base',\n            [\n                'or',\n                'number++',\n                [\n                    'null',\n                    10\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$base != 1',\n                'DIV/0'\n            ]\n        ]\n    ]);\n    defineFunction('log10', function (num) {\n        return Math.log(num) / Math.log(10);\n    }).args([[\n            '*num',\n            'number++'\n        ]]);\n    defineFunction('pi', function () {\n        return Math.PI;\n    }).args([]);\n    defineFunction('sqrtpi', function (n) {\n        return Math.sqrt(n * Math.PI);\n    }).args([[\n            '*num',\n            'number+'\n        ]]);\n    defineFunction('degrees', function (rad) {\n        return 180 * rad / Math.PI % 360;\n    }).args([[\n            '*radians',\n            'number'\n        ]]);\n    defineFunction('radians', function (deg) {\n        return Math.PI * deg / 180;\n    }).args([[\n            '*degrees',\n            'number'\n        ]]);\n    function _cosh(n) {\n        return (Math.exp(n) + Math.exp(-n)) / 2;\n    }\n    defineFunction('cosh', _cosh).args([[\n            '*num',\n            'number'\n        ]]);\n    defineFunction('acosh', function (n) {\n        return Math.log(n + Math.sqrt(n - 1) * Math.sqrt(n + 1));\n    }).args([\n        [\n            '*num',\n            'number'\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$num >= 1'\n            ]\n        ]\n    ]);\n    function _sinh(n) {\n        return (Math.exp(n) - Math.exp(-n)) / 2;\n    }\n    defineFunction('sinh', _sinh).args([[\n            '*num',\n            'number'\n        ]]);\n    defineFunction('asinh', function (n) {\n        return Math.log(n + Math.sqrt(n * n + 1));\n    }).args([[\n            '*num',\n            'number'\n        ]]);\n    defineFunction('sec', function (n) {\n        return 1 / Math.cos(n);\n    }).args([[\n            '*num',\n            'number'\n        ]]);\n    defineFunction('sech', function (n) {\n        return 1 / _cosh(n);\n    }).args([[\n            '*num',\n            'number'\n        ]]);\n    defineFunction('csc', function (n) {\n        return 1 / Math.sin(n);\n    }).args([[\n            '*num',\n            'number'\n        ]]);\n    defineFunction('csch', function (n) {\n        return 1 / _sinh(n);\n    }).args([[\n            '*num',\n            'number'\n        ]]);\n    defineFunction('atan2', function (x, y) {\n        return Math.atan(y / x);\n    }).args([\n        [\n            '*x',\n            'divisor'\n        ],\n        [\n            '*y',\n            'number'\n        ]\n    ]);\n    function _tanh(n) {\n        return _sinh(n) / _cosh(n);\n    }\n    defineFunction('tanh', _tanh).args([[\n            '*num',\n            'number'\n        ]]);\n    defineFunction('atanh', function (n) {\n        return Math.log(Math.sqrt(1 - n * n) / (1 - n));\n    }).args([[\n            '*num',\n            [\n                'and',\n                'number',\n                [\n                    '(between)',\n                    -1,\n                    1\n                ]\n            ]\n        ]]);\n    defineFunction('cot', function (n) {\n        return 1 / Math.tan(n);\n    }).args([[\n            '*num',\n            'divisor'\n        ]]);\n    defineFunction('coth', function (n) {\n        return 1 / _tanh(n);\n    }).args([[\n            '*num',\n            'divisor'\n        ]]);\n    defineFunction('acot', function (n) {\n        return Math.PI / 2 - Math.atan(n);\n    }).args([[\n            '*num',\n            'number'\n        ]]);\n    defineFunction('acoth', function (n) {\n        return Math.log((n + 1) / (n - 1)) / 2;\n    }).args([\n        [\n            '*num',\n            'number'\n        ],\n        [\n            '?',\n            [\n                'or',\n                [\n                    'assert',\n                    '$num < -1'\n                ],\n                [\n                    'assert',\n                    '$num > 1'\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('power', function (a, b) {\n        return Math.pow(a, b);\n    }).args([\n        [\n            '*a',\n            'number'\n        ],\n        [\n            '*b',\n            'number'\n        ]\n    ]);\n    defineFunction('mod', function (a, b) {\n        return a % b;\n    }).args([\n        [\n            '*a',\n            'number'\n        ],\n        [\n            '*b',\n            'divisor'\n        ]\n    ]);\n    defineFunction('quotient', function (a, b) {\n        return Math.floor(a / b);\n    }).args([\n        [\n            '*a',\n            'number'\n        ],\n        [\n            '*b',\n            'divisor'\n        ]\n    ]);\n    defineFunction('ceiling', function (num, s) {\n        return s ? s * Math.ceil(num / s) : 0;\n    }).args([\n        [\n            '*number',\n            'number'\n        ],\n        [\n            '*significance',\n            'number'\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$significance >= 0 || $number < 0'\n            ]\n        ]\n    ]);\n    defineFunction('ceiling.precise', function (num, s) {\n        s = Math.abs(s);\n        return s ? s * Math.ceil(num / s) : 0;\n    }).args([\n        [\n            '*number',\n            'number'\n        ],\n        [\n            '*significance',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    1\n                ]\n            ]\n        ]\n    ]);\n    defineAlias('iso.ceiling', 'ceiling.precise');\n    defineFunction('ceiling.math', function (num, s, mode) {\n        if (!s || !num) {\n            return 0;\n        }\n        if (num < 0 && (!mode && s < 0 || mode && s > 0)) {\n            s = -s;\n        }\n        return s ? s * Math.ceil(num / s) : 0;\n    }).args([\n        [\n            '*number',\n            'number'\n        ],\n        [\n            '*significance',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    '$number < 0 ? -1 : 1'\n                ]\n            ]\n        ],\n        [\n            '*mode',\n            [\n                'or',\n                'logical',\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('floor', function (num, s) {\n        return s ? s * Math.floor(num / s) : 0;\n    }).args([\n        [\n            '*number',\n            'number'\n        ],\n        [\n            '*significance',\n            'number'\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$significance >= 0 || $number < 0'\n            ]\n        ]\n    ]);\n    defineFunction('floor.precise', function (num, s) {\n        s = Math.abs(s);\n        return s ? s * Math.floor(num / s) : 0;\n    }).args([\n        [\n            '*number',\n            'number'\n        ],\n        [\n            '*significance',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    1\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('floor.math', function (num, s, mode) {\n        if (!s || !num) {\n            return 0;\n        }\n        if (num < 0 && (!mode && s < 0 || mode && s > 0)) {\n            s = -s;\n        }\n        return s ? s * Math.floor(num / s) : 0;\n    }).args([\n        [\n            '*number',\n            'number'\n        ],\n        [\n            '*significance',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    '$number < 0 ? -1 : 1'\n                ]\n            ]\n        ],\n        [\n            '*mode',\n            [\n                'or',\n                'logical',\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('int', Math.floor).args([[\n            '*number',\n            'number'\n        ]]);\n    defineFunction('mround', function (num, mult) {\n        return mult ? mult * Math.round(num / mult) : 0;\n    }).args([\n        [\n            '*number',\n            'number'\n        ],\n        [\n            '*multiple',\n            'number'\n        ]\n    ]);\n    defineFunction('round', function (num, digits) {\n        var sign = num < 0 ? -1 : 1;\n        if (sign < 0) {\n            num = -num;\n        }\n        digits = Math.pow(10, digits);\n        num *= digits;\n        num = Math.round(num);\n        return sign * num / digits;\n    }).args([\n        [\n            '*number',\n            'number'\n        ],\n        [\n            '*digits',\n            'number'\n        ]\n    ]);\n    defineFunction('roundup', function (num, digits) {\n        digits = Math.pow(10, digits);\n        num *= digits;\n        num = num < 0 ? Math.floor(num) : Math.ceil(num);\n        return num / digits;\n    }).args([\n        [\n            '*number',\n            'number'\n        ],\n        [\n            '*digits',\n            'number'\n        ]\n    ]);\n    defineFunction('rounddown', function (num, digits) {\n        digits = Math.pow(10, digits);\n        num *= digits;\n        num = num < 0 ? Math.ceil(num) : Math.floor(num);\n        return num / digits;\n    }).args([\n        [\n            '*number',\n            'number'\n        ],\n        [\n            '*digits',\n            'number'\n        ]\n    ]);\n    defineFunction('even', function (num) {\n        var n = num < 0 ? Math.floor(num) : Math.ceil(num);\n        return n % 2 ? n + (n < 0 ? -1 : 1) : n;\n    }).args([[\n            '*number',\n            'number'\n        ]]);\n    defineFunction('odd', function (num) {\n        var n = num < 0 ? Math.floor(num) : Math.ceil(num);\n        return n % 2 ? n : n + (n < 0 ? -1 : 1);\n    }).args([[\n            '*number',\n            'number'\n        ]]);\n    defineFunction('sign', function (num) {\n        return num < 0 ? -1 : num > 0 ? 1 : 0;\n    }).args([[\n            '*number',\n            'number'\n        ]]);\n    function _gcd(a, b) {\n        while (b) {\n            var r = a % b;\n            a = b;\n            b = r;\n        }\n        return a;\n    }\n    function _lcm(a, b) {\n        return Math.abs(a * b) / _gcd(a, b);\n    }\n    defineFunction('gcd', function (args) {\n        var a = args[0];\n        for (var i = 1; i < args.length; ++i) {\n            a = _gcd(a, args[i]);\n        }\n        return a;\n    }).args([[\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ]]);\n    defineFunction('lcm', function (args) {\n        var a = args[0];\n        for (var i = 1; i < args.length; ++i) {\n            a = _lcm(a, args[i]);\n        }\n        return a;\n    }).args([[\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ]]);\n    defineFunction('sum', function (numbers) {\n        return numbers.reduce(function (sum, num) {\n            return sum + num;\n        }, 0);\n    }).args([[\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ]]);\n    defineFunction('product', function (numbers) {\n        return numbers.reduce(function (prod, num) {\n            return prod * num;\n        }, 1);\n    }).args([[\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ]]);\n    defineFunction('sumproduct', function (a) {\n        var sum = 0;\n        a[0].each(function (p, row, col) {\n            if (typeof p == 'number') {\n                for (var i = 1; i < a.length; ++i) {\n                    var v = a[i].get(row, col);\n                    if (typeof v != 'number') {\n                        return;\n                    }\n                    p *= v;\n                }\n                sum += p;\n            }\n        });\n        return sum;\n    }).args([\n        [\n            'a1',\n            'matrix'\n        ],\n        [\n            '+',\n            [\n                'a2',\n                [\n                    'and',\n                    'matrix',\n                    [\n                        'assert',\n                        '$a2.width == $a1.width'\n                    ],\n                    [\n                        'assert',\n                        '$a2.height == $a1.height'\n                    ]\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('sumsq', function (numbers) {\n        return numbers.reduce(function (sum, num) {\n            return sum + num * num;\n        }, 0);\n    }).args([[\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ]]);\n    defineFunction('sumx2my2', function (a, b) {\n        var sum = 0;\n        a.each(function (x, row, col) {\n            var y = b.get(row, col);\n            if (typeof x == 'number' && typeof y == 'number') {\n                sum += x * x - y * y;\n            }\n        });\n        return sum;\n    }).args([\n        [\n            'a',\n            'matrix'\n        ],\n        [\n            'b',\n            [\n                'and',\n                'matrix',\n                [\n                    'assert',\n                    '$b.width == $a.width'\n                ],\n                [\n                    'assert',\n                    '$b.height == $a.height'\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('sumx2py2', function (a, b) {\n        var sum = 0;\n        a.each(function (x, row, col) {\n            var y = b.get(row, col);\n            if (typeof x == 'number' && typeof y == 'number') {\n                sum += x * x + y * y;\n            }\n        });\n        return sum;\n    }).args([\n        [\n            'a',\n            'matrix'\n        ],\n        [\n            'b',\n            [\n                'and',\n                'matrix',\n                [\n                    'assert',\n                    '$b.width == $a.width'\n                ],\n                [\n                    'assert',\n                    '$b.height == $a.height'\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('sumxmy2', function (a, b) {\n        var sum = 0;\n        a.each(function (x, row, col) {\n            var y = b.get(row, col);\n            if (typeof x == 'number' && typeof y == 'number') {\n                sum += (x - y) * (x - y);\n            }\n        });\n        return sum;\n    }).args([\n        [\n            'a',\n            'matrix'\n        ],\n        [\n            'b',\n            [\n                'and',\n                'matrix',\n                [\n                    'assert',\n                    '$b.width == $a.width'\n                ],\n                [\n                    'assert',\n                    '$b.height == $a.height'\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('seriessum', function (x, n, m, a) {\n        var sum = 0;\n        a.each(function (coef) {\n            if (typeof coef != 'number') {\n                throw new CalcError('VALUE');\n            }\n            sum += coef * Math.pow(x, n);\n            n += m;\n        });\n        return sum;\n    }).args([\n        [\n            'x',\n            'number'\n        ],\n        [\n            'y',\n            'number'\n        ],\n        [\n            'm',\n            'number'\n        ],\n        [\n            'a',\n            'matrix'\n        ]\n    ]);\n    defineFunction('min', function (numbers) {\n        return Math.min.apply(Math, numbers);\n    }).args([\n        [\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$numbers.length > 0',\n                'N/A'\n            ]\n        ]\n    ]);\n    defineFunction('max', function (numbers) {\n        return Math.max.apply(Math, numbers);\n    }).args([\n        [\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$numbers.length > 0',\n                'N/A'\n            ]\n        ]\n    ]);\n    defineFunction('counta', function (values) {\n        return values.length;\n    }).args([[\n            'values',\n            [\n                '#collect',\n                'anyvalue'\n            ]\n        ]]);\n    defineFunction('count', function (numbers) {\n        return numbers.length;\n    }).args([[\n            'numbers',\n            [\n                '#collect',\n                'number'\n            ]\n        ]]);\n    defineFunction('countunique', function (values) {\n        var count = 0, seen = [];\n        values.forEach(function (val) {\n            if (seen.indexOf(val) < 0) {\n                count++;\n                seen.push(val);\n            }\n        });\n        return count;\n    }).args([[\n            'values',\n            [\n                '#collect',\n                'anyvalue'\n            ]\n        ]]);\n    defineFunction('countblank', function (a) {\n        var count = 0;\n        function add(val) {\n            if (val == null || val === '') {\n                count++;\n            }\n        }\n        function loop(args) {\n            for (var i = 0; i < args.length; ++i) {\n                var x = args[i];\n                if (x instanceof Matrix) {\n                    x.each(add, true);\n                } else {\n                    add(x);\n                }\n            }\n        }\n        loop(a);\n        return count;\n    }).args([[\n            '+',\n            [\n                'args',\n                [\n                    'or',\n                    'matrix',\n                    'anyvalue'\n                ]\n            ]\n        ]]);\n    defineFunction('iseven', function (num) {\n        return num % 2 === 0;\n    }).args([[\n            '*number',\n            'number'\n        ]]);\n    defineFunction('isodd', function (num) {\n        return num % 2 !== 0;\n    }).args([[\n            '*number',\n            'number'\n        ]]);\n    defineFunction('n', function (val) {\n        if (typeof val == 'boolean') {\n            return val ? 1 : 0;\n        }\n        if (typeof val == 'number') {\n            return val;\n        }\n        return 0;\n    }).args([[\n            '*value',\n            'anyvalue'\n        ]]);\n    defineFunction('na', function () {\n        return new CalcError('N/A');\n    }).args([]);\n    function forIFS(args, f) {\n        var chunks = [], i = 0, matrix = args[0];\n        while (i < args.length) {\n            chunks.push({\n                matrix: args[i++],\n                pred: parseCriteria(args[i++])\n            });\n        }\n        ROW:\n            for (var row = 0; row < matrix.height; ++row) {\n                COL:\n                    for (var col = 0; col < matrix.width; ++col) {\n                        for (i = 0; i < chunks.length; ++i) {\n                            var val = chunks[i].matrix.get(row, col);\n                            if (!chunks[i].pred(val == null || val === '' ? 0 : val)) {\n                                continue COL;\n                            }\n                        }\n                        f(row, col);\n                    }\n            }\n    }\n    var ARGS_COUNTIFS = [\n        [\n            'm1',\n            'matrix'\n        ],\n        [\n            'c1',\n            'anyvalue'\n        ],\n        [\n            [\n                'm2',\n                [\n                    'and',\n                    'matrix',\n                    [\n                        'assert',\n                        '$m1.width == $m2.width'\n                    ],\n                    [\n                        'assert',\n                        '$m1.height == $m2.height'\n                    ]\n                ]\n            ],\n            [\n                'c2',\n                'anyvalue'\n            ]\n        ]\n    ];\n    defineFunction('countifs', function (m1, c1, rest) {\n        var count = 0;\n        rest.unshift(m1, c1);\n        forIFS(rest, function () {\n            count++;\n        });\n        return count;\n    }).args(ARGS_COUNTIFS);\n    var ARGS_SUMIFS = [[\n            'range',\n            'matrix'\n        ]].concat(ARGS_COUNTIFS);\n    defineFunction('sumifs', function (range, m1, c1, args) {\n        args.unshift(range, numericPredicate, m1, c1);\n        var sum = 0;\n        forIFS(args, function (row, col) {\n            var val = range.get(row, col);\n            if (val) {\n                sum += val;\n            }\n        });\n        return sum;\n    }).args(ARGS_SUMIFS);\n    defineFunction('averageifs', function (range, m1, c1, args) {\n        args.unshift(range, numericPredicate, m1, c1);\n        var sum = 0, count = 0;\n        forIFS(args, function (row, col) {\n            var val = range.get(row, col);\n            if (val == null || val === '') {\n                val = 0;\n            }\n            sum += val;\n            count++;\n        });\n        return count ? sum / count : new CalcError('DIV/0');\n    }).args(ARGS_SUMIFS);\n    defineFunction('countif', function (matrix, criteria) {\n        criteria = parseCriteria(criteria);\n        var count = 0;\n        matrix.each(function (val) {\n            if (criteria(val)) {\n                count++;\n            }\n        });\n        return count;\n    }).args([\n        [\n            'range',\n            'matrix'\n        ],\n        [\n            '*criteria',\n            'anyvalue'\n        ]\n    ]);\n    var ARGS_SUMIF = [\n        [\n            'range',\n            'matrix'\n        ],\n        [\n            '*criteria',\n            'anyvalue'\n        ],\n        [\n            'sumRange',\n            [\n                'or',\n                [\n                    'and',\n                    'matrix',\n                    [\n                        'assert',\n                        '$sumRange.width == $range.width'\n                    ],\n                    [\n                        'assert',\n                        '$sumRange.height == $range.height'\n                    ]\n                ],\n                [\n                    'null',\n                    '$range'\n                ]\n            ]\n        ]\n    ];\n    defineFunction('sumif', function (range, criteria, sumRange) {\n        var sum = 0;\n        criteria = parseCriteria(criteria);\n        range.each(function (val, row, col) {\n            if (criteria(val)) {\n                var v = sumRange.get(row, col);\n                if (numericPredicate(v)) {\n                    sum += v || 0;\n                }\n            }\n        });\n        return sum;\n    }).args(ARGS_SUMIF);\n    defineFunction('averageif', function (range, criteria, sumRange) {\n        var sum = 0, count = 0;\n        criteria = parseCriteria(criteria);\n        range.each(function (val, row, col) {\n            if (criteria(val)) {\n                var v = sumRange.get(row, col);\n                if (numericPredicate(v)) {\n                    sum += v || 0;\n                    count++;\n                }\n            }\n        });\n        return count ? sum / count : new CalcError('DIV/0');\n    }).args(ARGS_SUMIF);\n    (function (def) {\n        def('large', function (numbers, nth) {\n            return numbers.sort(descending)[nth];\n        });\n        def('small', function (numbers, nth) {\n            return numbers.sort(ascending)[nth];\n        });\n    }(function (name, handler) {\n        defineFunction(name, function (matrix, nth) {\n            var numbers = [];\n            var error = matrix.each(function (val) {\n                if (val instanceof CalcError) {\n                    return val;\n                }\n                if (typeof val == 'number') {\n                    numbers.push(val);\n                }\n            });\n            if (error) {\n                return error;\n            }\n            if (nth > numbers.length) {\n                return new CalcError('NUM');\n            }\n            return handler(numbers, nth - 1);\n        }).args([\n            [\n                'array',\n                'matrix'\n            ],\n            [\n                '*nth',\n                'number++'\n            ]\n        ]);\n    }));\n    function _avg(numbers) {\n        return numbers.reduce(function (sum, num) {\n            return sum + num;\n        }, 0) / numbers.length;\n    }\n    function _var_sp(numbers, divisor, avg) {\n        if (avg == null) {\n            avg = _avg(numbers);\n        }\n        return numbers.reduce(function (sum, num) {\n            return sum + Math.pow(num - avg, 2);\n        }, 0) / divisor;\n    }\n    function _stdev_sp(numbers, divisor) {\n        return Math.sqrt(_var_sp(numbers, divisor));\n    }\n    defineFunction('stdev.s', function (numbers) {\n        return _stdev_sp(numbers, numbers.length - 1);\n    }).args([\n        [\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$numbers.length >= 2',\n                'NUM'\n            ]\n        ]\n    ]);\n    defineFunction('stdev.p', function (numbers) {\n        return _stdev_sp(numbers, numbers.length);\n    }).args([\n        [\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$numbers.length >= 2',\n                'NUM'\n            ]\n        ]\n    ]);\n    defineFunction('var.s', function (numbers) {\n        return _var_sp(numbers, numbers.length - 1);\n    }).args([\n        [\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$numbers.length >= 2',\n                'NUM'\n            ]\n        ]\n    ]);\n    defineFunction('var.p', function (numbers) {\n        return _var_sp(numbers, numbers.length);\n    }).args([\n        [\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$numbers.length >= 2',\n                'NUM'\n            ]\n        ]\n    ]);\n    defineFunction('median', function (numbers) {\n        var n = numbers.length;\n        numbers.sort(ascending);\n        if (n % 2) {\n            return numbers[n >> 1];\n        }\n        return (numbers[n >> 1] + numbers[n >> 1 + 1]) / 2;\n    }).args([\n        [\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$numbers.length > 0',\n                'N/A'\n            ]\n        ]\n    ]);\n    defineFunction('mode.sngl', function (numbers) {\n        numbers.sort(ascending);\n        var prev = null, count = 0, max = 1, mode = null;\n        for (var i = 0; i < numbers.length; ++i) {\n            var n = numbers[i];\n            if (n != prev) {\n                count = 1;\n                prev = n;\n            } else {\n                count++;\n            }\n            if (count > max) {\n                max = count;\n                mode = n;\n            }\n        }\n        return mode == null ? new CalcError('N/A') : mode;\n    }).args([[\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ]]);\n    defineFunction('mode.mult', function (numbers) {\n        var seen = Object.create(null), max = 2, res = [];\n        numbers.forEach(function (num) {\n            var s = seen[num] || 0;\n            seen[num] = ++s;\n            if (s == max) {\n                res.push(num);\n            } else if (s > max) {\n                max = s;\n                res = [num];\n            }\n        });\n        var m = new Matrix(this);\n        res.forEach(function (num, i) {\n            m.set(i, 0, num);\n        });\n        return m;\n    }).args([[\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ]]);\n    defineFunction('geomean', function (numbers) {\n        var n = numbers.length;\n        var p = numbers.reduce(function (p, num) {\n            if (num < 0) {\n                throw new CalcError('NUM');\n            }\n            return p * num;\n        }, 1);\n        return Math.pow(p, 1 / n);\n    }).args([\n        [\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$numbers.length > 0',\n                'NUM'\n            ]\n        ]\n    ]);\n    defineFunction('harmean', function (numbers) {\n        var n = numbers.length;\n        var s = numbers.reduce(function (s, num) {\n            if (!num) {\n                throw new CalcError('DIV/0');\n            }\n            return s + 1 / num;\n        }, 0);\n        return n / s;\n    }).args([\n        [\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$numbers.length > 0',\n                'NUM'\n            ]\n        ]\n    ]);\n    defineFunction('trimmean', function (numbers, p) {\n        var n = numbers.length;\n        numbers.sort(ascending);\n        var discard = Math.floor(n * p);\n        if (discard % 2) {\n            --discard;\n        }\n        discard /= 2;\n        var sum = 0;\n        for (var i = discard; i < n - discard; ++i) {\n            sum += numbers[i];\n        }\n        return sum / (n - discard * 2);\n    }).args([\n        [\n            'numbers',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'percent',\n            [\n                'and',\n                'number',\n                [\n                    '[between)',\n                    0,\n                    1\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$numbers.length > 0',\n                'NUM'\n            ]\n        ]\n    ]);\n    defineFunction('frequency', function (data, bins) {\n        data.sort(ascending);\n        bins.sort(ascending);\n        var prev = -Infinity;\n        var i = 0;\n        function count(max) {\n            var n = 0;\n            while (i < data.length && data[i] > prev && data[i] <= max) {\n                ++n;\n                ++i;\n            }\n            return n;\n        }\n        var m = new Matrix(this);\n        bins.forEach(function (val, i) {\n            var n = count(val);\n            prev = val;\n            m.set(i, 0, n);\n        });\n        m.set(m.height, 0, data.length - i);\n        return m;\n    }).args([\n        [\n            'data',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'bins',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ]\n    ]);\n    defineFunction('rank.eq', function (val, numbers, asc) {\n        numbers.sort(asc ? ascending : descending);\n        var pos = numbers.indexOf(val);\n        return pos < 0 ? new CalcError('N/A') : pos + 1;\n    }).args([\n        [\n            'value',\n            'number'\n        ],\n        [\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ],\n        [\n            'order',\n            [\n                'or',\n                'logical',\n                [\n                    'null',\n                    false\n                ]\n            ]\n        ]\n    ]);\n    defineAlias('rank', 'rank.eq');\n    defineFunction('rank.avg', function (val, numbers, asc) {\n        numbers.sort(asc ? ascending : descending);\n        var pos = numbers.indexOf(val);\n        if (pos < 0) {\n            return new CalcError('N/A');\n        }\n        for (var i = pos; numbers[i] == val; ++i) {\n        }\n        return (pos + i + 1) / 2;\n    }).args([\n        [\n            'value',\n            'number'\n        ],\n        [\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ],\n        [\n            'order',\n            [\n                'or',\n                'logical',\n                [\n                    'null',\n                    false\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('kurt', function (numbers) {\n        var n = numbers.length;\n        var avg = _avg(numbers);\n        var variance = _var_sp(numbers, n - 1, avg);\n        var stddev = Math.sqrt(variance);\n        var sum = numbers.reduce(function (sum, num) {\n            return sum + Math.pow((num - avg) / stddev, 4);\n        }, 0);\n        return n * (n + 1) / ((n - 1) * (n - 2) * (n - 3)) * sum - 3 * Math.pow(n - 1, 2) / ((n - 2) * (n - 3));\n    }).args([\n        [\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$numbers.length >= 4',\n                'NUM'\n            ]\n        ]\n    ]);\n    function _percentrank(numbers, x, exc) {\n        var nlt = 0, ngt = 0, left = null, right = null, found = false;\n        numbers.forEach(function (num) {\n            if (num < x) {\n                nlt++;\n                left = left == null ? num : Math.max(left, num);\n            } else if (num > x) {\n                ngt++;\n                right = right == null ? num : Math.min(right, num);\n            } else {\n                found = true;\n            }\n        });\n        if (!nlt && !ngt) {\n            return new CalcError('N/A');\n        }\n        if (found) {\n            if (exc) {\n                return (nlt + 1) / (numbers.length + 1);\n            }\n            return nlt / (nlt + ngt);\n        }\n        return ((right - x) * _percentrank(numbers, left, exc) + (x - left) * _percentrank(numbers, right, exc)) / (right - left);\n    }\n    var ARGS_PERCENTRANK = [\n        [\n            'array',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'x',\n            'number'\n        ],\n        [\n            'significance',\n            [\n                'or',\n                [\n                    'null',\n                    3\n                ],\n                'integer++'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$array.length > 0',\n                'NUM'\n            ]\n        ]\n    ];\n    defineFunction('percentrank.inc', function (numbers, x, significance) {\n        var p = _percentrank(numbers, x, 0);\n        p = p.toFixed(significance + 1);\n        return parseFloat(p.substr(0, p.length - 1));\n    }).args(ARGS_PERCENTRANK);\n    defineFunction('percentrank.exc', function (numbers, x, significance) {\n        var p = _percentrank(numbers, x, 1);\n        p = p.toFixed(significance + 1);\n        return parseFloat(p.substr(0, p.length - 1));\n    }).args(ARGS_PERCENTRANK);\n    defineAlias('percentrank', 'percentrank.inc');\n    function _covariance(x, y, divisor) {\n        var sum = 0;\n        var ax = _avg(x);\n        var ay = _avg(y);\n        var n = x.length;\n        for (var i = 0; i < n; ++i) {\n            sum += (x[i] - ax) * (y[i] - ay);\n        }\n        return sum / divisor;\n    }\n    defineFunction('covariance.p', function (x, y) {\n        return _covariance(x, y, x.length);\n    }).args([\n        [\n            'array1',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'array2',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$array1.length == $array2.length',\n                'N/A'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$array1.length > 0',\n                'DIV/0'\n            ]\n        ]\n    ]);\n    defineFunction('covariance.s', function (x, y) {\n        return _covariance(x, y, x.length - 1);\n    }).args([\n        [\n            'array1',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'array2',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$array1.length == $array2.length',\n                'N/A'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$array1.length > 1',\n                'DIV/0'\n            ]\n        ]\n    ]);\n    defineAlias('covar', 'covariance.p');\n    var _fact = util.memoize(function (n) {\n        for (var i = 2, fact = 1; i <= n; ++i) {\n            fact *= i;\n        }\n        return fact;\n    });\n    defineFunction('fact', _fact).args([[\n            '*n',\n            'integer+'\n        ]]);\n    defineFunction('factdouble', function (n) {\n        for (var i = 2 + (n & 1), fact = 1; i <= n; i += 2) {\n            fact *= i;\n        }\n        return fact;\n    }).args([[\n            '*n',\n            'integer+'\n        ]]);\n    defineFunction('multinomial', function (numbers) {\n        var div = 1, sum = 0;\n        numbers.forEach(function (n) {\n            if (n < 0) {\n                throw new CalcError('NUM');\n            }\n            sum += n;\n            div *= _fact(n);\n        });\n        return _fact(sum) / div;\n    }).args([[\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ]]);\n    var _combinations = util.memoize(function (n, k) {\n        for (var f1 = k + 1, f2 = 1, p1 = 1, p2 = 1; f2 <= n - k; ++f1, ++f2) {\n            p1 *= f1;\n            p2 *= f2;\n        }\n        return p1 / p2;\n    });\n    defineFunction('combin', _combinations).args([\n        [\n            '*n',\n            'integer++'\n        ],\n        [\n            '*k',\n            [\n                'and',\n                'integer',\n                [\n                    '[between]',\n                    0,\n                    '$n'\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('combina', function (n, k) {\n        return _combinations(n + k - 1, n - 1);\n    }).args([\n        [\n            '*n',\n            'integer++'\n        ],\n        [\n            '*k',\n            [\n                'and',\n                'integer',\n                [\n                    '[between]',\n                    1,\n                    '$n'\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('average', function (numbers) {\n        var sum = numbers.reduce(function (sum, num) {\n            return sum + num;\n        }, 0);\n        return sum / numbers.length;\n    }).args([\n        [\n            'numbers',\n            [\n                'collect',\n                [\n                    'and',\n                    'number',\n                    [\n                        'not',\n                        'boolean'\n                    ]\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$numbers.length > 0',\n                'DIV/0'\n            ]\n        ]\n    ]);\n    defineFunction('averagea', function (values) {\n        var sum = 0, count = 0;\n        values.forEach(function (num) {\n            if (typeof num != 'string') {\n                sum += num;\n            }\n            ++count;\n        });\n        return count ? sum / count : new CalcError('DIV/0');\n    }).args([[\n            'values',\n            [\n                'collect',\n                'anyvalue'\n            ]\n        ]]);\n    function _percentile(numbers, rank) {\n        numbers.sort(ascending);\n        var n = numbers.length;\n        var k = rank | 0, d = rank - k;\n        if (k === 0) {\n            return numbers[0];\n        }\n        if (k >= n) {\n            return numbers[n - 1];\n        }\n        --k;\n        return numbers[k] + d * (numbers[k + 1] - numbers[k]);\n    }\n    function _percentile_inc(numbers, p) {\n        var rank = p * (numbers.length - 1) + 1;\n        return _percentile(numbers, rank);\n    }\n    function _percentile_exc(numbers, p) {\n        var rank = p * (numbers.length + 1);\n        return _percentile(numbers, rank);\n    }\n    defineFunction('percentile.inc', _percentile_inc).args([\n        [\n            'numbers',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'p',\n            [\n                'and',\n                'number',\n                [\n                    '[between]',\n                    0,\n                    1\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('percentile.exc', _percentile_exc).args([\n        [\n            'numbers',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'p',\n            [\n                'and',\n                'number',\n                [\n                    '(between)',\n                    0,\n                    1\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('quartile.inc', function (numbers, quarter) {\n        return _percentile_inc(numbers, quarter / 4);\n    }).args([\n        [\n            'numbers',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'quarter',\n            [\n                'values',\n                0,\n                1,\n                2,\n                3,\n                4\n            ]\n        ]\n    ]);\n    defineFunction('quartile.exc', function (numbers, quarter) {\n        return _percentile_exc(numbers, quarter / 4);\n    }).args([\n        [\n            'numbers',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'quarter',\n            [\n                'values',\n                0,\n                1,\n                2,\n                3,\n                4\n            ]\n        ]\n    ]);\n    defineAlias('quartile', 'quartile.inc');\n    defineAlias('percentile', 'percentile.inc');\n    var AGGREGATE_FUNCS = [\n        'AVERAGE',\n        'COUNT',\n        'COUNTA',\n        'MAX',\n        'MIN',\n        'PRODUCT',\n        'STDEV.S',\n        'STDEV.P',\n        'SUM',\n        'VAR.S',\n        'VAR.P',\n        'MEDIAN',\n        'MODE.SNGL',\n        'LARGE',\n        'SMALL',\n        'PERCENTILE.INC',\n        'QUARTILE.INC',\n        'PERCENTILE.EXC',\n        'QUARTILE.EXC'\n    ];\n    function fetchValuesForAggregate(self, args, options) {\n        var values = [];\n        var opt_ignore_hidden_rows = 1;\n        var opt_ignore_errors = 2;\n        var opt_use_aggregates = 4;\n        (function fetchValues(args) {\n            if (args instanceof Ref) {\n                self.getRefCells(args, true).forEach(function (cell) {\n                    var value = cell.value;\n                    if (options & opt_ignore_hidden_rows && cell.hidden) {\n                        return;\n                    }\n                    if (cell.formula) {\n                        var str = cell.formula.print(cell.row, cell.col);\n                        if (/^\\s*(?:aggregate|subtotal)\\s*\\(/i.test(str)) {\n                            if (!(options & opt_use_aggregates)) {\n                                return;\n                            }\n                        }\n                        if ('value' in cell.formula) {\n                            value = cell.formula.value;\n                        }\n                    }\n                    if (options & opt_ignore_errors && value instanceof CalcError) {\n                        return;\n                    }\n                    if (typeof value == 'number' || value instanceof CalcError) {\n                        values.push(value);\n                    }\n                });\n            } else if (Array.isArray(args)) {\n                for (var i = 0; i < args.length; ++i) {\n                    fetchValues(args[i]);\n                }\n            } else if (args instanceof Matrix) {\n                args.each(fetchValues);\n            } else if (typeof args == 'number') {\n                values.push(args);\n            } else if (args instanceof CalcError && !(options & opt_ignore_errors)) {\n                values.push(args);\n            }\n        }(args));\n        return values;\n    }\n    defineFunction('aggregate', function (callback, funcId, options, args) {\n        var self = this;\n        self.resolveCells(args, function () {\n            var values;\n            if (funcId > 12) {\n                values = fetchValuesForAggregate(self, args[0], options);\n                var k = args[1];\n                if (k instanceof CellRef) {\n                    k = self.getRefData(k);\n                }\n                if (typeof k != 'number') {\n                    return callback(new CalcError('VALUE'));\n                }\n            } else {\n                values = fetchValuesForAggregate(self, args, options);\n            }\n            self.func(AGGREGATE_FUNCS[funcId - 1], callback, values);\n        });\n    }).argsAsync([\n        [\n            'funcId',\n            [\n                'values',\n                1,\n                2,\n                3,\n                4,\n                5,\n                6,\n                7,\n                8,\n                9,\n                10,\n                11,\n                12,\n                13,\n                14,\n                15,\n                16,\n                17,\n                18,\n                19\n            ]\n        ],\n        [\n            'options',\n            [\n                'or',\n                [\n                    'null',\n                    0\n                ],\n                [\n                    'values',\n                    0,\n                    1,\n                    2,\n                    3,\n                    4,\n                    5,\n                    6,\n                    7\n                ]\n            ]\n        ],\n        [\n            'args',\n            'rest'\n        ]\n    ]);\n    defineFunction('subtotal', function (callback, funcId) {\n        var self = this;\n        var ignoreHidden = funcId > 100;\n        if (ignoreHidden) {\n            funcId -= 100;\n        }\n        var args = [];\n        for (var i = 2; i < arguments.length; ++i) {\n            args.push(arguments[i]);\n        }\n        self.resolveCells(args, function () {\n            var values = fetchValuesForAggregate(self, args, ignoreHidden ? 1 : 0);\n            self.func(AGGREGATE_FUNCS[funcId - 1], callback, values);\n        });\n    }).argsAsync([\n        [\n            'funcId',\n            [\n                'values',\n                1,\n                2,\n                3,\n                4,\n                5,\n                6,\n                7,\n                8,\n                9,\n                10,\n                11,\n                101,\n                102,\n                103,\n                104,\n                105,\n                106,\n                107,\n                108,\n                109,\n                110,\n                111\n            ]\n        ],\n        [\n            '+',\n            [\n                'ref',\n                [\n                    'or',\n                    'ref',\n                    '#matrix'\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('avedev', function (numbers) {\n        var avg = numbers.reduce(function (sum, num) {\n            return sum + num;\n        }, 0) / numbers.length;\n        return numbers.reduce(function (sum, num) {\n            return sum + Math.abs(num - avg);\n        }, 0) / numbers.length;\n    }).args([\n        [\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$numbers.length >= 2',\n                'NUM'\n            ]\n        ]\n    ]);\n    function _binom_dist(x, n, p, cumulative) {\n        if (!cumulative) {\n            return _combinations(n, x) * Math.pow(p, x) * Math.pow(1 - p, n - x);\n        } else {\n            var sum = 0;\n            for (var j = 0; j <= x; ++j) {\n                sum += _combinations(n, j) * Math.pow(p, j) * Math.pow(1 - p, n - j);\n            }\n            return sum;\n        }\n    }\n    defineFunction('binom.dist', _binom_dist).args([\n        [\n            'successes',\n            'integer+'\n        ],\n        [\n            'trials',\n            [\n                'and',\n                'integer',\n                [\n                    'assert',\n                    '$trials >= $successes'\n                ]\n            ]\n        ],\n        [\n            'probability',\n            [\n                'and',\n                'number',\n                [\n                    '[between]',\n                    0,\n                    1\n                ]\n            ]\n        ],\n        [\n            'cumulative',\n            'logical'\n        ]\n    ]);\n    defineAlias('binomdist', 'binom.dist');\n    defineFunction('binom.inv', function (n, p, alpha) {\n        for (var x = 0; x <= n; ++x) {\n            if (_binom_dist(x, n, p, true) >= alpha) {\n                return x;\n            }\n        }\n        return new CalcError('N/A');\n    }).args([\n        [\n            'trials',\n            'integer+'\n        ],\n        [\n            'probability',\n            [\n                'and',\n                'number',\n                [\n                    '[between]',\n                    0,\n                    1\n                ]\n            ]\n        ],\n        [\n            'alpha',\n            [\n                'and',\n                'number',\n                [\n                    '[between]',\n                    0,\n                    1\n                ]\n            ]\n        ]\n    ]);\n    defineAlias('critbinom', 'binom.inv');\n    defineFunction('binom.dist.range', function (n, p, s, s2) {\n        var sum = 0;\n        for (var k = s; k <= s2; ++k) {\n            sum += _combinations(n, k) * Math.pow(p, k) * Math.pow(1 - p, n - k);\n        }\n        return sum;\n    }).args([\n        [\n            'trials',\n            'integer+'\n        ],\n        [\n            'probability',\n            [\n                'and',\n                'number',\n                [\n                    '[between]',\n                    0,\n                    1\n                ]\n            ]\n        ],\n        [\n            'successes_min',\n            [\n                'and',\n                'integer',\n                [\n                    '[between]',\n                    0,\n                    '$trials'\n                ]\n            ]\n        ],\n        [\n            'successes_max',\n            [\n                'or',\n                [\n                    'and',\n                    'integer',\n                    [\n                        '[between]',\n                        '$successes_min',\n                        '$trials'\n                    ]\n                ],\n                [\n                    'null',\n                    '$successes_min'\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('negbinom.dist', function (x, k, p, cumulative) {\n        if (cumulative) {\n            var sum = 0;\n            while (x >= 0) {\n                sum += _combinations(x + k - 1, x) * Math.pow(p, k) * Math.pow(1 - p, x);\n                x--;\n            }\n            return sum;\n        }\n        return _combinations(x + k - 1, x) * Math.pow(p, k) * Math.pow(1 - p, x);\n    }).args([\n        [\n            'number_f',\n            'integer+'\n        ],\n        [\n            'number_s',\n            'integer+'\n        ],\n        [\n            'probability_s',\n            [\n                'and',\n                'number',\n                [\n                    '[between]',\n                    0,\n                    1\n                ]\n            ]\n        ],\n        [\n            'cumulative',\n            'logical'\n        ]\n    ]);\n    defineAlias('negbinomdist', 'negbinom.dist');\n    defineFunction('address', function (row, col, abs, a1, sheet) {\n        var cell = new CellRef(row - 1, col - 1, abs - 1);\n        if (sheet) {\n            cell.setSheet(sheet, true);\n        }\n        return a1 ? cell.print(0, 0) : cell.print();\n    }).args([\n        [\n            'row',\n            'integer++'\n        ],\n        [\n            'col',\n            'integer++'\n        ],\n        [\n            'abs',\n            [\n                'or',\n                [\n                    'null',\n                    1\n                ],\n                [\n                    'values',\n                    1,\n                    2,\n                    3,\n                    4\n                ]\n            ]\n        ],\n        [\n            'a1',\n            [\n                'or',\n                [\n                    'null',\n                    true\n                ],\n                'logical'\n            ]\n        ],\n        [\n            'sheet',\n            [\n                'or',\n                'null',\n                'string'\n            ]\n        ]\n    ]);\n    defineFunction('areas', function (ref) {\n        var count = 0;\n        (function loop(x) {\n            if (x instanceof CellRef || x instanceof RangeRef) {\n                count++;\n            } else if (x instanceof UnionRef) {\n                x.refs.forEach(loop);\n            }\n        }(ref));\n        return count;\n    }).args([[\n            'ref',\n            'ref'\n        ]]);\n    defineFunction('choose', function (index, args) {\n        if (index > args.length) {\n            return new CalcError('N/A');\n        } else {\n            return args[index - 1];\n        }\n    }).args([\n        [\n            '*index',\n            'integer'\n        ],\n        [\n            '+',\n            [\n                'value',\n                'anything'\n            ]\n        ]\n    ]);\n    defineFunction('column', function (ref) {\n        if (!ref) {\n            return this.formula.col + 1;\n        }\n        if (ref instanceof CellRef) {\n            return ref.col + 1;\n        }\n        return this.asMatrix(ref).mapCol(function (col) {\n            return col + ref.topLeft.col + 1;\n        });\n    }).args([[\n            'ref',\n            [\n                'or',\n                'area',\n                'null'\n            ]\n        ]]);\n    defineFunction('columns', function (m) {\n        return m instanceof Ref ? m.width() : m.width;\n    }).args([[\n            'ref',\n            [\n                'or',\n                'area',\n                '#matrix'\n            ]\n        ]]);\n    defineFunction('formulatext', function (ref) {\n        var cell = this.getRefCells(ref)[0];\n        if (!cell.formula) {\n            return new CalcError('N/A');\n        }\n        return cell.formula.print(cell.row, cell.col);\n    }).args([[\n            'ref',\n            'ref'\n        ]]);\n    defineFunction('hlookup', function (value, m, row, approx) {\n        var resultCol = null;\n        m.eachCol(function (col) {\n            var data = m.get(0, col);\n            if (approx) {\n                if (data > value) {\n                    return true;\n                }\n                resultCol = col;\n            } else if (data === value) {\n                resultCol = col;\n                return true;\n            }\n        });\n        if (resultCol == null) {\n            return new CalcError('N/A');\n        }\n        return m.get(row - 1, resultCol);\n    }).args([\n        [\n            'value',\n            'anyvalue'\n        ],\n        [\n            'range',\n            'matrix'\n        ],\n        [\n            'row',\n            'integer++'\n        ],\n        [\n            'approx',\n            [\n                'or',\n                'logical',\n                [\n                    'null',\n                    true\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('index', function (m, row, col) {\n        if (row == null && col == null) {\n            return new CalcError('N/A');\n        }\n        if (m.width > 1 && m.height > 1) {\n            if (row != null && col != null) {\n                return m.get(row - 1, col - 1);\n            }\n            if (row == null) {\n                return m.mapRow(function (row) {\n                    return m.get(row, col - 1);\n                });\n            }\n            if (col == null) {\n                return m.mapCol(function (col) {\n                    return m.get(row - 1, col);\n                });\n            }\n        }\n        if (m.width == 1) {\n            return m.get(row - 1, 0);\n        }\n        if (m.height == 1) {\n            return m.get(0, col - 1);\n        }\n        return new CalcError('REF');\n    }).args([\n        [\n            'range',\n            'matrix'\n        ],\n        [\n            'row',\n            [\n                'or',\n                'integer++',\n                'null'\n            ]\n        ],\n        [\n            'col',\n            [\n                'or',\n                'integer++',\n                'null'\n            ]\n        ]\n    ]);\n    defineFunction('indirect', function (thing) {\n        try {\n            var f = this.formula;\n            var exp = calc.parseFormula(f.sheet, f.row, f.col, thing);\n            if (!(exp.ast instanceof Ref)) {\n                throw 1;\n            }\n            return exp.ast.absolute(f.row, f.col);\n        } catch (ex) {\n            return new CalcError('REF');\n        }\n    }).args([[\n            'thing',\n            'string'\n        ]]);\n    defineFunction('match', function (val, m, type) {\n        var index = 1, cmp;\n        if (type === 0) {\n            cmp = parseCriteria(val);\n        } else if (type === -1) {\n            cmp = parseCriteria('<=' + val);\n        } else if (type === 1) {\n            cmp = parseCriteria('>=' + val);\n        }\n        if (m.each(function (el) {\n                if (el != null && cmp(el)) {\n                    if (type !== 0 && val != el) {\n                        --index;\n                    }\n                    return true;\n                }\n                index++;\n            }, true) && index > 0) {\n            return index;\n        } else {\n            return new CalcError('N/A');\n        }\n    }).args([\n        [\n            'value',\n            'anyvalue'\n        ],\n        [\n            'range',\n            'matrix'\n        ],\n        [\n            'type',\n            [\n                'or',\n                [\n                    'values',\n                    -1,\n                    0,\n                    1\n                ],\n                [\n                    'null',\n                    1\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('offset', function (ref, rows, cols, height, width) {\n        var topLeft = (ref instanceof CellRef ? ref : ref.topLeft).clone();\n        topLeft.row += rows;\n        topLeft.col += cols;\n        if (topLeft.row < 0 || topLeft.col < 0) {\n            return new CalcError('VALUE');\n        }\n        if (height > 1 || width > 1) {\n            return new RangeRef(topLeft, new CellRef(topLeft.row + height - 1, topLeft.col + width - 1)).setSheet(ref.sheet, ref.hasSheet());\n        }\n        return topLeft;\n    }).args([\n        [\n            'ref',\n            'area'\n        ],\n        [\n            '*rows',\n            'integer'\n        ],\n        [\n            '*cols',\n            'integer'\n        ],\n        [\n            '*height',\n            [\n                'or',\n                'integer++',\n                [\n                    'null',\n                    '$ref.height()'\n                ]\n            ]\n        ],\n        [\n            '*width',\n            [\n                'or',\n                'integer++',\n                [\n                    'null',\n                    '$ref.width()'\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('row', function (ref) {\n        if (!ref) {\n            return this.formula.row + 1;\n        }\n        if (ref instanceof CellRef) {\n            return ref.row + 1;\n        }\n        return this.asMatrix(ref).mapRow(function (row) {\n            return row + ref.topLeft.row + 1;\n        });\n    }).args([[\n            'ref',\n            [\n                'or',\n                'area',\n                'null'\n            ]\n        ]]);\n    defineFunction('rows', function (m) {\n        return m instanceof Ref ? m.height() : m.height;\n    }).args([[\n            'ref',\n            [\n                'or',\n                'area',\n                '#matrix'\n            ]\n        ]]);\n    defineFunction('vlookup', function (value, m, col, approx) {\n        var resultRow = null;\n        m.eachRow(function (row) {\n            var data = m.get(row, 0);\n            if (approx) {\n                if (data > value) {\n                    return true;\n                }\n                resultRow = row;\n            } else if (data === value) {\n                resultRow = row;\n                return true;\n            }\n        });\n        if (resultRow == null) {\n            return new CalcError('N/A');\n        }\n        return m.get(resultRow, col - 1);\n    }).args([\n        [\n            'value',\n            'anyvalue'\n        ],\n        [\n            'range',\n            'matrix'\n        ],\n        [\n            'col',\n            'integer++'\n        ],\n        [\n            'approx',\n            [\n                'or',\n                'logical',\n                [\n                    'null',\n                    true\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('date', function (year, month, date) {\n        return packDate(year, month - 1, date);\n    }).args([\n        [\n            '*year',\n            'integer'\n        ],\n        [\n            '*month',\n            'integer'\n        ],\n        [\n            '*date',\n            'integer'\n        ]\n    ]);\n    defineFunction('day', function (date) {\n        return unpackDate(date).date;\n    }).args([[\n            '*date',\n            'date'\n        ]]);\n    defineFunction('month', function (date) {\n        return unpackDate(date).month + 1;\n    }).args([[\n            '*date',\n            'date'\n        ]]);\n    defineFunction('year', function (date) {\n        return unpackDate(date).year;\n    }).args([[\n            '*date',\n            'date'\n        ]]);\n    defineFunction('weekday', function (date) {\n        return unpackDate(date).day + 1;\n    }).args([[\n            '*date',\n            'date'\n        ]]);\n    defineFunction('weeknum', function (date, type) {\n        var fw = packDate(unpackDate(date).year, 0, 1);\n        var sy = unpackDate(fw);\n        var diff;\n        if (type == 21) {\n            diff = 3 - (sy.day + 6) % 7;\n            if (diff < 0) {\n                diff += 7;\n            }\n            fw += diff;\n            sy.date += diff;\n            sy.day = 4;\n            type = 1;\n        } else {\n            if (type == 1) {\n                type = 0;\n            } else if (type == 2) {\n                type = 1;\n            } else {\n                type = (type - 10) % 7;\n            }\n        }\n        diff = sy.day - type;\n        if (diff < 0) {\n            diff += 7;\n        }\n        fw -= diff;\n        return Math.ceil((date + 1 - fw) / 7);\n    }).args([\n        [\n            '*date',\n            'date'\n        ],\n        [\n            '*type',\n            [\n                'or',\n                [\n                    'null',\n                    1\n                ],\n                [\n                    'values',\n                    1,\n                    2,\n                    11,\n                    12,\n                    13,\n                    14,\n                    15,\n                    16,\n                    17,\n                    21\n                ]\n            ]\n        ]\n    ]);\n    function weeksInYear(year) {\n        var d = unpackDate(packDate(year, 0, 1));\n        if (d.day == 4 || d.day == 3 && runtime.isLeapYear(year)) {\n            return 53;\n        }\n        return 52;\n    }\n    defineFunction('isoweeknum', function isoweeknum(date) {\n        var d = unpackDate(date);\n        var dow = d.day || 7;\n        var wk = Math.floor((d.ord - dow + 10) / 7);\n        if (wk < 1) {\n            return weeksInYear(d.year - 1);\n        } else if (wk == 53 && wk > weeksInYear(d.year)) {\n            return 1;\n        }\n        return wk;\n    }).args([[\n            '*date',\n            'date'\n        ]]);\n    defineFunction('now', function () {\n        return runtime.dateToSerial(new Date());\n    }).args([]);\n    defineFunction('today', function () {\n        return runtime.dateToSerial(new Date()) | 0;\n    }).args([]);\n    defineFunction('time', function (hh, mm, ss) {\n        return runtime.packTime(hh, mm, ss, 0);\n    }).args([\n        [\n            '*hours',\n            'integer'\n        ],\n        [\n            '*minutes',\n            'integer'\n        ],\n        [\n            '*seconds',\n            'integer'\n        ]\n    ]);\n    defineFunction('hour', function (time) {\n        return runtime.unpackTime(time).hours;\n    }).args([[\n            '*time',\n            'datetime'\n        ]]);\n    defineFunction('minute', function (time) {\n        return runtime.unpackTime(time).minutes;\n    }).args([[\n            '*time',\n            'datetime'\n        ]]);\n    defineFunction('second', function (time) {\n        return runtime.unpackTime(time).seconds;\n    }).args([[\n            '*time',\n            'datetime'\n        ]]);\n    defineFunction('edate', function (base, months) {\n        var d = unpackDate(base);\n        var m = d.month + months;\n        var y = d.year + Math.floor(m / 12);\n        m %= 12;\n        if (m < 0) {\n            m += 12;\n        }\n        d = Math.min(d.date, daysInMonth(y, m));\n        return packDate(y, m, d);\n    }).args([\n        [\n            '*start_date',\n            'date'\n        ],\n        [\n            '*months',\n            'integer'\n        ]\n    ]);\n    defineFunction('eomonth', function (base, months) {\n        var d = unpackDate(base);\n        var m = d.month + months;\n        var y = d.year + Math.floor(m / 12);\n        m %= 12;\n        if (m < 0) {\n            m += 12;\n        }\n        d = daysInMonth(y, m);\n        return packDate(y, m, d);\n    }).args([\n        [\n            '*start_date',\n            'date'\n        ],\n        [\n            '*months',\n            'integer'\n        ]\n    ]);\n    defineFunction('workday', function (date, n, holidays) {\n        var inc = n > 0 ? 1 : -1;\n        n = Math.abs(n);\n        var dow = unpackDate(date).day;\n        while (n > 0) {\n            date += inc;\n            dow = (dow + inc) % 7;\n            if (dow > 0 && dow < 6 && holidays.indexOf(date) < 0) {\n                --n;\n            }\n        }\n        return date;\n    }).args([\n        [\n            'start_date',\n            'date'\n        ],\n        [\n            'days',\n            'integer'\n        ],\n        [\n            'holidays',\n            [\n                'collect',\n                'date'\n            ]\n        ]\n    ]);\n    defineFunction('networkdays', function (date, end, holidays) {\n        if (date > end) {\n            var tmp = date;\n            date = end;\n            end = tmp;\n        }\n        var count = 0;\n        var dow = unpackDate(date).day;\n        while (date <= end) {\n            if (dow > 0 && dow < 6 && holidays.indexOf(date) < 0) {\n                count++;\n            }\n            date++;\n            dow = (dow + 1) % 7;\n        }\n        return count;\n    }).args([\n        [\n            'start_date',\n            'date'\n        ],\n        [\n            'end_date',\n            'date'\n        ],\n        [\n            'holidays',\n            [\n                'collect',\n                'date'\n            ]\n        ]\n    ]);\n    defineFunction('days', function (start, end) {\n        return end - start;\n    }).args([\n        [\n            '*start_date',\n            'date'\n        ],\n        [\n            '*end_date',\n            'date'\n        ]\n    ]);\n    function _days_360(start, end, method) {\n        var d1 = unpackDate(start);\n        var d2 = unpackDate(end);\n        if (method) {\n            if (d1.date == 31) {\n                d1.date = 30;\n            }\n            if (d2.date == 31) {\n                d2.date = 30;\n            }\n        } else {\n            if (d1.month == 1 && d2.month == 1 && d1.date == daysInMonth(d1.year, 1) && d2.date == daysInMonth(d2.year, 1)) {\n                d2.date = 30;\n            }\n            if (d1.date == daysInMonth(d1.year, d1.month)) {\n                d1.date = 30;\n                if (d2.date == 31) {\n                    d2.date = 30;\n                }\n            } else {\n                if (d1.date == 30 && d2.date == 31) {\n                    d2.date = 30;\n                }\n            }\n        }\n        return 360 * (d2.year - d1.year) + 30 * (d2.month - d1.month) + (d2.date - d1.date);\n    }\n    runtime._days_360 = _days_360;\n    defineFunction('days360', _days_360).args([\n        [\n            '*start_date',\n            'date'\n        ],\n        [\n            '*end_date',\n            'date'\n        ],\n        [\n            '*method',\n            [\n                'or',\n                'logical',\n                [\n                    'null',\n                    'false'\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('yearfrac', function (start, end, method) {\n        switch (method) {\n        case 0:\n            return _days_360(start, end, false) / 360;\n        case 1:\n            return (end - start) / daysInYear(unpackDate(start).year);\n        case 2:\n            return (end - start) / 360;\n        case 3:\n            return (end - start) / 365;\n        case 4:\n            return _days_360(start, end, true) / 360;\n        }\n    }).args([\n        [\n            '*start_date',\n            'date'\n        ],\n        [\n            '*end_date',\n            'date'\n        ],\n        [\n            '*method',\n            [\n                'or',\n                [\n                    'null',\n                    0\n                ],\n                [\n                    'values',\n                    0,\n                    1,\n                    2,\n                    3,\n                    4\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('datevalue', function (text) {\n        var date = runtime.parseDate(text);\n        if (date) {\n            return runtime.dateToSerial(date);\n        }\n        return new CalcError('VALUE');\n    }).args([[\n            '*text',\n            'string'\n        ]]);\n    defineFunction('timevalue', function (text) {\n        var m = text.toLowerCase().match(/(\\d+):(\\d+)(:(\\d+)(\\.(\\d+))?)?\\s*(am?|pm?)?/);\n        if (m) {\n            var hh = parseFloat(m[1]);\n            var mm = parseFloat(m[2]);\n            var ss = m[3] ? parseFloat(m[4]) : 0;\n            var ampm = m[7];\n            if (ampm && (hh > 12 || hh < 1)) {\n                return new CalcError('VALUE');\n            }\n            if (/^p/.test(ampm)) {\n                hh += 12;\n            }\n            return runtime.packTime(hh, mm, ss, 0);\n        }\n        return new CalcError('VALUE');\n    }).args([[\n            '*text',\n            'string'\n        ]]);\n    defineFunction('mdeterm', function (m) {\n        var error = m.each(function (val) {\n            if (typeof val != 'number') {\n                return new CalcError('VALUE');\n            }\n        }, true);\n        return error || m.determinant();\n    }).args([[\n            'm',\n            [\n                'and',\n                'matrix',\n                [\n                    'assert',\n                    '$m.width == $m.height'\n                ]\n            ]\n        ]]);\n    defineFunction('transpose', function (m) {\n        return m.transpose();\n    }).args([[\n            'range',\n            'matrix'\n        ]]);\n    defineFunction('mmult', function (a, b) {\n        return a.multiply(b);\n    }).args([\n        [\n            'a',\n            'matrix'\n        ],\n        [\n            'b',\n            [\n                'and',\n                'matrix',\n                [\n                    'assert',\n                    '$b.height == $a.width'\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('munit', function (n) {\n        return new Matrix(this).unit(n);\n    }).args([[\n            'n',\n            'integer+'\n        ]]);\n    defineFunction('minverse', function (m) {\n        var error = m.each(function (val) {\n            if (typeof val != 'number') {\n                return new CalcError('VALUE');\n            }\n        }, true);\n        return error || m.inverse() || new CalcError('VALUE');\n    }).args([[\n            'm',\n            [\n                'and',\n                'matrix',\n                [\n                    'assert',\n                    '$m.width == $m.height'\n                ]\n            ]\n        ]]);\n    defineFunction('rand', function () {\n        return Math.random();\n    }).args([]);\n    defineFunction('randbetween', function (min, max) {\n        return min + Math.floor((max - min + 1) * Math.random());\n    }).args([\n        [\n            'min',\n            'integer'\n        ],\n        [\n            'max',\n            [\n                'and',\n                'integer',\n                [\n                    'assert',\n                    '$max >= $min'\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('true', function () {\n        return true;\n    }).args([]);\n    defineFunction('false', function () {\n        return true;\n    }).args([]);\n    defineFunction('roman', function (num) {\n        return util.arabicToRoman(num).toUpperCase();\n    }).args([[\n            '*number',\n            'integer'\n        ]]);\n    defineFunction('arabic', function (rom) {\n        var num = util.romanToArabic(rom);\n        return num == null ? new CalcError('VALUE') : num;\n    }).args([[\n            '*roman',\n            'string'\n        ]]);\n    defineFunction('base', function (number, radix, minLen) {\n        var str = number.toString(radix).toUpperCase();\n        while (str.length < minLen) {\n            str = '0' + str;\n        }\n        return str;\n    }).args([\n        [\n            '*number',\n            'integer'\n        ],\n        [\n            '*radix',\n            [\n                'and',\n                'integer',\n                [\n                    '[between]',\n                    2,\n                    36\n                ]\n            ]\n        ],\n        [\n            '*minLen',\n            [\n                'or',\n                'integer+',\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('decimal', function (text, radix) {\n        text = text.toUpperCase();\n        var val = 0;\n        for (var i = 0; i < text.length; ++i) {\n            var d = text.charCodeAt(i);\n            if (d >= 48 && d <= 57) {\n                d -= 48;\n            } else if (d >= 65 && d < 55 + radix) {\n                d -= 55;\n            } else {\n                return new CalcError('VALUE');\n            }\n            val = val * radix + d;\n        }\n        return val;\n    }).args([\n        [\n            '*text',\n            'string'\n        ],\n        [\n            '*radix',\n            [\n                'and',\n                'integer',\n                [\n                    '[between]',\n                    2,\n                    36\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('char', function (code) {\n        return String.fromCharCode(code);\n    }).args([[\n            '*code',\n            'integer+'\n        ]]);\n    var RX_NON_PRINTABLE = /[\\0-\\x1F\\x7F-\\x9F\\xAD\\u0378\\u0379\\u037F-\\u0383\\u038B\\u038D\\u03A2\\u0528-\\u0530\\u0557\\u0558\\u0560\\u0588\\u058B-\\u058E\\u0590\\u05C8-\\u05CF\\u05EB-\\u05EF\\u05F5-\\u0605\\u061C\\u061D\\u06DD\\u070E\\u070F\\u074B\\u074C\\u07B2-\\u07BF\\u07FB-\\u07FF\\u082E\\u082F\\u083F\\u085C\\u085D\\u085F-\\u089F\\u08A1\\u08AD-\\u08E3\\u08FF\\u0978\\u0980\\u0984\\u098D\\u098E\\u0991\\u0992\\u09A9\\u09B1\\u09B3-\\u09B5\\u09BA\\u09BB\\u09C5\\u09C6\\u09C9\\u09CA\\u09CF-\\u09D6\\u09D8-\\u09DB\\u09DE\\u09E4\\u09E5\\u09FC-\\u0A00\\u0A04\\u0A0B-\\u0A0E\\u0A11\\u0A12\\u0A29\\u0A31\\u0A34\\u0A37\\u0A3A\\u0A3B\\u0A3D\\u0A43-\\u0A46\\u0A49\\u0A4A\\u0A4E-\\u0A50\\u0A52-\\u0A58\\u0A5D\\u0A5F-\\u0A65\\u0A76-\\u0A80\\u0A84\\u0A8E\\u0A92\\u0AA9\\u0AB1\\u0AB4\\u0ABA\\u0ABB\\u0AC6\\u0ACA\\u0ACE\\u0ACF\\u0AD1-\\u0ADF\\u0AE4\\u0AE5\\u0AF2-\\u0B00\\u0B04\\u0B0D\\u0B0E\\u0B11\\u0B12\\u0B29\\u0B31\\u0B34\\u0B3A\\u0B3B\\u0B45\\u0B46\\u0B49\\u0B4A\\u0B4E-\\u0B55\\u0B58-\\u0B5B\\u0B5E\\u0B64\\u0B65\\u0B78-\\u0B81\\u0B84\\u0B8B-\\u0B8D\\u0B91\\u0B96-\\u0B98\\u0B9B\\u0B9D\\u0BA0-\\u0BA2\\u0BA5-\\u0BA7\\u0BAB-\\u0BAD\\u0BBA-\\u0BBD\\u0BC3-\\u0BC5\\u0BC9\\u0BCE\\u0BCF\\u0BD1-\\u0BD6\\u0BD8-\\u0BE5\\u0BFB-\\u0C00\\u0C04\\u0C0D\\u0C11\\u0C29\\u0C34\\u0C3A-\\u0C3C\\u0C45\\u0C49\\u0C4E-\\u0C54\\u0C57\\u0C5A-\\u0C5F\\u0C64\\u0C65\\u0C70-\\u0C77\\u0C80\\u0C81\\u0C84\\u0C8D\\u0C91\\u0CA9\\u0CB4\\u0CBA\\u0CBB\\u0CC5\\u0CC9\\u0CCE-\\u0CD4\\u0CD7-\\u0CDD\\u0CDF\\u0CE4\\u0CE5\\u0CF0\\u0CF3-\\u0D01\\u0D04\\u0D0D\\u0D11\\u0D3B\\u0D3C\\u0D45\\u0D49\\u0D4F-\\u0D56\\u0D58-\\u0D5F\\u0D64\\u0D65\\u0D76-\\u0D78\\u0D80\\u0D81\\u0D84\\u0D97-\\u0D99\\u0DB2\\u0DBC\\u0DBE\\u0DBF\\u0DC7-\\u0DC9\\u0DCB-\\u0DCE\\u0DD5\\u0DD7\\u0DE0-\\u0DF1\\u0DF5-\\u0E00\\u0E3B-\\u0E3E\\u0E5C-\\u0E80\\u0E83\\u0E85\\u0E86\\u0E89\\u0E8B\\u0E8C\\u0E8E-\\u0E93\\u0E98\\u0EA0\\u0EA4\\u0EA6\\u0EA8\\u0EA9\\u0EAC\\u0EBA\\u0EBE\\u0EBF\\u0EC5\\u0EC7\\u0ECE\\u0ECF\\u0EDA\\u0EDB\\u0EE0-\\u0EFF\\u0F48\\u0F6D-\\u0F70\\u0F98\\u0FBD\\u0FCD\\u0FDB-\\u0FFF\\u10C6\\u10C8-\\u10CC\\u10CE\\u10CF\\u1249\\u124E\\u124F\\u1257\\u1259\\u125E\\u125F\\u1289\\u128E\\u128F\\u12B1\\u12B6\\u12B7\\u12BF\\u12C1\\u12C6\\u12C7\\u12D7\\u1311\\u1316\\u1317\\u135B\\u135C\\u137D-\\u137F\\u139A-\\u139F\\u13F5-\\u13FF\\u169D-\\u169F\\u16F1-\\u16FF\\u170D\\u1715-\\u171F\\u1737-\\u173F\\u1754-\\u175F\\u176D\\u1771\\u1774-\\u177F\\u17DE\\u17DF\\u17EA-\\u17EF\\u17FA-\\u17FF\\u180F\\u181A-\\u181F\\u1878-\\u187F\\u18AB-\\u18AF\\u18F6-\\u18FF\\u191D-\\u191F\\u192C-\\u192F\\u193C-\\u193F\\u1941-\\u1943\\u196E\\u196F\\u1975-\\u197F\\u19AC-\\u19AF\\u19CA-\\u19CF\\u19DB-\\u19DD\\u1A1C\\u1A1D\\u1A5F\\u1A7D\\u1A7E\\u1A8A-\\u1A8F\\u1A9A-\\u1A9F\\u1AAE-\\u1AFF\\u1B4C-\\u1B4F\\u1B7D-\\u1B7F\\u1BF4-\\u1BFB\\u1C38-\\u1C3A\\u1C4A-\\u1C4C\\u1C80-\\u1CBF\\u1CC8-\\u1CCF\\u1CF7-\\u1CFF\\u1DE7-\\u1DFB\\u1F16\\u1F17\\u1F1E\\u1F1F\\u1F46\\u1F47\\u1F4E\\u1F4F\\u1F58\\u1F5A\\u1F5C\\u1F5E\\u1F7E\\u1F7F\\u1FB5\\u1FC5\\u1FD4\\u1FD5\\u1FDC\\u1FF0\\u1FF1\\u1FF5\\u1FFF\\u200B-\\u200F\\u202A-\\u202E\\u2060-\\u206F\\u2072\\u2073\\u208F\\u209D-\\u209F\\u20BB-\\u20CF\\u20F1-\\u20FF\\u218A-\\u218F\\u23F4-\\u23FF\\u2427-\\u243F\\u244B-\\u245F\\u2700\\u2B4D-\\u2B4F\\u2B5A-\\u2BFF\\u2C2F\\u2C5F\\u2CF4-\\u2CF8\\u2D26\\u2D28-\\u2D2C\\u2D2E\\u2D2F\\u2D68-\\u2D6E\\u2D71-\\u2D7E\\u2D97-\\u2D9F\\u2DA7\\u2DAF\\u2DB7\\u2DBF\\u2DC7\\u2DCF\\u2DD7\\u2DDF\\u2E3C-\\u2E7F\\u2E9A\\u2EF4-\\u2EFF\\u2FD6-\\u2FEF\\u2FFC-\\u2FFF\\u3040\\u3097\\u3098\\u3100-\\u3104\\u312E-\\u3130\\u318F\\u31BB-\\u31BF\\u31E4-\\u31EF\\u321F\\u32FF\\u4DB6-\\u4DBF\\u9FCD-\\u9FFF\\uA48D-\\uA48F\\uA4C7-\\uA4CF\\uA62C-\\uA63F\\uA698-\\uA69E\\uA6F8-\\uA6FF\\uA78F\\uA794-\\uA79F\\uA7AB-\\uA7F7\\uA82C-\\uA82F\\uA83A-\\uA83F\\uA878-\\uA87F\\uA8C5-\\uA8CD\\uA8DA-\\uA8DF\\uA8FC-\\uA8FF\\uA954-\\uA95E\\uA97D-\\uA97F\\uA9CE\\uA9DA-\\uA9DD\\uA9E0-\\uA9FF\\uAA37-\\uAA3F\\uAA4E\\uAA4F\\uAA5A\\uAA5B\\uAA7C-\\uAA7F\\uAAC3-\\uAADA\\uAAF7-\\uAB00\\uAB07\\uAB08\\uAB0F\\uAB10\\uAB17-\\uAB1F\\uAB27\\uAB2F-\\uABBF\\uABEE\\uABEF\\uABFA-\\uABFF\\uD7A4-\\uD7AF\\uD7C7-\\uD7CA\\uD7FC-\\uF8FF\\uFA6E\\uFA6F\\uFADA-\\uFAFF\\uFB07-\\uFB12\\uFB18-\\uFB1C\\uFB37\\uFB3D\\uFB3F\\uFB42\\uFB45\\uFBC2-\\uFBD2\\uFD40-\\uFD4F\\uFD90\\uFD91\\uFDC8-\\uFDEF\\uFDFE\\uFDFF\\uFE1A-\\uFE1F\\uFE27-\\uFE2F\\uFE53\\uFE67\\uFE6C-\\uFE6F\\uFE75\\uFEFD-\\uFF00\\uFFBF-\\uFFC1\\uFFC8\\uFFC9\\uFFD0\\uFFD1\\uFFD8\\uFFD9\\uFFDD-\\uFFDF\\uFFE7\\uFFEF-\\uFFFB\\uFFFE\\uFFFF]/g;\n    defineFunction('clean', function (text) {\n        return text.replace(RX_NON_PRINTABLE, '');\n    }).args([[\n            '*text',\n            'string'\n        ]]);\n    defineFunction('code', function (text) {\n        return text.charAt(0);\n    }).args([[\n            '*text',\n            'string'\n        ]]);\n    defineAlias('unichar', 'char');\n    defineAlias('unicode', 'code');\n    defineFunction('concatenate', function () {\n        var out = '';\n        for (var i = 0; i < arguments.length; ++i) {\n            out += arguments[i];\n        }\n        return out;\n    }).args([[\n            '+',\n            [\n                '*text',\n                'string'\n            ]\n        ]]);\n    defineFunction('dollar', function (number, decimals) {\n        var format = '$#,##0.DECIMALS;($#,##0.DECIMALS)';\n        var dec = '';\n        while (decimals-- > 0) {\n            dec += '0';\n        }\n        format = format.replace(/DECIMALS/g, dec);\n        return spreadsheet.formatting.text(number, format);\n    }).args([\n        [\n            '*number',\n            'number'\n        ],\n        [\n            '*decimals',\n            [\n                'or',\n                'integer++',\n                [\n                    'null',\n                    2\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('exact', function (a, b) {\n        return a === b;\n    }).args([\n        [\n            '*text1',\n            'string'\n        ],\n        [\n            '*text2',\n            'string'\n        ]\n    ]);\n    defineFunction('find', function (substring, string, start) {\n        var pos = string.indexOf(substring, start - 1);\n        return pos < 0 ? new CalcError('VALUE') : pos + 1;\n    }).args([\n        [\n            '*substring',\n            'string'\n        ],\n        [\n            '*string',\n            'string'\n        ],\n        [\n            '*start',\n            [\n                'or',\n                'integer++',\n                [\n                    'null',\n                    1\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('fixed', function (number, decimals, noCommas) {\n        var format = noCommas ? '0.DECIMALS' : '#,##0.DECIMALS';\n        var dec = '';\n        while (decimals-- > 0) {\n            dec += '0';\n        }\n        format = format.replace(/DECIMALS/g, dec);\n        return spreadsheet.formatting.text(number, format);\n    }).args([\n        [\n            '*number',\n            'number'\n        ],\n        [\n            '*decimals',\n            [\n                'or',\n                'integer++',\n                [\n                    'null',\n                    2\n                ]\n            ]\n        ],\n        [\n            '*noCommas',\n            [\n                'or',\n                'boolean',\n                [\n                    'null',\n                    false\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('left', function (text, length) {\n        return text.substr(0, length);\n    }).args([\n        [\n            '*text',\n            'string'\n        ],\n        [\n            '*length',\n            [\n                'or',\n                'integer+',\n                [\n                    'null',\n                    1\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('right', function (text, length) {\n        return text.substr(-length);\n    }).args([\n        [\n            '*text',\n            'string'\n        ],\n        [\n            '*length',\n            [\n                'or',\n                'integer+',\n                [\n                    'null',\n                    1\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('len', function (text) {\n        return text.length;\n    }).args([[\n            '*text',\n            'string'\n        ]]);\n    defineFunction('lower', function (text) {\n        return text.toLowerCase();\n    }).args([[\n            '*text',\n            'string'\n        ]]);\n    defineFunction('upper', function (text) {\n        return text.toUpperCase();\n    }).args([[\n            '*text',\n            'string'\n        ]]);\n    defineFunction('ltrim', function (text) {\n        return text.replace(/^\\s+/, '');\n    }).args([[\n            '*text',\n            'string'\n        ]]);\n    defineFunction('rtrim', function (text) {\n        return text.replace(/\\s+$/, '');\n    }).args([[\n            '*text',\n            'string'\n        ]]);\n    defineFunction('trim', function (text) {\n        return text.replace(/^\\s+|\\s+$/, '');\n    }).args([[\n            '*text',\n            'string'\n        ]]);\n    defineFunction('mid', function (text, start, length) {\n        return text.substr(start - 1, length);\n    }).args([\n        [\n            '*text',\n            'string'\n        ],\n        [\n            '*start',\n            'integer++'\n        ],\n        [\n            '*length',\n            'integer+'\n        ]\n    ]);\n    defineFunction('proper', function (text) {\n        return text.toLowerCase().replace(/\\b./g, function (s) {\n            return s.toUpperCase();\n        });\n    }).args([[\n            '*text',\n            'string'\n        ]]);\n    defineFunction('replace', function (text, start, length, newText) {\n        return text.substr(0, --start) + newText + text.substr(start + length);\n    }).args([\n        [\n            '*text',\n            'string'\n        ],\n        [\n            '*start',\n            'integer++'\n        ],\n        [\n            '*length',\n            'integer+'\n        ],\n        [\n            '*newText',\n            'string'\n        ]\n    ]);\n    defineFunction('rept', function (text, number) {\n        var out = '';\n        while (number-- > 0) {\n            out += text;\n        }\n        return out;\n    }).args([\n        [\n            '*text',\n            'string'\n        ],\n        [\n            '*number',\n            'integer+'\n        ]\n    ]);\n    defineFunction('search', function (substring, string, start) {\n        var pos = string.toLowerCase().indexOf(substring.toLowerCase(), start - 1);\n        return pos < 0 ? new CalcError('VALUE') : pos + 1;\n    }).args([\n        [\n            '*substring',\n            'string'\n        ],\n        [\n            '*string',\n            'string'\n        ],\n        [\n            '*start',\n            [\n                'or',\n                'integer++',\n                [\n                    'null',\n                    1\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('substitute', function (text, oldText, newText, nth) {\n        if (oldText === newText) {\n            return text;\n        }\n        var pos = -1;\n        function replace() {\n            text = text.substring(0, pos) + newText + text.substring(pos + oldText.length);\n        }\n        while ((pos = text.indexOf(oldText, pos + 1)) >= 0) {\n            if (nth == null) {\n                replace();\n            } else if (--nth === 0) {\n                replace();\n                break;\n            }\n        }\n        return text;\n    }).args([\n        [\n            '*text',\n            'string'\n        ],\n        [\n            '*oldText',\n            'string'\n        ],\n        [\n            '*newText',\n            'string'\n        ],\n        [\n            '*nth',\n            [\n                'or',\n                'integer++',\n                'null'\n            ]\n        ]\n    ]);\n    defineFunction('t', function (value) {\n        return typeof value == 'string' ? value : '';\n    }).args([[\n            '*value',\n            'anyvalue'\n        ]]);\n    defineFunction('text', function (value, format) {\n        return spreadsheet.formatting.text(value, format);\n    }).args([\n        [\n            '*value',\n            'anyvalue'\n        ],\n        [\n            '*format',\n            'string'\n        ]\n    ]);\n    defineFunction('value', function (value) {\n        if (typeof value == 'number') {\n            return value;\n        }\n        if (typeof value == 'boolean') {\n            return +value;\n        }\n        value = (value + '').replace(/[$,]/g, '');\n        value = parseFloat(value);\n        return isNaN(value) ? new CalcError('VALUE') : value;\n    }).args([[\n            '*value',\n            'anyvalue'\n        ]]);\n    defineFunction('iferror', function (value, valueIfError) {\n        return value instanceof CalcError ? valueIfError : value;\n    }).args([\n        [\n            '*value',\n            'forced!'\n        ],\n        [\n            '*value_if_error',\n            'anyvalue'\n        ]\n    ]);\n    var parseCriteria = function () {\n        var RXCACHE = Object.create(null);\n        function makeComparator(cmp, x) {\n            if (typeof x == 'string') {\n                var num = parseFloat(x);\n                if (!isNaN(num)) {\n                    x = num;\n                }\n            }\n            return function (a) {\n                var b = x;\n                if (typeof a == 'string' && typeof b == 'string') {\n                    a = a.toLowerCase();\n                    b = b.toLowerCase();\n                }\n                return cmp(a, b);\n            };\n        }\n        function lc(a) {\n            if (typeof a == 'string') {\n                return a.toLowerCase();\n            }\n            return a;\n        }\n        function compLT(a, b) {\n            return lc(a) < lc(b);\n        }\n        function compLTE(a, b) {\n            return lc(a) <= lc(b);\n        }\n        function compGT(a, b) {\n            return lc(a) > lc(b);\n        }\n        function compGTE(a, b) {\n            return lc(a) >= lc(b);\n        }\n        function compNE(a, b) {\n            return lc(a) != lc(b);\n        }\n        function compEQ(a, b) {\n            if (b instanceof RegExp) {\n                return b.test(a);\n            }\n            return lc(a) == lc(b);\n        }\n        return function (cmp) {\n            if (typeof cmp == 'function') {\n                return cmp;\n            }\n            var m;\n            if (m = /^=(.*)$/.exec(cmp)) {\n                return makeComparator(compEQ, m[1]);\n            }\n            if (m = /^<>(.*)$/.exec(cmp)) {\n                return makeComparator(compNE, m[1]);\n            }\n            if (m = /^<=(.*)$/.exec(cmp)) {\n                return makeComparator(compLTE, m[1]);\n            }\n            if (m = /^<(.*)$/.exec(cmp)) {\n                return makeComparator(compLT, m[1]);\n            }\n            if (m = /^>=(.*)$/.exec(cmp)) {\n                return makeComparator(compGTE, m[1]);\n            }\n            if (m = /^>(.*)$/.exec(cmp)) {\n                return makeComparator(compGT, m[1]);\n            }\n            if (/[?*]/.exec(cmp)) {\n                var rx = RXCACHE[cmp];\n                if (!rx) {\n                    rx = cmp.replace(/(~\\?|~\\*|[\\]({\\+\\.\\|\\^\\$\\\\})\\[]|[?*])/g, function (s) {\n                        switch (s) {\n                        case '~?':\n                            return '\\\\?';\n                        case '~*':\n                            return '\\\\*';\n                        case '?':\n                            return '.';\n                        case '*':\n                            return '.*';\n                        default:\n                            return '\\\\' + s;\n                        }\n                    });\n                    rx = RXCACHE[cmp] = new RegExp('^' + rx + '$', 'i');\n                }\n                return makeComparator(compEQ, rx);\n            }\n            return makeComparator(compEQ, cmp);\n        };\n    }();\n    function numericPredicate(val) {\n        return typeof val == 'number' || typeof val == 'boolean' || val == null || val === '';\n    }\n    function ascending(a, b) {\n        return a === b ? 0 : a < b ? -1 : 1;\n    }\n    function descending(a, b) {\n        return a === b ? 0 : a < b ? 1 : -1;\n    }\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/runtime.functions.2', ['spreadsheet/runtime'], f);\n}(function () {\n    'use strict';\n    if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n        return;\n    }\n    var spreadsheet = kendo.spreadsheet;\n    var calc = spreadsheet.calc;\n    var runtime = calc.runtime;\n    var defineFunction = runtime.defineFunction;\n    var CalcError = runtime.CalcError;\n    var packDate = runtime.packDate;\n    var unpackDate = runtime.unpackDate;\n    var isLeapYear = runtime.isLeapYear;\n    var daysInMonth = runtime.daysInMonth;\n    var _days_360 = runtime._days_360;\n    defineFunction('ERF', function (ll, ul) {\n        if (ul == null) {\n            return ERF(ll);\n        }\n        return ERF(ul) - ERF(ll);\n    }).args([\n        [\n            'lower_limit',\n            'number'\n        ],\n        [\n            'upper_limit',\n            [\n                'or',\n                'number',\n                'null'\n            ]\n        ]\n    ]);\n    defineFunction('ERFC', ERFC).args([[\n            'x',\n            'number'\n        ]]);\n    defineFunction('GAMMALN', GAMMALN).args([[\n            'x',\n            'number++'\n        ]]);\n    defineFunction('GAMMA', GAMMA).args([[\n            'x',\n            'number'\n        ]]);\n    defineFunction('GAMMA.DIST', GAMMA_DIST).args([\n        [\n            'x',\n            'number+'\n        ],\n        [\n            'alpha',\n            'number++'\n        ],\n        [\n            'beta',\n            'number++'\n        ],\n        [\n            'cumulative',\n            'logical'\n        ]\n    ]);\n    defineFunction('GAMMA.INV', GAMMA_INV).args([\n        [\n            'p',\n            [\n                'and',\n                'number',\n                [\n                    '[between]',\n                    0,\n                    1\n                ]\n            ]\n        ],\n        [\n            'alpha',\n            'number++'\n        ],\n        [\n            'beta',\n            'number++'\n        ]\n    ]);\n    defineFunction('NORM.S.DIST', NORM_S_DIST).args([\n        [\n            'z',\n            'number'\n        ],\n        [\n            'cumulative',\n            'logical'\n        ]\n    ]);\n    defineFunction('NORM.S.INV', NORM_S_INV).args([[\n            'p',\n            [\n                'and',\n                'number',\n                [\n                    '[between]',\n                    0,\n                    1\n                ]\n            ]\n        ]]);\n    defineFunction('NORM.DIST', NORM_DIST).args([\n        [\n            'x',\n            'number'\n        ],\n        [\n            'mean',\n            'number'\n        ],\n        [\n            'stddev',\n            'number++'\n        ],\n        [\n            'cumulative',\n            'logical'\n        ]\n    ]);\n    defineFunction('NORM.INV', NORM_INV).args([\n        [\n            'p',\n            [\n                'and',\n                'number',\n                [\n                    '[between]',\n                    0,\n                    1\n                ]\n            ]\n        ],\n        [\n            'mean',\n            'number'\n        ],\n        [\n            'stddev',\n            'number++'\n        ]\n    ]);\n    defineFunction('BETADIST', BETADIST).args([\n        [\n            'x',\n            'number'\n        ],\n        [\n            'alpha',\n            'number++'\n        ],\n        [\n            'beta',\n            'number++'\n        ],\n        [\n            'A',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            'B',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    1\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$x >= $A',\n                'NUM'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$x <= $B',\n                'NUM'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$A < $B',\n                'NUM'\n            ]\n        ]\n    ]);\n    defineFunction('BETA.DIST', BETA_DIST).args([\n        [\n            'x',\n            'number'\n        ],\n        [\n            'alpha',\n            'number++'\n        ],\n        [\n            'beta',\n            'number++'\n        ],\n        [\n            'cumulative',\n            'logical'\n        ],\n        [\n            'A',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            'B',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    1\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$x >= $A',\n                'NUM'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$x <= $B',\n                'NUM'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$A < $B',\n                'NUM'\n            ]\n        ]\n    ]);\n    defineFunction('BETA.INV', BETA_INV).args([\n        [\n            'p',\n            [\n                'and',\n                'number',\n                [\n                    '[between]',\n                    0,\n                    1\n                ]\n            ]\n        ],\n        [\n            'alpha',\n            'number++'\n        ],\n        [\n            'beta',\n            'number++'\n        ],\n        [\n            'A',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            'B',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    1\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('CHISQ.DIST', chisq_left).args([\n        [\n            'x',\n            'number+'\n        ],\n        [\n            'deg_freedom',\n            'integer++'\n        ],\n        [\n            'cumulative',\n            'logical'\n        ]\n    ]);\n    defineFunction('CHISQ.DIST.RT', chisq_right).args([\n        [\n            'x',\n            'number+'\n        ],\n        [\n            'deg_freedom',\n            'integer++'\n        ]\n    ]);\n    defineFunction('CHISQ.INV', chisq_left_inv).args([\n        [\n            'p',\n            [\n                'and',\n                'number',\n                [\n                    '[between]',\n                    0,\n                    1\n                ]\n            ]\n        ],\n        [\n            'deg_freedom',\n            'integer++'\n        ]\n    ]);\n    defineFunction('CHISQ.INV.RT', chisq_right_inv).args([\n        [\n            'p',\n            [\n                'and',\n                'number',\n                [\n                    '[between]',\n                    0,\n                    1\n                ]\n            ]\n        ],\n        [\n            'deg_freedom',\n            'integer++'\n        ]\n    ]);\n    defineFunction('CHISQ.TEST', function (ac, ex) {\n        return chisq_test(ac.data, ex.data);\n    }).args([\n        [\n            'actual_range',\n            'matrix'\n        ],\n        [\n            'expected_range',\n            'matrix'\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$actual_range.width == $expected_range.width'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$actual_range.height == $expected_range.height'\n            ]\n        ]\n    ]);\n    defineFunction('EXPON.DIST', expon).args([\n        [\n            'x',\n            'number+'\n        ],\n        [\n            'lambda',\n            'number++'\n        ],\n        [\n            'cumulative',\n            'logical'\n        ]\n    ]);\n    defineFunction('POISSON.DIST', poisson).args([\n        [\n            'x',\n            'integer+'\n        ],\n        [\n            'mean',\n            'number+'\n        ],\n        [\n            'cumulative',\n            'logical'\n        ]\n    ]);\n    defineFunction('F.DIST', Fdist).args([\n        [\n            'x',\n            'number+'\n        ],\n        [\n            'deg_freedom1',\n            'integer++'\n        ],\n        [\n            'deg_freedom2',\n            'integer++'\n        ],\n        [\n            'cumulative',\n            'logical'\n        ]\n    ]);\n    defineFunction('F.DIST.RT', Fdist_right).args([\n        [\n            'x',\n            'number+'\n        ],\n        [\n            'deg_freedom1',\n            'integer++'\n        ],\n        [\n            'deg_freedom2',\n            'integer++'\n        ]\n    ]);\n    defineFunction('F.INV', Finv).args([\n        [\n            'p',\n            [\n                'and',\n                'number',\n                [\n                    '[between]',\n                    0,\n                    1\n                ]\n            ]\n        ],\n        [\n            'deg_freedom1',\n            'integer++'\n        ],\n        [\n            'deg_freedom2',\n            'integer++'\n        ]\n    ]);\n    defineFunction('F.INV.RT', Finv_right).args([\n        [\n            'p',\n            [\n                'and',\n                'number',\n                [\n                    '[between]',\n                    0,\n                    1\n                ]\n            ]\n        ],\n        [\n            'deg_freedom1',\n            'integer++'\n        ],\n        [\n            'deg_freedom2',\n            'integer++'\n        ]\n    ]);\n    defineFunction('F.TEST', Ftest).args([\n        [\n            'array1',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'array2',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$array1.length >= 2',\n                'DIV/0'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$array2.length >= 2',\n                'DIV/0'\n            ]\n        ]\n    ]);\n    defineFunction('FISHER', fisher).args([[\n            'x',\n            [\n                'and',\n                'number',\n                [\n                    '(between)',\n                    -1,\n                    1\n                ]\n            ]\n        ]]);\n    defineFunction('FISHERINV', fisherinv).args([[\n            'y',\n            'number'\n        ]]);\n    defineFunction('T.DIST', Tdist).args([\n        [\n            'x',\n            'number'\n        ],\n        [\n            'deg_freedom',\n            'integer++'\n        ],\n        [\n            'cumulative',\n            'logical'\n        ]\n    ]);\n    defineFunction('T.DIST.RT', Tdist_right).args([\n        [\n            'x',\n            'number'\n        ],\n        [\n            'deg_freedom',\n            'integer++'\n        ]\n    ]);\n    defineFunction('T.DIST.2T', Tdist_2tail).args([\n        [\n            'x',\n            'number+'\n        ],\n        [\n            'deg_freedom',\n            'integer++'\n        ]\n    ]);\n    defineFunction('T.INV', Tdist_inv).args([\n        [\n            'p',\n            [\n                'and',\n                'number',\n                [\n                    '(between]',\n                    0,\n                    1\n                ]\n            ]\n        ],\n        [\n            'deg_freedom',\n            'integer++'\n        ]\n    ]);\n    defineFunction('T.INV.2T', Tdist_2tail_inv).args([\n        [\n            'p',\n            [\n                'and',\n                'number',\n                [\n                    '(between]',\n                    0,\n                    1\n                ]\n            ]\n        ],\n        [\n            'deg_freedom',\n            'integer++'\n        ]\n    ]);\n    defineFunction('T.TEST', Tdist_test).args([\n        [\n            'array1',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'array2',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'tails',\n            [\n                'and',\n                'integer',\n                [\n                    'values',\n                    1,\n                    2\n                ]\n            ]\n        ],\n        [\n            'type',\n            [\n                'and',\n                'integer',\n                [\n                    'values',\n                    1,\n                    2,\n                    3\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$type != 1 || $array1.length == $array2.length',\n                'N/A'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$array1.length >= 2',\n                'DIV/0'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$array2.length >= 2',\n                'DIV/0'\n            ]\n        ]\n    ]);\n    defineFunction('CONFIDENCE.T', confidence_t).args([\n        [\n            'alpha',\n            [\n                'and',\n                'number',\n                [\n                    '(between)',\n                    0,\n                    1\n                ]\n            ]\n        ],\n        [\n            'standard_dev',\n            'number++'\n        ],\n        [\n            'size',\n            [\n                'and',\n                'integer++',\n                [\n                    'assert',\n                    '$size != 1',\n                    'DIV/0'\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('CONFIDENCE.NORM', confidence_norm).args([\n        [\n            'alpha',\n            [\n                'and',\n                'number',\n                [\n                    '(between)',\n                    0,\n                    1\n                ]\n            ]\n        ],\n        [\n            'standard_dev',\n            'number++'\n        ],\n        [\n            'size',\n            [\n                'and',\n                'integer++'\n            ]\n        ]\n    ]);\n    defineFunction('GAUSS', gauss).args([[\n            'z',\n            'number'\n        ]]);\n    defineFunction('PHI', phi).args([[\n            'x',\n            'number'\n        ]]);\n    defineFunction('LOGNORM.DIST', lognorm_dist).args([\n        [\n            'x',\n            'number++'\n        ],\n        [\n            'mean',\n            'number'\n        ],\n        [\n            'standard_dev',\n            'number++'\n        ],\n        [\n            'cumulative',\n            'logical'\n        ]\n    ]);\n    defineFunction('LOGNORM.INV', lognorm_inv).args([\n        [\n            'probability',\n            [\n                'and',\n                'number',\n                [\n                    '(between)',\n                    0,\n                    1\n                ]\n            ]\n        ],\n        [\n            'mean',\n            'number'\n        ],\n        [\n            'standard_dev',\n            'number++'\n        ]\n    ]);\n    defineFunction('PROB', prob).args([\n        [\n            'x_range',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'prob_range',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'lower_limit',\n            'number'\n        ],\n        [\n            'upper_limit',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    '$lower_limit'\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$prob_range.length == $x_range.length',\n                'N/A'\n            ]\n        ]\n    ]);\n    defineFunction('SLOPE', slope).args([\n        [\n            'known_y',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'known_x',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$known_x.length == $known_y.length',\n                'N/A'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$known_x.length > 0 && $known_y.length > 0',\n                'N/A'\n            ]\n        ]\n    ]);\n    defineFunction('INTERCEPT', intercept).args([\n        [\n            'known_y',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'known_x',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$known_x.length == $known_y.length',\n                'N/A'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$known_x.length > 0 && $known_y.length > 0',\n                'N/A'\n            ]\n        ]\n    ]);\n    defineFunction('PEARSON', pearson).args([\n        [\n            'array1',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'array2',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$array2.length == $array1.length',\n                'N/A'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$array2.length > 0 && $array1.length > 0',\n                'N/A'\n            ]\n        ]\n    ]);\n    defineFunction('RSQ', rsq).args([\n        [\n            'known_y',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'known_x',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$known_x.length == $known_y.length',\n                'N/A'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$known_x.length > 0 && $known_y.length > 0',\n                'N/A'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$known_x.length != 1 && $known_y.length != 1',\n                'N/A'\n            ]\n        ]\n    ]);\n    defineFunction('STEYX', steyx).args([\n        [\n            'known_y',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'known_x',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$known_x.length == $known_y.length',\n                'N/A'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$known_x.length >= 3 && $known_y.length >= 3',\n                'DIV/0'\n            ]\n        ]\n    ]);\n    defineFunction('FORECAST', forecast).args([\n        [\n            'x',\n            'number'\n        ],\n        [\n            'known_y',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'known_x',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$known_x.length == $known_y.length',\n                'N/A'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$known_x.length > 0 && $known_y.length > 0',\n                'N/A'\n            ]\n        ]\n    ]);\n    defineFunction('LINEST', linest).args([\n        [\n            'known_y',\n            'matrix'\n        ],\n        [\n            'known_x',\n            [\n                'or',\n                'matrix',\n                'null'\n            ]\n        ],\n        [\n            'const',\n            [\n                'or',\n                'logical',\n                [\n                    'null',\n                    true\n                ]\n            ]\n        ],\n        [\n            'stats',\n            [\n                'or',\n                'logical',\n                [\n                    'null',\n                    false\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('LOGEST', logest).args([\n        [\n            'known_y',\n            'matrix'\n        ],\n        [\n            'known_x',\n            [\n                'or',\n                'matrix',\n                'null'\n            ]\n        ],\n        [\n            'const',\n            [\n                'or',\n                'logical',\n                [\n                    'null',\n                    true\n                ]\n            ]\n        ],\n        [\n            'stats',\n            [\n                'or',\n                'logical',\n                [\n                    'null',\n                    false\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('TREND', trend).args([\n        [\n            'known_y',\n            'matrix'\n        ],\n        [\n            'known_x',\n            [\n                'or',\n                'matrix',\n                'null'\n            ]\n        ],\n        [\n            'new_x',\n            [\n                'or',\n                'matrix',\n                'null'\n            ]\n        ],\n        [\n            'const',\n            [\n                'or',\n                'logical',\n                [\n                    'null',\n                    true\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('GROWTH', growth).args([\n        [\n            'known_y',\n            'matrix'\n        ],\n        [\n            'known_x',\n            [\n                'or',\n                'matrix',\n                'null'\n            ]\n        ],\n        [\n            'new_x',\n            [\n                'or',\n                'matrix',\n                'null'\n            ]\n        ],\n        [\n            'const',\n            [\n                'or',\n                'logical',\n                [\n                    'null',\n                    true\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('FV', FV).args([\n        [\n            'rate',\n            'number'\n        ],\n        [\n            'nper',\n            'number'\n        ],\n        [\n            'pmt',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            'pv',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            'type',\n            [\n                'or',\n                [\n                    'values',\n                    0,\n                    1\n                ],\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$pmt || $pv'\n            ]\n        ]\n    ]);\n    defineFunction('PV', PV).args([\n        [\n            'rate',\n            'number'\n        ],\n        [\n            'nper',\n            'number'\n        ],\n        [\n            'pmt',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            'fv',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            'type',\n            [\n                'or',\n                [\n                    'values',\n                    0,\n                    1\n                ],\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$pmt || $fv'\n            ]\n        ]\n    ]);\n    defineFunction('PMT', PMT).args([\n        [\n            'rate',\n            'number'\n        ],\n        [\n            'nper',\n            'number'\n        ],\n        [\n            'pmt',\n            'number'\n        ],\n        [\n            'fv',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            'type',\n            [\n                'or',\n                [\n                    'values',\n                    0,\n                    1\n                ],\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('NPER', NPER).args([\n        [\n            'rate',\n            'number'\n        ],\n        [\n            'pmt',\n            'number'\n        ],\n        [\n            'pv',\n            'number'\n        ],\n        [\n            'fv',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            'type',\n            [\n                'or',\n                [\n                    'values',\n                    0,\n                    1\n                ],\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('RATE', RATE).args([\n        [\n            'nper',\n            'number'\n        ],\n        [\n            'pmt',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            'pv',\n            'number'\n        ],\n        [\n            'fv',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            'type',\n            [\n                'or',\n                [\n                    'values',\n                    0,\n                    1\n                ],\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            'guess',\n            [\n                'or',\n                'number++',\n                [\n                    'null',\n                    0.01\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$pmt || $fv'\n            ]\n        ]\n    ]);\n    defineFunction('IPMT', IPMT).args([\n        [\n            'rate',\n            'number'\n        ],\n        [\n            'per',\n            'number++'\n        ],\n        [\n            'nper',\n            'number++'\n        ],\n        [\n            'pv',\n            'number'\n        ],\n        [\n            'fv',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            'type',\n            [\n                'or',\n                [\n                    'values',\n                    0,\n                    1\n                ],\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$per >= 1 && $per <= $nper'\n            ]\n        ]\n    ]);\n    defineFunction('PPMT', PPMT).args([\n        [\n            'rate',\n            'number'\n        ],\n        [\n            'per',\n            'number++'\n        ],\n        [\n            'nper',\n            'number++'\n        ],\n        [\n            'pv',\n            'number'\n        ],\n        [\n            'fv',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            'type',\n            [\n                'or',\n                [\n                    'values',\n                    0,\n                    1\n                ],\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$per >= 1 && $per <= $nper'\n            ]\n        ]\n    ]);\n    defineFunction('CUMPRINC', CUMPRINC).args([\n        [\n            'rate',\n            'number++'\n        ],\n        [\n            'nper',\n            'number++'\n        ],\n        [\n            'pv',\n            'number++'\n        ],\n        [\n            'start_period',\n            'number++'\n        ],\n        [\n            'end_period',\n            'number++'\n        ],\n        [\n            'type',\n            [\n                'or',\n                [\n                    'values',\n                    0,\n                    1\n                ],\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$end_period >= $start_period',\n                'NUM'\n            ]\n        ]\n    ]);\n    defineFunction('CUMIPMT', CUMIPMT).args([\n        [\n            'rate',\n            'number++'\n        ],\n        [\n            'nper',\n            'number++'\n        ],\n        [\n            'pv',\n            'number++'\n        ],\n        [\n            'start_period',\n            'number++'\n        ],\n        [\n            'end_period',\n            'number++'\n        ],\n        [\n            'type',\n            [\n                'or',\n                [\n                    'values',\n                    0,\n                    1\n                ],\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$end_period >= $start_period',\n                'NUM'\n            ]\n        ]\n    ]);\n    defineFunction('NPV', NPV).args([\n        [\n            'rate',\n            'number'\n        ],\n        [\n            'values',\n            [\n                'collect',\n                'number'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$values.length > 0',\n                'N/A'\n            ]\n        ]\n    ]);\n    defineFunction('IRR', IRR).args([\n        [\n            'values',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'guess',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    0.1\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('EFFECT', EFFECT).args([\n        [\n            'nominal_rate',\n            'number++'\n        ],\n        [\n            'npery',\n            'integer++'\n        ]\n    ]);\n    defineFunction('NOMINAL', NOMINAL).args([\n        [\n            'effect_rate',\n            'number++'\n        ],\n        [\n            'npery',\n            'integer++'\n        ]\n    ]);\n    defineFunction('XNPV', XNPV).args([\n        [\n            'rate',\n            'number'\n        ],\n        [\n            'values',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'dates',\n            [\n                'collect',\n                'date',\n                1\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$values.length == $dates.length',\n                'NUM'\n            ]\n        ]\n    ]);\n    defineFunction('XIRR', XIRR).args([\n        [\n            'values',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'dates',\n            [\n                'collect',\n                'date',\n                1\n            ]\n        ],\n        [\n            'guess',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    0.1\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$values.length == $dates.length',\n                'NUM'\n            ]\n        ]\n    ]);\n    defineFunction('ISPMT', ISPMT).args([\n        [\n            'rate',\n            'number'\n        ],\n        [\n            'per',\n            'number++'\n        ],\n        [\n            'nper',\n            'number++'\n        ],\n        [\n            'pv',\n            'number'\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$per >= 1 && $per <= $nper'\n            ]\n        ]\n    ]);\n    defineFunction('DB', DB).args([\n        [\n            'cost',\n            'number'\n        ],\n        [\n            'salvage',\n            'number'\n        ],\n        [\n            'life',\n            'number++'\n        ],\n        [\n            'period',\n            'number++'\n        ],\n        [\n            'month',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    12\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('DDB', DDB).args([\n        [\n            'cost',\n            'number'\n        ],\n        [\n            'salvage',\n            'number'\n        ],\n        [\n            'life',\n            'number++'\n        ],\n        [\n            'period',\n            'number++'\n        ],\n        [\n            'factor',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    2\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('SLN', SLN).args([\n        [\n            'cost',\n            'number'\n        ],\n        [\n            'salvage',\n            'number'\n        ],\n        [\n            'life',\n            'number++'\n        ]\n    ]);\n    defineFunction('SYD', SYD).args([\n        [\n            'cost',\n            'number'\n        ],\n        [\n            'salvage',\n            'number'\n        ],\n        [\n            'life',\n            'number++'\n        ],\n        [\n            'per',\n            'number++'\n        ]\n    ]);\n    defineFunction('VDB', VDB).args([\n        [\n            'cost',\n            'number+'\n        ],\n        [\n            'salvage',\n            'number+'\n        ],\n        [\n            'life',\n            'number++'\n        ],\n        [\n            'start_period',\n            'number+'\n        ],\n        [\n            'end_period',\n            'number+'\n        ],\n        [\n            'factor',\n            [\n                'or',\n                'number+',\n                [\n                    'null',\n                    2\n                ]\n            ]\n        ],\n        [\n            'no_switch',\n            [\n                'or',\n                'logical',\n                [\n                    'null',\n                    false\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$end_period >= $start_period',\n                'NUM'\n            ]\n        ]\n    ]);\n    var COUPS_ARGS = [\n        [\n            'settlement',\n            'date'\n        ],\n        [\n            'maturity',\n            'date'\n        ],\n        [\n            'frequency',\n            [\n                'and',\n                'integer',\n                [\n                    'values',\n                    1,\n                    2,\n                    4\n                ]\n            ]\n        ],\n        [\n            'basis',\n            [\n                'or',\n                [\n                    'null',\n                    0\n                ],\n                [\n                    'and',\n                    'integer',\n                    [\n                        'values',\n                        0,\n                        1,\n                        2,\n                        3,\n                        4\n                    ]\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$settlement < $maturity',\n                'NUM'\n            ]\n        ]\n    ];\n    defineFunction('COUPDAYBS', COUPDAYBS).args(COUPS_ARGS);\n    defineFunction('COUPDAYS', COUPDAYS).args(COUPS_ARGS);\n    defineFunction('COUPDAYSNC', COUPDAYSNC).args(COUPS_ARGS);\n    defineFunction('COUPPCD', COUPPCD).args(COUPS_ARGS);\n    defineFunction('COUPNCD', COUPNCD).args(COUPS_ARGS);\n    defineFunction('COUPNUM', COUPNUM).args(COUPS_ARGS);\n    defineFunction('ACCRINTM', ACCRINTM).args([\n        [\n            'issue',\n            'date'\n        ],\n        [\n            'settlement',\n            'date'\n        ],\n        [\n            'rate',\n            'number++'\n        ],\n        [\n            'par',\n            [\n                'or',\n                [\n                    'null',\n                    1000\n                ],\n                'number++'\n            ]\n        ],\n        [\n            'basis',\n            [\n                'or',\n                [\n                    'null',\n                    0\n                ],\n                [\n                    'and',\n                    'integer',\n                    [\n                        'values',\n                        0,\n                        1,\n                        2,\n                        3,\n                        4\n                    ]\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$issue < $settlement',\n                'NUM'\n            ]\n        ]\n    ]);\n    defineFunction('ACCRINT', ACCRINT).args([\n        [\n            'issue',\n            'date'\n        ],\n        [\n            'first_interest',\n            'date'\n        ],\n        [\n            'settlement',\n            'date'\n        ],\n        [\n            'rate',\n            'number++'\n        ],\n        [\n            'par',\n            [\n                'or',\n                [\n                    'null',\n                    1000\n                ],\n                'number++'\n            ]\n        ],\n        [\n            'frequency',\n            [\n                'and',\n                'integer',\n                [\n                    'values',\n                    1,\n                    2,\n                    4\n                ]\n            ]\n        ],\n        [\n            'basis',\n            [\n                'or',\n                [\n                    'null',\n                    0\n                ],\n                [\n                    'and',\n                    'integer',\n                    [\n                        'values',\n                        0,\n                        1,\n                        2,\n                        3,\n                        4\n                    ]\n                ]\n            ]\n        ],\n        [\n            'calc_method',\n            [\n                'or',\n                'logical',\n                [\n                    'null',\n                    true\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$issue < $settlement',\n                'NUM'\n            ]\n        ]\n    ]);\n    defineFunction('DISC', DISC).args([\n        [\n            'settlement',\n            'date'\n        ],\n        [\n            'maturity',\n            'date'\n        ],\n        [\n            'pr',\n            'number++'\n        ],\n        [\n            'redemption',\n            'number++'\n        ],\n        [\n            'basis',\n            [\n                'or',\n                [\n                    'null',\n                    0\n                ],\n                [\n                    'and',\n                    'integer',\n                    [\n                        'values',\n                        0,\n                        1,\n                        2,\n                        3,\n                        4\n                    ]\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$settlement < $maturity',\n                'NUM'\n            ]\n        ]\n    ]);\n    defineFunction('INTRATE', INTRATE).args([\n        [\n            'settlement',\n            'date'\n        ],\n        [\n            'maturity',\n            'date'\n        ],\n        [\n            'investment',\n            'number++'\n        ],\n        [\n            'redemption',\n            'number++'\n        ],\n        [\n            'basis',\n            [\n                'or',\n                [\n                    'null',\n                    0\n                ],\n                [\n                    'and',\n                    'integer',\n                    [\n                        'values',\n                        0,\n                        1,\n                        2,\n                        3,\n                        4\n                    ]\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$settlement < $maturity',\n                'NUM'\n            ]\n        ]\n    ]);\n    defineFunction('RECEIVED', RECEIVED).args([\n        [\n            'settlement',\n            'date'\n        ],\n        [\n            'maturity',\n            'date'\n        ],\n        [\n            'investment',\n            'number++'\n        ],\n        [\n            'discount',\n            'number++'\n        ],\n        [\n            'basis',\n            [\n                'or',\n                [\n                    'null',\n                    0\n                ],\n                [\n                    'and',\n                    'integer',\n                    [\n                        'values',\n                        0,\n                        1,\n                        2,\n                        3,\n                        4\n                    ]\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$settlement < $maturity',\n                'NUM'\n            ]\n        ]\n    ]);\n    defineFunction('PRICE', PRICE).args([\n        [\n            'settlement',\n            'date'\n        ],\n        [\n            'maturity',\n            'date'\n        ],\n        [\n            'rate',\n            'number++'\n        ],\n        [\n            'yld',\n            'number++'\n        ],\n        [\n            'redemption',\n            'number++'\n        ],\n        [\n            'frequency',\n            [\n                'and',\n                'integer',\n                [\n                    'values',\n                    1,\n                    2,\n                    4\n                ]\n            ]\n        ],\n        [\n            'basis',\n            [\n                'or',\n                [\n                    'null',\n                    0\n                ],\n                [\n                    'and',\n                    'integer',\n                    [\n                        'values',\n                        0,\n                        1,\n                        2,\n                        3,\n                        4\n                    ]\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$settlement < $maturity',\n                'NUM'\n            ]\n        ]\n    ]);\n    defineFunction('PRICEDISC', PRICEDISC).args([\n        [\n            'settlement',\n            'date'\n        ],\n        [\n            'maturity',\n            'date'\n        ],\n        [\n            'discount',\n            'number++'\n        ],\n        [\n            'redemption',\n            'number++'\n        ],\n        [\n            'basis',\n            [\n                'or',\n                [\n                    'null',\n                    0\n                ],\n                [\n                    'and',\n                    'integer',\n                    [\n                        'values',\n                        0,\n                        1,\n                        2,\n                        3,\n                        4\n                    ]\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$settlement < $maturity',\n                'NUM'\n            ]\n        ]\n    ]);\n    var MAX_IT = 300, EPS = 2.2204e-16, FP_MIN = 1e-30, f_abs = Math.abs;\n    function ERF(x) {\n        if (f_abs(x) >= 3.3) {\n            return 1 - ERFC(x);\n        }\n        var S = x > 0 ? 1 : -1;\n        if (S == -1) {\n            x = -x;\n        }\n        var m = 0, an = 1;\n        for (var n = 1; n < 100; n++) {\n            m += an;\n            an *= 2 * x * x / (2 * n + 1);\n        }\n        return S * 2 / Math.sqrt(Math.PI) * x * Math.exp(-x * x) * m;\n    }\n    function ERFC(x) {\n        if (f_abs(x) < 3.3) {\n            return 1 - ERF(x);\n        }\n        var s = 1;\n        if (x < 0) {\n            s = -1;\n            x = -x;\n        }\n        var frac = x;\n        for (var n = 8; n >= 1; n -= 0.5) {\n            frac = x + n / frac;\n        }\n        frac = 1 / (x + frac);\n        return s == 1 ? Math.exp(-x * x) / Math.sqrt(Math.PI) * frac : 2 - Math.exp(-x * x) / Math.sqrt(Math.PI) * frac;\n    }\n    function GAMMALN(x) {\n        var cof = [\n            1.000000000190015,\n            76.18009172947146,\n            -86.50532032941678,\n            24.01409824083091,\n            -1.231739572450155,\n            0.001208650973866179,\n            -0.000005395239384953\n        ];\n        var y = x, tmp = x + 5.5, ser = cof[0];\n        tmp -= (x + 0.5) * Math.log(tmp);\n        for (var j = 1; j <= 6; j++) {\n            y += 1;\n            ser += cof[j] / y;\n        }\n        return -tmp + Math.log(Math.sqrt(2 * Math.PI) * ser / x);\n    }\n    function GAMMA(x) {\n        if (x > 0) {\n            return Math.exp(GAMMALN(x));\n        }\n        var pi = Math.PI, y = -x;\n        return -pi / (y * GAMMA(y) * Math.sin(pi * y));\n    }\n    function BETALN(a, b) {\n        return GAMMALN(a) + GAMMALN(b) - GAMMALN(a + b);\n    }\n    function BETA(a, b) {\n        return Math.exp(BETALN(a, b));\n    }\n    function gamma_inc(a, x) {\n        return x < a + 1 ? g_series(a, x) : 1 - g_contfrac(a, x);\n    }\n    function g_series(a, x) {\n        var sum = 1 / a, frac = sum, ap = a;\n        var gln = GAMMALN(a), n;\n        for (n = 1; n <= MAX_IT; n++) {\n            ap++;\n            frac *= x / ap;\n            sum += frac;\n            if (f_abs(frac) < f_abs(sum) * EPS) {\n                break;\n            }\n        }\n        return sum * Math.exp(-x + a * Math.log(x) - gln);\n    }\n    function g_contfrac(a, x) {\n        var f = FP_MIN, c = f, d = 0, aj = 1, bj = x + 1 - a;\n        var gln = GAMMALN(a);\n        for (var i = 1; i <= MAX_IT; i++) {\n            d = bj + aj * d;\n            if (f_abs(d) < FP_MIN) {\n                d = FP_MIN;\n            }\n            c = bj + aj / c;\n            if (f_abs(c) < FP_MIN) {\n                c = FP_MIN;\n            }\n            d = 1 / d;\n            var delta = c * d;\n            f *= delta;\n            if (f_abs(delta - 1) < EPS) {\n                break;\n            }\n            bj += 2;\n            aj = -i * (i - a);\n        }\n        return f * Math.exp(-x - gln + a * Math.log(x));\n    }\n    function GAMMA_DIST(x, a, b, cumulative) {\n        if (!cumulative) {\n            return Math.pow(x / b, a - 1) * Math.exp(-x / b) / (b * GAMMA(a));\n        }\n        return gamma_inc(a, x / b);\n    }\n    function GAMMA_INV(p, a, b) {\n        if (p === 0) {\n            return 0;\n        }\n        if (p == 1) {\n            return Infinity;\n        }\n        var m = 0, M = 10, x = 0, ab = a * b;\n        if (ab > 1) {\n            M *= ab;\n        }\n        for (var i = 0; i < MAX_IT; i++) {\n            x = 0.5 * (m + M);\n            var q = GAMMA_DIST(x, a, b, true);\n            if (f_abs(p - q) < 1e-16) {\n                break;\n            }\n            if (q > p) {\n                M = x;\n            } else {\n                m = x;\n            }\n        }\n        return x;\n    }\n    function NORM_S_DIST(x, cumulative) {\n        if (!cumulative) {\n            return Math.exp(-x * x / 2) / Math.sqrt(2 * Math.PI);\n        }\n        return 0.5 + 0.5 * ERF(x / Math.sqrt(2));\n    }\n    function NORM_S_INV(p) {\n        var a = [\n                -39.69683028665376,\n                220.9460984245205,\n                -275.9285104469687,\n                138.357751867269,\n                -30.66479806614716,\n                2.506628277459239\n            ], b = [\n                -54.47609879822406,\n                161.5858368580409,\n                -155.6989798598866,\n                66.80131188771972,\n                -13.28068155288572\n            ], c = [\n                -0.007784894002430293,\n                -0.3223964580411365,\n                -2.400758277161838,\n                -2.549732539343734,\n                4.374664141464968,\n                2.938163982698783\n            ], d = [\n                0.007784695709041462,\n                0.3224671290700398,\n                2.445134137142996,\n                3.754408661907416\n            ];\n        var plow = 0.02425, phigh = 1 - plow;\n        var q, r;\n        if (p < plow) {\n            q = Math.sqrt(-2 * Math.log(p));\n            return (((((c[0] * q + c[1]) * q + c[2]) * q + c[3]) * q + c[4]) * q + c[5]) / ((((d[0] * q + d[1]) * q + d[2]) * q + d[3]) * q + 1);\n        }\n        if (phigh < p) {\n            q = Math.sqrt(-2 * Math.log(1 - p));\n            return -(((((c[0] * q + c[1]) * q + c[2]) * q + c[3]) * q + c[4]) * q + c[5]) / ((((d[0] * q + d[1]) * q + d[2]) * q + d[3]) * q + 1);\n        }\n        q = p - 0.5;\n        r = q * q;\n        return (((((a[0] * r + a[1]) * r + a[2]) * r + a[3]) * r + a[4]) * r + a[5]) * q / (((((b[0] * r + b[1]) * r + b[2]) * r + b[3]) * r + b[4]) * r + 1);\n    }\n    function NORM_DIST(x, m, s, cumulative) {\n        if (!cumulative) {\n            return Math.exp(-(x - m) * (x - m) / (2 * s * s)) / (s * Math.sqrt(2 * Math.PI));\n        }\n        return NORM_S_DIST((x - m) / s, true);\n    }\n    function NORM_INV(p, m, s) {\n        return m + s * NORM_S_INV(p);\n    }\n    function betastd_pdf(x, a, b) {\n        return Math.exp((a - 1) * Math.log(x) + (b - 1) * Math.log(1 - x) - BETALN(a, b));\n    }\n    function betastd_cdf(x, a, b) {\n        var k = Math.exp(a * Math.log(x) + b * Math.log(1 - x) - BETALN(a, b));\n        return x < (a + 1) / (a + b + 2) ? k * beta_lentz(a, b, x) / a : 1 - k * beta_lentz(b, a, 1 - x) / b;\n    }\n    function beta_lentz(a, b, x) {\n        var m, m2;\n        var aa, c, d, del, h, qab, qam, qap;\n        qab = a + b;\n        qap = a + 1;\n        qam = a - 1;\n        c = 1;\n        d = 1 - qab * x / qap;\n        if (f_abs(d) < FP_MIN) {\n            d = FP_MIN;\n        }\n        d = 1 / d;\n        h = d;\n        for (m = 1; m <= MAX_IT; m++) {\n            m2 = 2 * m;\n            aa = m * (b - m) * x / ((qam + m2) * (a + m2));\n            d = 1 + aa * d;\n            if (f_abs(d) < FP_MIN) {\n                d = FP_MIN;\n            }\n            c = 1 + aa / c;\n            if (f_abs(c) < FP_MIN) {\n                c = FP_MIN;\n            }\n            d = 1 / d;\n            h *= d * c;\n            aa = -(a + m) * (qab + m) * x / ((a + m2) * (qap + m2));\n            d = 1 + aa * d;\n            if (f_abs(d) < FP_MIN) {\n                d = FP_MIN;\n            }\n            c = 1 + aa / c;\n            if (f_abs(c) < FP_MIN) {\n                c = FP_MIN;\n            }\n            d = 1 / d;\n            del = d * c;\n            h *= del;\n            if (f_abs(del - 1) < EPS) {\n                break;\n            }\n        }\n        return h;\n    }\n    function betastd_inv(p, a, b) {\n        var m = 0, M = 1, x = 0;\n        for (var i = 0; i < MAX_IT; i++) {\n            x = 0.5 * (m + M);\n            var q = betastd_cdf(x, a, b);\n            if (f_abs(p - q) < EPS) {\n                break;\n            }\n            if (q > p) {\n                M = x;\n            } else {\n                m = x;\n            }\n        }\n        return x;\n    }\n    function BETADIST(x, a, b, m, M) {\n        return betastd_cdf((x - m) / (M - m), a, b);\n    }\n    function BETA_DIST(x, a, b, cdf, m, M) {\n        if (cdf) {\n            return betastd_cdf((x - m) / (M - m), a, b);\n        }\n        return betastd_pdf((x - m) / (M - m), a, b) / (M - m);\n    }\n    function BETA_INV(p, a, b, m, M) {\n        return m + (M - m) * betastd_inv(p, a, b);\n    }\n    function chisq_left(x, n, cds) {\n        return GAMMA_DIST(x, n / 2, 2, cds);\n    }\n    function chisq_right(x, n) {\n        return 1 - chisq_left(x, n, true);\n    }\n    function chisq_left_inv(p, n) {\n        return GAMMA_INV(p, n / 2, 2);\n    }\n    function chisq_right_inv(p, n) {\n        return chisq_left_inv(1 - p, n);\n    }\n    function chisq_test(obsv, expect) {\n        var rows = obsv.length, cols = obsv[0].length;\n        var x = 0, i, j;\n        for (i = 0; i < rows; i++) {\n            for (j = 0; j < cols; j++) {\n                var eij = expect[i][j];\n                var delta = obsv[i][j] - eij;\n                delta *= delta;\n                x += delta / eij;\n            }\n        }\n        var n = (rows - 1) * (cols - 1);\n        return chisq_right(x, n);\n    }\n    function expon(x, r, cdf) {\n        if (cdf) {\n            return 1 - Math.exp(-r * x);\n        }\n        return r * Math.exp(-r * x);\n    }\n    function poisson(k, m, cdf) {\n        if (cdf) {\n            return 1 - chisq_left(2 * m, 2 * (k + 1), true);\n        }\n        var lnf = 0;\n        for (var i = 2; i <= k; i++) {\n            lnf += Math.log(i);\n        }\n        return Math.exp(k * Math.log(m) - m - lnf);\n    }\n    function Fdist(x, n, d, cdf) {\n        if (cdf) {\n            return betastd_cdf(n * x / (d + n * x), n / 2, d / 2);\n        }\n        var u = n / d;\n        n /= 2;\n        d /= 2;\n        return u / BETA(n, d) * Math.pow(u * x, n - 1) / Math.pow(1 + u * x, n + d);\n    }\n    function Fdist_right(x, n, d) {\n        return 1 - Fdist(x, n, d, true);\n    }\n    function Finv_right(p, n, d) {\n        return d / n * (1 / BETA_INV(p, d / 2, n / 2, 0, 1) - 1);\n    }\n    function Finv(p, n, d) {\n        return d / n * (1 / BETA_INV(1 - p, d / 2, n / 2, 0, 1) - 1);\n    }\n    function _mean(arr) {\n        var me = 0, n = arr.length;\n        for (var i = 0; i < n; i++) {\n            me += arr[i];\n        }\n        return me / n;\n    }\n    function _var_sq(arr, m) {\n        var v = 0, n = arr.length;\n        for (var i = 0; i < n; i++) {\n            var delta = arr[i] - m;\n            v += delta * delta;\n        }\n        return v / (n - 1);\n    }\n    function Ftest(arr1, arr2) {\n        var n1 = arr1.length - 1, n2 = arr2.length - 1;\n        var va1 = _var_sq(arr1, _mean(arr1)), va2 = _var_sq(arr2, _mean(arr2));\n        if (!va1 || !va2) {\n            throw new CalcError('DIV/0');\n        }\n        return 2 * Fdist(va1 / va2, n1, n2, true);\n    }\n    function fisher(x) {\n        return 0.5 * Math.log((1 + x) / (1 - x));\n    }\n    function fisherinv(x) {\n        var e2 = Math.exp(2 * x);\n        return (e2 - 1) / (e2 + 1);\n    }\n    function Tdist(x, n, cdf) {\n        if (cdf) {\n            return 1 - 0.5 * betastd_cdf(n / (x * x + n), n / 2, 0.5);\n        }\n        return 1 / (Math.sqrt(n) * BETA(0.5, n / 2)) * Math.pow(1 + x * x / n, -(n + 1) / 2);\n    }\n    function Tdist_right(x, n) {\n        return 1 - Tdist(x, n, true);\n    }\n    function Tdist_2tail(x, n) {\n        if (x < 0) {\n            x = -x;\n        }\n        return 2 * Tdist_right(x, n);\n    }\n    function Tdist_inv(p, n) {\n        var x = betastd_inv(2 * Math.min(p, 1 - p), n / 2, 0.5);\n        x = Math.sqrt(n * (1 - x) / x);\n        return p > 0.5 ? x : -x;\n    }\n    function Tdist_2tail_inv(p, n) {\n        return Tdist_inv(1 - p / 2, n);\n    }\n    function Tdist_test(gr1, gr2, tail, type) {\n        var n1 = gr1.length, n2 = gr2.length;\n        var t_st, df;\n        if (type == 1) {\n            var d = 0, d2 = 0;\n            for (var i = 0; i < n1; i++) {\n                var delta = gr1[i] - gr2[i];\n                d += delta;\n                d2 += delta * delta;\n            }\n            var md = d / n1;\n            t_st = md / Math.sqrt((d2 - d * md) / (n1 * (n1 - 1)));\n            return tail == 1 ? Tdist_right(t_st, n1 - 1) : Tdist_2tail(t_st, n1 - 1);\n        }\n        var m1 = _mean(gr1), m2 = _mean(gr2), v1 = _var_sq(gr1, m1), v2 = _var_sq(gr2, m2);\n        if (type == 3) {\n            var u1 = v1 / n1, u2 = v2 / n2, u = u1 + u2;\n            var q1 = u1 / u, q2 = u2 / u;\n            df = 1 / (q1 * q1 / (n1 - 1) + q2 * q2 / (n2 - 1));\n            t_st = f_abs(m1 - m2) / Math.sqrt(u);\n            return tail == 1 ? Tdist_right(t_st, df) : Tdist_2tail(t_st, df);\n        } else {\n            df = n1 + n2 - 2;\n            t_st = f_abs(m1 - m2) * Math.sqrt(df * n1 * n2 / ((n1 + n2) * ((n1 - 1) * v1 + (n2 - 1) * v2)));\n            return tail == 1 ? Tdist_right(t_st, df) : Tdist_2tail(t_st, df);\n        }\n    }\n    function confidence_t(alpha, stddev, size) {\n        return -Tdist_inv(alpha / 2, size - 1) * stddev / Math.sqrt(size);\n    }\n    function confidence_norm(alpha, stddev, size) {\n        return -NORM_S_INV(alpha / 2) * stddev / Math.sqrt(size);\n    }\n    function gauss(z) {\n        return NORM_S_DIST(z, true) - 0.5;\n    }\n    function phi(x) {\n        return NORM_S_DIST(x);\n    }\n    function lognorm_dist(x, m, s, cumulative) {\n        if (cumulative) {\n            return 0.5 + 0.5 * ERF((Math.log(x) - m) / (s * Math.sqrt(2)));\n        }\n        var t = Math.log(x) - m;\n        return Math.exp(-t * t / (2 * s * s)) / (x * s * Math.sqrt(2 * Math.PI));\n    }\n    function lognorm_inv(p, m, s) {\n        return Math.exp(NORM_INV(p, m, s));\n    }\n    function prob(x_, p_, lw, up) {\n        var n = x_.length;\n        var s = 0, i;\n        for (i = 0; i < n; i++) {\n            if (p_[i] <= 0 || p_[i] > 1) {\n                throw new CalcError('NUM');\n            }\n            s += p_[i];\n        }\n        if (s != 1) {\n            throw new CalcError('NUM');\n        }\n        var res = 0;\n        for (i = 0; i < n; i++) {\n            var x = x_[i];\n            if (x >= lw && x <= up) {\n                res += p_[i];\n            }\n        }\n        return res;\n    }\n    function slope(y_, x_) {\n        var mx = _mean(x_), my = _mean(y_), b1 = 0, b2 = 0;\n        for (var i = 0, n = y_.length; i < n; i++) {\n            var t = x_[i] - mx;\n            b1 += t * (y_[i] - my);\n            b2 += t * t;\n        }\n        return b1 / b2;\n    }\n    function intercept(y_, x_) {\n        var mx = _mean(x_), my = _mean(y_);\n        var b1 = 0, b2 = 0;\n        for (var i = 0, n = y_.length; i < n; i++) {\n            var t = x_[i] - mx;\n            b1 += t * (y_[i] - my);\n            b2 += t * t;\n        }\n        return my - b1 * mx / b2;\n    }\n    function pearson(x_, y_) {\n        var mx = _mean(x_), my = _mean(y_);\n        var s1 = 0, s2 = 0, s3 = 0;\n        for (var i = 0, n = x_.length; i < n; i++) {\n            var t1 = x_[i] - mx, t2 = y_[i] - my;\n            s1 += t1 * t2;\n            s2 += t1 * t1;\n            s3 += t2 * t2;\n        }\n        return s1 / Math.sqrt(s2 * s3);\n    }\n    function rsq(x_, y_) {\n        var r = pearson(x_, y_);\n        return r * r;\n    }\n    function steyx(y_, x_) {\n        var n = x_.length;\n        var mx = _mean(x_), my = _mean(y_);\n        var s1 = 0, s2 = 0, s3 = 0;\n        for (var i = 0; i < n; i++) {\n            var t1 = x_[i] - mx, t2 = y_[i] - my;\n            s1 += t2 * t2;\n            s2 += t1 * t2;\n            s3 += t1 * t1;\n        }\n        return Math.sqrt((s1 - s2 * s2 / s3) / (n - 2));\n    }\n    function forecast(x, y_, x_) {\n        var mx = _mean(x_), my = _mean(y_);\n        var s1 = 0, s2 = 0;\n        for (var i = 0, n = x_.length; i < n; i++) {\n            var t1 = x_[i] - mx, t2 = y_[i] - my;\n            s1 += t1 * t2;\n            s2 += t1 * t1;\n        }\n        if (s2 === 0) {\n            throw new CalcError('N/A');\n        }\n        var b = s1 / s2, a = my - b * mx;\n        return a + b * x;\n    }\n    function _mat_mean(Mat) {\n        var n = Mat.height, sum = 0;\n        for (var i = 0; i < n; i++) {\n            sum += Mat.data[i][0];\n        }\n        return sum / n;\n    }\n    function _mat_devsq(Mat, mean) {\n        var n = Mat.height, sq = 0;\n        for (var i = 0; i < n; i++) {\n            var x = Mat.data[i][0] - mean;\n            sq += x * x;\n        }\n        return sq;\n    }\n    function linest(Y, X, konst, stats) {\n        var i = 0;\n        if (!X) {\n            X = Y.map(function () {\n                return ++i;\n            });\n        }\n        if (konst) {\n            X = X.clone();\n            X.eachRow(function (row) {\n                X.data[row].unshift(1);\n            });\n            ++X.width;\n        }\n        var Xt = X.transpose();\n        var B = Xt.multiply(X).inverse().multiply(Xt).multiply(Y);\n        var line_1 = [];\n        for (i = B.height - 1; i >= 0; i--) {\n            line_1.push(B.data[i][0]);\n        }\n        if (!konst) {\n            line_1.push(0);\n        }\n        if (!stats) {\n            return this.asMatrix([line_1]);\n        }\n        var Y1 = X.multiply(B);\n        var y_y1 = Y.adds(Y1, true);\n        var mp = !konst ? 0 : _mat_mean(Y1);\n        var SSreg = _mat_devsq(Y1, mp);\n        var me = !konst ? 0 : _mat_mean(y_y1);\n        var SSresid = _mat_devsq(y_y1, me);\n        var line_5 = [];\n        line_5.push(SSreg, SSresid);\n        var R2 = SSreg / (SSreg + SSresid);\n        var degfre = Y.height - X.width;\n        var err_est = Math.sqrt(SSresid / degfre);\n        var line_3 = [];\n        line_3.push(R2, err_est);\n        var F_sta = !konst ? R2 / X.width / ((1 - R2) / degfre) : SSreg / (X.width - 1) / (SSresid / degfre);\n        var line_4 = [];\n        line_4.push(F_sta, degfre);\n        var SCP = Xt.multiply(X).inverse();\n        var line_2 = [];\n        for (i = SCP.height - 1; i >= 0; i--) {\n            line_2.push(Math.sqrt(SCP.data[i][i] * SSresid / degfre));\n        }\n        return this.asMatrix([\n            line_1,\n            line_2,\n            line_3,\n            line_4,\n            line_5\n        ]);\n    }\n    function logest(Y, X, konst, stats) {\n        return linest.call(this, Y.map(Math.log), X, konst, stats).map(Math.exp);\n    }\n    function trend(Y, X, W, konst) {\n        var i = 0;\n        if (!X) {\n            X = Y.map(function () {\n                return ++i;\n            });\n        }\n        if (konst) {\n            X = X.clone();\n            X.eachRow(function (row) {\n                X.data[row].unshift(1);\n            });\n            ++X.width;\n        }\n        var Xt = X.transpose();\n        var B = Xt.multiply(X).inverse().multiply(Xt).multiply(Y);\n        if (!W) {\n            W = X;\n        } else {\n            if (konst) {\n                W = W.clone();\n                W.eachRow(function (row) {\n                    W.data[row].unshift(1);\n                });\n                ++W.width;\n            }\n        }\n        return W.multiply(B);\n    }\n    function growth(Y, X, new_X, konst) {\n        return trend.call(this, Y.map(Math.log), X, new_X, konst).map(Math.exp);\n    }\n    function root_newton(func, guess, max_it, eps) {\n        var MAX_IT = max_it || 20, EPS = eps || 1e-7;\n        var root = guess;\n        for (var j = 1; j <= MAX_IT; j++) {\n            var f_d = func(root), f = f_d[0], df = f_d[1];\n            var dx = f / df;\n            root -= dx;\n            if (Math.abs(dx) < EPS) {\n                return root;\n            }\n        }\n        return new CalcError('NUM');\n    }\n    function FV(rate, nper, pmt, pv, type) {\n        var h1 = Math.pow(1 + rate, nper);\n        var h2 = rate ? (h1 - 1) / rate : nper;\n        return -(pv * h1 + pmt * h2 * (1 + rate * type));\n    }\n    function PV(rate, nper, pmt, fv, type) {\n        if (!rate) {\n            return -fv - pmt * nper;\n        }\n        var h1 = Math.pow(1 + rate, nper);\n        return -(fv + pmt * (h1 - 1) / rate * (1 + rate * type)) / h1;\n    }\n    function PMT(rate, nper, pv, fv, type) {\n        if (!rate) {\n            return -(fv + pv) / nper;\n        }\n        var h1 = Math.pow(1 + rate, nper);\n        return -rate * (fv + pv * h1) / ((1 + rate * type) * (h1 - 1));\n    }\n    function NPER(rate, pmt, pv, fv, type) {\n        if (!rate) {\n            return -(fv + pv) / pmt;\n        }\n        var h1 = pmt * (1 + rate * type);\n        return Math.log((h1 - fv * rate) / (h1 + pv * rate)) / Math.log(1 + rate);\n    }\n    function RATE(nper, pmt, pv, fv, type, guess) {\n        function xfd(x) {\n            var h2 = Math.pow(1 + x, nper - 1), h1 = h2 * (1 + x);\n            return [\n                pv * h1 + pmt * (1 / x + type) * (h1 - 1) + fv,\n                nper * pv * h2 + pmt * (-(h1 - 1) / (x * x) + (1 / x + type) * nper * h2)\n            ];\n        }\n        return root_newton(xfd, guess);\n    }\n    function IPMT(rate, per, nper, pv, fv, type) {\n        if (type == 1 && per == 1) {\n            return 0;\n        }\n        var pmt = PMT(rate, nper, pv, fv, type);\n        var ipmt = FV(rate, per - 1, pmt, pv, type) * rate;\n        return type ? ipmt / (1 + rate) : ipmt;\n    }\n    function PPMT(rate, per, nper, pv, fv, type) {\n        var pmt = PMT(rate, nper, pv, fv, type);\n        return pmt - IPMT(rate, per, nper, pv, fv, type);\n    }\n    function CUMPRINC(rate, nper, pv, start, end, type) {\n        if (type == 1) {\n            start--;\n            end--;\n        }\n        var tn = Math.pow(1 + rate, nper), ts = Math.pow(1 + rate, start - 1), te = Math.pow(1 + rate, end);\n        var monthlyPayment = rate * pv * tn / (tn - 1);\n        var remainingBalanceAtStart = ts * pv - (ts - 1) / rate * monthlyPayment;\n        var remainingBalanceAtEnd = te * pv - (te - 1) / rate * monthlyPayment;\n        return remainingBalanceAtEnd - remainingBalanceAtStart;\n    }\n    function CUMIPMT(rate, nper, pv, start, end, type) {\n        var cip = 0;\n        for (var i = start; i <= end; i++) {\n            cip += IPMT(rate, i, nper, pv, 0, type);\n        }\n        return cip;\n    }\n    function NPV(rate, flows) {\n        var npv = 0;\n        for (var i = 0, n = flows.length; i < n; i++) {\n            npv += flows[i] * Math.pow(1 + rate, -i - 1);\n        }\n        return npv;\n    }\n    function IRR(flows, guess) {\n        function xfd(x) {\n            var npv = 0, npv1 = 0;\n            for (var j = 0, n = flows.length; j < n; j++) {\n                npv += flows[j] * Math.pow(1 + x, -j - 1);\n                npv1 += -j * flows[j] * Math.pow(1 + x, -j - 2);\n            }\n            return [\n                npv,\n                npv1\n            ];\n        }\n        return root_newton(xfd, guess);\n    }\n    function EFFECT(nominal_rate, npery) {\n        return Math.pow(1 + nominal_rate / npery, npery) - 1;\n    }\n    function NOMINAL(effect_rate, npery) {\n        return npery * (Math.pow(effect_rate + 1, 1 / npery) - 1);\n    }\n    function XNPV(rate, values, dates) {\n        var npv = 0;\n        for (var i = 0, n = values.length; i < n; i++) {\n            npv += values[i] * Math.pow(1 + rate, (dates[0] - dates[i]) / 365);\n        }\n        return npv;\n    }\n    function XIRR(values, dates, guess) {\n        function xfd(x) {\n            var npv = values[0], npv1 = 0;\n            for (var j = 1, n = values.length; j < n; j++) {\n                var delta = (dates[0] - dates[j]) / 365;\n                npv += values[j] * Math.pow(1 + x, delta);\n                npv1 += delta * values[j] * Math.pow(1 + x, delta - 1);\n            }\n            return [\n                npv,\n                npv1\n            ];\n        }\n        return root_newton(xfd, guess);\n    }\n    function ISPMT(rate, per, nper, pv) {\n        var tmp = -pv * rate;\n        return tmp * (1 - per / nper);\n    }\n    function DB(cost, salvage, life, period, month) {\n        var rate = 1 - Math.pow(salvage / cost, 1 / life);\n        rate = Math.floor(rate * 1000 + 0.5) / 1000;\n        var db = cost * rate * month / 12;\n        if (period == 1) {\n            return db;\n        }\n        for (var i = 1; i < life; i++) {\n            if (i == period - 1) {\n                return (cost - db) * rate;\n            }\n            db += (cost - db) * rate;\n        }\n        return (cost - db) * rate * (12 - month) / 12;\n    }\n    function DDB(cost, salvage, life, period, factor) {\n        var f = factor / life;\n        var prior = -cost * (Math.pow(1 - f, period - 1) - 1);\n        var dep = (cost - prior) * f;\n        dep = Math.min(dep, Math.max(0, cost - prior - salvage));\n        return dep;\n    }\n    function SLN(cost, salvage, life) {\n        return (cost - salvage) / life;\n    }\n    function SYD(cost, salvage, life, per) {\n        return (cost - salvage) * (life - per + 1) * 2 / (life * (life + 1));\n    }\n    function VDB(cost, salvage, life, start, end, factor, no_switch) {\n        var interest = factor >= life ? 1 : factor / life;\n        function _getGDA(value, period) {\n            var gda, oldValue, newValue;\n            if (interest == 1) {\n                oldValue = period == 1 ? value : 0;\n            } else {\n                oldValue = value * Math.pow(1 - interest, period - 1);\n            }\n            newValue = value * Math.pow(1 - interest, period);\n            gda = newValue < salvage ? oldValue - salvage : oldValue - newValue;\n            return gda < 0 ? 0 : gda;\n        }\n        function _interVDB(cost, life1, period) {\n            var remValue = cost - salvage;\n            var intEnd = Math.ceil(period);\n            var term, lia = 0, vdb = 0, nowLia = false;\n            for (var i = 1; i <= intEnd; i++) {\n                if (!nowLia) {\n                    var gda = _getGDA(cost, i);\n                    lia = remValue / (life1 - i + 1);\n                    if (lia > gda) {\n                        term = lia;\n                        nowLia = true;\n                    } else {\n                        term = gda;\n                        remValue -= gda;\n                    }\n                } else {\n                    term = lia;\n                }\n                if (i == intEnd) {\n                    term *= period + 1 - intEnd;\n                }\n                vdb += term;\n            }\n            return vdb;\n        }\n        var intStart = Math.floor(start), intEnd = Math.ceil(end);\n        var vdb = 0;\n        if (no_switch) {\n            for (var i = intStart + 1; i <= intEnd; i++) {\n                var term = _getGDA(cost, i);\n                if (i == intStart + 1) {\n                    term *= Math.min(end, intStart + 1) - start;\n                } else {\n                    if (i == intEnd) {\n                        term *= end + 1 - intEnd;\n                    }\n                }\n                vdb += term;\n            }\n        } else {\n            var life1 = life;\n            if (start != Math.floor(start)) {\n                if (factor > 1) {\n                    if (start >= life / 2) {\n                        var part = start - life / 2;\n                        start = life / 2;\n                        end -= part;\n                        life1 += 1;\n                    }\n                }\n            }\n            cost -= _interVDB(cost, life1, start);\n            vdb = _interVDB(cost, life - start, end - start);\n        }\n        return vdb;\n    }\n    function _edate(base, months) {\n        var d = unpackDate(base);\n        var m = d.month + months;\n        var y = d.year + Math.floor(m / 12);\n        m %= 12;\n        if (m < 0) {\n            m += 12;\n        }\n        d = Math.min(d.date, daysInMonth(y, m));\n        return packDate(y, m, d);\n    }\n    function _daysBetween(from, to, basis) {\n        if (basis == 1 || basis == 2 || basis == 3) {\n            return to - from;\n        }\n        return _days_360(from, to, basis);\n    }\n    function _borderCoupons(settlement, maturity, freq) {\n        var sett = unpackDate(settlement), base = unpackDate(maturity);\n        var periods = base.year - sett.year;\n        if (periods > 0) {\n            periods = (periods - 1) * freq;\n        }\n        var prev, next, months = 12 / freq;\n        do {\n            periods++;\n            prev = _edate(maturity, -periods * months);\n        } while (settlement < prev);\n        periods--;\n        next = _edate(maturity, -periods * months);\n        return [\n            prev,\n            next\n        ];\n    }\n    function _borderCoupons_fw(first, settlement, freq) {\n        var sett = unpackDate(settlement), base = unpackDate(first);\n        var periods = sett.year - base.year;\n        if (periods > 0) {\n            periods = (periods - 1) * freq;\n        }\n        var prev = first, next, months = 12 / freq;\n        while (settlement > prev) {\n            next = prev;\n            periods++;\n            prev = _edate(first, periods * months);\n        }\n        return [\n            next,\n            prev\n        ];\n    }\n    function COUPDAYBS(settlement, maturity, frequency, basis) {\n        var prev = _borderCoupons(settlement, maturity, frequency)[0];\n        return _daysBetween(prev, settlement, basis);\n    }\n    function COUPDAYS(settl, matur, freq, basis) {\n        if (basis == 1) {\n            var borders = _borderCoupons(settl, matur, freq);\n            return _daysBetween(borders[0], borders[1], 1);\n        }\n        if (basis == 3) {\n            return 365 / freq;\n        }\n        return 360 / freq;\n    }\n    function COUPDAYSNC(settl, matur, freq, basis) {\n        var next = _borderCoupons(settl, matur, freq)[1];\n        return _daysBetween(settl, next, basis);\n    }\n    function COUPPCD(settl, matur, freq) {\n        return _borderCoupons(settl, matur, freq)[0];\n    }\n    function COUPNCD(settl, matur, freq) {\n        return _borderCoupons(settl, matur, freq)[1];\n    }\n    function COUPNUM(settl, matur, freq) {\n        var sett = unpackDate(settl), mat = unpackDate(matur);\n        var months = 12 * (mat.year - sett.year) + mat.month - sett.month;\n        return 1 + (months * freq / 12 | 0);\n    }\n    function daysInYear(yr, basis) {\n        if (basis == 3) {\n            return 365;\n        }\n        if (basis == 1) {\n            return isLeapYear(yr) ? 366 : 365;\n        }\n        return 360;\n    }\n    function ACCRINTM(issue, maturity, rate, par, basis) {\n        var year_days = daysInYear(unpackDate(maturity).year, basis);\n        return rate * par * _daysBetween(issue, maturity, basis) / year_days;\n    }\n    function ACCRINT(issue, first, settl, rate, par, freq, basis, calc) {\n        var accr = 0, cost = par * rate / freq;\n        var brace, prev, next, prev1, next1, nrc;\n        var annual = basis % 2 === 0 ? 360 : 365;\n        function _numCoupons(from, to) {\n            return (to - from) * freq / annual | 0;\n        }\n        if (settl <= first) {\n            brace = _borderCoupons(settl, first, freq);\n            prev = brace[0];\n            next = brace[1];\n            if (prev <= issue) {\n                return cost * _daysBetween(issue, settl, basis) / _daysBetween(prev, next, basis);\n            }\n            brace = _borderCoupons(issue, prev, freq);\n            prev1 = brace[0];\n            next1 = brace[1];\n            nrc = _numCoupons(next1, settl);\n            return cost * (nrc + _daysBetween(issue, next1, basis) / _daysBetween(prev1, next1, basis) + (settl < next ? _daysBetween(prev, settl, basis) / _daysBetween(prev, next, basis) : 0));\n        } else {\n            brace = _borderCoupons_fw(first, settl, freq);\n            prev = brace[0];\n            next = brace[1];\n            nrc = _numCoupons(first, settl);\n            if (next == settl) {\n                accr = cost * nrc;\n            } else {\n                accr = cost * (nrc + _daysBetween(prev, settl, basis) / _daysBetween(prev, next, basis));\n            }\n            if (!calc) {\n                return accr;\n            }\n            brace = _borderCoupons(issue, first, freq);\n            prev = brace[0];\n            next = brace[1];\n            nrc = _numCoupons(issue, first);\n            accr += cost * (nrc + _daysBetween(issue, next, basis) / _daysBetween(prev, next, basis));\n            return accr;\n        }\n    }\n    function DISC(settl, matur, pr, redemption, basis) {\n        var annual = basis % 2 === 0 ? 360 : isLeapYear(unpackDate(settl).year) ? 366 : 365;\n        return (redemption - pr) / redemption * annual / _daysBetween(settl, matur, basis);\n    }\n    function INTRATE(settl, matur, investment, redemption, basis) {\n        var annual = basis % 2 === 0 ? 360 : isLeapYear(unpackDate(settl).year) ? 366 : 365;\n        return (redemption - investment) / investment * annual / _daysBetween(settl, matur, basis);\n    }\n    function RECEIVED(settl, matur, investment, discount, basis) {\n        var annual = basis % 2 === 0 ? 360 : isLeapYear(unpackDate(settl).year) ? 366 : 365;\n        return investment / (1 - discount * _daysBetween(settl, matur, basis) / annual);\n    }\n    function PRICE(settl, matur, rate, yld, redemption, freq, basis) {\n        var N = 1 + ((matur - settl) * freq / (basis % 2 === 0 ? 360 : 365) | 0);\n        var brace = _borderCoupons(settl, matur, freq), prev = brace[0], next = brace[1];\n        var beg_settl = _daysBetween(prev, settl, basis), settl_end = _daysBetween(settl, next, basis), beg_end = _daysBetween(prev, next, basis);\n        var den = 100 * rate / freq, yf = yld / freq, frac = settl_end / beg_end;\n        if (N == 1) {\n            return (redemption + den) / (1 + frac * yf) - beg_settl / beg_end * den;\n        }\n        return redemption / Math.pow(1 + yf, N - 1 + frac) + den * Math.pow(1 + yf, 1 - N - frac) * (Math.pow(1 + yf, N) - 1) / yf - beg_settl / beg_end * den;\n    }\n    function PRICEDISC(settl, matur, discount, redemption, basis) {\n        var dsm = _daysBetween(settl, matur, basis), dy = daysInYear(unpackDate(matur).year, basis);\n        return redemption - discount * redemption * dsm / dy;\n    }\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/borderpalette', [\n        'kendo.core',\n        'kendo.colorpicker',\n        'kendo.popup'\n    ], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var $ = kendo.jQuery;\n        var BORDER_TYPES = [\n            'allBorders',\n            'insideBorders',\n            'insideHorizontalBorders',\n            'insideVerticalBorders',\n            'outsideBorders',\n            'leftBorder',\n            'topBorder',\n            'rightBorder',\n            'bottomBorder',\n            'noBorders'\n        ];\n        var BORDER_PALETTE_MESSAGES = kendo.spreadsheet.messages.borderPalette = {\n            allBorders: 'All borders',\n            insideBorders: 'Inside borders',\n            insideHorizontalBorders: 'Inside horizontal borders',\n            insideVerticalBorders: 'Inside vertical borders',\n            outsideBorders: 'Outside borders',\n            leftBorder: 'Left border',\n            topBorder: 'Top border',\n            rightBorder: 'Right border',\n            bottomBorder: 'Bottom border',\n            noBorders: 'No border',\n            reset: 'Reset color',\n            customColor: 'Custom color...',\n            apply: 'Apply',\n            cancel: 'Cancel'\n        };\n        var ColorChooser = kendo.ui.Widget.extend({\n            init: function (element, options) {\n                kendo.ui.Widget.call(this, element, options);\n                this.element = element;\n                this.color = options.color;\n                this._resetButton();\n                this._colorPalette();\n                this._customColorPalette();\n                this._customColorButton();\n                this.resetButton.on('click', this.resetColor.bind(this));\n                this.customColorButton.on('click', this.customColor.bind(this));\n            },\n            options: { name: 'ColorChooser' },\n            events: ['change'],\n            destroy: function () {\n                kendo.unbind(this.dialog.element.find('.k-action-buttons'));\n                this.dialog.destroy();\n                this.colorPalette.destroy();\n                this.resetButton.off('click');\n                this.customColorButton.off('click');\n            },\n            value: function (value) {\n                if (value !== undefined) {\n                    this.color = value;\n                    this.customColorButton.find('.k-icon').css('background-color', this.color);\n                    this.colorPalette.value(null);\n                    this.flatColorPicker.value(this.color);\n                } else {\n                    return this.color;\n                }\n            },\n            _change: function (value) {\n                this.color = value;\n                this.trigger('change', { value: value });\n            },\n            _colorPalette: function () {\n                var element = $('<div />', { 'class': 'k-spreadsheet-color-palette' });\n                var colorPalette = this.colorPalette = $('<div />').kendoColorPalette({\n                    palette: [\n                        '#ffffff',\n                        '#000000',\n                        '#d6ecff',\n                        '#4e5b6f',\n                        '#7fd13b',\n                        '#ea157a',\n                        '#feb80a',\n                        '#00addc',\n                        '#738ac8',\n                        '#1ab39f',\n                        '#f2f2f2',\n                        '#7f7f7f',\n                        '#a7d6ff',\n                        '#d9dde4',\n                        '#e5f5d7',\n                        '#fad0e4',\n                        '#fef0cd',\n                        '#c5f2ff',\n                        '#e2e7f4',\n                        '#c9f7f1',\n                        '#d8d8d8',\n                        '#595959',\n                        '#60b5ff',\n                        '#b3bcca',\n                        '#cbecb0',\n                        '#f6a1c9',\n                        '#fee29c',\n                        '#8be6ff',\n                        '#c7d0e9',\n                        '#94efe3',\n                        '#bfbfbf',\n                        '#3f3f3f',\n                        '#007dea',\n                        '#8d9baf',\n                        '#b2e389',\n                        '#f272af',\n                        '#fed46b',\n                        '#51d9ff',\n                        '#aab8de',\n                        '#5fe7d5',\n                        '#a5a5a5',\n                        '#262626',\n                        '#003e75',\n                        '#3a4453',\n                        '#5ea226',\n                        '#af0f5b',\n                        '#c58c00',\n                        '#0081a5',\n                        '#425ea9',\n                        '#138677',\n                        '#7f7f7f',\n                        '#0c0c0c',\n                        '#00192e',\n                        '#272d37',\n                        '#3f6c19',\n                        '#750a3d',\n                        '#835d00',\n                        '#00566e',\n                        '#2c3f71',\n                        '#0c594f'\n                    ],\n                    value: this.color,\n                    change: function (e) {\n                        this.customColorButton.find('.k-icon').css('background-color', 'transparent');\n                        this.flatColorPicker.value(null);\n                        this._change(e.value);\n                    }.bind(this)\n                }).data('kendoColorPalette');\n                element.append(colorPalette.wrapper).appendTo(this.element);\n            },\n            _customColorPalette: function () {\n                var element = $('<div />', {\n                    'class': 'k-spreadsheet-window',\n                    'html': '<div></div>' + '<div class=\\'k-action-buttons\\'>' + '<button class=\\'k-button k-primary\\' data-bind=\\'click: apply\\'>' + BORDER_PALETTE_MESSAGES.apply + '</button>' + '<button class=\\'k-button\\' data-bind=\\'click: close\\'>' + BORDER_PALETTE_MESSAGES.cancel + '</button>' + '</div>'\n                });\n                var dialog = this.dialog = element.appendTo(document.body).kendoWindow({\n                    animation: false,\n                    scrollable: false,\n                    resizable: false,\n                    maximizable: false,\n                    modal: true,\n                    visible: false,\n                    width: 268,\n                    open: function () {\n                        this.center();\n                    }\n                }).data('kendoWindow');\n                dialog.one('activate', function () {\n                    this.element.find('[data-role=flatcolorpicker]').data('kendoFlatColorPicker')._hueSlider.resize();\n                });\n                var flatColorPicker = this.flatColorPicker = dialog.element.children().first().kendoFlatColorPicker().data('kendoFlatColorPicker');\n                var viewModel = kendo.observable({\n                    apply: function () {\n                        this.customColorButton.find('.k-icon').css('background-color', flatColorPicker.value());\n                        this.colorPalette.value(null);\n                        this._change(flatColorPicker.value());\n                        dialog.close();\n                    }.bind(this),\n                    close: function () {\n                        flatColorPicker.value(null);\n                        dialog.close();\n                    }\n                });\n                kendo.bind(dialog.element.find('.k-action-buttons'), viewModel);\n            },\n            _resetButton: function () {\n                this.resetButton = $('<a class=\\'k-button k-reset-color\\' href=\\'#\\'>' + '<span class=\\'k-icon k-font-icon k-i-reset-color\\'></span>' + BORDER_PALETTE_MESSAGES.reset + '</a>').appendTo(this.element);\n            },\n            _customColorButton: function () {\n                this.customColorButton = $('<a class=\\'k-button k-custom-color\\' href=\\'#\\'>' + '<span class=\\'k-icon\\'></span>' + BORDER_PALETTE_MESSAGES.customColor + '</a>').appendTo(this.element);\n            },\n            resetColor: function () {\n                this.colorPalette.value(null);\n                this.flatColorPicker.value(null);\n                this._change(null);\n            },\n            customColor: function () {\n                this.dialog.open();\n            }\n        });\n        var BorderPalette = kendo.ui.Widget.extend({\n            init: function (element, options) {\n                kendo.ui.Widget.call(this, element, options);\n                this.element = element;\n                this.color = '#000';\n                this.element.addClass('k-spreadsheet-border-palette');\n                this._borderTypePalette();\n                this._borderColorPalette();\n                this.element.on('click', '.k-spreadsheet-border-type-palette .k-button', this._click.bind(this));\n            },\n            options: { name: 'BorderPalette' },\n            events: ['change'],\n            destroy: function () {\n                this.colorChooser.destroy();\n                this.element.off('click');\n            },\n            _borderTypePalette: function () {\n                var messages = BORDER_PALETTE_MESSAGES;\n                var buttons = BORDER_TYPES.map(function (type) {\n                    return '<a title=\"' + messages[type] + '\" href=\"#\" data-border-type=\"' + type + '\" class=\"k-button k-button-icon\">' + '<span class=\"k-sprite k-font-icon k-icon k-i-' + kendo.toHyphens(type) + '\"></span>' + '</a>';\n                }).join('');\n                var element = $('<div />', {\n                    'class': 'k-spreadsheet-border-type-palette',\n                    'html': buttons\n                });\n                element.appendTo(this.element);\n            },\n            _borderColorPalette: function () {\n                var element = $('<div />', { 'class': 'k-spreadsheet-border-color-palette' });\n                element.appendTo(this.element);\n                this.colorChooser = new ColorChooser(element, {\n                    color: this.color,\n                    change: this._colorChange.bind(this)\n                });\n            },\n            _click: function (e) {\n                this.type = $(e.currentTarget).data('borderType');\n                this.trigger('change', {\n                    type: this.type,\n                    color: this.color\n                });\n            },\n            _colorChange: function (e) {\n                this.color = e.value;\n                if (this.type) {\n                    this.trigger('change', {\n                        type: this.type,\n                        color: this.color\n                    });\n                }\n            }\n        });\n        kendo.spreadsheet.ColorChooser = ColorChooser;\n        kendo.spreadsheet.BorderPalette = BorderPalette;\n    }(window.kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/toolbar', [\n        'kendo.toolbar',\n        'kendo.colorpicker',\n        'kendo.combobox',\n        'kendo.dropdownlist',\n        'kendo.popup',\n        'spreadsheet/borderpalette'\n    ], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var $ = kendo.jQuery;\n        var ToolBar = kendo.ui.ToolBar;\n        var MESSAGES = kendo.spreadsheet.messages.toolbar = {\n            addColumnLeft: 'Add column left',\n            addColumnRight: 'Add column right',\n            addRowAbove: 'Add row above',\n            addRowBelow: 'Add row below',\n            alignment: 'Alignment',\n            alignmentButtons: {\n                justtifyLeft: 'Align left',\n                justifyCenter: 'Center',\n                justifyRight: 'Align right',\n                justifyFull: 'Justify',\n                alignTop: 'Align top',\n                alignMiddle: 'Align middle',\n                alignBottom: 'Align bottom'\n            },\n            backgroundColor: 'Background',\n            bold: 'Bold',\n            borders: 'Borders',\n            colorPicker: {\n                reset: 'Reset color',\n                customColor: 'Custom color...'\n            },\n            copy: 'Copy',\n            cut: 'Cut',\n            deleteColumn: 'Delete column',\n            deleteRow: 'Delete row',\n            filter: 'Filter',\n            fontFamily: 'Font',\n            fontSize: 'Font size',\n            format: 'Custom format...',\n            formatTypes: {\n                automatic: 'Automatic',\n                number: 'Number',\n                percent: 'Percent',\n                financial: 'Financial',\n                currency: 'Currency',\n                date: 'Date',\n                time: 'Time',\n                dateTime: 'Date time',\n                duration: 'Duration',\n                moreFormats: 'More formats...'\n            },\n            formatDecreaseDecimal: 'Decrease decimal',\n            formatIncreaseDecimal: 'Increase decimal',\n            freeze: 'Freeze panes',\n            freezeButtons: {\n                freezePanes: 'Freeze panes',\n                freezeRows: 'Freeze rows',\n                freezeColumns: 'Freeze columns',\n                unfreeze: 'Unfreeze panes'\n            },\n            italic: 'Italic',\n            merge: 'Merge cells',\n            mergeButtons: {\n                mergeCells: 'Merge all',\n                mergeHorizontally: 'Merge horizontally',\n                mergeVertically: 'Merge vertically',\n                unmerge: 'Unmerge'\n            },\n            open: 'Open...',\n            paste: 'Paste',\n            quickAccess: {\n                redo: 'Redo',\n                undo: 'Undo'\n            },\n            exportAs: 'Export...',\n            sortAsc: 'Sort ascending',\n            sortDesc: 'Sort descending',\n            sortButtons: {\n                sortSheetAsc: 'Sort sheet A to Z',\n                sortSheetDesc: 'Sort sheet Z to A',\n                sortRangeAsc: 'Sort range A to Z',\n                sortRangeDesc: 'Sort range Z to A'\n            },\n            textColor: 'Text Color',\n            textWrap: 'Wrap text',\n            underline: 'Underline',\n            validation: 'Data validation...'\n        };\n        var defaultTools = {\n            home: [\n                'open',\n                'exportAs',\n                [\n                    'cut',\n                    'copy',\n                    'paste'\n                ],\n                [\n                    'bold',\n                    'italic',\n                    'underline'\n                ],\n                'backgroundColor',\n                'textColor',\n                'borders',\n                'fontSize',\n                'fontFamily',\n                'alignment',\n                'textWrap',\n                [\n                    'formatDecreaseDecimal',\n                    'formatIncreaseDecimal'\n                ],\n                'format',\n                'merge',\n                'freeze',\n                'filter'\n            ],\n            insert: [\n                [\n                    'addColumnLeft',\n                    'addColumnRight',\n                    'addRowBelow',\n                    'addRowAbove'\n                ],\n                [\n                    'deleteColumn',\n                    'deleteRow'\n                ]\n            ],\n            data: [\n                'sort',\n                'filter',\n                'validation'\n            ]\n        };\n        var toolDefaults = {\n            open: {\n                type: 'open',\n                overflow: 'never',\n                iconClass: 'xlsa'\n            },\n            exportAs: {\n                type: 'exportAsDialog',\n                dialogName: 'exportAs',\n                overflow: 'never',\n                text: '',\n                iconClass: 'xlsa'\n            },\n            bold: {\n                type: 'button',\n                command: 'PropertyChangeCommand',\n                property: 'bold',\n                value: true,\n                iconClass: 'bold',\n                togglable: true\n            },\n            italic: {\n                type: 'button',\n                command: 'PropertyChangeCommand',\n                property: 'italic',\n                value: true,\n                iconClass: 'italic',\n                togglable: true\n            },\n            underline: {\n                type: 'button',\n                command: 'PropertyChangeCommand',\n                property: 'underline',\n                value: true,\n                iconClass: 'underline',\n                togglable: true\n            },\n            formatDecreaseDecimal: {\n                type: 'button',\n                command: 'AdjustDecimalsCommand',\n                value: -1,\n                iconClass: 'decrease-decimal'\n            },\n            formatIncreaseDecimal: {\n                type: 'button',\n                command: 'AdjustDecimalsCommand',\n                value: +1,\n                iconClass: 'increase-decimal'\n            },\n            textWrap: {\n                type: 'button',\n                command: 'TextWrapCommand',\n                property: 'wrap',\n                value: true,\n                iconClass: 'text-wrap',\n                togglable: true\n            },\n            cut: {\n                type: 'button',\n                command: 'ToolbarCutCommand',\n                iconClass: 'cut'\n            },\n            copy: {\n                type: 'button',\n                command: 'ToolbarCopyCommand',\n                iconClass: 'copy'\n            },\n            paste: {\n                type: 'button',\n                command: 'ToolbarPasteCommand',\n                iconClass: 'paste'\n            },\n            separator: { type: 'separator' },\n            alignment: {\n                type: 'alignment',\n                iconClass: 'justify-left'\n            },\n            backgroundColor: {\n                type: 'colorPicker',\n                property: 'background',\n                iconClass: 'background'\n            },\n            textColor: {\n                type: 'colorPicker',\n                property: 'color',\n                iconClass: 'text'\n            },\n            fontFamily: {\n                type: 'fontFamily',\n                property: 'fontFamily',\n                iconClass: 'text'\n            },\n            fontSize: {\n                type: 'fontSize',\n                property: 'fontSize',\n                iconClass: 'font-size'\n            },\n            format: {\n                type: 'format',\n                property: 'format',\n                iconClass: 'format-number'\n            },\n            filter: {\n                type: 'filter',\n                property: 'hasFilter',\n                iconClass: 'filter'\n            },\n            merge: {\n                type: 'merge',\n                iconClass: 'merge-cells'\n            },\n            freeze: {\n                type: 'freeze',\n                iconClass: 'freeze-panes'\n            },\n            borders: {\n                type: 'borders',\n                iconClass: 'all-borders'\n            },\n            formatCells: {\n                type: 'dialog',\n                dialogName: 'formatCells',\n                overflow: 'never'\n            },\n            addColumnLeft: {\n                type: 'button',\n                command: 'AddColumnCommand',\n                value: 'left',\n                iconClass: 'add-column-left'\n            },\n            addColumnRight: {\n                type: 'button',\n                command: 'AddColumnCommand',\n                value: 'right',\n                iconClass: 'add-column-right'\n            },\n            addRowBelow: {\n                type: 'button',\n                command: 'AddRowCommand',\n                value: 'below',\n                iconClass: 'add-row-below'\n            },\n            addRowAbove: {\n                type: 'button',\n                command: 'AddRowCommand',\n                value: 'above',\n                iconClass: 'add-row-above'\n            },\n            deleteColumn: {\n                type: 'button',\n                command: 'DeleteColumnCommand',\n                iconClass: 'delete-column'\n            },\n            deleteRow: {\n                type: 'button',\n                command: 'DeleteRowCommand',\n                iconClass: 'delete-row'\n            },\n            sort: {\n                type: 'sort',\n                iconClass: 'sort-desc'\n            },\n            validation: {\n                type: 'dialog',\n                dialogName: 'validation',\n                iconClass: 'exception',\n                overflow: 'never'\n            }\n        };\n        var SpreadsheetToolBar = ToolBar.extend({\n            init: function (element, options) {\n                options.items = this._expandTools(options.tools || SpreadsheetToolBar.prototype.options.tools[options.toolbarName]);\n                ToolBar.fn.init.call(this, element, options);\n                var handleClick = this._click.bind(this);\n                this.element.addClass('k-spreadsheet-toolbar');\n                this._addSeparators(this.element);\n                this.bind({\n                    click: handleClick,\n                    toggle: handleClick\n                });\n            },\n            _addSeparators: function (element) {\n                var groups = element.children('.k-widget, a.k-button, .k-button-group');\n                groups.before('<span class=\\'k-separator\\' />');\n            },\n            _expandTools: function (tools) {\n                function expandTool(toolName) {\n                    var options = $.isPlainObject(toolName) ? toolName : toolDefaults[toolName] || {};\n                    var spriteCssClass = 'k-icon k-font-icon k-i-' + options.iconClass;\n                    var type = options.type;\n                    var typeDefaults = {\n                        splitButton: { spriteCssClass: spriteCssClass },\n                        button: { showText: 'overflow' },\n                        colorPicker: { toolIcon: spriteCssClass }\n                    };\n                    var tool = $.extend({\n                        name: options.name || toolName,\n                        text: MESSAGES[options.name || toolName],\n                        spriteCssClass: spriteCssClass,\n                        attributes: { title: MESSAGES[options.name || toolName] }\n                    }, typeDefaults[type], options);\n                    if (type == 'splitButton') {\n                        tool.menuButtons = tool.menuButtons.map(expandTool);\n                    }\n                    tool.attributes['data-tool'] = toolName;\n                    if (options.property) {\n                        tool.attributes['data-property'] = options.property;\n                    }\n                    return tool;\n                }\n                return tools.reduce(function (tools, tool) {\n                    if ($.isArray(tool)) {\n                        tools.push({\n                            type: 'buttonGroup',\n                            buttons: tool.map(expandTool)\n                        });\n                    } else {\n                        tools.push(expandTool.call(this, tool));\n                    }\n                    return tools;\n                }, []);\n            },\n            _click: function (e) {\n                var toolName = e.target.attr('data-tool');\n                var tool = toolDefaults[toolName] || {};\n                var commandType = tool.command;\n                if (!commandType) {\n                    return;\n                }\n                var args = {\n                    command: commandType,\n                    options: {\n                        property: tool.property || null,\n                        value: tool.value || null\n                    }\n                };\n                if (typeof args.options.value === 'boolean') {\n                    args.options.value = e.checked ? true : null;\n                }\n                this.action(args);\n            },\n            events: [\n                'click',\n                'toggle',\n                'open',\n                'close',\n                'overflowOpen',\n                'overflowClose',\n                'action',\n                'dialog'\n            ],\n            options: {\n                name: 'SpreadsheetToolBar',\n                resizable: true,\n                tools: defaultTools\n            },\n            action: function (args) {\n                this.trigger('action', args);\n            },\n            dialog: function (args) {\n                this.trigger('dialog', args);\n            },\n            refresh: function (activeCell) {\n                var range = activeCell;\n                var tools = this._tools();\n                function setToggle(tool, value) {\n                    var toolbar = tool.toolbar;\n                    var overflow = tool.overflow;\n                    var togglable = toolbar && toolbar.options.togglable || overflow && overflow.options.togglable;\n                    if (!togglable) {\n                        return;\n                    }\n                    var toggle = false;\n                    if (typeof value === 'boolean') {\n                        toggle = value;\n                    } else if (typeof value === 'string') {\n                        toggle = toolbar.options.value === value;\n                    }\n                    toolbar.toggle(toggle);\n                    if (overflow) {\n                        overflow.toggle(toggle);\n                    }\n                }\n                function update(tool, value) {\n                    var toolbar = tool.toolbar;\n                    var overflow = tool.overflow;\n                    if (toolbar && toolbar.update) {\n                        toolbar.update(value);\n                    }\n                    if (overflow && overflow.update) {\n                        overflow.update(value);\n                    }\n                }\n                for (var i = 0; i < tools.length; i++) {\n                    var property = tools[i].property;\n                    var tool = tools[i].tool;\n                    var value = kendo.isFunction(range[property]) ? range[property]() : range;\n                    if (tool.type === 'button') {\n                        setToggle(tool, value);\n                    } else {\n                        update(tool, value);\n                    }\n                }\n            },\n            _tools: function () {\n                return this.element.find('[data-property]').toArray().reduce(function (tools, element) {\n                    element = $(element);\n                    var property = element.attr('data-property');\n                    tools.push({\n                        property: property,\n                        tool: this._getItem(element)\n                    });\n                    return tools;\n                }.bind(this), []);\n            },\n            destroy: function () {\n                this.element.find('[data-command],.k-button').each(function () {\n                    var element = $(this);\n                    var instance = element.data('instance');\n                    if (instance && instance.destroy) {\n                        instance.destroy();\n                    }\n                });\n                ToolBar.fn.destroy.call(this);\n            }\n        });\n        kendo.spreadsheet.ToolBar = SpreadsheetToolBar;\n        var DropDownTool = kendo.toolbar.Item.extend({\n            init: function (options, toolbar) {\n                var dropDownList = $('<select />').kendoDropDownList({ height: 'auto' }).data('kendoDropDownList');\n                this.dropDownList = dropDownList;\n                this.element = dropDownList.wrapper;\n                this.options = options;\n                this.toolbar = toolbar;\n                this.attributes();\n                this.addUidAttr();\n                this.addOverflowAttr();\n                dropDownList.bind('open', this._open.bind(this));\n                dropDownList.bind('change', this._change.bind(this));\n                this.element.width(options.width).attr({\n                    'data-command': 'PropertyChangeCommand',\n                    'data-property': options.property\n                });\n            },\n            _open: function () {\n                var ddl = this.dropDownList;\n                var list = ddl.list;\n                var listWidth;\n                list.css({\n                    whiteSpace: 'nowrap',\n                    width: 'auto'\n                });\n                listWidth = list.width();\n                if (listWidth) {\n                    listWidth += 20;\n                } else {\n                    listWidth = ddl._listWidth;\n                }\n                list.css('width', listWidth + kendo.support.scrollbar());\n                ddl._listWidth = listWidth;\n            },\n            _change: function (e) {\n                var instance = e.sender;\n                var value = instance.value();\n                var dataItem = instance.dataItem();\n                var popupName = dataItem ? dataItem.popup : undefined;\n                if (popupName) {\n                    this.toolbar.dialog({ name: popupName });\n                } else {\n                    this.toolbar.action({\n                        command: 'PropertyChangeCommand',\n                        options: {\n                            property: this.options.property,\n                            value: value == 'null' ? null : value\n                        }\n                    });\n                }\n            },\n            value: function (value) {\n                if (value !== undefined) {\n                    this.dropDownList.value(value);\n                } else {\n                    return this.dropDownList.value();\n                }\n            }\n        });\n        var PopupTool = kendo.toolbar.Item.extend({\n            init: function (options, toolbar) {\n                this.element = $('<a href=\\'#\\' class=\\'k-button k-button-icon\\'>' + '<span class=\\'' + options.spriteCssClass + '\\'>' + '</span><span class=\\'k-icon k-i-arrow-s\\'></span>' + '</a>');\n                this.element.on('click', this.open.bind(this)).attr('data-command', options.command);\n                this.options = options;\n                this.toolbar = toolbar;\n                this.attributes();\n                this.addUidAttr();\n                this.addOverflowAttr();\n                this._popup();\n            },\n            destroy: function () {\n                this.popup.destroy();\n            },\n            open: function () {\n                this.popup.toggle();\n            },\n            _popup: function () {\n                var element = this.element;\n                this.popup = $('<div class=\\'k-spreadsheet-popup\\' />').appendTo(element).kendoPopup({ anchor: element }).data('kendoPopup');\n            }\n        });\n        kendo.toolbar.registerComponent('dialog', kendo.toolbar.ToolBarButton.extend({\n            init: function (options, toolbar) {\n                kendo.toolbar.ToolBarButton.fn.init.call(this, options, toolbar);\n                this._dialogName = options.dialogName;\n                this.element.bind('click', this.open.bind(this)).data('instance', this);\n            },\n            open: function () {\n                this.toolbar.dialog({ name: this._dialogName });\n            }\n        }));\n        kendo.toolbar.registerComponent('exportAsDialog', kendo.toolbar.Item.extend({\n            init: function (options, toolbar) {\n                this._dialogName = options.dialogName;\n                this.toolbar = toolbar;\n                this.element = $('<button class=\\'k-button k-button-icon\\' title=\\'' + options.attributes.title + '\\'>' + '<span class=\\'k-icon k-font-icon k-i-xls\\' />' + '</button>').data('instance', this);\n                this.element.bind('click', this.open.bind(this)).data('instance', this);\n            },\n            open: function () {\n                this.toolbar.dialog({ name: this._dialogName });\n            }\n        }));\n        var OverflowDialogButton = kendo.toolbar.OverflowButton.extend({\n            init: function (options, toolbar) {\n                kendo.toolbar.OverflowButton.fn.init.call(this, options, toolbar);\n                this.element.on('click', this._click.bind(this));\n                this.message = this.options.text;\n                var instance = this.element.data('button');\n                this.element.data(this.options.type, instance);\n            },\n            _click: $.noop\n        });\n        var ColorPicker = PopupTool.extend({\n            init: function (options, toolbar) {\n                PopupTool.fn.init.call(this, options, toolbar);\n                this.popup.element.addClass('k-spreadsheet-colorpicker');\n                this.colorChooser = new kendo.spreadsheet.ColorChooser(this.popup.element, { change: this._colorChange.bind(this) });\n                this.element.attr({ 'data-property': options.property });\n                this.element.data({\n                    type: 'colorPicker',\n                    colorPicker: this,\n                    instance: this\n                });\n            },\n            destroy: function () {\n                this.colorChooser.destroy();\n                PopupTool.fn.destroy.call(this);\n            },\n            update: function (value) {\n                this.value(value);\n            },\n            value: function (value) {\n                this.colorChooser.value(value);\n            },\n            _colorChange: function (e) {\n                this.toolbar.action({\n                    command: 'PropertyChangeCommand',\n                    options: {\n                        property: this.options.property,\n                        value: e.sender.value()\n                    }\n                });\n                this.popup.close();\n            }\n        });\n        var ColorPickerButton = OverflowDialogButton.extend({\n            init: function (options, toolbar) {\n                options.iconName = 'text';\n                OverflowDialogButton.fn.init.call(this, options, toolbar);\n            },\n            _click: function () {\n                this.toolbar.dialog({\n                    name: 'colorPicker',\n                    options: {\n                        title: this.options.property,\n                        property: this.options.property\n                    }\n                });\n            }\n        });\n        kendo.toolbar.registerComponent('colorPicker', ColorPicker, ColorPickerButton);\n        var FONT_SIZES = [\n            8,\n            9,\n            10,\n            11,\n            12,\n            13,\n            14,\n            16,\n            18,\n            20,\n            22,\n            24,\n            26,\n            28,\n            36,\n            48,\n            72\n        ];\n        var DEFAULT_FONT_SIZE = 12;\n        var FontSize = kendo.toolbar.Item.extend({\n            init: function (options, toolbar) {\n                var comboBox = $('<input />').kendoComboBox({\n                    change: this._valueChange.bind(this),\n                    dataSource: options.fontSizes || FONT_SIZES,\n                    value: DEFAULT_FONT_SIZE\n                }).data('kendoComboBox');\n                this.comboBox = comboBox;\n                this.element = comboBox.wrapper;\n                this.options = options;\n                this.toolbar = toolbar;\n                this.attributes();\n                this.addUidAttr();\n                this.addOverflowAttr();\n                this.element.width(options.width).attr({\n                    'data-command': 'PropertyChangeCommand',\n                    'data-property': options.property\n                });\n                this.element.data({\n                    type: 'fontSize',\n                    fontSize: this\n                });\n            },\n            _valueChange: function (e) {\n                this.toolbar.action({\n                    command: 'PropertyChangeCommand',\n                    options: {\n                        property: this.options.property,\n                        value: kendo.parseInt(e.sender.value())\n                    }\n                });\n            },\n            update: function (value) {\n                this.value(kendo.parseInt(value) || DEFAULT_FONT_SIZE);\n            },\n            value: function (value) {\n                if (value !== undefined) {\n                    this.comboBox.value(value);\n                } else {\n                    return this.comboBox.value();\n                }\n            }\n        });\n        var FontSizeButton = OverflowDialogButton.extend({\n            _click: function () {\n                this.toolbar.dialog({\n                    name: 'fontSize',\n                    options: {\n                        sizes: FONT_SIZES,\n                        defaultSize: DEFAULT_FONT_SIZE\n                    }\n                });\n            },\n            update: function (value) {\n                this._value = value || DEFAULT_FONT_SIZE;\n                this.element.find('.k-text').text(this.message + ' (' + this._value + ') ...');\n            }\n        });\n        kendo.toolbar.registerComponent('fontSize', FontSize, FontSizeButton);\n        var FONT_FAMILIES = [\n            'Arial',\n            'Courier New',\n            'Georgia',\n            'Times New Roman',\n            'Trebuchet MS',\n            'Verdana'\n        ];\n        var DEFAULT_FONT_FAMILY = 'Arial';\n        var FontFamily = DropDownTool.extend({\n            init: function (options, toolbar) {\n                DropDownTool.fn.init.call(this, options, toolbar);\n                var ddl = this.dropDownList;\n                ddl.setDataSource(options.fontFamilies || FONT_FAMILIES);\n                ddl.value(DEFAULT_FONT_FAMILY);\n                this.element.data({\n                    type: 'fontFamily',\n                    fontFamily: this\n                });\n            },\n            update: function (value) {\n                this.value(value || DEFAULT_FONT_FAMILY);\n            }\n        });\n        var FontFamilyButton = OverflowDialogButton.extend({\n            _click: function () {\n                this.toolbar.dialog({\n                    name: 'fontFamily',\n                    options: {\n                        fonts: FONT_FAMILIES,\n                        defaultFont: DEFAULT_FONT_FAMILY\n                    }\n                });\n            },\n            update: function (value) {\n                this._value = value || DEFAULT_FONT_FAMILY;\n                this.element.find('.k-text').text(this.message + ' (' + this._value + ') ...');\n            }\n        });\n        kendo.toolbar.registerComponent('fontFamily', FontFamily, FontFamilyButton);\n        var defaultFormats = kendo.spreadsheet.formats = {\n            automatic: null,\n            number: '#,0.00',\n            percent: '0.00%',\n            financial: '_(\"$\"* #,##0.00_);_(\"$\"* (#,##0.00);_(\"$\"* \"-\"??_);_(@_)',\n            currency: '$#,##0.00;[Red]$#,##0.00',\n            date: 'm/d/yyyy',\n            time: 'h:mm:ss AM/PM',\n            dateTime: 'm/d/yyyy h:mm',\n            duration: '[h]:mm:ss'\n        };\n        var Format = DropDownTool.extend({\n            _revertTitle: function (e) {\n                e.sender.value('');\n                e.sender.wrapper.width('auto');\n            },\n            init: function (options, toolbar) {\n                DropDownTool.fn.init.call(this, options, toolbar);\n                var ddl = this.dropDownList;\n                var icon = '<span class=\\'k-icon k-font-icon k-i-' + options.iconClass + '\\' style=\\'line-height: 1em; width: 1.35em;\\'></span>';\n                ddl.bind('change', this._revertTitle.bind(this));\n                ddl.bind('dataBound', this._revertTitle.bind(this));\n                ddl.setOptions({\n                    dataValueField: 'format',\n                    dataTextField: 'name',\n                    dataValuePrimitive: true,\n                    valueTemplate: icon,\n                    template: '# if (data.sample) { #' + '<span class=\\'k-spreadsheet-sample\\'>#: data.sample #</span>' + '# } #' + '#: data.name #'\n                });\n                ddl.text(icon);\n                ddl.setDataSource([\n                    {\n                        format: defaultFormats.automatic,\n                        name: MESSAGES.formatTypes.automatic\n                    },\n                    {\n                        format: defaultFormats.number,\n                        name: MESSAGES.formatTypes.number,\n                        sample: '1,499.99'\n                    },\n                    {\n                        format: defaultFormats.percent,\n                        name: MESSAGES.formatTypes.percent,\n                        sample: '14.50%'\n                    },\n                    {\n                        format: defaultFormats.financial,\n                        name: MESSAGES.formatTypes.financial,\n                        sample: '(1,000.12)'\n                    },\n                    {\n                        format: defaultFormats.currency,\n                        name: MESSAGES.formatTypes.currency,\n                        sample: '$1,499.99'\n                    },\n                    {\n                        format: defaultFormats.date,\n                        name: MESSAGES.formatTypes.date,\n                        sample: '4/21/2012'\n                    },\n                    {\n                        format: defaultFormats.time,\n                        name: MESSAGES.formatTypes.time,\n                        sample: '5:49:00 PM'\n                    },\n                    {\n                        format: defaultFormats.dateTime,\n                        name: MESSAGES.formatTypes.dateTime,\n                        sample: '4/21/2012 5:49:00'\n                    },\n                    {\n                        format: defaultFormats.duration,\n                        name: MESSAGES.formatTypes.duration,\n                        sample: '168:05:00'\n                    },\n                    {\n                        popup: 'formatCells',\n                        name: MESSAGES.formatTypes.moreFormats\n                    }\n                ]);\n                this.element.data({\n                    type: 'format',\n                    format: this\n                });\n            }\n        });\n        var FormatButton = OverflowDialogButton.extend({\n            _click: function () {\n                this.toolbar.dialog({ name: 'formatCells' });\n            }\n        });\n        kendo.toolbar.registerComponent('format', Format, FormatButton);\n        var BorderChangeTool = PopupTool.extend({\n            init: function (options, toolbar) {\n                PopupTool.fn.init.call(this, options, toolbar);\n                this._borderPalette();\n                this.element.data({\n                    type: 'borders',\n                    instance: this\n                });\n            },\n            destroy: function () {\n                this.borderPalette.destroy();\n                PopupTool.fn.destroy.call(this);\n            },\n            _borderPalette: function () {\n                var element = $('<div />').appendTo(this.popup.element);\n                this.borderPalette = new kendo.spreadsheet.BorderPalette(element, { change: this._action.bind(this) });\n            },\n            _action: function (e) {\n                this.toolbar.action({\n                    command: 'BorderChangeCommand',\n                    options: {\n                        border: e.type,\n                        style: {\n                            size: 1,\n                            color: e.color\n                        }\n                    }\n                });\n            }\n        });\n        var BorderChangeButton = OverflowDialogButton.extend({\n            _click: function () {\n                this.toolbar.dialog({ name: 'borders' });\n            }\n        });\n        kendo.toolbar.registerComponent('borders', BorderChangeTool, BorderChangeButton);\n        var AlignmentTool = PopupTool.extend({\n            init: function (options, toolbar) {\n                PopupTool.fn.init.call(this, options, toolbar);\n                this.element.attr({ 'data-property': 'alignment' });\n                this._commandPalette();\n                this.popup.element.on('click', '.k-button', function (e) {\n                    this._action($(e.currentTarget));\n                }.bind(this));\n                this.element.data({\n                    type: 'alignment',\n                    alignment: this,\n                    instance: this\n                });\n            },\n            buttons: [\n                {\n                    property: 'textAlign',\n                    value: 'left',\n                    iconClass: 'justify-left',\n                    text: MESSAGES.alignmentButtons.justtifyLeft\n                },\n                {\n                    property: 'textAlign',\n                    value: 'center',\n                    iconClass: 'justify-center',\n                    text: MESSAGES.alignmentButtons.justifyCenter\n                },\n                {\n                    property: 'textAlign',\n                    value: 'right',\n                    iconClass: 'justify-right',\n                    text: MESSAGES.alignmentButtons.justifyRight\n                },\n                {\n                    property: 'textAlign',\n                    value: 'justify',\n                    iconClass: 'justify-full',\n                    text: MESSAGES.alignmentButtons.justifyFull\n                },\n                {\n                    property: 'verticalAlign',\n                    value: 'top',\n                    iconClass: 'align-top',\n                    text: MESSAGES.alignmentButtons.alignTop\n                },\n                {\n                    property: 'verticalAlign',\n                    value: 'center',\n                    iconClass: 'align-middle',\n                    text: MESSAGES.alignmentButtons.alignMiddle\n                },\n                {\n                    property: 'verticalAlign',\n                    value: 'bottom',\n                    iconClass: 'align-bottom',\n                    text: MESSAGES.alignmentButtons.alignBottom\n                }\n            ],\n            destroy: function () {\n                this.popup.element.off();\n                PopupTool.fn.destroy.call(this);\n            },\n            update: function (range) {\n                var textAlign = range.textAlign();\n                var verticalAlign = range.verticalAlign();\n                this.popup.element.find('.k-button').removeClass('k-state-active');\n                if (textAlign) {\n                    this.popup.element.find('.k-button[data-value=' + textAlign + ']').addClass('k-state-active');\n                }\n                if (verticalAlign) {\n                    this.popup.element.find('.k-button[data-value=' + verticalAlign + ']').addClass('k-state-active');\n                }\n            },\n            _commandPalette: function () {\n                var buttons = this.buttons;\n                var element = $('<div />').appendTo(this.popup.element);\n                buttons.forEach(function (options, index) {\n                    var button = '<a title=\\'' + options.text + '\\' data-property=\\'' + options.property + '\\' data-value=\\'' + options.value + '\\' class=\\'k-button k-button-icon\\'>' + '<span class=\\'k-icon k-font-icon k-i-' + options.iconClass + '\\'></span>' + '</a>';\n                    if (index !== 0 && buttons[index - 1].property !== options.property) {\n                        element.append($('<span class=\\'k-separator\\' />'));\n                    }\n                    element.append(button);\n                });\n            },\n            _action: function (button) {\n                var property = button.attr('data-property');\n                var value = button.attr('data-value');\n                this.toolbar.action({\n                    command: 'PropertyChangeCommand',\n                    options: {\n                        property: property,\n                        value: value\n                    }\n                });\n            }\n        });\n        var AlignmentButton = OverflowDialogButton.extend({\n            _click: function () {\n                this.toolbar.dialog({ name: 'alignment' });\n            }\n        });\n        kendo.toolbar.registerComponent('alignment', AlignmentTool, AlignmentButton);\n        var MergeTool = PopupTool.extend({\n            init: function (options, toolbar) {\n                PopupTool.fn.init.call(this, options, toolbar);\n                this._commandPalette();\n                this.popup.element.on('click', '.k-button', function (e) {\n                    this._action($(e.currentTarget));\n                }.bind(this));\n                this.element.data({\n                    type: 'merge',\n                    merge: this,\n                    instance: this\n                });\n            },\n            buttons: [\n                {\n                    value: 'cells',\n                    iconClass: 'merge-cells',\n                    text: MESSAGES.mergeButtons.mergeCells\n                },\n                {\n                    value: 'horizontally',\n                    iconClass: 'merge-horizontally',\n                    text: MESSAGES.mergeButtons.mergeHorizontally\n                },\n                {\n                    value: 'vertically',\n                    iconClass: 'merge-vertically',\n                    text: MESSAGES.mergeButtons.mergeVertically\n                },\n                {\n                    value: 'unmerge',\n                    iconClass: 'normal-layout',\n                    text: MESSAGES.mergeButtons.unmerge\n                }\n            ],\n            destroy: function () {\n                this.popup.element.off();\n                PopupTool.fn.destroy.call(this);\n            },\n            _commandPalette: function () {\n                var element = $('<div />').appendTo(this.popup.element);\n                this.buttons.forEach(function (options) {\n                    var button = '<a title=\\'' + options.text + '\\' data-value=\\'' + options.value + '\\' class=\\'k-button k-button-icontext\\'>' + '<span class=\\'k-icon k-font-icon k-i-' + options.iconClass + '\\'></span>' + options.text + '</a>';\n                    element.append(button);\n                });\n            },\n            _action: function (button) {\n                var value = button.attr('data-value');\n                this.toolbar.action({\n                    command: 'MergeCellCommand',\n                    options: { value: value }\n                });\n            }\n        });\n        var MergeButton = OverflowDialogButton.extend({\n            _click: function () {\n                this.toolbar.dialog({ name: 'merge' });\n            }\n        });\n        kendo.toolbar.registerComponent('merge', MergeTool, MergeButton);\n        var FreezeTool = PopupTool.extend({\n            init: function (options, toolbar) {\n                PopupTool.fn.init.call(this, options, toolbar);\n                this._commandPalette();\n                this.popup.element.on('click', '.k-button', function (e) {\n                    this._action($(e.currentTarget));\n                }.bind(this));\n                this.element.data({\n                    type: 'freeze',\n                    freeze: this,\n                    instance: this\n                });\n            },\n            buttons: [\n                {\n                    value: 'panes',\n                    iconClass: 'freeze-panes',\n                    text: MESSAGES.freezeButtons.freezePanes\n                },\n                {\n                    value: 'rows',\n                    iconClass: 'freeze-row',\n                    text: MESSAGES.freezeButtons.freezeRows\n                },\n                {\n                    value: 'columns',\n                    iconClass: 'freeze-col',\n                    text: MESSAGES.freezeButtons.freezeColumns\n                },\n                {\n                    value: 'unfreeze',\n                    iconClass: 'normal-layout',\n                    text: MESSAGES.freezeButtons.unfreeze\n                }\n            ],\n            destroy: function () {\n                this.popup.element.off();\n                PopupTool.fn.destroy.call(this);\n            },\n            _commandPalette: function () {\n                var element = $('<div />').appendTo(this.popup.element);\n                this.buttons.forEach(function (options) {\n                    var button = '<a title=\\'' + options.text + '\\' data-value=\\'' + options.value + '\\' class=\\'k-button k-button-icontext\\'>' + '<span class=\\'k-icon k-font-icon k-i-' + options.iconClass + '\\'></span>' + options.text + '</a>';\n                    element.append(button);\n                });\n            },\n            _action: function (button) {\n                var value = button.attr('data-value');\n                this.toolbar.action({\n                    command: 'FreezePanesCommand',\n                    options: { value: value }\n                });\n            }\n        });\n        var FreezeButton = OverflowDialogButton.extend({\n            _click: function () {\n                this.toolbar.dialog({ name: 'freeze' });\n            }\n        });\n        kendo.toolbar.registerComponent('freeze', FreezeTool, FreezeButton);\n        var Sort = DropDownTool.extend({\n            _revertTitle: function (e) {\n                e.sender.value('');\n                e.sender.wrapper.width('auto');\n            },\n            init: function (options, toolbar) {\n                DropDownTool.fn.init.call(this, options, toolbar);\n                var ddl = this.dropDownList;\n                ddl.bind('change', this._revertTitle.bind(this));\n                ddl.bind('dataBound', this._revertTitle.bind(this));\n                ddl.setOptions({\n                    valueTemplate: '<span class=\\'k-icon k-font-icon k-i-' + options.iconClass + '\\' style=\\'line-height: 1em; width: 1.35em;\\'></span>',\n                    template: '<span class=\\'k-icon k-font-icon k-i-#= iconClass #\\' style=\\'line-height: 1em; width: 1.35em;\\'></span>#=text#',\n                    dataTextField: 'text',\n                    dataValueField: 'value'\n                });\n                ddl.setDataSource([\n                    {\n                        value: 'asc',\n                        sheet: false,\n                        text: MESSAGES.sortButtons.sortRangeAsc,\n                        iconClass: 'sort-asc'\n                    },\n                    {\n                        value: 'desc',\n                        sheet: false,\n                        text: MESSAGES.sortButtons.sortRangeDesc,\n                        iconClass: 'sort-desc'\n                    }\n                ]);\n                ddl.select(0);\n                this.element.data({\n                    type: 'sort',\n                    sort: this\n                });\n            },\n            _change: function (e) {\n                var instance = e.sender;\n                var dataItem = instance.dataItem();\n                if (dataItem) {\n                    this.toolbar.action({\n                        command: 'SortCommand',\n                        options: {\n                            value: dataItem.value,\n                            sheet: dataItem.sheet\n                        }\n                    });\n                }\n            },\n            value: $.noop\n        });\n        var SortButton = OverflowDialogButton.extend({\n            _click: function () {\n                this.toolbar.dialog({ name: 'sort' });\n            }\n        });\n        kendo.toolbar.registerComponent('sort', Sort, SortButton);\n        var Filter = kendo.toolbar.ToolBarButton.extend({\n            init: function (options, toolbar) {\n                options.showText = 'overflow';\n                kendo.toolbar.ToolBarButton.fn.init.call(this, options, toolbar);\n                this.element.on('click', this._click.bind(this));\n                this.element.data({\n                    type: 'filter',\n                    filter: this\n                });\n            },\n            _click: function () {\n                this.toolbar.action({ command: 'FilterCommand' });\n            },\n            update: function (value) {\n                this.toggle(value);\n            }\n        });\n        var FilterButton = OverflowDialogButton.extend({\n            init: function (options, toolbar) {\n                OverflowDialogButton.fn.init.call(this, options, toolbar);\n                this.element.data({\n                    type: 'filter',\n                    filter: this\n                });\n            },\n            _click: function () {\n                this.toolbar.action({ command: 'FilterCommand' });\n            },\n            update: function (value) {\n                this.toggle(value);\n            }\n        });\n        kendo.toolbar.registerComponent('filter', Filter, FilterButton);\n        var Open = kendo.toolbar.Item.extend({\n            init: function (options, toolbar) {\n                this.toolbar = toolbar;\n                this.element = $('<div class=\\'k-button k-upload-button k-button-icon\\'>' + '<span class=\\'k-icon k-font-icon k-i-folder-open\\' />' + '</div>').data('instance', this);\n                $('<input type=\\'file\\' autocomplete=\\'off\\' accept=\\'.xlsx\\'/>').attr('title', options.attributes.title).bind('change', this._change.bind(this)).appendTo($('<form>').appendTo(this.element));\n            },\n            _change: function (e) {\n                this.toolbar.action({\n                    command: 'OpenCommand',\n                    options: { file: e.target.files[0] }\n                });\n                e.target.parentNode.reset();\n            }\n        });\n        kendo.toolbar.registerComponent('open', Open);\n        kendo.spreadsheet.TabStrip = kendo.ui.TabStrip.extend({\n            init: function (element, options) {\n                kendo.ui.TabStrip.fn.init.call(this, element, options);\n                element.addClass('k-spreadsheet-tabstrip');\n                this._quickAccessButtons();\n                this.quickAccessToolBar.on('click', '.k-button', function (e) {\n                    var action = $(e.currentTarget).attr('title').toLowerCase();\n                    this.trigger('action', { action: action });\n                }.bind(this));\n                this.toolbars = {};\n                var tabs = options.dataSource;\n                this.contentElements.each(function (idx, element) {\n                    this._toolbar($(element), tabs[idx].id, options.toolbarOptions[tabs[idx].id]);\n                }.bind(this));\n                this.one('activate', function () {\n                    this.toolbars[this.options.dataSource[0].id].resize();\n                });\n            },\n            events: kendo.ui.TabStrip.fn.events.concat([\n                'action',\n                'dialog'\n            ]),\n            destroy: function () {\n                this.quickAccessToolBar.off('click');\n                kendo.ui.TabStrip.fn.destroy.call(this);\n                for (var name in this.toolbars) {\n                    this.toolbars[name].destroy();\n                }\n            },\n            action: function (args) {\n                this.trigger('action', args);\n            },\n            dialog: function (args) {\n                this.trigger('dialog', args);\n            },\n            refreshTools: function (range) {\n                var toolbars = this.toolbars;\n                for (var name in toolbars) {\n                    if (toolbars.hasOwnProperty(name)) {\n                        toolbars[name].refresh(range);\n                    }\n                }\n            },\n            _quickAccessButtons: function () {\n                var buttons = [\n                    {\n                        title: MESSAGES.quickAccess.undo,\n                        iconClass: 'undo-large',\n                        action: 'undo'\n                    },\n                    {\n                        title: MESSAGES.quickAccess.redo,\n                        iconClass: 'redo-large',\n                        action: 'redo'\n                    }\n                ];\n                var buttonTemplate = kendo.template('<a href=\\'\\\\#\\' title=\\'#= title #\\' data-action=\\'#= action #\\' class=\\'k-button k-button-icon\\'><span class=\\'k-icon k-font-icon k-i-#=iconClass#\\'></span></a>');\n                this.quickAccessToolBar = $('<div />', {\n                    'class': 'k-spreadsheet-quick-access-toolbar',\n                    'html': kendo.render(buttonTemplate, buttons)\n                }).insertBefore(this.wrapper);\n                this.quickAccessToolBar.on('click', '.k-button', function (e) {\n                    e.preventDefault();\n                    var action = $(e.currentTarget).attr('title').toLowerCase();\n                    this.action({ action: action });\n                }.bind(this));\n                this.quickAccessAdjust();\n            },\n            quickAccessAdjust: function () {\n                this.tabGroup.css('padding-left', this.quickAccessToolBar.outerWidth());\n            },\n            _toolbar: function (container, name, tools) {\n                var element;\n                var options;\n                if (this.toolbars[name]) {\n                    this.toolbars[name].destroy();\n                    container.children('.k-toolbar').remove();\n                }\n                if (tools) {\n                    element = container.html('<div />').children('div');\n                    options = {\n                        tools: typeof tools === 'boolean' ? undefined : tools,\n                        toolbarName: name,\n                        action: this.action.bind(this),\n                        dialog: this.dialog.bind(this)\n                    };\n                    this.toolbars[name] = new kendo.spreadsheet.ToolBar(element, options);\n                }\n            }\n        });\n    }(window.kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/dialogs', [\n        'kendo.core',\n        'kendo.binder',\n        'kendo.validator'\n    ], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var $ = kendo.jQuery;\n        var ObservableObject = kendo.data.ObservableObject;\n        var MESSAGES = kendo.spreadsheet.messages.dialogs = {\n            apply: 'Apply',\n            save: 'Save',\n            cancel: 'Cancel',\n            remove: 'Remove',\n            okText: 'OK',\n            formatCellsDialog: {\n                title: 'Format',\n                categories: {\n                    number: 'Number',\n                    currency: 'Currency',\n                    date: 'Date'\n                }\n            },\n            fontFamilyDialog: { title: 'Font' },\n            fontSizeDialog: { title: 'Font size' },\n            bordersDialog: { title: 'Borders' },\n            alignmentDialog: {\n                title: 'Alignment',\n                buttons: {\n                    justtifyLeft: 'Align left',\n                    justifyCenter: 'Center',\n                    justifyRight: 'Align right',\n                    justifyFull: 'Justify',\n                    alignTop: 'Align top',\n                    alignMiddle: 'Align middle',\n                    alignBottom: 'Align bottom'\n                }\n            },\n            mergeDialog: {\n                title: 'Merge cells',\n                buttons: {\n                    mergeCells: 'Merge all',\n                    mergeHorizontally: 'Merge horizontally',\n                    mergeVertically: 'Merge vertically',\n                    unmerge: 'Unmerge'\n                }\n            },\n            freezeDialog: {\n                title: 'Freeze panes',\n                buttons: {\n                    freezePanes: 'Freeze panes',\n                    freezeRows: 'Freeze rows',\n                    freezeColumns: 'Freeze columns',\n                    unfreeze: 'Unfreeze panes'\n                }\n            },\n            validationDialog: {\n                title: 'Data Validation',\n                hintMessage: 'Please enter a valid {0} value {1}.',\n                hintTitle: 'Validation {0}',\n                criteria: {\n                    any: 'Any value',\n                    number: 'Number',\n                    text: 'Text',\n                    date: 'Date',\n                    custom: 'Custom Formula',\n                    list: 'List'\n                },\n                comparers: {\n                    greaterThan: 'greater than',\n                    lessThan: 'less than',\n                    between: 'between',\n                    notBetween: 'not between',\n                    equalTo: 'equal to',\n                    notEqualTo: 'not equal to',\n                    greaterThanOrEqualTo: 'greater than or equal to',\n                    lessThanOrEqualTo: 'less than or equal to'\n                },\n                comparerMessages: {\n                    greaterThan: 'greater than {0}',\n                    lessThan: 'less than {0}',\n                    between: 'between {0} and {1}',\n                    notBetween: 'not between {0} and {1}',\n                    equalTo: 'equal to {0}',\n                    notEqualTo: 'not equal to {0}',\n                    greaterThanOrEqualTo: 'greater than or equal to {0}',\n                    lessThanOrEqualTo: 'less than or equal to {0}',\n                    custom: 'that satisfies the formula: {0}'\n                },\n                labels: {\n                    criteria: 'Criteria',\n                    comparer: 'Comparer',\n                    min: 'Min',\n                    max: 'Max',\n                    value: 'Value',\n                    start: 'Start',\n                    end: 'End',\n                    onInvalidData: 'On invalid data',\n                    rejectInput: 'Reject input',\n                    showWarning: 'Show warning',\n                    showHint: 'Show hint',\n                    hintTitle: 'Hint title',\n                    hintMessage: 'Hint message',\n                    ignoreBlank: 'Ignore blank'\n                },\n                placeholders: {\n                    typeTitle: 'Type title',\n                    typeMessage: 'Type message'\n                }\n            },\n            exportAsDialog: {\n                title: 'Export...',\n                labels: {\n                    scale: 'Scale',\n                    fit: 'Fit to page',\n                    fileName: 'File name',\n                    saveAsType: 'Save as type',\n                    exportArea: 'Export',\n                    paperSize: 'Paper size',\n                    margins: 'Margins',\n                    orientation: 'Orientation',\n                    print: 'Print',\n                    guidelines: 'Guidelines',\n                    center: 'Center',\n                    horizontally: 'Horizontally',\n                    vertically: 'Vertically'\n                }\n            },\n            modifyMergedDialog: { errorMessage: 'Cannot change part of a merged cell.' },\n            useKeyboardDialog: {\n                title: 'Copying and pasting',\n                errorMessage: 'These actions cannot be invoked through the menu. Please use the keyboard shortcuts instead:',\n                labels: {\n                    forCopy: 'for copy',\n                    forCut: 'for cut',\n                    forPaste: 'for paste'\n                }\n            },\n            unsupportedSelectionDialog: { errorMessage: 'That action cannot be performed on multiple selection.' }\n        };\n        var registry = {};\n        kendo.spreadsheet.dialogs = {\n            register: function (name, dialogClass) {\n                registry[name] = dialogClass;\n            },\n            create: function (name, options) {\n                var dialogClass = registry[name];\n                if (dialogClass) {\n                    return new dialogClass(options);\n                }\n            }\n        };\n        var SpreadsheetDialog = kendo.spreadsheet.SpreadsheetDialog = kendo.Observable.extend({\n            init: function (options) {\n                kendo.Observable.fn.init.call(this, options);\n                this.options = $.extend(true, {}, this.options, options);\n                this.bind(this.events, options);\n            },\n            events: [\n                'close',\n                'activate'\n            ],\n            dialog: function () {\n                if (!this._dialog) {\n                    this._dialog = $('<div class=\\'k-spreadsheet-window k-action-window\\' />').addClass(this.options.className || '').append(this.options.template).appendTo(document.body).kendoWindow({\n                        scrollable: false,\n                        resizable: false,\n                        maximizable: false,\n                        modal: true,\n                        visible: false,\n                        width: this.options.width || 320,\n                        title: this.options.title,\n                        open: function () {\n                            this.center();\n                        },\n                        close: this._onDialogClose.bind(this),\n                        activate: this._onDialogActivate.bind(this),\n                        deactivate: this._onDialogDeactivate.bind(this)\n                    }).data('kendoWindow');\n                }\n                return this._dialog;\n            },\n            _onDialogClose: function () {\n                this.trigger('close');\n            },\n            _onDialogActivate: function () {\n                this.trigger('activate');\n            },\n            _onDialogDeactivate: function () {\n                this.trigger('deactivate');\n                this.destroy();\n            },\n            destroy: function () {\n                if (this._dialog) {\n                    this._dialog.destroy();\n                    this._dialog = null;\n                }\n            },\n            open: function () {\n                this.dialog().open();\n            },\n            apply: function () {\n                this.close();\n            },\n            close: function () {\n                this.dialog().close();\n            }\n        });\n        function formattedValue(value, format) {\n            return kendo.spreadsheet.formatting.text(value, format);\n        }\n        var FormatCellsViewModel = kendo.spreadsheet.FormatCellsViewModel = ObservableObject.extend({\n            init: function (options) {\n                ObservableObject.fn.init.call(this, options);\n                this.useCategory(this.category);\n            },\n            useCategory: function (category) {\n                var type = category && category.type || 'number';\n                var formatCurrency = type == 'currency';\n                this.category = category;\n                this.set('showCurrencyFilter', formatCurrency && this.currencies.length > 1);\n                if (!formatCurrency) {\n                    this.set('formats', this.allFormats[type + 'Formats']);\n                } else {\n                    this.currency(this.currencies[0]);\n                }\n                this.useFirstFormat();\n            },\n            useFirstFormat: function () {\n                if (this.formats.length) {\n                    this.set('format', this.formats[0].value);\n                }\n            },\n            currency: function (currency) {\n                if (currency !== undefined) {\n                    this._currency = currency;\n                    var info = currency.value;\n                    var formats = [\n                        {\n                            currency: info,\n                            decimals: true\n                        },\n                        {\n                            currency: info,\n                            decimals: true,\n                            iso: true\n                        },\n                        {\n                            currency: info,\n                            decimals: false\n                        }\n                    ];\n                    formats = formats.map(function (format) {\n                        format = FormatCellsViewModel.convert.currency(format);\n                        return {\n                            value: format,\n                            name: formattedValue(1000, format)\n                        };\n                    });\n                    this.set('formats', formats);\n                    this.useFirstFormat();\n                }\n                return this._currency || this.currencies[0];\n            },\n            categoryFilter: function (category) {\n                if (category !== undefined) {\n                    this.useCategory(category);\n                }\n                return this.category;\n            },\n            preview: function () {\n                var format = this.get('format');\n                var value = this.value || 0;\n                if (format && format.length) {\n                    return formattedValue(value, format);\n                } else {\n                    return value;\n                }\n            }\n        });\n        FormatCellsViewModel.convert = {\n            currency: function (options) {\n                function repeat(token, n) {\n                    return new Array(n + 1).join(token);\n                }\n                var info = options.currency;\n                var format = info.pattern[1];\n                if (options.decimals) {\n                    format = format.replace(/n/g, 'n' + info['.'] + repeat('0', info.decimals));\n                }\n                if (options.iso) {\n                    format = '\"' + info.abbr + '\" ' + format.replace(/\\s*\\$\\s*/g, '');\n                } else {\n                    format = format.replace(/\\$/g, info.symbol);\n                }\n                format = format.replace(/n/g, '?');\n                return format;\n            },\n            date: function (format) {\n                if (/T|Z/.test(format)) {\n                    return '';\n                }\n                return format.toLowerCase().replace(/tt/g, 'AM/PM').replace(/'/g, '\"');\n            }\n        };\n        function uniqueBy(field, array) {\n            var result = [];\n            var values = [];\n            for (var i = 0; i < array.length; i++) {\n                if ($.inArray(array[i][field], values) == -1) {\n                    result.push(array[i]);\n                    values.push(array[i][field]);\n                }\n            }\n            return result;\n        }\n        var FormatCellsDialog = SpreadsheetDialog.extend({\n            init: function (options) {\n                SpreadsheetDialog.fn.init.call(this, options);\n                this._generateFormats();\n            },\n            options: {\n                title: MESSAGES.formatCellsDialog.title,\n                className: 'k-spreadsheet-format-cells',\n                categories: [\n                    {\n                        type: 'number',\n                        name: MESSAGES.formatCellsDialog.categories.number\n                    },\n                    {\n                        type: 'currency',\n                        name: MESSAGES.formatCellsDialog.categories.currency\n                    },\n                    {\n                        type: 'date',\n                        name: MESSAGES.formatCellsDialog.categories.date\n                    }\n                ],\n                template: '<div class=\\'k-root-tabs\\' data-role=\\'tabstrip\\' ' + 'data-text-field=\\'name\\' ' + 'data-bind=\\'source: categories, value: categoryFilter\\' ' + 'data-animation=\\'false\\' />' + '<div class=\\'k-spreadsheet-preview\\' data-bind=\\'text: preview\\' />' + '<script type=\\'text/x-kendo-template\\' id=\\'format-item-template\\'>' + '#: data.name #' + '</script>' + '<select data-role=\\'dropdownlist\\' class=\\'k-format-filter\\' ' + 'data-text-field=\\'description\\' ' + 'data-value-field=\\'value.name\\' ' + 'data-bind=\\'visible: showCurrencyFilter, value: currency, source: currencies\\' />' + '<ul data-role=\\'staticlist\\' tabindex=\\'0\\' ' + 'class=\\'k-list k-reset\\' ' + 'data-template=\\'format-item-template\\' ' + 'data-value-primitive=\\'true\\' ' + 'data-value-field=\\'value\\' ' + 'data-bind=\\'source: formats, value: format\\' />' + '<div class=\\'k-action-buttons\\'>' + '<button class=\\'k-button k-primary\\' data-bind=\\'click: apply\\'>' + MESSAGES.apply + '</button>' + '<button class=\\'k-button\\' data-bind=\\'click: close\\'>' + MESSAGES.cancel + '</button>' + '</div>'\n            },\n            _generateFormats: function () {\n                var options = this.options;\n                if (!options.currencies) {\n                    options.currencies = FormatCellsDialog.currenciesFrom(kendo.cultures);\n                }\n                if (!options.numberFormats) {\n                    options.numberFormats = [\n                        {\n                            value: '#.00%',\n                            name: '100.00%'\n                        },\n                        {\n                            value: '#%',\n                            name: '100%'\n                        },\n                        {\n                            value: '#.00',\n                            name: '1024.00'\n                        },\n                        {\n                            value: '#,###.00',\n                            name: '1,024.00'\n                        }\n                    ];\n                }\n                if (!options.dateFormats) {\n                    var calendarPatterns = kendo.cultures.current.calendars.standard.patterns;\n                    options.dateFormats = uniqueBy('value', $.map(calendarPatterns, function (format) {\n                        format = FormatCellsViewModel.convert.date(format);\n                        if (!format) {\n                            return;\n                        }\n                        return {\n                            value: format,\n                            name: formattedValue(34567.7678, format)\n                        };\n                    }));\n                }\n            },\n            open: function (range) {\n                var options = this.options;\n                var value = range.value();\n                var categories = options.categories.slice(0);\n                var element;\n                this.viewModel = new FormatCellsViewModel({\n                    currencies: options.currencies.slice(0),\n                    allFormats: {\n                        numberFormats: options.numberFormats.slice(0),\n                        dateFormats: options.dateFormats.slice(0)\n                    },\n                    categories: categories,\n                    format: range.format(),\n                    category: value instanceof Date ? categories[2] : categories[0],\n                    apply: this.apply.bind(this),\n                    close: this.close.bind(this),\n                    value: value\n                });\n                SpreadsheetDialog.fn.open.call(this);\n                element = this.dialog().element;\n                kendo.bind(element, this.viewModel);\n                var currencyFilter = element.find('select.k-format-filter').data('kendoDropDownList');\n                if (options.currencies.length > 10) {\n                    currencyFilter.setOptions({ filter: 'contains' });\n                }\n                element.find(kendo.roleSelector('staticlist')).parent().addClass('k-list-wrapper');\n            },\n            apply: function () {\n                var format = this.viewModel.format;\n                SpreadsheetDialog.fn.apply.call(this);\n                this.trigger('action', {\n                    command: 'PropertyChangeCommand',\n                    options: {\n                        property: 'format',\n                        value: format\n                    }\n                });\n            }\n        });\n        FormatCellsDialog.currenciesFrom = function (cultures) {\n            return uniqueBy('description', $.map(cultures, function (culture, name) {\n                if (!/-/.test(name)) {\n                    return;\n                }\n                var currency = culture.numberFormat.currency;\n                var description = kendo.format('{0} ({1}, {2})', currency.name, currency.abbr, currency.symbol);\n                return {\n                    description: description,\n                    value: currency\n                };\n            }));\n        };\n        kendo.spreadsheet.dialogs.register('formatCells', FormatCellsDialog);\n        kendo.spreadsheet.dialogs.FormatCellsDialog = FormatCellsDialog;\n        var MessageDialog = SpreadsheetDialog.extend({\n            options: {\n                className: 'k-spreadsheet-message',\n                title: '',\n                text: '',\n                template: '<div class=\\'k-spreadsheet-message-content\\' data-bind=\\'text: text\\' />' + '<div class=\\'k-action-buttons\\'>' + '<button class=\\'k-button k-primary\\' data-bind=\\'click: close, text: okText\\' />' + '</div>'\n            },\n            open: function () {\n                SpreadsheetDialog.fn.open.call(this);\n                kendo.bind(this.dialog().element, {\n                    text: this.options.text,\n                    okText: MESSAGES.okText,\n                    close: this.close.bind(this)\n                });\n            }\n        });\n        kendo.spreadsheet.dialogs.register('message', MessageDialog);\n        var FontFamilyDialog = SpreadsheetDialog.extend({\n            init: function (options) {\n                SpreadsheetDialog.fn.init.call(this, options);\n                this._list();\n            },\n            options: {\n                title: MESSAGES.fontFamilyDialog.title,\n                template: '<ul class=\\'k-list k-reset\\'></ul>'\n            },\n            _list: function () {\n                var ul = this.dialog().element.find('ul');\n                var fonts = this.options.fonts;\n                var defaultFont = this.options.defaultFont;\n                this.list = new kendo.ui.StaticList(ul, {\n                    dataSource: new kendo.data.DataSource({ data: fonts }),\n                    template: '#:data#',\n                    value: defaultFont,\n                    change: this.apply.bind(this)\n                });\n                this.list.dataSource.fetch();\n            },\n            apply: function (e) {\n                SpreadsheetDialog.fn.apply.call(this);\n                this.trigger('action', {\n                    command: 'PropertyChangeCommand',\n                    options: {\n                        property: 'fontFamily',\n                        value: e.sender.value()[0]\n                    }\n                });\n            }\n        });\n        kendo.spreadsheet.dialogs.register('fontFamily', FontFamilyDialog);\n        var FontSizeDialog = SpreadsheetDialog.extend({\n            init: function (options) {\n                SpreadsheetDialog.fn.init.call(this, options);\n                this._list();\n            },\n            options: {\n                title: MESSAGES.fontSizeDialog.title,\n                template: '<ul class=\\'k-list k-reset\\'></ul>'\n            },\n            _list: function () {\n                var ul = this.dialog().element.find('ul');\n                var sizes = this.options.sizes;\n                var defaultSize = this.options.defaultSize;\n                this.list = new kendo.ui.StaticList(ul, {\n                    dataSource: new kendo.data.DataSource({ data: sizes }),\n                    template: '#:data#',\n                    value: defaultSize,\n                    change: this.apply.bind(this)\n                });\n                this.list.dataSource.fetch();\n            },\n            apply: function (e) {\n                SpreadsheetDialog.fn.apply.call(this);\n                this.trigger('action', {\n                    command: 'PropertyChangeCommand',\n                    options: {\n                        property: 'fontSize',\n                        value: kendo.parseInt(e.sender.value()[0])\n                    }\n                });\n            }\n        });\n        kendo.spreadsheet.dialogs.register('fontSize', FontSizeDialog);\n        var BordersDialog = SpreadsheetDialog.extend({\n            init: function (options) {\n                SpreadsheetDialog.fn.init.call(this, options);\n                this.element = this.dialog().element;\n                this._borderPalette();\n                this.viewModel = kendo.observable({\n                    apply: this.apply.bind(this),\n                    close: this.close.bind(this)\n                });\n                kendo.bind(this.element.find('.k-action-buttons'), this.viewModel);\n            },\n            options: {\n                title: MESSAGES.bordersDialog.title,\n                width: 177,\n                template: '<div></div>' + '<div class=\\'k-action-buttons\\'>' + '<button class=\\'k-button k-primary\\' data-bind=\\'click: apply\\'>' + MESSAGES.apply + '</button>' + '<button class=\\'k-button\\' data-bind=\\'click: close\\'>' + MESSAGES.cancel + '</button>' + '</div>'\n            },\n            apply: function () {\n                SpreadsheetDialog.fn.apply.call(this);\n                var state = this.value();\n                this.trigger('action', {\n                    command: 'BorderChangeCommand',\n                    options: {\n                        border: state.type,\n                        style: {\n                            size: 1,\n                            color: state.color\n                        }\n                    }\n                });\n            },\n            _borderPalette: function () {\n                var element = this.dialog().element.find('div:first');\n                this.borderPalette = new kendo.spreadsheet.BorderPalette(element, { change: this.value.bind(this) });\n            },\n            value: function (state) {\n                if (state === undefined) {\n                    return this._state;\n                } else {\n                    this._state = state;\n                }\n            }\n        });\n        kendo.spreadsheet.dialogs.register('borders', BordersDialog);\n        var ColorChooser = SpreadsheetDialog.extend({\n            init: function (options) {\n                SpreadsheetDialog.fn.init.call(this, options);\n                this.element = this.dialog().element;\n                this.property = options.property;\n                this.options.title = options.title;\n                this.viewModel = kendo.observable({\n                    apply: this.apply.bind(this),\n                    close: this.close.bind(this)\n                });\n                kendo.bind(this.element.find('.k-action-buttons'), this.viewModel);\n            },\n            options: { template: '<div></div>' + '<div class=\\'k-action-buttons\\'>' + '<button class=\\'k-button k-primary\\' data-bind=\\'click: apply\\'>' + MESSAGES.apply + '</button>' + '<button class=\\'k-button\\' data-bind=\\'click: close\\'>' + MESSAGES.cancel + '</button>' + '</div>' },\n            apply: function () {\n                SpreadsheetDialog.fn.apply.call(this);\n                this.trigger('action', {\n                    command: 'PropertyChangeCommand',\n                    options: {\n                        property: this.property,\n                        value: this.value()\n                    }\n                });\n            },\n            value: function (e) {\n                if (e === undefined) {\n                    return this._value;\n                } else {\n                    this._value = e.value;\n                }\n            }\n        });\n        var ColorPickerDialog = ColorChooser.extend({\n            init: function (options) {\n                options.width = 177;\n                ColorChooser.fn.init.call(this, options);\n                this._colorPalette();\n            },\n            _colorPalette: function () {\n                var element = this.dialog().element.find('div:first');\n                this.colorPalette = element.kendoColorPalette({\n                    palette: [\n                        '#ffffff',\n                        '#000000',\n                        '#d6ecff',\n                        '#4e5b6f',\n                        '#7fd13b',\n                        '#ea157a',\n                        '#feb80a',\n                        '#00addc',\n                        '#738ac8',\n                        '#1ab39f',\n                        '#f2f2f2',\n                        '#7f7f7f',\n                        '#a7d6ff',\n                        '#d9dde4',\n                        '#e5f5d7',\n                        '#fad0e4',\n                        '#fef0cd',\n                        '#c5f2ff',\n                        '#e2e7f4',\n                        '#c9f7f1',\n                        '#d8d8d8',\n                        '#595959',\n                        '#60b5ff',\n                        '#b3bcca',\n                        '#cbecb0',\n                        '#f6a1c9',\n                        '#fee29c',\n                        '#8be6ff',\n                        '#c7d0e9',\n                        '#94efe3',\n                        '#bfbfbf',\n                        '#3f3f3f',\n                        '#007dea',\n                        '#8d9baf',\n                        '#b2e389',\n                        '#f272af',\n                        '#fed46b',\n                        '#51d9ff',\n                        '#aab8de',\n                        '#5fe7d5',\n                        '#a5a5a5',\n                        '#262626',\n                        '#003e75',\n                        '#3a4453',\n                        '#5ea226',\n                        '#af0f5b',\n                        '#c58c00',\n                        '#0081a5',\n                        '#425ea9',\n                        '#138677',\n                        '#7f7f7f',\n                        '#0c0c0c',\n                        '#00192e',\n                        '#272d37',\n                        '#3f6c19',\n                        '#750a3d',\n                        '#835d00',\n                        '#00566e',\n                        '#2c3f71',\n                        '#0c594f'\n                    ],\n                    change: this.value.bind(this)\n                }).data('kendoColorPalette');\n            }\n        });\n        kendo.spreadsheet.dialogs.register('colorPicker', ColorPickerDialog);\n        var CustomColorDialog = ColorChooser.extend({\n            init: function (options) {\n                options.width = 268;\n                ColorChooser.fn.init.call(this, options);\n                this.dialog().setOptions({ animation: false });\n                this.dialog().one('activate', this._colorPicker.bind(this));\n            },\n            _colorPicker: function () {\n                var element = this.dialog().element.find('div:first');\n                this.colorPicker = element.kendoFlatColorPicker({ change: this.value.bind(this) }).data('kendoFlatColorPicker');\n            }\n        });\n        kendo.spreadsheet.dialogs.register('customColor', CustomColorDialog);\n        var AlignmentDialog = SpreadsheetDialog.extend({\n            init: function (options) {\n                SpreadsheetDialog.fn.init.call(this, options);\n                this._list();\n            },\n            options: {\n                title: 'Alignment',\n                template: '<ul class=\\'k-list k-reset\\'></ul>',\n                buttons: [\n                    {\n                        property: 'textAlign',\n                        value: 'left',\n                        iconClass: 'justify-left',\n                        text: MESSAGES.alignmentDialog.buttons.justtifyLeft\n                    },\n                    {\n                        property: 'textAlign',\n                        value: 'center',\n                        iconClass: 'justify-center',\n                        text: MESSAGES.alignmentDialog.buttons.justifyCenter\n                    },\n                    {\n                        property: 'textAlign',\n                        value: 'right',\n                        iconClass: 'justify-right',\n                        text: MESSAGES.alignmentDialog.buttons.justifyRight\n                    },\n                    {\n                        property: 'textAlign',\n                        value: 'justify',\n                        iconClass: 'justify-full',\n                        text: MESSAGES.alignmentDialog.buttons.justifyFull\n                    },\n                    {\n                        property: 'verticalAlign',\n                        value: 'top',\n                        iconClass: 'align-top',\n                        text: MESSAGES.alignmentDialog.buttons.alignTop\n                    },\n                    {\n                        property: 'verticalAlign',\n                        value: 'center',\n                        iconClass: 'align-middle',\n                        text: MESSAGES.alignmentDialog.buttons.alignMiddle\n                    },\n                    {\n                        property: 'verticalAlign',\n                        value: 'bottom',\n                        iconClass: 'align-bottom',\n                        text: MESSAGES.alignmentDialog.buttons.alignBottom\n                    }\n                ]\n            },\n            _list: function () {\n                var ul = this.dialog().element.find('ul');\n                this.list = new kendo.ui.StaticList(ul, {\n                    dataSource: new kendo.data.DataSource({ data: this.options.buttons }),\n                    template: '<a title=\\'#=text#\\' data-property=\\'#=property#\\' data-value=\\'#=value#\\'>' + '<span class=\\'k-icon k-font-icon k-i-#=iconClass#\\'></span>' + '#=text#' + '</a>',\n                    change: this.apply.bind(this)\n                });\n                this.list.dataSource.fetch();\n            },\n            apply: function (e) {\n                var dataItem = e.sender.value()[0];\n                SpreadsheetDialog.fn.apply.call(this);\n                this.trigger('action', {\n                    command: 'PropertyChangeCommand',\n                    options: {\n                        property: dataItem.property,\n                        value: dataItem.value\n                    }\n                });\n            }\n        });\n        kendo.spreadsheet.dialogs.register('alignment', AlignmentDialog);\n        var MergeDialog = SpreadsheetDialog.extend({\n            init: function (options) {\n                SpreadsheetDialog.fn.init.call(this, options);\n                this._list();\n            },\n            options: {\n                title: MESSAGES.mergeDialog.title,\n                template: '<ul class=\\'k-list k-reset\\'></ul>',\n                buttons: [\n                    {\n                        value: 'cells',\n                        iconClass: 'merge-cells',\n                        text: MESSAGES.mergeDialog.buttons.mergeCells\n                    },\n                    {\n                        value: 'horizontally',\n                        iconClass: 'merge-horizontally',\n                        text: MESSAGES.mergeDialog.buttons.mergeHorizontally\n                    },\n                    {\n                        value: 'vertically',\n                        iconClass: 'merge-vertically',\n                        text: MESSAGES.mergeDialog.buttons.mergeVertically\n                    },\n                    {\n                        value: 'unmerge',\n                        iconClass: 'normal-layout',\n                        text: MESSAGES.mergeDialog.buttons.unmerge\n                    }\n                ]\n            },\n            _list: function () {\n                var ul = this.dialog().element.find('ul');\n                this.list = new kendo.ui.StaticList(ul, {\n                    dataSource: new kendo.data.DataSource({ data: this.options.buttons }),\n                    template: '<a title=\\'#=text#\\' data-value=\\'#=value#\\'>' + '<span class=\\'k-icon k-font-icon k-i-#=iconClass#\\'></span>#=text#' + '</a>',\n                    change: this.apply.bind(this)\n                });\n                this.list.dataSource.fetch();\n            },\n            apply: function (e) {\n                var dataItem = e.sender.value()[0];\n                SpreadsheetDialog.fn.apply.call(this);\n                this.trigger('action', {\n                    command: 'MergeCellCommand',\n                    options: { value: dataItem.value }\n                });\n            }\n        });\n        kendo.spreadsheet.dialogs.register('merge', MergeDialog);\n        var FreezeDialog = SpreadsheetDialog.extend({\n            init: function (options) {\n                SpreadsheetDialog.fn.init.call(this, options);\n                this._list();\n            },\n            options: {\n                title: MESSAGES.freezeDialog.title,\n                template: '<ul class=\\'k-list k-reset\\'></ul>',\n                buttons: [\n                    {\n                        value: 'panes',\n                        iconClass: 'freeze-panes',\n                        text: MESSAGES.freezeDialog.buttons.freezePanes\n                    },\n                    {\n                        value: 'rows',\n                        iconClass: 'freeze-row',\n                        text: MESSAGES.freezeDialog.buttons.freezeRows\n                    },\n                    {\n                        value: 'columns',\n                        iconClass: 'freeze-col',\n                        text: MESSAGES.freezeDialog.buttons.freezeColumns\n                    },\n                    {\n                        value: 'unfreeze',\n                        iconClass: 'normal-layout',\n                        text: MESSAGES.freezeDialog.buttons.unfreeze\n                    }\n                ]\n            },\n            _list: function () {\n                var ul = this.dialog().element.find('ul');\n                this.list = new kendo.ui.StaticList(ul, {\n                    dataSource: new kendo.data.DataSource({ data: this.options.buttons }),\n                    template: '<a title=\\'#=text#\\' data-value=\\'#=value#\\'>' + '<span class=\\'k-icon k-font-icon k-i-#=iconClass#\\'></span>#=text#' + '</a>',\n                    change: this.apply.bind(this)\n                });\n                this.list.dataSource.fetch();\n            },\n            apply: function (e) {\n                var dataItem = e.sender.value()[0];\n                SpreadsheetDialog.fn.apply.call(this);\n                this.trigger('action', {\n                    command: 'FreezePanesCommand',\n                    options: { value: dataItem.value }\n                });\n            }\n        });\n        kendo.spreadsheet.dialogs.register('freeze', FreezeDialog);\n        var ValidationViewModel = kendo.spreadsheet.ValidationCellsViewModel = ObservableObject.extend({\n            init: function (options) {\n                ObservableObject.fn.init.call(this, options);\n                this.bind('change', function (e) {\n                    if (e.field === 'criterion') {\n                        this.reset();\n                        if (this.criterion === 'custom' || this.criterion === 'list') {\n                            this.setHintMessageTemplate();\n                        }\n                    }\n                    if (e.field === 'comparer') {\n                        this.setHintMessageTemplate();\n                    }\n                    if ((e.field == 'hintMessage' || e.field == 'hintTitle') && !this._mute) {\n                        this.shouldBuild = false;\n                    }\n                    if ((e.field == 'from' || e.field == 'to' || e.field == 'hintMessageTemplate' || e.field == 'type') && this.shouldBuild) {\n                        this.buildMessages();\n                    }\n                }.bind(this));\n                this.reset();\n            },\n            buildMessages: function () {\n                this._mute = true;\n                this.set('hintTitle', this.hintTitleTemplate ? kendo.format(this.hintTitleTemplate, this.type) : '');\n                this.set('hintMessage', this.hintMessageTemplate ? kendo.format(this.hintMessageTemplate, this.from, this.to) : '');\n                this._mute = false;\n            },\n            reset: function () {\n                this.setComparers();\n                this.set('comparer', this.comparers[0].type);\n                this.set('from', null);\n                this.set('to', null);\n                this.set('useCustomMessages', false);\n                this.shouldBuild = true;\n                this.hintTitleTemplate = this.defaultHintTitle;\n                this.buildMessages();\n            },\n            setComparers: function () {\n                var all = this.defaultComparers;\n                var comparers = [];\n                if (this.criterion === 'text') {\n                    var text_comparers = [\n                        'equalTo',\n                        'notEqualTo'\n                    ];\n                    for (var idx = 0; idx < all.length; idx++) {\n                        if (text_comparers[0] == all[idx].type) {\n                            comparers.push(all[idx]);\n                            text_comparers.shift();\n                        }\n                    }\n                } else {\n                    comparers = all.slice();\n                }\n                this.set('comparers', comparers);\n            },\n            setHintMessageTemplate: function () {\n                if (this.criterion !== 'custom' && this.criterion !== 'list') {\n                    this.set('hintMessageTemplate', kendo.format(this.defaultHintMessage, this.criterion, this.comparerMessages[this.comparer]));\n                } else {\n                    this.set('hintMessageTemplate', '');\n                    this.set('hintMessage', '');\n                }\n            },\n            isAny: function () {\n                return this.get('criterion') === 'any';\n            },\n            isNumber: function () {\n                return this.get('criterion') === 'number';\n            },\n            showToForNumber: function () {\n                return this.showTo() && this.isNumber();\n            },\n            showToForDate: function () {\n                return this.showTo() && this.isDate();\n            },\n            isText: function () {\n                return this.get('criterion') === 'text';\n            },\n            isDate: function () {\n                return this.get('criterion') === 'date';\n            },\n            isList: function () {\n                return this.get('criterion') === 'list';\n            },\n            isCustom: function () {\n                return this.get('criterion') === 'custom';\n            },\n            showRemove: function () {\n                return this.get('hasValidation');\n            },\n            showTo: function () {\n                return this.get('comparer') == 'between' || this.get('comparer') == 'notBetween';\n            },\n            update: function (validation) {\n                this.set('hasValidation', !!validation);\n                if (validation) {\n                    this.fromValidationObject(validation);\n                }\n            },\n            fromValidationObject: function (validation) {\n                this.set('criterion', validation.dataType);\n                this.set('comparer', validation.comparerType);\n                this.set('from', validation.from);\n                this.set('to', validation.to);\n                this.set('type', validation.type);\n                this.set('ignoreBlank', validation.allowNulls);\n                if (validation.messageTemplate || validation.titleTemplate) {\n                    this.hintMessageTemplate = validation.messageTemplate;\n                    this.hintMessage = validation.messageTemplate;\n                    this.hintTitleTemplate = validation.titleTemplate;\n                    this.hintTitle = validation.titleTemplate;\n                    this.useCustomMessages = true;\n                    this.buildMessages();\n                } else {\n                    this.useCustomMessages = false;\n                }\n            },\n            toValidationObject: function () {\n                if (this.criterion === 'any') {\n                    return null;\n                }\n                var options = {\n                    type: this.type,\n                    dataType: this.criterion,\n                    comparerType: this.comparer,\n                    from: this.from,\n                    to: this.to,\n                    allowNulls: this.ignoreBlank\n                };\n                if (this.useCustomMessages) {\n                    options.messageTemplate = this.shouldBuild ? this.hintMessageTemplate : this.hintMessage;\n                    options.titleTemplate = this.hintTitle;\n                }\n                return options;\n            }\n        });\n        var ValidationDialog = SpreadsheetDialog.extend({\n            init: function (options) {\n                SpreadsheetDialog.fn.init.call(this, options);\n            },\n            options: {\n                width: 420,\n                title: MESSAGES.validationDialog.title,\n                criterion: 'any',\n                type: 'reject',\n                ignoreBlank: true,\n                hintMessage: MESSAGES.validationDialog.hintMessage,\n                hintTitle: MESSAGES.validationDialog.hintTitle,\n                useCustomMessages: false,\n                criteria: [\n                    {\n                        type: 'any',\n                        name: 'Any value'\n                    },\n                    {\n                        type: 'number',\n                        name: 'Number'\n                    },\n                    {\n                        type: 'text',\n                        name: 'Text'\n                    },\n                    {\n                        type: 'date',\n                        name: 'Date'\n                    },\n                    {\n                        type: 'custom',\n                        name: 'Custom Formula'\n                    },\n                    {\n                        type: 'list',\n                        name: 'List'\n                    }\n                ],\n                comparers: [\n                    {\n                        type: 'greaterThan',\n                        name: MESSAGES.validationDialog.comparers.greaterThan\n                    },\n                    {\n                        type: 'lessThan',\n                        name: MESSAGES.validationDialog.comparers.lessThan\n                    },\n                    {\n                        type: 'between',\n                        name: MESSAGES.validationDialog.comparers.between\n                    },\n                    {\n                        type: 'notBetween',\n                        name: MESSAGES.validationDialog.comparers.notBetween\n                    },\n                    {\n                        type: 'equalTo',\n                        name: MESSAGES.validationDialog.comparers.equalTo\n                    },\n                    {\n                        type: 'notEqualTo',\n                        name: MESSAGES.validationDialog.comparers.notEqualTo\n                    },\n                    {\n                        type: 'greaterThanOrEqualTo',\n                        name: MESSAGES.validationDialog.comparers.greaterThanOrEqualTo\n                    },\n                    {\n                        type: 'lessThanOrEqualTo',\n                        name: MESSAGES.validationDialog.comparers.lessThanOrEqualTo\n                    }\n                ],\n                comparerMessages: MESSAGES.validationDialog.comparerMessages,\n                errorTemplate: '<div class=\"k-widget k-tooltip k-tooltip-validation\" style=\"margin:0.5em\"><span class=\"k-icon k-warning\"> </span>' + '#=message#<div class=\"k-callout k-callout-n\"></div></div>',\n                template: '<div class=\"k-edit-form-container\">' + '<div class=\"k-edit-label\"><label>' + MESSAGES.validationDialog.labels.criteria + ':</label></div>' + '<div class=\"k-edit-field\">' + '<select data-role=\"dropdownlist\" ' + 'data-text-field=\"name\" ' + 'data-value-field=\"type\" ' + 'data-bind=\"value: criterion, source: criteria\" />' + '</div>' + '<div data-bind=\"visible: isNumber\">' + '<div class=\"k-edit-label\"><label>' + MESSAGES.validationDialog.labels.comparer + ':</label></div>' + '<div class=\"k-edit-field\">' + '<select data-role=\"dropdownlist\" ' + 'data-text-field=\"name\" ' + 'data-value-field=\"type\" ' + 'data-bind=\"value: comparer, source: comparers\" />' + '</div>' + '<div class=\"k-edit-label\"><label>' + MESSAGES.validationDialog.labels.min + ':</label></div>' + '<div class=\"k-edit-field\">' + '<input name=\"' + MESSAGES.validationDialog.labels.min + '\" placeholder=\"e.g. 10\" class=\"k-textbox\" data-bind=\"value: from, enabled: isNumber\" required=\"required\" />' + '</div>' + '<div data-bind=\"visible: showTo\">' + '<div class=\"k-edit-label\"><label>' + MESSAGES.validationDialog.labels.max + ':</label></div>' + '<div class=\"k-edit-field\">' + '<input name=\"' + MESSAGES.validationDialog.labels.max + '\" placeholder=\"e.g. 100\" class=\"k-textbox\" data-bind=\"value: to, enabled: showToForNumber\" required=\"required\" />' + '</div>' + '</div>' + '</div>' + '<div data-bind=\"visible: isText\">' + '<div class=\"k-edit-label\"><label>' + MESSAGES.validationDialog.labels.comparer + ':</label></div>' + '<div class=\"k-edit-field\">' + '<select data-role=\"dropdownlist\" ' + 'data-text-field=\"name\" ' + 'data-value-field=\"type\" ' + 'data-bind=\"value: comparer, source: comparers\" />' + '</div>' + '<div class=\"k-edit-label\"><label>' + MESSAGES.validationDialog.labels.value + ':</label></div>' + '<div class=\"k-edit-field\">' + '<input name=\"' + MESSAGES.validationDialog.labels.value + '\" class=\"k-textbox\" data-bind=\"value: from, enabled: isText\" required=\"required\" />' + '</div>' + '</div>' + '<div data-bind=\"visible: isDate\">' + '<div class=\"k-edit-label\"><label>' + MESSAGES.validationDialog.labels.comparer + ':</label></div>' + '<div class=\"k-edit-field\">' + '<select data-role=\"dropdownlist\" ' + 'data-text-field=\"name\" ' + 'data-value-field=\"type\" ' + 'data-bind=\"value: comparer, source: comparers\" />' + '</div>' + '<div class=\"k-edit-label\"><label>' + MESSAGES.validationDialog.labels.start + ':</label></div>' + '<div class=\"k-edit-field\">' + '<input name=\"' + MESSAGES.validationDialog.labels.start + '\" class=\"k-textbox\" data-bind=\"value: from, enabled: isDate\" required=\"required\" />' + '</div>' + '<div data-bind=\"visible: showTo\">' + '<div class=\"k-edit-label\"><label>' + MESSAGES.validationDialog.labels.end + ':</label></div>' + '<div class=\"k-edit-field\">' + '<input name=\"' + MESSAGES.validationDialog.labels.end + '\" class=\"k-textbox\" data-bind=\"value: to, enabled: showToForDate\" required=\"required\" />' + '</div>' + '</div>' + '</div>' + '<div data-bind=\"visible: isCustom\">' + '<div class=\"k-edit-label\"><label>' + MESSAGES.validationDialog.labels.value + ':</label></div>' + '<div class=\"k-edit-field\">' + '<input name=\"' + MESSAGES.validationDialog.labels.value + '\" class=\"k-textbox\" data-bind=\"value: from, enabled: isCustom\" required=\"required\" />' + '</div>' + '</div>' + '<div data-bind=\"visible: isList\">' + '<div class=\"k-edit-label\"><label>' + MESSAGES.validationDialog.labels.value + ':</label></div>' + '<div class=\"k-edit-field\">' + '<input name=\"' + MESSAGES.validationDialog.labels.value + '\" class=\"k-textbox\" data-bind=\"value: from, enabled: isList\" required=\"required\" />' + '</div>' + '</div>' + '<div data-bind=\"invisible: isAny\">' + '<div class=\"k-edit-label\"><label>' + MESSAGES.validationDialog.labels.ignoreBlank + ':</label></div>' + '<div class=\"k-edit-field\">' + '<input type=\"checkbox\" name=\"ignoreBlank\" id=\"ignoreBlank\" class=\"k-checkbox\" data-bind=\"checked: ignoreBlank\"/>' + '<label class=\"k-checkbox-label\" for=\"ignoreBlank\"></label>' + '</div>' + '</div>' + '<div data-bind=\"invisible: isAny\">' + '<div class=\"k-action-buttons\"></div>' + '<div class=\"k-edit-label\"><label>' + MESSAGES.validationDialog.labels.onInvalidData + ':</label></div>' + '<div class=\"k-edit-field\">' + '<input type=\"radio\" id=\"validationTypeReject\" name=\"validationType\" value=\"reject\" data-bind=\"checked: type\" class=\"k-radio\" />' + '<label for=\"validationTypeReject\" class=\"k-radio-label\">' + MESSAGES.validationDialog.labels.rejectInput + '</label> ' + '<input type=\"radio\" id=\"validationTypeWarning\" name=\"validationType\" value=\"warning\" data-bind=\"checked: type\" class=\"k-radio\" />' + '<label for=\"validationTypeWarning\" class=\"k-radio-label\">' + MESSAGES.validationDialog.labels.showWarning + '</label>' + '</div>' + '</div>' + '<div data-bind=\"invisible: isAny\">' + '<div class=\"k-edit-label\"><label>' + MESSAGES.validationDialog.labels.showHint + ':</label></div>' + '<div class=\"k-edit-field\">' + '<input type=\"checkbox\" name=\"useCustomMessages\" id=\"useCustomMessages\" class=\"k-checkbox\" data-bind=\"checked: useCustomMessages\" />' + '<label class=\"k-checkbox-label\" for=\"useCustomMessages\"></label>' + '</div>' + '<div data-bind=\"visible: useCustomMessages\">' + '<div class=\"k-edit-label\"><label>' + MESSAGES.validationDialog.labels.hintTitle + ':</label></div>' + '<div class=\"k-edit-field\">' + '<input class=\"k-textbox\" placeholder=\"' + MESSAGES.validationDialog.placeholders.typeTitle + '\" data-bind=\"value: hintTitle\" />' + '</div>' + '<div class=\"k-edit-label\"><label>' + MESSAGES.validationDialog.labels.hintMessage + ':</label></div>' + '<div class=\"k-edit-field\">' + '<input class=\"k-textbox\" placeholder=\"' + MESSAGES.validationDialog.placeholders.typeMessage + '\" data-bind=\"value: hintMessage\" />' + '</div>' + '</div>' + '</div>' + '<div class=\"k-action-buttons\">' + '<button class=\"k-button\" data-bind=\"visible: showRemove, click: remove\">' + MESSAGES.remove + '</button>' + '<button class=\"k-button k-primary\" data-bind=\"click: apply\">' + MESSAGES.apply + '</button>' + '<button class=\"k-button\" data-bind=\"click: close\">' + MESSAGES.cancel + '</button>' + '</div>' + '</div>'\n            },\n            open: function (range) {\n                var options = this.options;\n                var element;\n                this.viewModel = new ValidationViewModel({\n                    type: options.type,\n                    defaultHintMessage: options.hintMessage,\n                    defaultHintTitle: options.hintTitle,\n                    defaultComparers: options.comparers.slice(0),\n                    comparerMessages: options.comparerMessages,\n                    criteria: options.criteria.slice(0),\n                    criterion: options.criterion,\n                    ignoreBlank: options.ignoreBlank,\n                    apply: this.apply.bind(this),\n                    close: this.close.bind(this),\n                    remove: this.remove.bind(this)\n                });\n                this.viewModel.update(range.validation());\n                SpreadsheetDialog.fn.open.call(this);\n                element = this.dialog().element;\n                if (this.validatable) {\n                    this.validatable.destroy();\n                }\n                kendo.bind(element, this.viewModel);\n                this.validatable = new kendo.ui.Validator(element.find('.k-edit-form-container'), {\n                    validateOnBlur: false,\n                    errorTemplate: this.options.errorTemplate || undefined\n                });\n            },\n            apply: function () {\n                if (this.validatable.validate()) {\n                    SpreadsheetDialog.fn.apply.call(this);\n                    this.trigger('action', {\n                        command: 'EditValidationCommand',\n                        options: { value: this.viewModel.toValidationObject() }\n                    });\n                }\n            },\n            remove: function () {\n                this.viewModel.set('criterion', 'any');\n                this.apply();\n            }\n        });\n        kendo.spreadsheet.dialogs.register('validation', ValidationDialog);\n        kendo.spreadsheet.dialogs.ValidationDialog = ValidationDialog;\n        var ExportAsDialog = SpreadsheetDialog.extend({\n            init: function (options) {\n                SpreadsheetDialog.fn.init.call(this, options);\n                this.viewModel = kendo.observable({\n                    title: this.options.title,\n                    name: this.options.name,\n                    extension: this.options.extension,\n                    fileFormats: this.options.fileFormats,\n                    excel: options.excelExport,\n                    pdf: {\n                        proxyURL: options.pdfExport.proxyURL,\n                        forceProxy: options.pdfExport.forceProxy,\n                        title: options.pdfExport.title,\n                        author: options.pdfExport.author,\n                        subject: options.pdfExport.subject,\n                        keywords: options.pdfExport.keywords,\n                        creator: options.pdfExport.creator,\n                        date: options.pdfExport.date,\n                        fitWidth: this.options.pdf.fitWidth,\n                        area: this.options.pdf.area,\n                        areas: this.options.pdf.areas,\n                        paperSize: this.options.pdf.paperSize,\n                        paperSizes: this.options.pdf.paperSizes,\n                        margin: this.options.pdf.margin,\n                        margins: this.options.pdf.margins,\n                        landscape: this.options.pdf.landscape,\n                        guidelines: this.options.pdf.guidelines,\n                        hCenter: this.options.pdf.hCenter,\n                        vCenter: this.options.pdf.vCenter\n                    },\n                    apply: this.apply.bind(this),\n                    close: this.close.bind(this)\n                });\n                this.viewModel.bind('change', function (e) {\n                    if (e.field === 'extension') {\n                        this.set('showPdfOptions', this.extension === '.pdf' ? true : false);\n                    }\n                });\n                kendo.bind(this.dialog().element, this.viewModel);\n            },\n            options: {\n                title: MESSAGES.exportAsDialog.title,\n                name: 'Workbook',\n                extension: '.xlsx',\n                fileFormats: [\n                    {\n                        description: 'Excel Workbook (.xlsx)',\n                        extension: '.xlsx'\n                    },\n                    {\n                        description: 'Portable Document Format(.pdf)',\n                        extension: '.pdf'\n                    }\n                ],\n                pdf: {\n                    fitWidth: true,\n                    area: 'workbook',\n                    areas: [\n                        {\n                            area: 'workbook',\n                            text: 'Entire Workbook'\n                        },\n                        {\n                            area: 'sheet',\n                            text: 'Active Sheet'\n                        },\n                        {\n                            area: 'selection',\n                            text: 'Selection'\n                        }\n                    ],\n                    paperSize: 'a4',\n                    paperSizes: [\n                        {\n                            value: 'a2',\n                            text: 'A2 (420 mm \\xD7 594 mm)     '\n                        },\n                        {\n                            value: 'a3',\n                            text: 'A3 (297 mm x 420 mm)     '\n                        },\n                        {\n                            value: 'a4',\n                            text: 'A4 (210 mm x 297 mm)     '\n                        },\n                        {\n                            value: 'a5',\n                            text: 'A5 (148 mm x 210 mm)     '\n                        },\n                        {\n                            value: 'b3',\n                            text: 'B3 (353 mm \\xD7 500 mm)     '\n                        },\n                        {\n                            value: 'b4',\n                            text: 'B4 (250 mm x 353 mm)     '\n                        },\n                        {\n                            value: 'b5',\n                            text: 'B5 (176 mm x 250 mm)     '\n                        },\n                        {\n                            value: 'folio',\n                            text: 'Folio (8.5\" x 13\")       '\n                        },\n                        {\n                            value: 'legal',\n                            text: 'Legal (8.5\" x 14\")       '\n                        },\n                        {\n                            value: 'letter',\n                            text: 'Letter (8.5\" x 11\")      '\n                        },\n                        {\n                            value: 'tabloid',\n                            text: 'Tabloid (11\" x 17\")      '\n                        },\n                        {\n                            value: 'executive',\n                            text: 'Executive (7.25\" x 10.5\")'\n                        }\n                    ],\n                    margin: {\n                        bottom: '0.75in',\n                        left: '0.7in',\n                        right: '0.7in',\n                        top: '0.75in'\n                    },\n                    margins: [\n                        {\n                            value: {\n                                bottom: '0.75in',\n                                left: '0.7in',\n                                right: '0.7in',\n                                top: '0.75in'\n                            },\n                            text: 'Normal'\n                        },\n                        {\n                            value: {\n                                bottom: '0.75in',\n                                left: '0.25in',\n                                right: '0.25in',\n                                top: '0.75in'\n                            },\n                            text: 'Narrow'\n                        },\n                        {\n                            value: {\n                                bottom: '1in',\n                                left: '1in',\n                                right: '1in',\n                                top: '1in'\n                            },\n                            text: 'Wide'\n                        }\n                    ],\n                    landscape: true,\n                    guidelines: true,\n                    hCenter: true,\n                    vCenter: true\n                },\n                width: 520,\n                template: '<div class=\\'k-edit-label\\'><label>' + MESSAGES.exportAsDialog.labels.fileName + ':</label></div>' + '<div class=\\'k-edit-field\\'>' + '<input class=\\'k-textbox\\' data-bind=\\'value: name\\' />' + '</div>' + '<div >' + '<div class=\\'k-edit-label\\'><label>' + MESSAGES.exportAsDialog.labels.saveAsType + ':</label></div>' + '<div class=\\'k-edit-field\\'>' + '<select data-role=\\'dropdownlist\\' class=\\'k-file-format\\' ' + 'data-text-field=\\'description\\' ' + 'data-value-field=\\'extension\\' ' + 'data-bind=\\'value: extension, source: fileFormats\\' />' + '</div>' + '</div>' + '<div class=\\'export-config\\' data-bind=\\'visible: showPdfOptions\\'>' + '<div class=\\'k-edit-label\\'><label>' + MESSAGES.exportAsDialog.labels.exportArea + ':</label></div>' + '<div class=\\'k-edit-field\\'>' + '<select data-role=\\'dropdownlist\\' class=\\'k-file-format\\' ' + 'data-text-field=\\'text\\' ' + 'data-value-field=\\'area\\' ' + 'data-bind=\\'value: pdf.area, source: pdf.areas\\' />' + '</div>' + '<div class=\\'k-edit-label\\'><label>' + MESSAGES.exportAsDialog.labels.paperSize + ':</label></div>' + '<div class=\\'k-edit-field\\'>' + '<select data-role=\\'dropdownlist\\' class=\\'k-file-format\\' ' + 'data-text-field=\\'text\\' ' + 'data-value-field=\\'value\\' ' + 'data-bind=\\'value: pdf.paperSize, source: pdf.paperSizes\\' />' + '</div>' + '<div class=\\'k-edit-label\\'><label>' + MESSAGES.exportAsDialog.labels.margins + ':</label></div>' + '<div class=\\'k-edit-field\\'>' + '<select data-role=\\'dropdownlist\\' class=\\'k-file-format\\' ' + 'data-value-primitive=\\'true\\'' + 'data-text-field=\\'text\\' ' + 'data-value-field=\\'value\\' ' + 'data-bind=\\'value: pdf.margin, source: pdf.margins\\' />' + '</div>' + '<div class=\\'k-edit-label\\'><label>' + MESSAGES.exportAsDialog.labels.orientation + ':</label></div>' + '<div class=\\'k-edit-field\\'>' + '<input type=\\'radio\\' id=\\'k-orientation-portrait\\' name=\\'orientation\\' data-type=\\'boolean\\' data-bind=\\'checked: pdf.landscape\\' value=\\'false\\' /><label class=\\'k-orientation-label k-orientation-portrait-label\\' for=\\'k-orientation-portrait\\'></label>' + '<input type=\\'radio\\' id=\\'k-orientation-landscape\\' name=\\'orientation\\' data-type=\\'boolean\\' data-bind=\\'checked: pdf.landscape\\' value=\\'true\\' /><label class=\\'k-orientation-label k-orientation-landscape-label\\' for=\\'k-orientation-landscape\\'></label>' + '</div>' + '<div class=\\'k-edit-label\\'><label>' + MESSAGES.exportAsDialog.labels.print + ':</label></div>' + '<div class=\\'k-edit-field\\'>' + '<input class=\\'k-checkbox\\' id=\\'guidelines\\' type=\\'checkbox\\' data-bind=\\'checked: pdf.guidelines\\'/><label class=\\'k-checkbox-label\\' for=\\'guidelines\\'>' + MESSAGES.exportAsDialog.labels.guidelines + '</label>' + '</div>' + '<div class=\\'k-edit-label\\'><label>' + MESSAGES.exportAsDialog.labels.scale + ':</label></div>' + '<div class=\\'k-edit-field\\'>' + '<input class=\\'k-checkbox\\' id=\\'fitWidth\\' type=\\'checkbox\\' data-bind=\\'checked: pdf.fitWidth\\'/><label class=\\'k-checkbox-label\\' for=\\'fitWidth\\'>' + MESSAGES.exportAsDialog.labels.fit + '</label>' + '</div>' + '<div class=\\'k-edit-label\\'><label>' + MESSAGES.exportAsDialog.labels.center + ':</label></div>' + '<div class=\\'k-edit-field\\'>' + '<input class=\\'k-checkbox\\' id=\\'hCenter\\' type=\\'checkbox\\' data-bind=\\'checked: pdf.hCenter\\'/><label class=\\'k-checkbox-label\\' for=\\'hCenter\\'>' + MESSAGES.exportAsDialog.labels.horizontally + '</label>' + '<input class=\\'k-checkbox\\' id=\\'vCenter\\' type=\\'checkbox\\' data-bind=\\'checked: pdf.vCenter\\'/><label class=\\'k-checkbox-label\\' for=\\'vCenter\\'>' + MESSAGES.exportAsDialog.labels.vertically + '</label>' + '</div>' + '<div class=\\'k-page-orientation\\' data-bind=\\'css: {k-page-landscape: pdf.landscape}\\'>' + '<div class=\\'k-margins-horizontal\\'></div>' + '<div class=\\'k-margins-vertical\\'></div>' + '</div>' + '</div>' + '<div class=\\'k-action-buttons\\'>' + '<button class=\\'k-button k-primary\\' data-bind=\\'click: apply\\'>' + MESSAGES.save + '</button>' + '<button class=\\'k-button\\' data-bind=\\'click: close\\'>' + MESSAGES.cancel + '</button>' + '</div>'\n            },\n            apply: function () {\n                SpreadsheetDialog.fn.apply.call(this);\n                this.trigger('action', {\n                    command: 'SaveAsCommand',\n                    options: this.viewModel\n                });\n            }\n        });\n        kendo.spreadsheet.dialogs.register('exportAs', ExportAsDialog);\n        var ModifyMergedDialog = MessageDialog.extend({\n            init: function (options) {\n                SpreadsheetDialog.fn.init.call(this, options);\n            },\n            options: { template: MESSAGES.modifyMergedDialog.errorMessage + '<div class=\"k-action-buttons\">' + '<button class=\\'k-button k-primary\\' data-bind=\\'click: close, text: okText\\' />' + '</div>' }\n        });\n        kendo.spreadsheet.dialogs.register('modifyMerged', ModifyMergedDialog);\n        var UseKeyboardDialog = MessageDialog.extend({\n            init: function (options) {\n                SpreadsheetDialog.fn.init.call(this, options);\n            },\n            options: {\n                title: MESSAGES.useKeyboardDialog.title,\n                template: MESSAGES.useKeyboardDialog.errorMessage + '<div>Ctrl+C ' + MESSAGES.useKeyboardDialog.labels.forCopy + '</div>' + '<div>Ctrl+X ' + MESSAGES.useKeyboardDialog.labels.forCut + '</div>' + '<div>Ctrl+V ' + MESSAGES.useKeyboardDialog.labels.forPaste + '</div>' + '<div class=\"k-action-buttons\">' + '<button class=\\'k-button k-primary\\' data-bind=\\'click: close, text: okText\\' />' + '</div>'\n            }\n        });\n        kendo.spreadsheet.dialogs.register('useKeyboard', UseKeyboardDialog);\n        var UnsupportedSelectionDialog = MessageDialog.extend({\n            init: function (options) {\n                SpreadsheetDialog.fn.init.call(this, options);\n            },\n            options: { template: MESSAGES.unsupportedSelectionDialog.errorMessage + '<div class=\"k-action-buttons\">' + '<button class=\\'k-button k-primary\\' data-bind=\\'click: close, text: okText\\' />' + '</div>' }\n        });\n        kendo.spreadsheet.dialogs.register('unsupportedSelection', UnsupportedSelectionDialog);\n    }(window.kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/sheetbinder', [\n        'kendo.core',\n        'kendo.data',\n        'spreadsheet/sheet'\n    ], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var SheetDataSourceBinder = kendo.Class.extend({\n            init: function (options) {\n                this.options = $.extend({}, this.options, options);\n                this.columns = this._normalizeColumns(this.options.columns);\n                this._sheet();\n                this._dataSource();\n                this._header();\n                this.dataSource.fetch();\n            },\n            _sheet: function () {\n                this.sheet = this.options.sheet;\n                this._sheetChangeHandler = this._sheetChange.bind(this);\n                this._sheetDeleteRowHandler = this._sheetDeleteRow.bind(this);\n                this._sheetInsertRowHandler = this._sheetInsertRow.bind(this);\n                this.sheet.bind('change', this._sheetChangeHandler).bind('deleteRow', this._sheetDeleteRowHandler).bind('insertRow', this._sheetInsertRowHandler);\n            },\n            _sheetInsertRow: function (e) {\n                if (e.index !== undefined) {\n                    this.dataSource.insert(Math.max(e.index - 1, 0), {});\n                }\n            },\n            _sheetDeleteRow: function (e) {\n                if (e.index !== undefined) {\n                    var dataSource = this.dataSource;\n                    var model = dataSource.view()[e.index - 1];\n                    if (model) {\n                        dataSource.remove(model);\n                    }\n                }\n            },\n            _header: function () {\n                this.sheet.batch(function () {\n                    this.columns.forEach(function (column, index) {\n                        this.sheet.range(0, index).value(column.title);\n                    }.bind(this));\n                }.bind(this));\n            },\n            _sheetChange: function (e) {\n                if (e.recalc && e.ref) {\n                    var dataSource = this.dataSource;\n                    var data = dataSource.view();\n                    var columns = this.columns;\n                    if (!columns.length && data.length) {\n                        columns = Object.keys(data[0].toJSON());\n                    }\n                    this._skipRebind = true;\n                    var values = this.sheet.range(e.ref).values();\n                    e.ref.forEach(function (ref) {\n                        ref = ref.toRangeRef();\n                        var record;\n                        var valueIndex = 0;\n                        for (var ri = ref.topLeft.row; ri <= ref.bottomRight.row; ri++) {\n                            record = data[ri - 1];\n                            if (!record) {\n                                record = dataSource.insert(ri - 1, {});\n                                data = dataSource.view();\n                            }\n                            var colValueIndex = 0;\n                            for (var ci = ref.topLeft.col; ci <= ref.bottomRight.col && ci < columns.length; ci++) {\n                                record.set(columns[ci].field, values[valueIndex][colValueIndex++]);\n                            }\n                            valueIndex++;\n                        }\n                    });\n                    this._skipRebind = false;\n                }\n            },\n            _normalizeColumns: function (columns) {\n                return columns.map(function (column) {\n                    var field = column.field || column;\n                    return {\n                        field: field,\n                        title: column.title || field\n                    };\n                });\n            },\n            _dataSource: function () {\n                var options = this.options;\n                var dataSource = options.dataSource;\n                dataSource = Array.isArray(dataSource) ? { data: dataSource } : dataSource;\n                if (this.dataSource && this._changeHandler) {\n                    this.dataSource.unbind('change', this._changeHandler);\n                } else {\n                    this._changeHandler = this._change.bind(this);\n                }\n                this.dataSource = kendo.data.DataSource.create(dataSource).bind('change', this._changeHandler);\n            },\n            _change: function () {\n                if (this._skipRebind) {\n                    return;\n                }\n                var data = this.dataSource.view();\n                var columns = this.columns;\n                if (!columns.length && data.length) {\n                    this.columns = columns = this._normalizeColumns(Object.keys(data[0].toJSON()));\n                    this._header();\n                }\n                var getters = columns.map(function (column) {\n                    return kendo.getter(column.field);\n                });\n                this.sheet.batch(function () {\n                    for (var idx = 0, length = data.length; idx < length; idx++) {\n                        for (var getterIdx = 0; getterIdx < getters.length; getterIdx++) {\n                            this.sheet.range(idx + 1, getterIdx).value(getters[getterIdx](data[idx]));\n                        }\n                    }\n                }.bind(this));\n            },\n            destroy: function () {\n                this.dataSource.unbind('change', this._changeHandler);\n                this.sheet.unbind('change', this._sheetChangeHandler).unbind('deleteRow', this._sheetDeleteRowHandler).unbind('insertRow', this._sheetInsertRowHandler);\n            },\n            options: { columns: [] }\n        });\n        kendo.spreadsheet.SheetDataSourceBinder = SheetDataSourceBinder;\n    }(kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/filtermenu', [\n        'kendo.core',\n        'kendo.popup',\n        'kendo.treeview',\n        'kendo.numerictextbox',\n        'kendo.datepicker',\n        'kendo.datetimepicker'\n    ], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var $ = kendo.jQuery;\n        var Widget = kendo.ui.Widget;\n        var classNames = {\n            details: 'k-details',\n            button: 'k-button',\n            detailsSummary: 'k-details-summary',\n            detailsContent: 'k-details-content',\n            icon: 'k-icon k-font-icon',\n            iconCollapse: 'k-i-collapse-se',\n            iconExpand: 'k-i-expand-e',\n            iconSearch: 'k-i-search',\n            textbox: 'k-textbox',\n            wrapper: 'k-spreadsheet-filter-menu',\n            filterByCondition: 'k-spreadsheet-condition-filter',\n            filterByValue: 'k-spreadsheet-value-filter',\n            valuesTreeViewWrapper: 'k-spreadsheet-value-treeview-wrapper',\n            actionButtons: 'k-action-buttons'\n        };\n        var Details = Widget.extend({\n            init: function (element, options) {\n                Widget.fn.init.call(this, element, options);\n                this.element.addClass(FilterMenu.classNames.details);\n                this._summary = this.element.find('.' + FilterMenu.classNames.detailsSummary).on('click', this._toggle.bind(this));\n                var iconClass = options.expanded ? FilterMenu.classNames.iconCollapse : FilterMenu.classNames.iconExpand;\n                this._icon = $('<span />', { 'class': FilterMenu.classNames.icon + ' ' + iconClass }).prependTo(this._summary);\n                this._container = kendo.wrap(this._summary.next(), true);\n                if (!options.expanded) {\n                    this._container.hide();\n                }\n            },\n            options: { name: 'Details' },\n            events: ['toggle'],\n            visible: function () {\n                return this.options.expanded;\n            },\n            toggle: function (show) {\n                var animation = kendo.fx(this._container).expand('vertical');\n                animation.stop()[show ? 'reverse' : 'play']();\n                this._icon.toggleClass(FilterMenu.classNames.iconExpand, show).toggleClass(FilterMenu.classNames.iconCollapse, !show);\n                this.options.expanded = !show;\n            },\n            _toggle: function () {\n                var show = this.visible();\n                this.toggle(show);\n                this.trigger('toggle', { show: show });\n            }\n        });\n        var FILTERMENU_MESSAGES = kendo.spreadsheet.messages.filterMenu = {\n            sortAscending: 'Sort range A to Z',\n            sortDescending: 'Sort range Z to A',\n            filterByValue: 'Filter by value',\n            filterByCondition: 'Filter by condition',\n            apply: 'Apply',\n            search: 'Search',\n            addToCurrent: 'Add to current selection',\n            clear: 'Clear',\n            blanks: '(Blanks)',\n            operatorNone: 'None',\n            and: 'AND',\n            or: 'OR',\n            operators: {\n                string: {\n                    contains: 'Text contains',\n                    doesnotcontain: 'Text does not contain',\n                    startswith: 'Text starts with',\n                    endswith: 'Text ends with'\n                },\n                date: {\n                    eq: 'Date is',\n                    neq: 'Date is not',\n                    lt: 'Date is before',\n                    gt: 'Date is after'\n                },\n                number: {\n                    eq: 'Is equal to',\n                    neq: 'Is not equal to',\n                    gte: 'Is greater than or equal to',\n                    gt: 'Is greater than',\n                    lte: 'Is less than or equal to',\n                    lt: 'Is less than'\n                }\n            }\n        };\n        kendo.data.binders.spreadsheetFilterValue = kendo.data.Binder.extend({\n            init: function (element, bindings, options) {\n                kendo.data.Binder.fn.init.call(this, element, bindings, options);\n                this._change = $.proxy(this.change, this);\n                $(this.element).on('change', this._change);\n            },\n            refresh: function () {\n                var that = this, value = that.bindings.spreadsheetFilterValue.get();\n                $(that.element).val(value instanceof Date ? '' : value);\n            },\n            change: function () {\n                var value = this.element.value;\n                this.bindings.spreadsheetFilterValue.set(value);\n            }\n        });\n        kendo.data.binders.widget.spreadsheetFilterValue = kendo.data.Binder.extend({\n            init: function (widget, bindings, options) {\n                kendo.data.Binder.fn.init.call(this, widget.element[0], bindings, options);\n                this.widget = widget;\n                this._change = $.proxy(this.change, this);\n                this.widget.first('change', this._change);\n            },\n            refresh: function () {\n                var binding = this.bindings.spreadsheetFilterValue, value = binding.get(), type = $(this.widget.element).data('filterType');\n                if (type === 'date' && value instanceof Date || type === 'number' && !isNaN(value)) {\n                    this.widget.value(value);\n                } else {\n                    this.widget.value(null);\n                }\n            },\n            change: function () {\n                var value = this.widget.value(), binding = this.bindings.spreadsheetFilterValue;\n                binding.set(value);\n            }\n        });\n        var templates = {\n            filterByValue: '<div class=\\'' + classNames.detailsSummary + '\\'>#= messages.filterByValue #</div>' + '<div class=\\'' + classNames.detailsContent + '\\'>' + '<div class=\\'k-textbox k-space-right\\'>' + '<input placeholder=\\'#= messages.search #\\' data-#=ns#bind=\\'events: { input: filterValues }\\' />' + '<span class=\\'k-icon k-font-icon k-i-search\\' />' + '</div>' + '<div data-#=ns#bind=\\'visible: hasActiveSearch\\'><input class=\\'k-checkbox\\' type=\\'checkbox\\' data-#=ns#bind=\\'checked: appendToSearch\\' id=\\'_#=guid#\\' /><label class=\\'k-checkbox-label\\' for=\\'_#=guid#\\'>#= messages.addToCurrent #</label></div>' + '<div class=\\'' + classNames.valuesTreeViewWrapper + '\\'>' + '<div data-#=ns#role=\\'treeview\\' ' + 'data-#=ns#checkboxes=\\'{ checkChildren: true }\\' ' + 'data-#=ns#bind=\\'source: valuesDataSource, events: { check: valuesChange, select: valueSelect }\\' ' + '/>' + '</div>' + '</div>',\n            filterByCondition: '<div class=\\'' + classNames.detailsSummary + '\\'>#= messages.filterByCondition #</div>' + '<div class=\\'' + classNames.detailsContent + '\\'>' + '<div>' + '<select ' + 'data-#=ns#role=\"dropdownlist\"' + 'data-#=ns#bind=\"value: operator, source: operators, events: { change: operatorChange } \"' + 'data-value-primitive=\"false\"' + 'data-option-label=\"#=messages.operatorNone#\"' + 'data-height=\"auto\"' + 'data-text-field=\"text\"' + 'data-value-field=\"unique\">' + '</select>' + '</div>' + '<div data-#=ns#bind=\"visible: isString\">' + '<input data-filter-type=\"string\" data-#=ns#bind=\"spreadsheetFilterValue: customFilter.criteria[0].value\" class=\"k-textbox\" />' + '</div>' + '<div data-#=ns#bind=\"visible: isNumber\">' + '<input data-filter-type=\"number\" data-#=ns#role=\"numerictextbox\" data-#=ns#bind=\"spreadsheetFilterValue: customFilter.criteria[0].value\" />' + '</div>' + '<div data-#=ns#bind=\"visible: isDate\">' + '<input data-filter-type=\"date\" data-#=ns#role=\"datepicker\" data-#=ns#bind=\"spreadsheetFilterValue: customFilter.criteria[0].value\" />' + '</div>' + '</div>',\n            menuItem: '<li data-command=\\'#=command#\\' data-dir=\\'#=dir#\\'>' + '<span class=\\'k-icon k-font-icon k-i-#=iconClass#\\'></span>#=text#' + '</li>',\n            actionButtons: '<button data-#=ns#bind=\\'click: apply\\' class=\\'k-button k-primary\\'>#=messages.apply#</button>' + '<button data-#=ns#bind=\\'click: clear\\' class=\\'k-button\\'>#=messages.clear#</button>'\n        };\n        function distinctValues(values) {\n            var hash = {};\n            var result = [];\n            for (var i = 0; i < values.length; i++) {\n                if (!hash[values[i].value]) {\n                    hash[values[i].value] = values[i];\n                    result.push(values[i]);\n                } else if (!hash[values[i].value].checked && values[i].checked) {\n                    hash[values[i].value].checked = true;\n                }\n            }\n            return result;\n        }\n        function filter(dataSource, query) {\n            var hasVisibleChildren = false;\n            var data = dataSource instanceof kendo.data.HierarchicalDataSource && dataSource.data();\n            for (var i = 0; i < data.length; i++) {\n                var item = data[i];\n                var text = item.text.toString().toLowerCase();\n                var itemVisible = query === true || query === '' || text.indexOf(query) >= 0;\n                var anyVisibleChildren = filter(item.children, itemVisible || query);\n                hasVisibleChildren = hasVisibleChildren || anyVisibleChildren || itemVisible;\n                item.hidden = !itemVisible && !anyVisibleChildren;\n                item.checked = !item.hidden;\n            }\n            if (data) {\n                dataSource.filter({\n                    field: 'hidden',\n                    operator: 'neq',\n                    value: true\n                });\n            }\n            return hasVisibleChildren;\n        }\n        function uncheckAll(dataSource) {\n            var data = dataSource instanceof kendo.data.HierarchicalDataSource && dataSource.data();\n            for (var i = 0; i < data.length; i++) {\n                var item = data[i];\n                item.checked = false;\n                if (item.hasChildren) {\n                    uncheckAll(item.children);\n                }\n            }\n        }\n        var FilterMenuViewModel = kendo.spreadsheet.FilterMenuViewModel = kendo.data.ObservableObject.extend({\n            valuesChange: function (e) {\n                var dataSource = e ? e.sender.dataSource : this.valuesDataSource;\n                var checked = function (item) {\n                    return item.checked && item.value;\n                };\n                var value = function (item) {\n                    return item.dataType === 'date' ? kendo.spreadsheet.dateToNumber(item.value) : item.value;\n                };\n                var unique = function (value, index, array) {\n                    return array.lastIndexOf(value) === index;\n                };\n                var data = dataSource.data();\n                var values = data[0].children.data().toJSON();\n                var blanks = values.filter(function (item) {\n                    return item.dataType === 'blank';\n                });\n                blanks = blanks.length ? blanks[0].checked : false;\n                values = values.filter(checked).map(value);\n                if (this.appendToSearch && this.valueFilter && this.valueFilter.values.length) {\n                    values = values.concat(this.valueFilter.values.toJSON()).sort().filter(unique);\n                }\n                this.set('valueFilter', {\n                    values: values,\n                    blanks: blanks\n                });\n            },\n            valueSelect: function (e) {\n                e.preventDefault();\n                var node = e.sender.dataItem(e.node);\n                node.set('checked', !node.checked);\n            },\n            hasActiveSearch: false,\n            appendToSearch: false,\n            filterValues: function (e) {\n                var query = typeof e == 'string' ? e : $(e.target).val().toLowerCase();\n                var dataSource = this.valuesDataSource;\n                this.set('hasActiveSearch', !!query);\n                uncheckAll(dataSource);\n                filter(dataSource, query);\n            },\n            reset: function () {\n                this.set('customFilter', {\n                    logic: 'and',\n                    criteria: [{\n                            operator: null,\n                            value: null\n                        }]\n                });\n                this.set('valueFilter', { values: [] });\n            },\n            operatorChange: function (e) {\n                var dataItem = e.sender.dataItem();\n                this.set('operatorType', dataItem.type);\n                this.set('customFilter.criteria[0].operator', dataItem.value);\n            },\n            isNone: function () {\n                return this.get('operatorType') === undefined;\n            },\n            isString: function () {\n                return this.get('operatorType') === 'string';\n            },\n            isNumber: function () {\n                return this.get('operatorType') === 'number';\n            },\n            isDate: function () {\n                return this.get('operatorType') === 'date';\n            }\n        });\n        function flattenOperators(operators) {\n            var messages = FILTERMENU_MESSAGES.operators;\n            var result = [];\n            for (var type in operators) {\n                if (!operators.hasOwnProperty(type)) {\n                    continue;\n                }\n                for (var operator in operators[type]) {\n                    if (!operators[type].hasOwnProperty(operator)) {\n                        continue;\n                    }\n                    result.push({\n                        text: messages[type][operator],\n                        value: operator,\n                        unique: type + '_' + operator,\n                        type: type\n                    });\n                }\n            }\n            return result;\n        }\n        var FilterMenuController = kendo.spreadsheet.FilterMenuController = {\n            valuesTree: function (range, column) {\n                return [{\n                        text: 'All',\n                        expanded: true,\n                        checked: true,\n                        items: this.values(range.resize({ top: 1 }), column)\n                    }];\n            },\n            values: function (range, column) {\n                var values = [];\n                var messages = FILTERMENU_MESSAGES;\n                var columnRange = range.column(column);\n                var sheet = range.sheet();\n                columnRange.forEachCell(function (row, col, cell) {\n                    if (cell.value === undefined) {\n                        cell.dataType = 'blank';\n                    } else if (cell.format) {\n                        cell.dataType = kendo.spreadsheet.formatting.type(cell.value, cell.format);\n                    } else {\n                        cell.dataType = typeof cell.value;\n                    }\n                    if (cell.value !== null && cell.format) {\n                        cell.text = kendo.spreadsheet.formatting.text(cell.value, cell.format);\n                    } else {\n                        cell.text = cell.value ? cell.value : messages.blanks;\n                    }\n                    if (cell.dataType === 'percent') {\n                        cell.dataType = 'number';\n                    }\n                    if (cell.dataType === 'date') {\n                        cell.value = kendo.spreadsheet.numberToDate(cell.value);\n                    }\n                    if (cell.hasOwnProperty('wrap')) {\n                        delete cell.wrap;\n                    }\n                    cell.checked = !sheet.isHiddenRow(row);\n                    values.push(cell);\n                });\n                values = distinctValues(values);\n                values.sort(function (a, b) {\n                    if (a.dataType === b.dataType) {\n                        return 0;\n                    }\n                    if (a.dataType === 'blank' || b.dataType === 'blank') {\n                        return a.dataType === 'blank' ? -1 : 1;\n                    }\n                    if (a.dataType === 'number' || b.dataType === 'number') {\n                        return a.dataType === 'number' ? -1 : 1;\n                    }\n                    if (a.dataType === 'date' || b.dataType === 'date') {\n                        return a.dataType === 'date' ? -1 : 1;\n                    }\n                    return 0;\n                });\n                return values;\n            },\n            filterType: function (range, column) {\n                var sheet = range.sheet();\n                var filter = this.filterForColumn(column, sheet);\n                var type;\n                filter = filter && filter.filter.toJSON();\n                if (filter && filter.filter == 'custom') {\n                    var value = filter.criteria[0].value;\n                    if (value instanceof Date) {\n                        type = 'date';\n                    } else if (typeof value == 'string') {\n                        type = 'string';\n                    } else if (typeof value == 'number') {\n                        type = 'number';\n                    }\n                }\n                if (!type) {\n                    var topValue = this.values(range.row(1), column)[0];\n                    type = topValue && topValue.dataType;\n                    if (type == 'blank') {\n                        type = null;\n                    }\n                }\n                return type;\n            },\n            filterForColumn: function (column, sheet) {\n                var allFilters = sheet.filter();\n                var filters;\n                if (allFilters) {\n                    filters = allFilters.columns.filter(function (item) {\n                        return item.index === column;\n                    })[0];\n                }\n                return filters;\n            },\n            filter: function (column, sheet) {\n                var columnFilters = this.filterForColumn(column, sheet);\n                if (!columnFilters) {\n                    return;\n                }\n                var options = columnFilters.filter.toJSON();\n                var type = options.filter;\n                delete options.filter;\n                var result = {\n                    type: type,\n                    options: options\n                };\n                var criteria = options.criteria;\n                if (criteria && criteria.length) {\n                    result.operator = criteria[0].operator;\n                }\n                return result;\n            }\n        };\n        var FilterMenu = Widget.extend({\n            init: function (element, options) {\n                Widget.call(this, element, options);\n                this.element.addClass(FilterMenu.classNames.wrapper);\n                this.viewModel = new FilterMenuViewModel({\n                    active: 'value',\n                    operator: null,\n                    operators: flattenOperators(this.options.operators),\n                    clear: this.clear.bind(this),\n                    apply: this.apply.bind(this)\n                });\n                this._filterInit();\n                this._popup();\n                this._sort();\n                this._filterByCondition();\n                this._filterByValue();\n                this._actionButtons();\n            },\n            options: {\n                name: 'FilterMenu',\n                column: 0,\n                range: null,\n                operators: {\n                    string: {\n                        contains: 'Text contains',\n                        doesnotcontain: 'Text does not contain',\n                        startswith: 'Text starts with',\n                        endswith: 'Text ends with'\n                    },\n                    date: {\n                        eq: 'Date is',\n                        neq: 'Date is not',\n                        lt: 'Date is before',\n                        gt: 'Date is after'\n                    },\n                    number: {\n                        eq: 'Is equal to',\n                        neq: 'Is not equal to',\n                        gte: 'Is greater than or equal to',\n                        gt: 'Is greater than',\n                        lte: 'Is less than or equal to',\n                        lt: 'Is less than'\n                    }\n                }\n            },\n            events: ['action'],\n            destroy: function () {\n                Widget.fn.destroy.call(this);\n                this.menu.destroy();\n                this.valuesTreeView.destroy();\n                this.popup.destroy();\n            },\n            openFor: function (anchor) {\n                this.popup.setOptions({ anchor: anchor });\n                this.popup.open();\n            },\n            close: function () {\n                this.popup.close();\n            },\n            clear: function () {\n                this.action({\n                    command: 'ClearFilterCommand',\n                    options: { column: this.options.column }\n                });\n                this.viewModel.reset();\n                this.close();\n            },\n            apply: function () {\n                this._active();\n                var options = {\n                    operatingRange: this.options.range,\n                    column: this.options.column\n                };\n                var valueFilter;\n                var customFilter;\n                if (this.viewModel.active === 'value') {\n                    this.viewModel.valuesChange({ sender: this.valuesTreeView });\n                    valueFilter = this.viewModel.valueFilter.toJSON();\n                    if (valueFilter.values && valueFilter.values.length) {\n                        options.valueFilter = valueFilter;\n                    }\n                } else if (this.viewModel.active === 'custom') {\n                    customFilter = this.viewModel.customFilter.toJSON();\n                    if (customFilter.criteria.length && customFilter.criteria[0].value !== null) {\n                        options.customFilter = customFilter;\n                    }\n                }\n                if (options.valueFilter || options.customFilter) {\n                    this.action({\n                        command: 'ApplyFilterCommand',\n                        options: options\n                    });\n                }\n            },\n            action: function (options) {\n                this.trigger('action', $.extend({}, options));\n            },\n            _filterInit: function () {\n                var column = this.options.column;\n                var range = this.options.range;\n                var sheet = range.sheet();\n                var activeFilter = FilterMenuController.filter(column, sheet);\n                if (activeFilter) {\n                    var filterType = FilterMenuController.filterType(range, column);\n                    this.viewModel.set('active', activeFilter.type);\n                    this.viewModel.set(activeFilter.type + 'Filter', activeFilter.options);\n                    if (activeFilter.type == 'custom') {\n                        this.viewModel.set('operator', filterType + '_' + activeFilter.operator);\n                        this.viewModel.set('operatorType', filterType);\n                    }\n                } else {\n                    this.viewModel.reset();\n                }\n            },\n            _popup: function () {\n                this.popup = this.element.kendoPopup({ copyAnchorStyles: false }).data('kendoPopup');\n            },\n            _sort: function () {\n                var template = kendo.template(FilterMenu.templates.menuItem);\n                var messages = FILTERMENU_MESSAGES;\n                var items = [\n                    {\n                        command: 'sort',\n                        dir: 'asc',\n                        text: messages.sortAscending,\n                        iconClass: 'sort-asc'\n                    },\n                    {\n                        command: 'sort',\n                        dir: 'desc',\n                        text: messages.sortDescending,\n                        iconClass: 'sort-desc'\n                    }\n                ];\n                var ul = $('<ul />', { 'html': kendo.render(template, items) }).appendTo(this.element);\n                this.menu = ul.kendoMenu({\n                    orientation: 'vertical',\n                    select: function (e) {\n                        var dir = $(e.item).data('dir');\n                        var range = this.options.range.resize({ top: 1 });\n                        var options = {\n                            value: dir,\n                            sheet: false,\n                            operatingRange: range,\n                            column: this.options.column\n                        };\n                        if (range.isSortable()) {\n                            this.action({\n                                command: 'SortCommand',\n                                options: options\n                            });\n                        } else {\n                            this.close();\n                        }\n                    }.bind(this)\n                }).data('kendoMenu');\n            },\n            _appendTemplate: function (template, className, details, expanded) {\n                var compiledTemplate = kendo.template(template);\n                var wrapper = $('<div class=\\'' + className + '\\'/>').html(compiledTemplate({\n                    messages: FILTERMENU_MESSAGES,\n                    guid: kendo.guid(),\n                    ns: kendo.ns\n                }));\n                this.element.append(wrapper);\n                if (details) {\n                    details = new Details(wrapper, {\n                        expanded: expanded,\n                        toggle: this._detailToggle.bind(this)\n                    });\n                }\n                kendo.bind(wrapper, this.viewModel);\n                return wrapper;\n            },\n            _detailToggle: function (e) {\n                this.element.find('[data-role=details]').not(e.sender.element).data('kendoDetails').toggle(!e.show);\n            },\n            _filterByCondition: function () {\n                var isExpanded = this.viewModel.active === 'custom';\n                this._appendTemplate(FilterMenu.templates.filterByCondition, FilterMenu.classNames.filterByCondition, true, isExpanded);\n            },\n            _filterByValue: function () {\n                var isExpanded = this.viewModel.active === 'value';\n                var wrapper = this._appendTemplate(FilterMenu.templates.filterByValue, FilterMenu.classNames.filterByValue, true, isExpanded);\n                this.valuesTreeView = wrapper.find('[data-role=treeview]').data('kendoTreeView');\n                var values = FilterMenuController.valuesTree(this.options.range, this.options.column);\n                this.viewModel.set('valuesDataSource', new kendo.data.HierarchicalDataSource({ data: values }));\n            },\n            _actionButtons: function () {\n                this._appendTemplate(FilterMenu.templates.actionButtons, FilterMenu.classNames.actionButtons, false);\n            },\n            _active: function () {\n                var activeContainer = this.element.find('[data-role=details]').filter(function (index, element) {\n                    return $(element).data('kendoDetails').visible();\n                });\n                if (activeContainer.hasClass(FilterMenu.classNames.filterByValue)) {\n                    this.viewModel.set('active', 'value');\n                } else if (activeContainer.hasClass(FilterMenu.classNames.filterByCondition)) {\n                    this.viewModel.set('active', 'custom');\n                }\n            }\n        });\n        kendo.spreadsheet.FilterMenu = FilterMenu;\n        $.extend(true, FilterMenu, {\n            classNames: classNames,\n            templates: templates\n        });\n    }(window.kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/editor', ['kendo.core'], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var SheetEditor = kendo.Observable.extend({\n            init: function (view) {\n                kendo.Observable.fn.init.call(this);\n                this.view = view;\n                this.formulaBar = view.formulaBar;\n                this.barInput = view.formulaBar.formulaInput;\n                this.cellInput = view.formulaInput;\n                this.barInput.syncWith(this.cellInput);\n                this.cellInput.syncWith(this.barInput);\n                this.barInput.bind('keyup', this._triggerUpdate.bind(this));\n                this.cellInput.bind('keyup', this._triggerUpdate.bind(this));\n                this.barInput.bind('focus', this._focus.bind(this));\n                this.cellInput.bind('focus', this._focus.bind(this));\n            },\n            events: [\n                'activate',\n                'deactivate',\n                'change',\n                'update'\n            ],\n            _focus: function (e) {\n                this.lastActive = e.sender == this.barInput ? 'bar' : 'cell';\n            },\n            _triggerUpdate: function () {\n                this.trigger('update', { value: this.value() });\n            },\n            activeEditor: function () {\n                var editor = null;\n                var activeElement = kendo._activeElement();\n                if (this.barElement()[0] === activeElement) {\n                    editor = this.barInput;\n                } else if (this.cellElement()[0] === activeElement) {\n                    editor = this.cellInput;\n                }\n                return editor;\n            },\n            activate: function (options) {\n                this._active = true;\n                this._rect = options.rect;\n                this.cellInput.position(options.rect);\n                this.cellInput.resize(options.rect);\n                this.cellInput.tooltip(options.tooltip);\n                this.cellInput.activeCell = this.barInput.activeCell = options.range.topLeft;\n                this.trigger('activate');\n                return this;\n            },\n            deactivate: function () {\n                var cellInput = this.cellInput;\n                if (!this._active) {\n                    return;\n                }\n                if (cellInput.value() != this._value) {\n                    if (this.trigger('change', { value: cellInput.value() })) {\n                        return;\n                    }\n                }\n                this._active = false;\n                this._rect = null;\n                cellInput.hide();\n                this.trigger('deactivate');\n            },\n            enable: function (enable) {\n                this.barInput.enable(enable);\n            },\n            barElement: function () {\n                return this.barInput.element;\n            },\n            cellElement: function () {\n                return this.cellInput.element;\n            },\n            focusLastActive: function () {\n                this.focus(this.lastActive);\n            },\n            focus: function (inputType) {\n                inputType = inputType || 'cell';\n                if (inputType === 'cell') {\n                    this.cellInput.element.focus();\n                    this.cellInput.end();\n                } else {\n                    this.barInput.element.focus();\n                }\n            },\n            isActive: function () {\n                return this._active;\n            },\n            isFiltered: function () {\n                return this.barInput.popup.visible() || this.cellInput.popup.visible();\n            },\n            canInsertRef: function (isKeyboardAction) {\n                var editor = this.activeEditor();\n                return editor && editor.canInsertRef(isKeyboardAction);\n            },\n            highlightedRefs: function () {\n                var editor = this.activeEditor();\n                var refs = [];\n                if (editor) {\n                    refs = editor.highlightedRefs();\n                }\n                return refs;\n            },\n            scale: function () {\n                this.cellInput.scale();\n            },\n            toggleTooltip: function (rect) {\n                this.cellInput.toggleTooltip(notEqual(this._rect, rect));\n            },\n            value: function (value) {\n                if (value === undefined) {\n                    return this.barInput.value();\n                }\n                if (value === null) {\n                    value = '';\n                }\n                this._value = value;\n                this.barInput.value(value);\n                this.cellInput.value(value);\n            }\n        });\n        function notEqual(oldRect, newRect) {\n            return oldRect && (oldRect.top !== newRect.top || oldRect.left !== newRect.left);\n        }\n        kendo.spreadsheet.SheetEditor = SheetEditor;\n    }(kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/autofill', [\n        'spreadsheet/runtime',\n        'spreadsheet/range'\n    ], f);\n}(function () {\n    'use strict';\n    if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n        return;\n    }\n    var spreadsheet = kendo.spreadsheet;\n    var Range = spreadsheet.Range;\n    var runtime = spreadsheet.calc.runtime;\n    var Formula = runtime.Formula;\n    var MSG_INCOMPATIBLE = 'Incompatible ranges in fillFrom';\n    var MSG_NO_DIRECTION = 'Cannot determine fill direction';\n    Range.prototype._previewFillFrom = function (srcRange, direction) {\n        var destRange = this, sheet = destRange._sheet;\n        if (typeof srcRange == 'string') {\n            srcRange = sheet.range(srcRange);\n        }\n        var src = srcRange._ref.toRangeRef();\n        var dest = destRange._ref.toRangeRef();\n        if (src.intersects(dest)) {\n            if (src.eq(dest)) {\n                return null;\n            }\n            dest = dest.clone();\n            if (src.topLeft.eq(dest.topLeft)) {\n                if (src.width() == dest.width()) {\n                    dest.topLeft.row += src.height();\n                    direction = 0;\n                } else if (src.height() == dest.height()) {\n                    dest.topLeft.col += src.width();\n                    direction = 1;\n                } else {\n                    throw new Error(MSG_INCOMPATIBLE);\n                }\n            } else if (src.bottomRight.eq(dest.bottomRight)) {\n                if (src.width() == dest.width()) {\n                    dest.bottomRight.row -= src.height();\n                    direction = 2;\n                } else if (src.height() == dest.height()) {\n                    dest.bottomRight.col -= src.width();\n                    direction = 3;\n                } else {\n                    throw new Error(MSG_INCOMPATIBLE);\n                }\n            } else {\n                throw new Error(MSG_INCOMPATIBLE);\n            }\n            return sheet.range(dest)._previewFillFrom(srcRange, direction);\n        }\n        if (direction == null) {\n            if (src.topLeft.col == dest.topLeft.col) {\n                direction = src.topLeft.row < dest.topLeft.row ? 0 : 2;\n            } else if (src.topLeft.row == dest.topLeft.row) {\n                direction = src.topLeft.col < dest.topLeft.col ? 1 : 3;\n            } else {\n                throw new Error(MSG_NO_DIRECTION);\n            }\n        }\n        var horizontal = direction & 1;\n        var descending = direction & 2;\n        if (horizontal && src.height() != dest.height() || !horizontal && src.width() != dest.width()) {\n            throw new Error(MSG_INCOMPATIBLE);\n        }\n        var data = srcRange._properties(), n;\n        if (!horizontal) {\n            data = transpose(data);\n            n = dest.height();\n        } else {\n            n = dest.width();\n        }\n        var fill = new Array(data.length);\n        for (var i = 0; i < data.length; ++i) {\n            var s = data[i];\n            var f = findSeries(s);\n            var a = fill[i] = new Array(n);\n            for (var j = 0; j < n; ++j) {\n                var idx = descending ? -j - 1 : s.length + j;\n                var srcIdx = descending ? s.length - j % s.length - 1 : j % s.length;\n                a[descending ? n - j - 1 : j] = f(idx, srcIdx);\n            }\n        }\n        if (!horizontal) {\n            fill = transpose(fill);\n        }\n        return {\n            props: fill,\n            direction: direction,\n            dest: destRange\n        };\n    };\n    Range.prototype.fillFrom = function (srcRange, direction) {\n        var x = this._previewFillFrom(srcRange, direction);\n        x.dest._properties(x.props);\n        return x.dest;\n    };\n    function linearRegression(data) {\n        var N = data.length;\n        var mx = (N + 1) / 2, my = data.reduce(function (a, b) {\n                return a + b;\n            }, 0) / N;\n        var s1 = 0, s2 = 0;\n        for (var i = 0; i < N; i++) {\n            var t1 = i + 1 - mx, t2 = data[i] - my;\n            s1 += t1 * t2;\n            s2 += t1 * t1;\n        }\n        if (!s2) {\n            return function (N) {\n                return data[N % data.length];\n            };\n        }\n        var b = s1 / s2, a = my - b * mx;\n        return function (N) {\n            return a + b * (N + 1);\n        };\n    }\n    function findSeries(properties) {\n        function findStep(a) {\n            var diff = a[1] - a[0];\n            for (var i = 2; i < a.length; ++i) {\n                if (a[i] - a[i - 1] != diff) {\n                    return null;\n                }\n            }\n            return diff;\n        }\n        function getData(a) {\n            return a.map(function (v) {\n                return v.number;\n            });\n        }\n        var series = [];\n        var data = properties.map(function (x) {\n            return x.formula || x.value;\n        });\n        forEachSeries(data, function (begin, end, type, a) {\n            var f, values;\n            if (type == 'number') {\n                values = getData(a);\n                if (values.length == 1 && (begin > 0 || end < data.length || formatType(values[0], properties[begin].format) == 'date')) {\n                    values.push(values[0] + 1);\n                }\n                f = linearRegression(values);\n            } else if (type == 'string' || type == 'formula' || type == 'boolean') {\n                f = function (N, i) {\n                    return data[i];\n                };\n            } else if (Array.isArray(type)) {\n                if (a.length == 1) {\n                    f = function (N) {\n                        return type[(a[0].number + N) % type.length];\n                    };\n                } else {\n                    var diff = findStep(getData(a));\n                    if (diff == null) {\n                        f = function (N) {\n                            return a[N % a.length].value;\n                        };\n                    } else {\n                        f = function (N) {\n                            var idx = a[0].number + diff * N;\n                            return type[idx % type.length];\n                        };\n                    }\n                }\n            } else if (type != 'null') {\n                values = getData(a);\n                if (values.length == 1) {\n                    values.push(values[0] + 1);\n                }\n                values = linearRegression(values);\n                f = function (N, i) {\n                    return data[i].replace(/^(.*\\D)\\d+/, '$1' + values(N, i));\n                };\n            } else {\n                f = function () {\n                    return null;\n                };\n            }\n            var s = {\n                f: f,\n                begin: begin,\n                end: end,\n                len: end - begin\n            };\n            for (var i = begin; i < end; ++i) {\n                series[i] = s;\n            }\n        });\n        return function (N, i) {\n            var s = series[i];\n            var q = N / data.length | 0;\n            var r = N % data.length;\n            var n = q * s.len + r - s.begin;\n            var value = s.f(n, i);\n            var props = clone(properties[i]);\n            if (value instanceof Formula) {\n                props.formula = value;\n            } else {\n                props.value = value;\n            }\n            return props;\n        };\n    }\n    function formatType(value, format) {\n        if (format != null) {\n            return spreadsheet.formatting.type(value, format);\n        }\n    }\n    function clone(obj) {\n        var copy = {};\n        Object.keys(obj || {}).forEach(function (key) {\n            copy[key] = obj[key];\n        });\n        return copy;\n    }\n    function forEachSeries(data, f) {\n        var prev = null, start = 0, a = [], type;\n        for (var i = 0; i < data.length; ++i) {\n            type = getType(data[i]);\n            a.push(type);\n            if (prev != null && type.type !== prev.type) {\n                f(start, i, prev.type, a.slice(start, i));\n                start = i;\n            }\n            prev = type;\n        }\n        f(start, i, prev.type, a.slice(start, i));\n    }\n    function getType(el) {\n        if (typeof el == 'number') {\n            return {\n                type: 'number',\n                number: el\n            };\n        }\n        if (typeof el == 'string') {\n            var lst = findStringList(el);\n            if (lst) {\n                return lst;\n            }\n            var m = /^(.*\\D)(\\d+)/.exec(el);\n            if (m) {\n                el = el.replace(/^(.*\\D)\\d+/, '$1-######');\n                return {\n                    type: el,\n                    match: m,\n                    number: parseFloat(m[2])\n                };\n            }\n            return { type: 'string' };\n        }\n        if (typeof el == 'boolean') {\n            return { type: 'boolean' };\n        }\n        if (el == null) {\n            return { type: 'null' };\n        }\n        if (el instanceof Formula) {\n            return { type: 'formula' };\n        }\n        window.console.error(el);\n        throw new Error('Cannot fill data');\n    }\n    function stringLists() {\n        var culture = kendo.culture();\n        return [\n            culture.calendars.standard.days.namesAbbr,\n            culture.calendars.standard.days.names,\n            culture.calendars.standard.months.namesAbbr,\n            culture.calendars.standard.months.names\n        ];\n    }\n    function findStringList(str) {\n        var strl = str.toLowerCase();\n        var lists = stringLists();\n        for (var i = 0; i < lists.length; ++i) {\n            var a = lists[i];\n            for (var j = a.length; --j >= 0;) {\n                var el = a[j].toLowerCase();\n                if (el == strl) {\n                    return {\n                        type: a,\n                        number: j,\n                        value: str\n                    };\n                }\n            }\n        }\n    }\n    function transpose(a) {\n        var height = a.length, width = a[0].length;\n        var t = [];\n        for (var i = 0; i < width; ++i) {\n            t[i] = [];\n            for (var j = 0; j < height; ++j) {\n                t[i][j] = a[j][i];\n            }\n        }\n        return t;\n    }\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/print', [\n        'kendo.pdf',\n        'spreadsheet/sheet',\n        'spreadsheet/range',\n        'spreadsheet/references',\n        'spreadsheet/numformat',\n        'util/text-metrics'\n    ], f);\n}(function () {\n    'use strict';\n    if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n        return;\n    }\n    var spreadsheet = kendo.spreadsheet;\n    var CellRef = spreadsheet.CellRef;\n    var drawing = kendo.drawing;\n    var formatting = spreadsheet.formatting;\n    var geo = kendo.geometry;\n    var GUIDELINE_WIDTH = 0.8;\n    function distributeCoords(heights, pageHeight) {\n        var curr = 0;\n        var out = [];\n        var threshold = 0.2 * pageHeight;\n        var bottom = pageHeight;\n        heights.forEach(function (h) {\n            if (pageHeight && curr + h > bottom) {\n                if (bottom - curr < threshold) {\n                    curr = pageHeight * Math.ceil(curr / pageHeight);\n                }\n                bottom += pageHeight * Math.ceil(h / pageHeight);\n            }\n            out.push(curr);\n            curr += h;\n        });\n        out.push(curr);\n        return out;\n    }\n    function getMergedCells(sheet, range) {\n        var grid = sheet._grid;\n        var primary = {};\n        var secondary = {};\n        sheet.forEachMergedCell(range, function (ref) {\n            var topLeft = ref.topLeft;\n            grid.forEach(ref, function (cellRef) {\n                if (topLeft.eq(cellRef)) {\n                    primary[cellRef.print()] = ref;\n                } else if (range.contains(cellRef)) {\n                    secondary[cellRef.print()] = topLeft;\n                }\n            });\n        });\n        return {\n            primary: primary,\n            secondary: secondary\n        };\n    }\n    function doLayout(sheet, range, options) {\n        var cells = [];\n        var rowHeights = [];\n        var colWidths = [];\n        var mergedCells = getMergedCells(sheet, range);\n        var maxRow = -1, maxCol = -1;\n        sheet.forEach(range, function (row, col, cell) {\n            var relrow = row - range.topLeft.row;\n            var relcol = col - range.topLeft.col;\n            if (!relcol) {\n                rowHeights.push(sheet.rowHeight(row));\n            }\n            if (!relrow) {\n                colWidths.push(sheet.columnWidth(col));\n            }\n            if (sheet.isHiddenColumn(col) || sheet.isHiddenRow(row)) {\n                return;\n            }\n            var nonEmpty = options.forScreen || shouldDrawCell(cell);\n            if (!(options.emptyCells || nonEmpty)) {\n                return;\n            }\n            var id = new CellRef(row, col).print();\n            if (mergedCells.secondary[id]) {\n                return;\n            }\n            if (nonEmpty) {\n                maxRow = Math.max(maxRow, relrow);\n                maxCol = Math.max(maxCol, relcol);\n            } else {\n                cell.empty = true;\n            }\n            var m = mergedCells.primary[id];\n            if (m) {\n                delete mergedCells.primary[id];\n                cell.merged = true;\n                cell.rowspan = m.height();\n                cell.colspan = m.width();\n                if (options.forScreen) {\n                    cell.width = sheet._columns.sum(m.topLeft.col, m.bottomRight.col);\n                    cell.height = sheet._rows.sum(m.topLeft.row, m.bottomRight.row);\n                }\n            } else {\n                cell.rowspan = 1;\n                cell.colspan = 1;\n            }\n            cell.row = relrow;\n            cell.col = relcol;\n            cells.push(cell);\n        });\n        rowHeights = rowHeights.slice(0, maxRow + 1);\n        colWidths = colWidths.slice(0, maxCol + 1);\n        var pageWidth = options.pageWidth;\n        var pageHeight = options.pageHeight;\n        var scaleFactor = 1;\n        if (options.fitWidth) {\n            var width = colWidths.reduce(sum, 0);\n            if (width > pageWidth) {\n                scaleFactor = pageWidth / width;\n                pageWidth /= scaleFactor;\n                pageHeight /= scaleFactor;\n            }\n        }\n        var yCoords = distributeCoords(rowHeights, pageHeight || 0);\n        var xCoords = distributeCoords(colWidths, pageWidth || 0);\n        var boxWidth = 0;\n        var boxHeight = 0;\n        cells = cells.filter(function (cell) {\n            if (cell.empty && (cell.row > maxRow || cell.col > maxCol)) {\n                return false;\n            }\n            cell.left = xCoords[cell.col];\n            cell.top = yCoords[cell.row];\n            if (cell.merged) {\n                if (!options.forScreen) {\n                    cell.right = orlast(xCoords, cell.col + cell.colspan);\n                    cell.bottom = orlast(yCoords, cell.row + cell.rowspan);\n                    cell.width = cell.right - cell.left;\n                    cell.height = cell.bottom - cell.top;\n                } else {\n                    cell.right = cell.left + cell.width;\n                    cell.bottom = cell.top + cell.height;\n                }\n            } else {\n                cell.width = colWidths[cell.col];\n                cell.height = rowHeights[cell.row];\n                cell.bottom = cell.top + cell.height;\n                cell.right = cell.left + cell.width;\n            }\n            boxWidth = Math.max(boxWidth, cell.right);\n            boxHeight = Math.max(boxHeight, cell.bottom);\n            return true;\n        });\n        Object.keys(mergedCells.primary).forEach(function (id) {\n            var ref = mergedCells.primary[id];\n            sheet.forEach(ref.topLeft.toRangeRef(), function (row, col, cell) {\n                var relrow = row - range.topLeft.row;\n                var relcol = col - range.topLeft.col;\n                cell.merged = true;\n                cell.colspan = ref.height();\n                cell.rowspan = ref.width();\n                if (relrow < 0) {\n                    cell.top = -sheet._rows.sum(row, row - relrow - 1);\n                } else {\n                    cell.top = yCoords[relrow];\n                }\n                if (relcol < 0) {\n                    cell.left = -sheet._columns.sum(col, col - relcol - 1);\n                } else {\n                    cell.left = xCoords[relcol];\n                }\n                cell.height = sheet._rows.sum(ref.topLeft.row, ref.bottomRight.row);\n                cell.width = sheet._columns.sum(ref.topLeft.col, ref.bottomRight.col);\n                cell.right = cell.left + cell.width;\n                cell.bottom = cell.top + cell.height;\n                cells.push(cell);\n            });\n        });\n        return {\n            width: boxWidth,\n            height: boxHeight,\n            cells: cells.sort(normalOrder),\n            scale: scaleFactor,\n            xCoords: xCoords,\n            yCoords: yCoords\n        };\n    }\n    function sum(a, b) {\n        return a + b;\n    }\n    function orlast(a, i) {\n        return i < a.length ? a[i] : a[a.length - 1];\n    }\n    function shouldDrawCell(cell) {\n        return cell.value != null || cell.merged || cell.background != null || cell.borderTop != null || cell.borderRight != null || cell.borderBottom != null || cell.borderLeft != null;\n    }\n    function normalOrder(a, b) {\n        if (a.top < b.top) {\n            return -1;\n        } else if (a.top == b.top) {\n            if (a.left < b.left) {\n                return -1;\n            } else if (a.left == b.left) {\n                return 0;\n            } else {\n                return 1;\n            }\n        } else {\n            return 1;\n        }\n    }\n    function drawLayout(layout, group, options) {\n        var ncols = Math.ceil(layout.width / options.pageWidth);\n        var nrows = Math.ceil(layout.height / options.pageHeight);\n        var pageWidth = options.pageWidth / layout.scale;\n        var pageHeight = options.pageHeight / layout.scale;\n        for (var i = 0; i < ncols; ++i) {\n            for (var j = 0; j < nrows; ++j) {\n                addPage(j, i);\n            }\n        }\n        function addPage(row, col) {\n            var left = col * pageWidth;\n            var right = left + pageWidth;\n            var top = row * pageHeight;\n            var bottom = top + pageHeight;\n            var endbottom = 0, endright = 0;\n            var cells = layout.cells.filter(function (cell) {\n                if (cell.right <= left || cell.left >= right || cell.bottom <= top || cell.top >= bottom) {\n                    return false;\n                }\n                endbottom = Math.max(cell.bottom, endbottom);\n                endright = Math.max(cell.right, endright);\n                return true;\n            });\n            if (cells.length > 0) {\n                var page = new drawing.Group();\n                group.append(page);\n                page.clip(drawing.Path.fromRect(new geo.Rect([\n                    0,\n                    0\n                ], [\n                    options.pageWidth,\n                    options.pageHeight\n                ])));\n                var content = new drawing.Group();\n                page.append(content);\n                var matrix = geo.Matrix.scale(layout.scale, layout.scale).multiplyCopy(geo.Matrix.translate(-left, -top));\n                if (options.hCenter || options.vCenter) {\n                    matrix = matrix.multiplyCopy(geo.Matrix.translate(options.hCenter ? (right - endright) / 2 : 0, options.vCenter ? (bottom - endbottom) / 2 : 0));\n                }\n                content.transform(matrix);\n                if (options.guidelines) {\n                    var prev = null;\n                    layout.xCoords.forEach(function (x) {\n                        x = Math.min(x, endright);\n                        if (x !== prev && x >= left && x <= right) {\n                            prev = x;\n                            content.append(new drawing.Path().moveTo(x, top).lineTo(x, endbottom).close().stroke('#999', GUIDELINE_WIDTH));\n                        }\n                    });\n                    var prev = null;\n                    layout.yCoords.forEach(function (y) {\n                        y = Math.min(y, endbottom);\n                        if (y !== prev && y >= top && y <= bottom) {\n                            prev = y;\n                            content.append(new drawing.Path().moveTo(left, y).lineTo(endright, y).close().stroke('#999', GUIDELINE_WIDTH));\n                        }\n                    });\n                }\n                var borders = new drawing.Group();\n                cells.forEach(function (cell) {\n                    drawCell(cell, content, borders, options);\n                });\n                content.append(borders);\n            }\n        }\n    }\n    function drawCell(cell, content, borders, options) {\n        var g = new drawing.Group();\n        content.append(g);\n        var rect = new geo.Rect([\n            cell.left,\n            cell.top\n        ], [\n            cell.width,\n            cell.height\n        ]);\n        if (cell.background || cell.merged) {\n            var r2d2 = rect;\n            if (options.guidelines) {\n                r2d2 = rect.clone();\n                r2d2.origin.x += GUIDELINE_WIDTH / 2;\n                r2d2.origin.y += GUIDELINE_WIDTH / 2;\n                r2d2.size.width -= GUIDELINE_WIDTH;\n                r2d2.size.height -= GUIDELINE_WIDTH;\n            }\n            g.append(new drawing.Rect(r2d2).fill(cell.background || '#fff').stroke(null));\n        }\n        if (cell.borderLeft) {\n            borders.append(new drawing.Path().moveTo(cell.left, cell.top).lineTo(cell.left, cell.bottom).close().stroke(cell.borderLeft.color, cell.borderLeft.size));\n        }\n        if (cell.borderTop) {\n            borders.append(new drawing.Path().moveTo(cell.left, cell.top).lineTo(cell.right, cell.top).close().stroke(cell.borderTop.color, cell.borderTop.size));\n        }\n        if (cell.borderRight) {\n            borders.append(new drawing.Path().moveTo(cell.right, cell.top).lineTo(cell.right, cell.bottom).close().stroke(cell.borderRight.color, cell.borderRight.size));\n        }\n        if (cell.borderBottom) {\n            borders.append(new drawing.Path().moveTo(cell.left, cell.bottom).lineTo(cell.right, cell.bottom).close().stroke(cell.borderBottom.color, cell.borderBottom.size));\n        }\n        var val = cell.value;\n        if (val != null) {\n            var type = typeof val == 'number' ? 'number' : null;\n            var clip = new drawing.Group();\n            clip.clip(drawing.Path.fromRect(rect));\n            g.append(clip);\n            var f;\n            if (cell.format) {\n                f = formatting.textAndColor(val, cell.format);\n                val = f.text;\n                if (f.type) {\n                    type = f.type;\n                }\n            } else {\n                val += '';\n            }\n            if (!cell.textAlign) {\n                switch (type) {\n                case 'number':\n                case 'date':\n                case 'percent':\n                    cell.textAlign = 'right';\n                    break;\n                case 'boolean':\n                    cell.textAlign = 'center';\n                    break;\n                }\n            }\n            drawText(val, f && f.color || cell.color || '#000', cell, clip);\n        }\n    }\n    function drawText(text, color, cell, group) {\n        var rect_left = cell.left + 2;\n        var rect_top = cell.top + 2;\n        var rect_width = cell.width - 4;\n        var rect_height = cell.height - 4;\n        var font = makeFontDef(cell);\n        var style = { font: font };\n        var props = {\n            font: font,\n            fill: { color: color }\n        };\n        var lines = [], text_height = 0, top = rect_top;\n        if (cell.wrap) {\n            lineBreak(text, style, rect_width).forEach(function (line) {\n                var tmp = new drawing.Text(line.text, [\n                    rect_left,\n                    top\n                ], props);\n                top += line.box.height;\n                lines.push({\n                    el: tmp,\n                    box: line.box\n                });\n            });\n            text_height = top - rect_top;\n        } else {\n            var tmp = new drawing.Text(text, [\n                rect_left,\n                top\n            ], props);\n            var box = kendo.util.measureText(text, style);\n            lines.push({\n                el: tmp,\n                box: box\n            });\n            text_height = box.height;\n        }\n        var cont = new drawing.Group();\n        group.append(cont);\n        var vtrans = 0;\n        switch (cell.verticalAlign) {\n        case 'center':\n            vtrans = rect_height - text_height >> 1;\n            break;\n        case undefined:\n        case null:\n        case 'bottom':\n            vtrans = rect_height - text_height;\n            break;\n        }\n        if (vtrans < 0) {\n            vtrans = 0;\n        }\n        lines.forEach(function (line) {\n            cont.append(line.el);\n            var htrans = 0;\n            switch (cell.textAlign) {\n            case 'center':\n                htrans = rect_width - line.box.width >> 1;\n                break;\n            case 'right':\n                htrans = rect_width - line.box.width;\n                break;\n            }\n            if (htrans < 0) {\n                htrans = 0;\n            }\n            if (htrans || vtrans) {\n                line.el.transform(geo.Matrix.translate(htrans, vtrans));\n            }\n        });\n    }\n    function lineBreak(text, style, width) {\n        var lines = [];\n        var len = text.length;\n        var start = 0;\n        while (start < len) {\n            split(start, len, len);\n        }\n        return lines;\n        function split(min, eol, max) {\n            var sub = text.substring(start, eol).trim();\n            var box = kendo.util.measureText(sub, style);\n            if (box.width <= width) {\n                if (eol < max - 1) {\n                    split(eol, eol + max >> 1, max);\n                } else {\n                    lines.push({\n                        text: sub,\n                        box: box\n                    });\n                    start = eol;\n                }\n            } else if (min < eol) {\n                split(min, min + eol >> 1, eol);\n            }\n        }\n    }\n    function makeFontDef(cell) {\n        var font = [];\n        if (cell.italic) {\n            font.push('italic');\n        }\n        if (cell.bold) {\n            font.push('bold');\n        }\n        font.push((cell.fontSize || 12) + 'px');\n        font.push(cell.fontFamily || 'Arial');\n        return font.join(' ');\n    }\n    function draw(sheet, range, options, callback) {\n        if (options == null && callback == null) {\n            callback = range;\n            options = {};\n            range = spreadsheet.SHEETREF;\n        }\n        if (callback == null) {\n            callback = options;\n            if (range instanceof spreadsheet.Range || range instanceof spreadsheet.Ref || typeof range == 'string') {\n                options = {};\n            } else {\n                options = range;\n                range = spreadsheet.SHEETREF;\n            }\n        }\n        options = kendo.jQuery.extend({\n            paperSize: 'A4',\n            landscape: true,\n            margin: '1cm',\n            guidelines: true,\n            emptyCells: true,\n            fitWidth: false,\n            center: false\n        }, options);\n        var group = new drawing.Group();\n        var paper = kendo.pdf.getPaperOptions(options);\n        group.options.set('pdf', {\n            author: options.author,\n            creator: options.creator,\n            date: options.date,\n            keywords: options.keywords,\n            margin: paper.margin,\n            multiPage: true,\n            paperSize: paper.paperSize,\n            subject: options.subject,\n            title: options.title\n        });\n        var pageWidth = paper.paperSize[0];\n        var pageHeight = paper.paperSize[1];\n        if (paper.margin) {\n            pageWidth -= paper.margin.left + paper.margin.right;\n            pageHeight -= paper.margin.top + paper.margin.bottom;\n        }\n        options.pageWidth = pageWidth;\n        options.pageHeight = pageHeight;\n        var layout = doLayout(sheet, sheet._ref(range), options);\n        drawLayout(layout, group, options);\n        callback(group);\n    }\n    spreadsheet.Sheet.prototype.draw = function (range, options, callback) {\n        var sheet = this;\n        if (sheet._workbook) {\n            sheet.recalc(sheet._workbook._context, function () {\n                draw(sheet, range, options, callback);\n            });\n        } else {\n            draw(sheet, range, options, callback);\n        }\n    };\n    spreadsheet.draw = {\n        doLayout: doLayout,\n        drawLayout: drawLayout,\n        shouldDrawCell: shouldDrawCell\n    };\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('kendo.spreadsheet', [\n        'util/undoredostack',\n        'util/text-metrics',\n        'util/parse-xml',\n        'kendo.excel',\n        'kendo.progressbar',\n        'kendo.pdf',\n        'spreadsheet/commands',\n        'spreadsheet/formulabar',\n        'spreadsheet/formulainput',\n        'spreadsheet/eventlistener',\n        'spreadsheet/rangelist',\n        'spreadsheet/propertybag',\n        'spreadsheet/references',\n        'spreadsheet/navigator',\n        'spreadsheet/axismanager',\n        'spreadsheet/clipboard',\n        'spreadsheet/range',\n        'spreadsheet/sheet',\n        'spreadsheet/sheetsbar',\n        'spreadsheet/excel-reader',\n        'spreadsheet/workbook',\n        'spreadsheet/formulacontext',\n        'spreadsheet/controller',\n        'spreadsheet/view',\n        'spreadsheet/grid',\n        'spreadsheet/axis',\n        'spreadsheet/filter',\n        'spreadsheet/sorter',\n        'spreadsheet/runtime',\n        'spreadsheet/calc',\n        'spreadsheet/numformat',\n        'spreadsheet/runtime.functions',\n        'spreadsheet/runtime.functions.2',\n        'spreadsheet/toolbar',\n        'spreadsheet/dialogs',\n        'spreadsheet/sheetbinder',\n        'spreadsheet/filtermenu',\n        'spreadsheet/editor',\n        'spreadsheet/autofill',\n        'spreadsheet/print'\n    ], f);\n}(function () {\n    var __meta__ = {\n        id: 'spreadsheet',\n        name: 'Spreadsheet',\n        category: 'web',\n        description: 'Spreadsheet component',\n        depends: [\n            'core',\n            'binder',\n            'colorpicker',\n            'combobox',\n            'data',\n            'dom',\n            'dropdownlist',\n            'menu',\n            'ooxml',\n            'popup',\n            'sortable',\n            'tabstrip',\n            'toolbar',\n            'treeview',\n            'window',\n            'validator',\n            'excel',\n            'pdf',\n            'drawing'\n        ]\n    };\n    (function (kendo, undefined) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var $ = kendo.jQuery;\n        var Widget = kendo.ui.Widget;\n        var Workbook = kendo.spreadsheet.Workbook;\n        var Controller = kendo.spreadsheet.Controller;\n        var View = kendo.spreadsheet.View;\n        var NS = '.kendoSpreadsheet';\n        var ALL_REASONS = {\n            recalc: true,\n            selection: true,\n            activeCell: true,\n            layout: true,\n            sheetSelection: true,\n            resize: true,\n            editorChange: false,\n            editorClose: false\n        };\n        var classNames = { wrapper: 'k-widget k-spreadsheet' };\n        var Spreadsheet = kendo.ui.Widget.extend({\n            init: function (element, options) {\n                Widget.fn.init.call(this, element, options);\n                this.element.addClass(Spreadsheet.classNames.wrapper);\n                this._view = new View(this.element, {\n                    toolbar: this.options.toolbar,\n                    sheetsbar: this.options.sheetsbar\n                });\n                this._workbook = new Workbook(this.options, this._view);\n                this._controller = new Controller(this._view, this._workbook);\n                this._autoRefresh = true;\n                this._bindWorkbookEvents();\n                this._view.workbook(this._workbook);\n                this.refresh();\n                this._resizeHandler = function () {\n                    this.resize();\n                }.bind(this);\n                $(window).on('resize' + NS, this._resizeHandler);\n            },\n            _resize: function () {\n                this.refresh({ layout: true });\n            },\n            _workbookChange: function (e) {\n                if (this._autoRefresh) {\n                    this.refresh(e);\n                }\n            },\n            activeSheet: function (sheet) {\n                return this._workbook.activeSheet(sheet);\n            },\n            moveSheetToIndex: function (sheet, index) {\n                return this._workbook.moveSheetToIndex(sheet, index);\n            },\n            insertSheet: function (options) {\n                return this._workbook.insertSheet(options);\n            },\n            sheets: function () {\n                return this._workbook.sheets();\n            },\n            removeSheet: function (sheet) {\n                return this._workbook.removeSheet(sheet);\n            },\n            sheetByName: function (sheetName) {\n                return this._workbook.sheetByName(sheetName);\n            },\n            sheetIndex: function (sheet) {\n                return this._workbook.sheetIndex(sheet);\n            },\n            sheetByIndex: function (index) {\n                return this._workbook.sheetByIndex(index);\n            },\n            renameSheet: function (sheet, newSheetName) {\n                return this._workbook.renameSheet(sheet, newSheetName);\n            },\n            refresh: function (reason) {\n                if (!reason) {\n                    reason = ALL_REASONS;\n                }\n                if (!reason.editorClose) {\n                    this._view.sheet(this._workbook.activeSheet());\n                    this._controller.sheet(this._workbook.activeSheet());\n                    this._workbook.refresh(reason);\n                }\n                if (!reason.editorChange) {\n                    this._view.refresh(reason);\n                    this._controller.refresh();\n                    this._view.render();\n                    this.trigger('render');\n                }\n                return this;\n            },\n            openDialog: function (name, options) {\n                return this._view.openDialog(name, options);\n            },\n            autoRefresh: function (value) {\n                if (value !== undefined) {\n                    this._autoRefresh = value;\n                    if (value === true) {\n                        this.refresh();\n                    }\n                    return this;\n                }\n                return this._autoRefresh;\n            },\n            toJSON: function () {\n                return this._workbook.toJSON();\n            },\n            fromJSON: function (json) {\n                if (json.sheets) {\n                    this._workbook.destroy();\n                    this._workbook = new Workbook($.extend({}, this.options, json));\n                    this._bindWorkbookEvents();\n                    this._view.workbook(this._workbook);\n                    this._controller.workbook(this._workbook);\n                    this.activeSheet(this.activeSheet());\n                } else {\n                    this.refresh();\n                }\n            },\n            fromFile: function (blob, name) {\n                return this._workbook.fromFile(blob, name);\n            },\n            saveAsPDF: function (options) {\n                this._workbook.saveAsPDF($.extend({}, this.options.pdf, options, { workbook: this._workbook }));\n            },\n            saveAsExcel: function (options) {\n                this._workbook.saveAsExcel(options);\n            },\n            draw: function (options, callback) {\n                this._workbook.draw(options, callback);\n            },\n            _workbookExcelExport: function (e) {\n                if (this.trigger('excelExport', e)) {\n                    e.preventDefault();\n                }\n            },\n            _workbookExcelImport: function (e) {\n                if (this.trigger('excelImport', e)) {\n                    e.preventDefault();\n                } else {\n                    this._initProgress(e.promise);\n                }\n            },\n            _initProgress: function (deferred) {\n                var loading = $('<div class=\\'k-loading-mask\\' ' + 'style=\\'width: 100%; height: 100%; top: 0;\\'>' + '<div class=\\'k-loading-color\\'/>' + '</div>').appendTo(this.element);\n                var pb = $('<div class=\\'k-loading-progress\\'>').appendTo(loading).kendoProgressBar({\n                    type: 'chunk',\n                    chunkCount: 10,\n                    min: 0,\n                    max: 1,\n                    value: 0\n                }).data('kendoProgressBar');\n                deferred.progress(function (e) {\n                    pb.value(e.progress);\n                }).always(function () {\n                    kendo.destroy(loading);\n                    loading.remove();\n                });\n            },\n            _workbookPdfExport: function (e) {\n                if (this.trigger('pdfExport', e)) {\n                    e.preventDefault();\n                }\n            },\n            _bindWorkbookEvents: function () {\n                this._workbook.bind('change', this._workbookChange.bind(this));\n                this._workbook.bind('excelExport', this._workbookExcelExport.bind(this));\n                this._workbook.bind('excelImport', this._workbookExcelImport.bind(this));\n                this._workbook.bind('pdfExport', this._workbookPdfExport.bind(this));\n            },\n            destroy: function () {\n                kendo.ui.Widget.fn.destroy.call(this);\n                this._workbook.destroy();\n                this._controller.destroy();\n                this._view.destroy();\n                if (this._resizeHandler) {\n                    $(window).off('resize' + NS, this._resizeHandler);\n                }\n            },\n            options: {\n                name: 'Spreadsheet',\n                toolbar: true,\n                sheetsbar: true,\n                rows: 200,\n                columns: 50,\n                rowHeight: 20,\n                columnWidth: 64,\n                headerHeight: 20,\n                headerWidth: 32,\n                excel: {\n                    proxyURL: '',\n                    fileName: 'Workbook.xlsx'\n                },\n                pdf: {\n                    area: 'workbook',\n                    fileName: 'Workbook.pdf',\n                    proxyURL: '',\n                    paperSize: 'a4',\n                    landscape: true,\n                    margin: null,\n                    title: null,\n                    author: null,\n                    subject: null,\n                    keywords: null,\n                    creator: 'Kendo UI PDF Generator v.' + kendo.version,\n                    date: null\n                }\n            },\n            events: [\n                'pdfExport',\n                'excelExport',\n                'excelImport',\n                'render'\n            ]\n        });\n        kendo.spreadsheet.ALL_REASONS = ALL_REASONS;\n        kendo.ui.plugin(Spreadsheet);\n        $.extend(true, Spreadsheet, { classNames: classNames });\n    }(window.kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));"],"sourceRoot":"/source/"}