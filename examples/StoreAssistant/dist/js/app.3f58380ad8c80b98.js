!function(){"use strict";var e=angular.module("esStoreAssistant",["ngAnimate","ngSanitize","ui.router","ngStorage","angular-loading-bar","pascalprecht.translate","es.Services.Web","kendo.directives","underscore","es.Web.UI","ui.bootstrap"]);e.esVersion="1.0.5",e.config(["$logProvider","esWebApiProvider","$translateProvider",function(e,a,s){s.useStaticFilesLoader({files:[{prefix:"languages/eswebapi-locale-",suffix:".json"},{prefix:"applanguages/",suffix:".json"}]}),s.preferredLanguage("el"),s.fallbackLanguage("en"),s.useSanitizeValueStrategy("escape"),e.addDefaultAppenders();var t={host:"eswebapi.entersoft.gr",allowUnsecureConnection:!1};a.setSettings(t)}]),e.run(["$log","$rootScope","$state","esGlobals",function(e,a,s,t){a.$on("$stateChangeError",function(e,a,i,r,n,o){t.getUserMessage(o).isLogin?s.go("login"):e.preventDefault()}),a.$on("$stateChangeStart",function(e,i,r,n,o){(i||{}).esUnauthenticated||"login"==i||(a.toState=i,a.toStateParams=r,t.isAuthenticated()||(e.preventDefault(),s.go("login")))}),s.go("login")}]),e.config(["$stateProvider","$urlRouterProvider",function(e,a){a.when("","/login"),a.when("/","/login"),e.state("appmenu",{abstract:!0,url:"",templateUrl:"views/appmenu.html"}).state("login",{url:"/login",templateUrl:"views/login.html",controller:"LoginCtrl",controllerAs:"login",esUnauthenticated:!0}).state("customer_search",{url:"/customer_search",parent:"appmenu",templateUrl:"views/customer_search.html",controller:"customer_searchCtrl",controllerAs:"vm",esUnauthenticated:!1}).state("customer_new",{url:"/customer_new",parent:"appmenu",templateUrl:"views/customer_new.html",controller:"customer_newCtrl",controllerAs:"vm",esUnauthenticated:!1}).state("storeSales",{url:"/storeSales",parent:"appmenu",templateUrl:"views/storesales.html",controller:"storeSalesCtrl",controllerAs:"vm",esUnauthenticated:!1}).state("skuAvailability",{url:"/skuAvailability",parent:"appmenu",templateUrl:"views/sku_availability.html",controller:"sku_AvailabilityCtrl",controllerAs:"vm",esUnauthenticated:!1}).state("sales",{url:"/sales",parent:"appmenu",templateUrl:"views/sales.html",esUnauthenticated:!1})}])}(),angular.module("esStoreAssistant").run(["$templateCache",function(e){"use strict";e.put("views/about.html","<div class=\"panel panel-primary\"><uif-spinner ng-show=state.isRunning uif-size=large>{{'MENU.WORKING' | translate}}</uif-spinner><div class=panel-heading>{{'MENU.SYSTEMINFO' | translate}}</div><table class=\"table table-striped table-bordered table-hover\"><thead><tr><th>{{'MENU.SUBSYSTEM' | translate}}</th><th>{{'MENU.VERSION' | translate}}</th></tr></thead><tbody><tr ng-repeat=\"ver in versionInfo | orderBy:'code'\"><td>{{ver.code}}</td><td>{{ver.value}}</td></tr></tbody></table></div>"),e.put("views/appmenu.html","<nav class=\"navbar navbar-inverse navbar-fixed-top\"><div class=container-fluid><div class=navbar-header><button type=button class=\"navbar-toggle collapsed\" data-toggle=collapse data-target=#es-navbar aria-expanded=false><span class=sr-only>Toggle navigation</span> <span class=icon-bar></span> <span class=icon-bar></span> <span class=icon-bar></span></button> <a class=navbar-brand href=#><img alt=\"Entersoft SA\" src=https://www.entersoft.gr/esaddin/eslogo32.png></a></div><div class=\"collapse navbar-collapse\" id=es-navbar><ul class=\"nav navbar-nav\"><li class=dropdown><a class=dropdown-toggle data-toggle=dropdown role=button aria-haspopup=true aria-expanded=false>{{'MENU.SALES.TITLE' | translate}}<span class=caret></span></a><ul class=dropdown-menu><li><a ui-sref=salesScore>{{'MENU.SALES.SCORE' | translate}}</a></li><li><a ui-sref=salesInfo>{{'MENU.SALES.INFORMATION' | translate}}</a></li></ul></li><li class=dropdown><a class=dropdown-toggle data-toggle=dropdown role=button aria-haspopup=true aria-expanded=false>{{'MENU.SKU.TITLE' | translate}}<span class=caret></span></a><ul class=dropdown-menu><li><a ui-sref=skuAvailability>{{'MENU.SKU.AVAILABILITY' | translate}}</a></li><li><a ui-sref=skuPrice>{{'MENU.SKU.PRICE' | translate}}</a></li><li><a ui-sref=skuInfo>{{'MENU.SKU.INFORMATION' | translate}}</a></li></ul></li><li class=dropdown><a class=dropdown-toggle data-toggle=dropdown role=button aria-haspopup=true aria-expanded=false>{{'MENU.CUSTOMER.TITLE' | translate}}<span class=caret></span></a><ul class=dropdown-menu><li><a ui-sref=customer_search>{{'MENU.CUSTOMER.INFORMATION' | translate}}</a></li><li><a ui-sref=customer_new>{{'MENU.CUSTOMER.NEW' | translate}}</a></li></ul></li><li class=dropdown><a class=dropdown-toggle data-toggle=dropdown role=button aria-haspopup=true aria-expanded=false>{{'MENU.DOCS.TITLE' | translate}}<span class=caret></span></a><ul class=dropdown-menu><li><a ui-sref=docsOrders>{{'MENU.DOCS.ORDERS' | translate}}</a></li><li><a ui-sref=docsReturns>{{'MENU.DOCS.RETURNS' | translate}}</a></li></ul></li><li class=dropdown><a class=dropdown-toggle data-toggle=dropdown role=button aria-haspopup=true aria-expanded=false>{{'MENU.STORE.TITLE' | translate}}<span class=caret></span></a><ul class=dropdown-menu><li><a ui-sref=storeSales>{{'MENU.STORE.SALES' | translate}}</a></li><li><a ui-sref=storeScore>{{'MENU.STORE.SCORE' | translate}}</a></li></ul></li></ul><div class=\"navbar-text navbar-right\"><img aria-hidden=true ng-src={{theSession.UserLogoUrl}} style=\"display: inline; width: 32px; height: 32px\"></div><ul class=\"nav navbar-nav navbar-right\"><li class=dropdown><a class=dropdown-toggle data-toggle=dropdown role=button aria-haspopup=true aria-expanded=false>{{theSession.UserName}}<span class=caret></span></a><ul class=dropdown-menu><li><a ng-click=signOut()>{{'MENU.SIGNOUT' | translate}}</a></li></ul></li></ul></div></div></nav><div ui-view>"),e.put("views/customer_new.html",'<div class="container esContainer"><es-params-panel es-params-def=vm.customerFields es-params-values=vm.customerValues es-panel-open=true es-run-click=vm.addCustomer() es-run-title=Add es-show-run=true></es-params-panel></div>'),e.put("views/customer_search.html",'<div class=container><uib-accordion close-others=true><div uib-accordion-group class=panel-primary heading="1. Search ..." is-open=vm.status.searchisOpen><es-params-panel class=esContainer es-params-def=vm.customerFields es-run-title=Search es-params-values=vm.customerValues es-panel-open=vm.status.searchisOpen es-run-click=vm.searchCustomer() es-show-run=true></es-params-panel></div><div uib-accordion-group class=panel-danger heading="2. Locate a customer ..." is-open=vm.status.listisOpen><es-grid es-group-id=vm.pqDef.GroupID es-filter-id=vm.pqDef.FilterID es-execute-params=vm.pqDef.Params es-pq-options=vm.pqDef.PQOptions es-data-source=vm.searchDS es-post-process-grid-options=vm.handleGridOptions(arg1)></div><div uib-accordion-group class=panel-success heading="3. Customer" is-open=vm.status.formisOpen><h5>{{vm.CustomerCode}}</h5></div></uib-accordion></div>'),e.put("views/es00documents.html","<div class=modal-header><h3 class=modal-title id=modal-title>{{vm.title}}</h3></div><div class=modal-body id=modal-body><uif-spinner ng-show=vm.state.isRunning uif-size=large>{{'MENU.WORKING' | translate}}</uif-spinner><es00-documents-detail es-isudgid=vm.cRow.fTaskGID></es00-documents-detail></div><div class=modal-footer><button class=\"btn btn-primary\" type=button ng-click=vm.ok()>{{'MENU.CLOSE' | translate}}</button></div>"),e.put("views/login.html","<div ng-cloak><es-login ng-show=showLogin es-credentials=esCredentials es-on-success=authenticate() es-show-subscription=true es-show-bridge=true es-show-sticky-session=0></es-login><uif-spinner ng-show=!showLogin uif-size=large>{{'MENU.AUTHENTICATING' | translate}}</uif-spinner></div>"),e.put("views/recipients.html","<div class=\"alert alert-warning\" role=alert><uif-spinner ng-show=recipients.state.isRunning uif-size=large>{{'MENU.WORKING' | translate}}</uif-spinner><strong>{{recipients.Rows.length}} eMail {{'PERSON.CONTACT' | translate}}</strong> {{'MENU.FOUNDINENTERSOFT' | translate}}</div><div ng-repeat=\"cRow in recipients.Rows\"><uif-persona-card uif-style=round uif-size=xlarge uif-image-url={{cRow.contactPhoto}}><uif-persona-card-primary-text>{{cRow.Name}}</uif-persona-card-primary-text><uif-persona-card-secondary-text>{{cRow.Department}}, {{cRow.CompanyName}}</uif-persona-card-secondary-text><uif-persona-card-tertiary-text>{{'PERSON.POSITION' | translate}}: {{cRow.Title}}</uif-persona-card-tertiary-text><uif-persona-card-optional-text>{{cRow.CompanyAddress}}</uif-persona-card-optional-text><uif-persona-card-action uif-icon=mail uif-placeholder=regular><uif-persona-card-detail-line ng-if=cRow.PersomEmail><uif-persona-card-detail-label>{{'PERSON.PERSONAL' | translate}}:</uif-persona-card-detail-label><uif-link ng-href=mailto:{{cRow.PersomEmail}}>{{cRow.PersomEmail}}</uif-link></uif-persona-card-detail-line><uif-persona-card-detail-line ng-if=cRow.ContactEmail><uif-persona-card-detail-label>{{'PERSON.CONTACT' | translate}}:</uif-persona-card-detail-label><uif-link ng-href=mailto:{{cRow.ContactEmail}}>{{cRow.ContactEmail}}</uif-link></uif-persona-card-detail-line></uif-persona-card-action><uif-persona-card-action uif-icon=phone uif-placeholder=regular><uif-persona-card-detail-line><uif-persona-card-detail-label>{{'PERSON.MOBILE' | translate}}:</uif-persona-card-detail-label>{{cRow.Mobile1}} / {{cRow.Mobile2}}</uif-persona-card-detail-line><uif-persona-card-detail-line><uif-persona-card-detail-label>{{'PERSON.PHONE' | translate}}(s):</uif-persona-card-detail-label>{{cRow.Person_Telephone1}} / {{cRow.Person_Telephone2}}</uif-persona-card-detail-line></uif-persona-card-action><uif-persona-card-action uif-icon=phone uif-placeholder=regular><uif-persona-card-detail-line><uif-persona-card-detail-label>{{'PERSON.COMPANY' | translate}}:</uif-persona-card-detail-label>{{cRow.Person_Telephone1}}</uif-persona-card-detail-line><uif-persona-card-detail-line><uif-persona-card-detail-label>{{'PERSON.COMPANY' | translate}}:</uif-persona-card-detail-label>{{cRow.Company_Telephone2}}</uif-persona-card-detail-line></uif-persona-card-action><uif-persona-card-action uif-icon=org ng-click=\"alert('hello')\" uif-placeholder=topright><uif-link ng-href=mailto:{{cRow.PersomEmail}}>{{cRow.PersomEmail}}</uif-link></uif-persona-card-action></uif-persona-card><br></div>"),e.put("views/sales.html","<h1>Hello World</h1>"),e.put("views/sku_availability.html",'<div class=container><uib-accordion close-others=true><div uib-accordion-group class=panel-primary heading="1. Search ..." is-open=vm.status.searchisOpen><form name=search_sku class=form><div class=row><div class="form-group col-xs-12"><input id=searchctrl class="form-control input-lg" placeholder="Barcode, Code, Multiple Codes" ng-required=true ng-model-options="{getterSetter: true}" ng-model=vm.searchValue.pValue></div></div><button class="btn btn-primary" type=button ng-disabled="search_sku.$invalid || vm.status.isrunning" ng-click=vm.searchSKU()>{{\'ESUI.GENERIC.OK\' | translate}}</button></form></div><div uib-accordion-group class=panel-danger heading="2. Local Store" is-open=vm.status.storeisOpen is-disabled=!vm.myStoreRow><table class="table table-hover table-condensed"><thead><tr><th>{{\'TABLE.FIELD\' | translate}}</th><th>{{\'TABLE.VALUE\' | translate}}</th></tr></thead><tbody><tr><td>Scan Code</td><td>{{vm.searchValue.strVal()}}</td></tr><tr ng-repeat="col in vm.myStoreInfo.columns"><td>{{col.title}}</td><td>{{vm.myStoreRow[col.field]}}</td></tr></tbody></table></div><div uib-accordion-group class=panel-success heading="3. Other Stores" is-open=vm.status.otherisOpen is-disabled=!vm.myStoreRow><es-grid es-group-id=vm.otherDef.GroupID es-filter-id=vm.otherDef.FilterID es-execute-params=vm.otherDef.Params es-pq-options=vm.otherDef.PQOptions es-data-source=vm.otherDS></div></uib-accordion></div>'),e.put("views/storeSales.html","<div id=esContainer><es-combo-pq es-pq-def=vm.storeSalesPQs></es-combo-pq></div>")}]),function(){"use strict";angular.module("esStoreAssistant").controller("LoginCtrl",["$state","$rootScope","$scope","$log","esWebApi","esUIHelper","_","esCache","esMessaging","esGlobals","$translate","$localStorage",function(e,a,s,t,i,r,n,o,l,u,c,d){function p(){var s,t="sales";a.toState&&(t=a.toState.name,s=a.toStateParams,a.toState=null,a.toStateParams={}),e.go(t,s)}function m(){s.esCredentials.subscriptionPassword&&s.esCredentials.UserID&&s.esCredentials.Password&&s.esCredentials.BranchID?(s.showLogin=!1,s.authenticate()):s.showLogin=!0}s.esCredentials=d.esStoreAssistantCredentials||{LangID:"en-US"},s.showLogin=!1,s.authenticate=function(){var e={ESDeviceID:"sme mail box",ESApplicationID:"Sme App",ESChannelID:"Outlook addin"};i.openSession(s.esCredentials,e).then(function(e){var a=angular.merge({},i.getServerSettings(),s.esCredentials);d.esStoreAssistantCredentials=a,p()},function(e){s.showLogin=!0})};m()}])}(),function(){"use strict";angular.module("esStoreAssistant").controller("MenuCtrl",["$state","$rootScope","$scope","$log","esWebApi","esUIHelper","_","esCache","esMessaging","esGlobals",function(e,a,s,t,i,r,n,o,l,u){function c(){s.theSession={isAuth:!1,UserName:"",UserLogoUrl:""}}c(),s.signOut=function(){i.logout().then(function(){e.go("login")}).catch(function(a){e.go("login")})},angular.isFunction(a.showMessage)||(a.showMessage=function(e){s.esnotify.error(e)}),l.subscribe("ES_HTTP_CORE_ERR",function(e,s){var t=u.getUserMessage(e,s);a.showMessage(t.messageToShow)}),l.subscribe("AUTH_CHANGED",function(e,a){a?(s.theSession.isAuth=!0,s.theSession.UserName=e.connectionModel.Name,s.theSession.UserLogoUrl=i.downloadES00BlobURLByObject("ESGOUser",e.connectionModel.GID,0)):c()})}])}(),function(){"use strict";angular.module("esStoreAssistant").controller("customer_searchCtrl",["$scope","esMessaging","esWebApi","esUIHelper","esGlobals","$timeout",function(e,a,s,t,i,r){var n=this;n.status={searchisOpen:!0,listisOpen:!1,formisOpen:!1},n.searchDS={};var o=new t.ESParamsDefinitions;o.createDefinitions("Search for a customer",[{id:"Loyalty",aa:1,caption:"Loyalty Number",visible:!0},{id:"eMail",aa:3,caption:"eMail",visible:!0},{id:"Name",aa:2,caption:"Name",visible:!0},{id:"Phone",aa:4,caption:"Phone",visible:!0,inputType:"tel"}]),n.customerFields=o,n.customerValues=o.getParamsValues();var l=new i.ESPQOptions(1,10,!0,!0,!1);n.pqDef=new i.ESPublicQueryDef("1","ESWebManager","BusEntitiesCustomers",l,n.customerValues),n.handleGridOptions=function(e){return e?(e.toolbar=null,e.sortable=!1,e.filterable=!1,e.groupable=!1,e.change=function(e){var a=e.sender.select();a&&1==a.length&&r(function(){n.CustomerCode=e.sender.dataItem(a[0]).Code,n.status.formisOpen=!0,n.status.searchisOpen=!1,n.status.listisOpen=!1})},e):e},n.searchCustomer=function(){n.searchDS&&angular.isFunction(n.searchDS.read)&&(n.searchDS.read(),n.status.listisOpen=!0,n.status.searchisOpen=!1,n.status.formisOpen=!1)}}])}(),function(){"use strict";angular.module("esStoreAssistant").controller("storeSalesCtrl",["$scope","esMessaging","esWebApi","esUIHelper","esGlobals","$timeout",function(e,a,s,t,i,r){this.storeSalesPQs={AA:3040,ID:"PQ_3040",GroupID:"SALES",Title:{en:"",el:"Ανάλυση λιανικής",ro:"",bg:""},Description:"Ανάλυση λιανικής",ESUIType:"esCombo",esDef:[{AA:3041,ID:"PQ_3041",Title:"Ανάλυση καλαθιού λιανικής ανά υποκατάστημα",Description:"Ανάλυση καλαθιού λιανικής ανά υποκατάστημα",ESUIType:"esGrid",esDef:{GroupID:"ESWebManager",FilterID:"SalesRetailMarketBasketAnalysisByBranch",PQOptions:{ServerPaging:!0,PageSize:20,AutoExecute:!1}}},{AA:3042,ID:"PQ_3042",Title:"Μέση τιμή τζίρου & ποσότητας ανά ημέρα",Description:"Μέση τιμή τζίρου & ποσότητας ανά ημέρα",ESUIType:"esChart",esDef:{GroupID:"ESWebManager",FilterID:"SalesRetailAverageTurnOverQuantityByDay",UIOptions:{autoBind:!0,legend:{visible:!0,position:"top",labels:{template:"#= series.title #"}},series:[{type:"column",field:"ESFIItemPeriodics_TurnOver",categoryField:"Day",axis:"ESFIItemPeriodics_TurnOver",color:"#228B22",title:"Τζίρος"},{type:"line",field:"Quantity",categoryField:"Day",axis:"Quantity",title:"Ποσότητα"}],valueAxis:[{visible:!0,name:"ESFIItemPeriodics_TurnOver",labels:{format:"{0}"},title:{text:{en:"Turnover",el:"Τζίρος",ro:"",bg:""}}},{visible:!0,name:"Quantity",labels:{format:"{0}"},title:{text:{en:"Quantity",el:"Ποσότητα",ro:"",bg:""}}}],categoryAxis:{categories:"Day",labels:{rotation:45,font:"8px"},axisCrossingValues:[0,205]},tooltip:{visible:!0,template:" #= category #, <br/>  #= kendo.format('{0:n2}',value )#"}}}},{AA:3043,ID:"PQ_3043",Title:"Φόρτος συναλλαγών ανά εβδομάδα",Description:"Φόρτος συναλλαγών ανά εβδομάδα",ESUIType:"esChart",esDef:{GroupID:"ESWebManager",FilterID:"SalesRetailTransactionLoadAnalysisByWeek",UIOptions:{autoBind:!0,legend:{visible:!0,position:"top",labels:{template:"#= series.title #"}},series:[{type:"column",field:"ESFIItemPeriodics_TurnOver",categoryField:"Week",axis:"ESFIItemPeriodics_TurnOver",color:"#228B22",title:"Τζίρος"},{type:"line",field:"ESFIItemPeriodics_SalesQty",categoryField:"Week",axis:"ESFIItemPeriodics_SalesQty",title:"Ποσότητα"}],valueAxis:[{visible:!0,name:"ESFIItemPeriodics_TurnOver",labels:{format:"{0}"},title:{text:{en:"Turnover",el:"Τζίρος",ro:"",bg:""}}},{visible:!0,name:"ESFIItemPeriodics_SalesQty",labels:{format:"{0}"},title:{text:{en:"Number of transactions",el:"Πλήθος συναλλαγών",ro:"",bg:""}}}],categoryAxis:{categories:"Week",labels:{rotation:45,font:"8px"},axisCrossingValues:[0,205]},tooltip:{visible:!0,template:" #= category #, <br/>  #= kendo.format('{0:n2}',value )#"}}}}]}}])}(),function(){"use strict";angular.module("esStoreAssistant").controller("customer_newCtrl",["$scope","esMessaging","esWebApi","esUIHelper","esGlobals","$timeout",function(e,a,s,t,i,r){var n=this,o=new t.ESParamsDefinitions;o.createDefinitions("Welcome a new customer",[{id:"First_Name",aa:1,caption:"First Name",visible:!0,required:!0},{id:"eMail",aa:3,caption:"eMail",visible:!0,required:!0},{id:"Last_Name",aa:2,caption:"Last Name",visible:!0,required:!0},{id:"MobilePhone",aa:4,caption:"Mobile Phone",visible:!0,required:!0,inputType:"tel"}]),n.customerFields=o,n.customerValues=o.getParamsValues(),n.addCustomer=function(){alert("Save")}}])}(),function(){"use strict";angular.module("esStoreAssistant").controller("sku_AvailabilityCtrl",["$scope","esMessaging","esWebApi","esUIHelper","esGlobals","$timeout",function(e,a,s,t,i,r){var n=this;n.otherDS={},n.status={searchisOpen:!0,storeisOpen:!1,otherisOpen:!1,isrunning:!1},n.searchValue=new i.ESParamVal("SeachCode"),n.params=new i.ESParamValues([n.searchValue]),n.pqDef=new i.ESPublicQueryDef("1","ESWebManager","BusEntitiesItems",null,n.params);var o=new i.ESPQOptions(1,10,!0,!0,!1);n.otherDef=new i.ESPublicQueryDef("1","ESWebManager","BusEntitiesItems",o,n.params),n.searchSKU=function(){n.status.isrunning=!0,s.fetchPublicQuery(n.pqDef).then(function(a){a.data.Rows&&a.data.Rows.length?(a.data.Rows.length>1&&e.showMessage("MULTIPLE SKU "+n.searchValue.strVal()+" FOUND"),n.otherDS&&angular.isFunction(n.otherDS.read)&&n.otherDS.read(),s.fetchPublicQueryInfo(n.pqDef.GroupID,n.pqDef.FilterID).then(function(e){var s=t.winGridInfoToESGridInfo(n.pqDef.GroupID,n.pqDef.FilterID,e.data);s.columns=_.remove(s.columns,function(e){return!(e.hidden||"Longitude"==e.field||"Latitude"==e.field)}),r(function(){n.status.isrunning=!1,n.myStoreInfo=s,n.myStoreRow=a.data.Rows[0],n.status.searchisOpen=!1,n.status.storeisOpen=!0,n.status.otherisOpen=!1})}).catch(function(e){n.status.isrunning=!1})):e.showMessage("SKU "+n.searchValue.strVal()+" NOT FOUND")}).catch(function(e){n.status.searchisOpen=!0,n.status.storeisOpen=!1,n.status.otherisOpen=!1,n.status.isrunning=!1})}}])}();